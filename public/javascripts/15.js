(window.webpackJsonp=window.webpackJsonp||[]).push([[15,18,19],{334:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnimationBase", function() { return AnimationBase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Animation", function() { return Animation; });\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(332);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(333);\n/* harmony import */ var _Sprite_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(347);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\nwindow.m_draw_animation_texture_info = false;\r\n\r\nclass IAnimation {\r\n\tconstructor(raw, url) {\r\n\t\tthis._raw = null;\r\n\t\tthis._url = null;\r\n\t\t\r\n\t\tObject.defineProperties(this, {\r\n\t\t\t_raw: {\r\n\t\t\t\tvalue: raw\r\n\t\t\t},\r\n\t\t\t_url: {\r\n\t\t\t\tvalue: url\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tthis.frame = 0;\r\n\t\tthis.time = 0;\r\n\r\n\t\t/** elapsed time */\r\n\t\tthis.delta = 0;\r\n\r\n\t\t/** @type {Sprite[]} */\r\n\t\tthis.textures = [];\r\n\t\t\r\n\t\t/** @type {boolean} */\r\n\t\tthis.is_loop = true;\r\n\t\t\r\n\t\t/** @type {boolean} */\r\n\t\tthis.is_end = false;\r\n\r\n\t\tif (!raw && !this._url) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTotalTime() {\r\n\t\treturn this.textures.reduce((pv, cv) => pv + cv.delay, 0);\r\n\t}\r\n\t\r\n\tclone() {\r\n\t\tlet newAnim = new this.constructor(this._raw, this._url);\r\n\t\tnewAnim.textures = this.textures;\r\n\t\treturn newAnim;\r\n\t}\r\n\t\r\n\tload() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} stamp\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/** reset frame */\r\n\t_resetFrame() {\r\n\t\tthis.frame = 0;\r\n\t\tthis.time = 0;\r\n\t}\r\n\r\n\t/** restart */\r\n\treset() {\r\n\t\tthis.frame = 0;\r\n\t\tthis.time = 0;\r\n\t\tthis.is_end = false;\r\n\t}\r\n\t\r\n\tget texture() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * remove at nextStep\r\n\t */\r\n\tdestroy() {\r\n\t\tthis.is_loop = false;//防止重複\r\n\t\tthis.is_end = true;\r\n\t}\r\n}\r\n\r\n/**\r\n * process animation\r\n */\r\nclass AnimationBase extends IAnimation {\r\n\t/**\r\n\t * @param {!any} raw\r\n\t * @param {!string} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\t}\r\n\r\n\tload() {\r\n\t\tif (!this._raw) {\r\n\t\t\t//this._raw = await $get.data(this._url);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i in this._raw; ++i) {\r\n\t\t\t//let url = this._url + "/" + i;\r\n\r\n\t\t\tlet texture = new _Sprite_js__WEBPACK_IMPORTED_MODULE_2__[/* Sprite */ "a"](this._raw[i]);\r\n\r\n\t\t\t//texture._url = url;\r\n\r\n\t\t\tthis.textures[i] = texture;\r\n\t\t}\r\n\t\t\r\n\t\tif (this.textures[0]) {\r\n\t\t\tif (!this.textures[0].isLoaded()) {\r\n\t\t\t\tthis.textures[0].__loadTexture();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tisEnd() {\r\n\t\treturn this.is_end;\r\n\t}\r\n\r\n\t/**\r\n\t * aways loop\r\n\t * @param {number} stamp\r\n\t */\r\n\t_update(stamp) {\r\n\t\tconst fc = this.textures.length;\r\n\r\n\t\tif (fc > 0) {//??\r\n\t\t\tthis.time = this.time + stamp;\r\n\r\n\t\t\tif (this.time > this.texture.delay) {\r\n\t\t\t\tthis.frame = ++this.frame % fc;\r\n\t\t\t\tthis.time = 0;\r\n\t\t\t}\r\n\t\t\t//this.frame = Math.trunc(this.time / 1000) % fc;\r\n\t\t}\r\n\r\n\t\tthis.delta += stamp;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} stamp\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tconst fc = this.textures.length;\r\n\r\n\t\tif (fc > 0) {//??\r\n\t\t\tthis.time = this.time + stamp;\r\n\r\n\t\t\tif (this.time > this.texture.delay) {\r\n\t\t\t\tthis.frame = this.frame + 1;\r\n\t\t\t\tif (this.frame >= fc) {\r\n\t\t\t\t\tif (this.is_loop) {\r\n\t\t\t\t\t\tthis.reset();//make loop\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t//防止錯誤\r\n\t\t\t\t\t\tthis.frame = fc - 1;//this._resetFrame();\r\n\r\n\t\t\t\t\t\tthis.is_end = true;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.time = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.delta += stamp;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer - GraphLayerRenderer\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tdraw(renderer, x, y, angle, flip) {\r\n\t\tlet texture = this.texture;\r\n\t\trenderer.drawRotaGraph(texture, x, y, angle, flip);\r\n\t}\r\n\t\r\n\tget texture() {\r\n\t\treturn this.textures[this.frame];\r\n\t}\r\n}\r\n\r\n/**\r\n * animation rendering\r\n */\r\nclass Animation extends AnimationBase {\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\r\n\t\tthis.draw = this._draw_and_preload;\r\n\t}\r\n\r\n\t/**\r\n\t * draw and load next frame\r\n\t * @param {IRenderer} renderer - GraphLayerRenderer\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\t_draw_and_preload(renderer, x, y, angle, flip) {\r\n\t\tlet frame;\r\n\r\n\t\t// if current frame is not loaded then render prev frame\r\n\t\tfor (frame = this.frame; frame >= 0; --frame) {\r\n\t\t\tlet texture = this.textures[frame];\r\n\r\n\t\t\tif (texture.isLoaded()) {\r\n\t\t\t\trenderer.drawRotaGraph(texture, x, y, angle, flip);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//preload next frame\r\n\t\tlet texture = this.textures[++frame];\r\n\t\tif (texture) {//if frame < this.textures.length\r\n\t\t\tif (!texture.isLoaded()) {\r\n\t\t\t\ttexture.__loadTexture();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {//if all testure are loaded\r\n\t\t\tdelete this.draw;\r\n\t\t}\r\n\t}\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvQW5pbWF0aW9uLmpzP2E0ZDUiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCB7IFZlYzIgfSBmcm9tIFwiLi9tYXRoLmpzXCI7XHJcbmltcG9ydCB7IElHcmFwaCwgSVJlbmRlcmVyIH0gZnJvbSBcIi4vSVJlbmRlcmVyLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBTcHJpdGUgfSBmcm9tIFwiLi9TcHJpdGUuanNcIjtcclxuXHJcblxyXG53aW5kb3cubV9kcmF3X2FuaW1hdGlvbl90ZXh0dXJlX2luZm8gPSBmYWxzZTtcclxuXHJcbmNsYXNzIElBbmltYXRpb24ge1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHR0aGlzLl9yYXcgPSBudWxsO1xyXG5cdFx0dGhpcy5fdXJsID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xyXG5cdFx0XHRfcmF3OiB7XHJcblx0XHRcdFx0dmFsdWU6IHJhd1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRfdXJsOiB7XHJcblx0XHRcdFx0dmFsdWU6IHVybFxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5mcmFtZSA9IDA7XHJcblx0XHR0aGlzLnRpbWUgPSAwO1xyXG5cclxuXHRcdC8qKiBlbGFwc2VkIHRpbWUgKi9cclxuXHRcdHRoaXMuZGVsdGEgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7U3ByaXRlW119ICovXHJcblx0XHR0aGlzLnRleHR1cmVzID0gW107XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cclxuXHRcdHRoaXMuaXNfbG9vcCA9IHRydWU7XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cclxuXHRcdHRoaXMuaXNfZW5kID0gZmFsc2U7XHJcblxyXG5cdFx0aWYgKCFyYXcgJiYgIXRoaXMuX3VybCkge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGdldFRvdGFsVGltZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLnRleHR1cmVzLnJlZHVjZSgocHYsIGN2KSA9PiBwdiArIGN2LmRlbGF5LCAwKTtcclxuXHR9XHJcblx0XHJcblx0Y2xvbmUoKSB7XHJcblx0XHRsZXQgbmV3QW5pbSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3JhdywgdGhpcy5fdXJsKTtcclxuXHRcdG5ld0FuaW0udGV4dHVyZXMgPSB0aGlzLnRleHR1cmVzO1xyXG5cdFx0cmV0dXJuIG5ld0FuaW07XHJcblx0fVxyXG5cdFxyXG5cdGxvYWQoKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhbXBcclxuXHQgKi9cclxuXHR1cGRhdGUoc3RhbXApIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRcIik7XHJcblx0fVxyXG5cclxuXHQvKiogcmVzZXQgZnJhbWUgKi9cclxuXHRfcmVzZXRGcmFtZSgpIHtcclxuXHRcdHRoaXMuZnJhbWUgPSAwO1xyXG5cdFx0dGhpcy50aW1lID0gMDtcclxuXHR9XHJcblxyXG5cdC8qKiByZXN0YXJ0ICovXHJcblx0cmVzZXQoKSB7XHJcblx0XHR0aGlzLmZyYW1lID0gMDtcclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblx0XHR0aGlzLmlzX2VuZCA9IGZhbHNlO1xyXG5cdH1cclxuXHRcclxuXHRnZXQgdGV4dHVyZSgpIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiByZW1vdmUgYXQgbmV4dFN0ZXBcclxuXHQgKi9cclxuXHRkZXN0cm95KCkge1xyXG5cdFx0dGhpcy5pc19sb29wID0gZmFsc2U7Ly/pmLLmraLph43opIdcclxuXHRcdHRoaXMuaXNfZW5kID0gdHJ1ZTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBwcm9jZXNzIGFuaW1hdGlvblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFuaW1hdGlvbkJhc2UgZXh0ZW5kcyBJQW5pbWF0aW9uIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0geyFhbnl9IHJhd1xyXG5cdCAqIEBwYXJhbSB7IXN0cmluZ30gdXJsXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IocmF3LCB1cmwpIHtcclxuXHRcdHN1cGVyKHJhdywgdXJsKTtcclxuXHR9XHJcblxyXG5cdGxvYWQoKSB7XHJcblx0XHRpZiAoIXRoaXMuX3Jhdykge1xyXG5cdFx0XHQvL3RoaXMuX3JhdyA9IGF3YWl0ICRnZXQuZGF0YSh0aGlzLl91cmwpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIGluIHRoaXMuX3JhdzsgKytpKSB7XHJcblx0XHRcdC8vbGV0IHVybCA9IHRoaXMuX3VybCArIFwiL1wiICsgaTtcclxuXHJcblx0XHRcdGxldCB0ZXh0dXJlID0gbmV3IFNwcml0ZSh0aGlzLl9yYXdbaV0pO1xyXG5cclxuXHRcdFx0Ly90ZXh0dXJlLl91cmwgPSB1cmw7XHJcblxyXG5cdFx0XHR0aGlzLnRleHR1cmVzW2ldID0gdGV4dHVyZTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYgKHRoaXMudGV4dHVyZXNbMF0pIHtcclxuXHRcdFx0aWYgKCF0aGlzLnRleHR1cmVzWzBdLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0XHR0aGlzLnRleHR1cmVzWzBdLl9fbG9hZFRleHR1cmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRpc0VuZCgpIHtcclxuXHRcdHJldHVybiB0aGlzLmlzX2VuZDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGF3YXlzIGxvb3BcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhbXBcclxuXHQgKi9cclxuXHRfdXBkYXRlKHN0YW1wKSB7XHJcblx0XHRjb25zdCBmYyA9IHRoaXMudGV4dHVyZXMubGVuZ3RoO1xyXG5cclxuXHRcdGlmIChmYyA+IDApIHsvLz8/XHJcblx0XHRcdHRoaXMudGltZSA9IHRoaXMudGltZSArIHN0YW1wO1xyXG5cclxuXHRcdFx0aWYgKHRoaXMudGltZSA+IHRoaXMudGV4dHVyZS5kZWxheSkge1xyXG5cdFx0XHRcdHRoaXMuZnJhbWUgPSArK3RoaXMuZnJhbWUgJSBmYztcclxuXHRcdFx0XHR0aGlzLnRpbWUgPSAwO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vdGhpcy5mcmFtZSA9IE1hdGgudHJ1bmModGhpcy50aW1lIC8gMTAwMCkgJSBmYztcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmRlbHRhICs9IHN0YW1wO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhbXBcclxuXHQgKi9cclxuXHR1cGRhdGUoc3RhbXApIHtcclxuXHRcdGNvbnN0IGZjID0gdGhpcy50ZXh0dXJlcy5sZW5ndGg7XHJcblxyXG5cdFx0aWYgKGZjID4gMCkgey8vPz9cclxuXHRcdFx0dGhpcy50aW1lID0gdGhpcy50aW1lICsgc3RhbXA7XHJcblxyXG5cdFx0XHRpZiAodGhpcy50aW1lID4gdGhpcy50ZXh0dXJlLmRlbGF5KSB7XHJcblx0XHRcdFx0dGhpcy5mcmFtZSA9IHRoaXMuZnJhbWUgKyAxO1xyXG5cdFx0XHRcdGlmICh0aGlzLmZyYW1lID49IGZjKSB7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5pc19sb29wKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMucmVzZXQoKTsvL21ha2UgbG9vcFxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8v6Ziy5q2i6Yyv6KqkXHJcblx0XHRcdFx0XHRcdHRoaXMuZnJhbWUgPSBmYyAtIDE7Ly90aGlzLl9yZXNldEZyYW1lKCk7XHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLmlzX2VuZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy50aW1lID0gMDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR0aGlzLmRlbHRhICs9IHN0YW1wO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtJUmVuZGVyZXJ9IHJlbmRlcmVyIC0gR3JhcGhMYXllclJlbmRlcmVyXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqL1xyXG5cdGRyYXcocmVuZGVyZXIsIHgsIHksIGFuZ2xlLCBmbGlwKSB7XHJcblx0XHRsZXQgdGV4dHVyZSA9IHRoaXMudGV4dHVyZTtcclxuXHRcdHJlbmRlcmVyLmRyYXdSb3RhR3JhcGgodGV4dHVyZSwgeCwgeSwgYW5nbGUsIGZsaXApO1xyXG5cdH1cclxuXHRcclxuXHRnZXQgdGV4dHVyZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLnRleHR1cmVzW3RoaXMuZnJhbWVdO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIGFuaW1hdGlvbiByZW5kZXJpbmdcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBbmltYXRpb24gZXh0ZW5kcyBBbmltYXRpb25CYXNlIHtcclxuXHRjb25zdHJ1Y3RvcihyYXcsIHVybCkge1xyXG5cdFx0c3VwZXIocmF3LCB1cmwpO1xyXG5cclxuXHRcdHRoaXMuZHJhdyA9IHRoaXMuX2RyYXdfYW5kX3ByZWxvYWQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBkcmF3IGFuZCBsb2FkIG5leHQgZnJhbWVcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXIgLSBHcmFwaExheWVyUmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcblx0ICovXHJcblx0X2RyYXdfYW5kX3ByZWxvYWQocmVuZGVyZXIsIHgsIHksIGFuZ2xlLCBmbGlwKSB7XHJcblx0XHRsZXQgZnJhbWU7XHJcblxyXG5cdFx0Ly8gaWYgY3VycmVudCBmcmFtZSBpcyBub3QgbG9hZGVkIHRoZW4gcmVuZGVyIHByZXYgZnJhbWVcclxuXHRcdGZvciAoZnJhbWUgPSB0aGlzLmZyYW1lOyBmcmFtZSA+PSAwOyAtLWZyYW1lKSB7XHJcblx0XHRcdGxldCB0ZXh0dXJlID0gdGhpcy50ZXh0dXJlc1tmcmFtZV07XHJcblxyXG5cdFx0XHRpZiAodGV4dHVyZS5pc0xvYWRlZCgpKSB7XHJcblx0XHRcdFx0cmVuZGVyZXIuZHJhd1JvdGFHcmFwaCh0ZXh0dXJlLCB4LCB5LCBhbmdsZSwgZmxpcCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvL3ByZWxvYWQgbmV4dCBmcmFtZVxyXG5cdFx0bGV0IHRleHR1cmUgPSB0aGlzLnRleHR1cmVzWysrZnJhbWVdO1xyXG5cdFx0aWYgKHRleHR1cmUpIHsvL2lmIGZyYW1lIDwgdGhpcy50ZXh0dXJlcy5sZW5ndGhcclxuXHRcdFx0aWYgKCF0ZXh0dXJlLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0XHR0ZXh0dXJlLl9fbG9hZFRleHR1cmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7Ly9pZiBhbGwgdGVzdHVyZSBhcmUgbG9hZGVkXHJcblx0XHRcdGRlbGV0ZSB0aGlzLmRyYXc7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///334\n')},336:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterAnimationBase", function() { return CharacterAnimationBase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterRenderer", function() { return CharacterRenderer; });\n/* harmony import */ var _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(353);\n/* harmony import */ var _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(349);\n/* harmony import */ var _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _init_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(368);\n/* harmony import */ var _Animation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(334);\n/* harmony import */ var _Engine_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(335);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(333);\n/* harmony import */ var _Sprite_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(347);\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(332);\n/* harmony import */ var _CharacterActionAnimation_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(371);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet zMap = {};\r\nlet sMap = {};\r\n\r\n\r\n/**\r\n * 00026623.blink[1].brow has bug\r\n * \'Weapon/01702694\' is Longcoat(islot)\r\n * how to use cash-weapon (ex: 01702504|0152)\r\n */\r\n\r\n/**\r\n * multi-image-sprite\r\n */\r\nclass FragmentTexture extends _Sprite_js__WEBPACK_IMPORTED_MODULE_6__[/* SpriteBase */ "b"] {\r\n\t/**\r\n\t * @param {wzproperty} raw\r\n\t * @param {string} full_path\r\n\t */\r\n\tconstructor(raw, full_path) {\r\n\t\tsuper(raw, full_path);\r\n\r\n\t\tif (this._raw.origin) {\r\n\t\t\tthis._raw.origin.__proto__ = _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].prototype;\r\n\t\t}\r\n\r\n\t\tfor (let i in this._raw.map) {\r\n\t\t\tthis._raw.map[i].__proto__ = _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].prototype;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * if this.relative == null then remove this\r\n\t\t * @type {Vec2}\r\n\t\t */\r\n\t\tthis.relative = new _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"](0, 0);\r\n\t\t\r\n\t\tthis.calcRelative = this._calcRelative;//this._getRelativeFunction();//this.__old_calcRelative;//\r\n\r\n\t\tthis.filter = new _IRenderer_js__WEBPACK_IMPORTED_MODULE_5__["ImageFilter"]();\r\n\t\tthis.opacity = 1;\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis.visible = true;\r\n\r\n\r\n\t\t/** @type {string} - extra property. */\r\n\t\tthis._slot = null;\r\n\r\n\t\t/** @type {string} - extra property. 在哪個部位 */\r\n\t\tthis._place = null;\r\n\r\n\t\t/** @type {string} - extra property: _slot itemId, _place, _raw.z z */\r\n\t\tthis.classList = null;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {number}\r\n\t */\r\n\tget z() {\r\n\t\treturn zMap[this._raw.z] || 1;\r\n\t}\r\n\tset z(not_value) {\r\n\t\tconsole.error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {number}\r\n\t */\r\n\tget order() {\r\n\t\tdebugger;\r\n\t\treturn this.z;\r\n\t}\r\n\tset order(not_value) {\r\n\t\tdebugger;\r\n\t\tconsole.error(new TypeError("Not implement"));\r\n\t}\r\n\r\n\t/** @returns {Vec2} */\r\n\tget origin() { return this._raw.origin || _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty; }\r\n\r\n\tisHasAnchor() { return !!this._raw.map; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget brow() { return this._raw.map.brow; }\r\n\tisAnchorBrow() { return !!this._raw.map.brow; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget neck() { return this._raw.map.neck; }\r\n\tisAnchorNeck() { return !!this._raw.map.neck; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget navel() { return this._raw.map.navel; }\r\n\tisAnchorNavel() { return !!this._raw.map.navel; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget hand() { return this._raw.map.hand; }\r\n\tisAnchorHand() { return !!this._raw.map.hand; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget handMove() { return this._raw.map.handMove; }\r\n\tisAnchorHandMove() { return !!this._raw.map.handMove; }\r\n\r\n\r\n\t/** @returns {Vec2} */\r\n\tget _earBelowHead() { return this._raw.map.earBelowHead; }\r\n\tisAnchor_EarBelowHead() { return !!this._raw.map.earBelowHead; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget _earOverHead() { return this._raw.map.earOverHead; }\r\n\tisAnchor_EarOverHead() { return !!this._raw.map.earOverHead; }\r\n\r\n\t/**\r\n\t * @param {FragmentTexture} that - this\r\n\t * @param {FragmentTexture} base - parent\r\n\t * @param {string} anchor - anchor name\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_anchor(that, base, anchor) {\r\n\t\treturn base[anchor].minus(that[anchor]).plus(base.origin.minus(that.origin));\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative(chara, body, head) {\r\n\t\tthis.calcRelative = this._getRelativeFunction(chara);\r\n\t\treturn this.calcRelative(chara, body, head);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {function(CharacterAnimationBase,FragmentTexture,FragmentTexture):Vec2}\r\n\t */\r\n\t_getRelativeFunction(chara) {\r\n\t\tif (!this.isHasAnchor()) {\r\n\t\t\treturn this._calcRelativeEmpty;\r\n\t\t}\r\n\t\tif (this.isAnchorNeck()) {\r\n\t\t\treturn this._calcRelative_neck;\r\n\t\t}\r\n\t\tif (this.isAnchorBrow()) {\r\n\t\t\treturn this._calcRelative_brow;\r\n\t\t}\r\n\t\tif (this.isAnchorNavel()) {\r\n\t\t\tif (this == chara.slots.body) {\r\n\t\t\t\treturn this._getOrigin;\r\n\t\t\t}\r\n\t\t\treturn this._calcRelative_navel;\r\n\t\t}\r\n\t\tif (this.isAnchorHand()) {\r\n\t\t\treturn this._calcRelative_hand;\r\n\t\t}\r\n\t\tif (this.isAnchorHandMove()) {\r\n\t\t\tif (this._url.lastIndexOf("lHand") > 0) {\r\n\t\t\t\treturn this._calcRelative_handMove_lHand;\r\n\t\t\t}\r\n\t\t\treturn this._calcRelative_handMove;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelativeEmpty(chara, body, head) {\r\n\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty;\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_getOrigin(chara, body, head) {\r\n\t\treturn this.origin;\r\n\t}\r\n\t/**\r\n\t * neck on the navel\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_neck(chara, body, head) {\r\n\t\treturn this._anchor(this, body, "neck").minus(body.origin);\r\n\t}\r\n\t/**\r\n\t * brow on the head & head on the neck & neck on the navel\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_brow(chara, body, head) {\r\n\t\treturn this._anchor(this, head, "brow").plus(this._anchor(head, body, "neck")).minus(body.origin);//anchor_brow+(-7,-33)\r\n\t}\r\n\t/**\r\n\t * this is origin point, no anchor\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_navel(chara, body, head) {\r\n\t\treturn body.navel.minus(this.navel).minus(this.origin);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_hand(chara, body, head) {\r\n\t\tconst hand = chara.slots.body.fragments.arm.getTexture(chara);\r\n\t\tif (hand == null) {\r\n\t\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty.minus(this.hand).minus(this.origin).minus(body.origin);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this._anchor(this, hand, "hand").minus(this._anchor(body, hand, "navel")).minus(body.origin);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_handMove(chara, body, head) {\r\n\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty.minus(this.origin).minus(this.handMove);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_handMove_lHand(chara, body, head) {\r\n\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty.minus(this.origin);\r\n\t}\r\n\t\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\tupdate(chara) {\r\n\t\tif (chara.slots.body && chara.slots.head) {\r\n\t\t\tconst body = chara.slots.body.fragments.body.getTexture(chara);\r\n\t\t\tconst head = chara.slots.head.fragments.head.getTexture(chara);\r\n\t\t\tif (body && head) {\r\n\t\t\t\tthis.relative = this.calcRelative(chara, body, head);\r\n\r\n\t\t\t\tconst tamingMob = chara.slots.tamingMob;\r\n\t\t\t\tif (tamingMob) {\r\n\t\t\t\t\tthis.relative = tamingMob.adj_pos(this.relative, body, chara);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\trender(renderer, chara) {\r\n\t\tif (!(this.relative && this.visible)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst x = this.relative.x;\r\n\t\tconst y = this.relative.y;\r\n\r\n\t\trenderer.globalAlpha = this.opacity;\r\n\t\tif (this.filter.isEmpty) {\r\n\t\t\trenderer.drawGraph2(this, x, y);\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.ctx.filter = this.filter.toString();\r\n\t\t\trenderer.drawGraph2(this, x, y);\r\n\t\t\trenderer.ctx.filter = "none";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass BodyFragmentTexture extends FragmentTexture {\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\tupdate(chara) {\r\n\t\tsuper.update(chara);\r\n\t\tthis.visible = !chara.hideBody;\r\n\t}\r\n}\r\n\r\nclass HairFragmentTexture extends FragmentTexture {\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\r\n\t\t/** @type {HairFragmentTexture} */\r\n\t\tthis.graph2 = null;\r\n\r\n\t\t/** @type {HairFragmentTexture} */\r\n\t\tthis.graph3 = null;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\tupdate(chara) {\r\n\t\tif (chara.slots.body && chara.slots.head) {\r\n\t\t\tconst body = chara.slots.body.fragments.body.getTexture(chara);\r\n\t\t\tconst head = chara.slots.head.fragments.head.getTexture(chara);\r\n\t\t\tif (body && head) {\r\n\t\t\t\tthis.relative = this.calcRelative(chara, body, head);\r\n\r\n\t\t\t\tconst tamingMob = chara.slots.tamingMob;\r\n\t\t\t\tif (tamingMob) {\r\n\t\t\t\t\tthis.relative = tamingMob.adj_pos(this.relative, body, chara);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.graph2) {\r\n\t\t\t\t\tthis.graph2.relative = this.relative;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.graph3) {\r\n\t\t\t\t\tthis.graph3.relative = this.relative;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\trender(renderer, chara) {\r\n\t\tif (!this.relative) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\trenderer.globalAlpha = this.opacity || 1;\r\n\t\tif (this.filter.isEmpty) {\r\n\t\t\tthis._render(renderer);\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.ctx.filter = this.filter.toString();\r\n\t\t\tthis._render(renderer);\r\n\t\t\trenderer.ctx.filter = "none";\r\n\t\t}\r\n\t}\r\n\t_render(renderer) {\r\n\t\tconst x = this.relative.x;\r\n\t\tconst y = this.relative.y;\r\n\r\n\t\trenderer.drawGraph2(this, x, y);\r\n\r\n\t\tif (this.graph2 && this.graph2.opacity) {//color2\r\n\t\t\trenderer.globalAlpha = this.graph2.opacity;\r\n\r\n\t\t\trenderer.drawGraph2(this.graph2, x, y);\r\n\t\t}\r\n\t\tif (this.graph3 && this.graph3.opacity) {//color3\r\n\t\t\trenderer.globalAlpha = this.graph3.opacity;\r\n\r\n\t\t\trenderer.drawGraph2(this.graph3, x, y);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nclass ItemEffectAnimation extends _Animation__WEBPACK_IMPORTED_MODULE_3__["Animation"] {\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\t\t\r\n\t\tObject.defineProperty(this, "_raw", {\r\n\t\t\tvalue: raw,\r\n\t\t});\r\n\r\n\t\t//this._url = this._url;\r\n\r\n\t\tthis.__getAttr("z", -1);\r\n\t\tthis.__getAttr("pos", 1);\r\n\r\n\t\tsuper.load();\r\n\t}\r\n\t__getAttr(attr, defVal) {\r\n\t\tif (attr in this._raw) {\r\n\t\t\tthis[attr] = this._raw[attr];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis[attr] = defVal;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {boolean} actionExceptRotation\r\n\t * @param {number} angle\r\n\t * @param {boolean} flip\r\n\t */\r\n\trender(renderer, actionExceptRotation, angle, flip) {\r\n\t\tif (actionExceptRotation) {\r\n\t\t\tthis.draw(renderer, 0, 0, -angle, flip);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst oy = -this.texture.height * 0.25;\r\n\t\t\tthis.draw(renderer, 0, oy, 0, flip);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//\t/data/Effect/ItemEff/1102918\r\nclass ItemEffect {\r\n\tconstructor() {\r\n\t\tthis._url = null;\r\n\t\tthis._raw = null;\r\n\r\n\t\t/** @type {{[animationName:string]:ItemEffectAnimation}} */\r\n\t\tthis.animation = {};\r\n\r\n\t\tthis.action = null;\r\n\t\tthis.time = 0;\r\n\t\tthis.frame = 0;\r\n\r\n\t\tthis.fixed = 0;\r\n\t\tthis.z = -2;\r\n\t\tthis.action = 1;\r\n\t\tthis.actionExceptRotation = 0;\r\n\t\t\r\n\t\tthis.enable = true;\r\n\t}\r\n\r\n\tstatic async Init() {\r\n\t\ttry {\r\n\t\t\t/** @type {Set<string>} */\r\n\t\t\tlet itemEffectList = ItemEffect._list;\r\n\r\n\t\t\t/** @type {string[]} */\r\n\t\t\tlet raw = await $get.list("/Effect/ItemEff");\r\n\r\n\t\t\titemEffectList.clear();\r\n\r\n\t\t\traw.forEach(id => {\r\n\t\t\t\titemEffectList.add(parseInt(id, 10));\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * if (!exist) return null\r\n\t * @param {string} equipID\r\n\t * @returns {Promise<ItemEffect>}\r\n\t */\r\n\tstatic async load(equipID) {\r\n\t\tconst id = Number(equipID);\r\n\r\n\t\tif (ItemEffect._list.has(id)) {\r\n\t\t\tlet eff = new ItemEffect();\r\n\t\t\tawait eff.load(equipID);\r\n\t\t\treturn eff;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * if (!exist) return null\r\n\t * @param {string} equipID\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tasync load(equipID) {\r\n\t\tconst id = Number(equipID);\r\n\t\tconst url = `/Effect/ItemEff/${id}/effect`;\r\n\t\tlet raw;\r\n\r\n\t\ttry {\r\n\t\t\traw = await $get.data(url);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow ex;\r\n\t\t}\r\n\r\n\t\tif (raw) {\r\n\t\t\treturn this._load(equipID, url, raw);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} stamp\r\n\t * @param {string} action\r\n\t */\r\n\tupdate(stamp, action) {\r\n\t\tif (action in this.animation) {\r\n\t\t\tthis.action = action;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.action = "default";\r\n\t\t}\r\n\r\n\t\tif (this.animation[this.action]) {\r\n\t\t\tthis.animation[this.action].update(stamp);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {CharacterRenderer} chara\r\n\t */\r\n\trender(renderer, chara) {\r\n\t\tif (this.animation && this.animation[this.action]) {\r\n\t\t\tthis.animation[this.action].render(renderer, this.actionExceptRotation, chara.angle, chara.front > 0);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} equipID\r\n\t * @param {object} raw_data\r\n\t */\r\n\t_load(equipID, url, raw) {\r\n\t\tthis.id = equipID;\r\n\r\n\t\tif (!raw) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\t//this._url = url;\r\n\t\tObject.defineProperty(this, "_raw", {\r\n\t\t\tvalue: raw,\r\n\t\t});\r\n\r\n\t\tthis.__construct();\r\n\t}\r\n\t__construct() {\r\n\t\tthis.__getAttr("fixed", 0);\r\n\t\tthis.__getAttr("z", -1);\r\n\t\tthis.__getAttr("action", 1);\r\n\t\tthis.__getAttr("actionExceptRotation", 0);\r\n\r\n\t\tfor (let i in this._raw) {\r\n\t\t\tif (this._raw[i] && typeof this._raw[i] == "object" && \'0\' in this._raw[i]) {//animation has frames\r\n\t\t\t\tthis.animation[i] = new ItemEffectAnimation(this._raw[i], [this._url, i].join("/"));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t__getAttr(attr, defVal) {\r\n\t\tif (attr in this._raw) {\r\n\t\t\tthis[attr] = this._raw[attr];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis[attr] = defVal;\r\n\t\t}\r\n\t}\r\n}\r\n/** @type {Set<string>} */\r\nItemEffect._list = new Set();\r\n\r\nclass CharacterFragmentBase {\r\n\t/**\r\n\t * @param {{[action:string]: FragmentTexture[]}} textures\r\n\t */\r\n\tconstructor(textures) {\r\n\t\t/** @type {{[action:string]: FragmentTexture[]}} - textures[action:string][frame:number] */\r\n\t\tthis.textures = textures;\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n}\r\n\r\n/**\r\n * @final \r\n */\r\nclass CharacterBodyFragment extends CharacterFragmentBase {\r\n\tconstructor(textures) {\r\n\t\tsuper(textures);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\treturn this.getFrameTexture(chara, chara.action_frame);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tif (!(chara.action in this.textures)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet ft = this.textures[chara.action][frame];//if frame not exist then return undefined\r\n\t\treturn ft;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tif (this.textures[chara.action]) {\r\n\t\t\treturn this.textures[chara.action].length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\n/**\r\n * @final \r\n */\r\nclass CharacterFaceFragment extends CharacterFragmentBase {\r\n\tconstructor(textures) {\r\n\t\tsuper(textures);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\treturn this.getFrameTexture(chara, chara.emotion_frame);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tif (!(chara.emotion in this.textures)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet ft = this.textures[chara.emotion][frame];\r\n\t\treturn ft;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tif (this.textures[chara.emotion]) {\r\n\t\t\treturn this.textures[chara.emotion].length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\n/**\r\n * @final \r\n */\r\nclass CharacterTamingMobFragment extends CharacterFragmentBase {\r\n\tconstructor(textures) {\r\n\t\tsuper(textures);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\treturn this.getFrameTexture(chara, chara.actani.actionFrame);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame - not sync chara._frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tif (!(chara._ride_action in this.textures)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet ft = this.textures[chara._ride_action][frame];//if frame not exist then return undefined\r\n\t\treturn ft;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tif (this.textures[chara._ride_action]) {\r\n\t\t\treturn this.textures[chara._ride_action].length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\nclass EquipImageFilter {\r\n\t/**\r\n\t * @param {CharacterAppearanceBase} equip\r\n\t */\r\n\tconstructor(equip) {\r\n\t\tthis.equip = equip;\r\n\t}\r\n\r\n\tget hue() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.hue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\tset hue(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.hue = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget sat() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.sat;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 100;\r\n\t}\r\n\tset sat(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.sat = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget bri() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.bri;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 100;\r\n\t}\r\n\tset bri(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.bri = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget contrast() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.contrast;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 100;\r\n\t}\r\n\tset contrast(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.contrast = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn {\r\n\t\t\thue: this.hue,\r\n\t\t\tsaturation: fixedNum(this.sat),\r\n\t\t\tbrightness: fixedNum(this.bri),\r\n\t\t\tcontrast: fixedNum(this.contrast),\r\n\t\t};\r\n\t\tfunction fixedNum(val) {\r\n\t\t\treturn Number((val / 100).toFixed(1));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {{hue: number, saturation: number, brightness: number, contrast: number}} data\r\n\t */\r\n\tparse(data) {\r\n\t\tlet { hue = 0, saturation = 1, brightness = 1, contrast = 1 } = data;\r\n\t\tthis.hue = Number(hue);\r\n\t\tthis.sat = Number(saturation) * 100;\r\n\t\tthis.bri = Number(brightness) * 100;\r\n\t\tthis.contrast = Number(contrast) * 100;\r\n\t}\r\n}\r\n\r\n/**\r\n * @interface\r\n */\r\nclass ICharacterAppearanceBase {\r\n\tconstructor() {\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t */\r\n\tisLoaded() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t */\r\n\t_unload() {\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t */\r\n\ttoJSON() {\r\n\t\tthrow new Error("Not implement");\r\n\t\treturn {\r\n\t\t\tid: -1,//invalid ID\r\n\t\t};\r\n\t}\r\n}\r\n\r\n/**\r\n * ??\r\n */\r\nclass _CharacterAppearanceBaseSlotLink extends ICharacterAppearanceBase {\r\n\tconstructor(slot_link) {\r\n\t\tsuper();\r\n\t\tthis.slot_link = slot_link;//??\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn {\r\n\t\t\tid: slot_link,//??\r\n\t\t};\r\n\t}\r\n}\r\n\r\n/**\r\n * character loader\r\n */\r\nclass CharacterAppearanceBase extends ICharacterAppearanceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t\t\r\n\t\tthis._raw = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\t//this._url = null;\r\n\t\t\t\r\n\t\t/** @type {ItemEffect} */\r\n\t\tthis.effect = null;\r\n\r\n\t\t/**\r\n\t\t * @type {{[place:string]:CharacterFragmentBase}}\r\n\t\t */\r\n\t\tthis.fragments = null;\r\n\r\n\t\tthis._onload = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.id = null;\r\n\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tthis.categoryInfo = null;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.slot_order = 0;\r\n\r\n\t\t/** @type {object<string, number>} */\r\n\t\tthis.islot = {};\r\n\r\n\t\t/** @type {object<string, number>} */\r\n\t\tthis.vslot = {};\r\n\r\n\t\tthis.filter = new EquipImageFilter(this);\r\n\t}\r\n\r\n\tisLoaded() {\r\n\t\treturn this.fragments != null;\r\n\t}\r\n\r\n\t/** @type {function(CharacterAppearanceBase):void} */\r\n\tget _onload() {\r\n\t\treturn this.__onload;\r\n\t}\r\n\tset _onload(func) {\r\n\t\tthis.__onload = func;\r\n\t\tif (this.isLoaded()) {\r\n\t\t\tthis.__onload.call(this, this);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {string} id\r\n\t * @param {ItemCategoryInfo} cateInfo\r\n\t * @param {void} use_category - no use\r\n\t * @returns {Promise<boolean>} - true if item exist\r\n\t */\r\n\tasync load(url, id, cateInfo, use_category) {\r\n\t\tlet raw;\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.categoryInfo = cateInfo;\r\n\t\t\r\n\t\ttry {\r\n\t\t\tif (_public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "c"].isEquipExist(id, cateInfo)) {\r\n\t\t\t\traw = await _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "c"].getItem(id);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow ex;\r\n\t\t}\r\n\t\t\r\n\t\ttry {\r\n\t\t\tif (!raw && load_extern_item_data) {\r\n\t\t\t\traw = await load_extern_item_data(id);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow ex;\r\n\t\t}\r\n\r\n\t\t//this._url = url;\r\n\t\tObject.defineProperty(this, "_raw", {\r\n\t\t\tvalue: raw,\r\n\t\t});\r\n\r\n\t\tthis.__load_slot();\r\n\r\n\t\tthis.__load_fragments();\r\n\r\n\t\tif (this._onload) {\r\n\t\t\tthis._onload.call(this, this);\r\n\t\t}\r\n\r\n\t\t//// if not body, head, face, hair then try load effect\r\n\t\t//if (id >= "00050000") {\r\n\t\t\t// load if exist\r\n\t\t\tItemEffect.load(this.id).then(a => this.effect = a);//01102918\t//01102915\r\n\t\t//}\r\n\r\n\t\treturn true;\r\n\t}\r\n\t__load_fragments() {\r\n\t\tconst FragmentConstructor = this.FragmentConstructor;\r\n\r\n\t\t//Object.keys(this._raw_textures).map(k => { return \'0\' in this._raw_textures[k]; })\r\n\r\n\t\tlet action_list = Object.keys(this._raw_textures);\r\n\r\n\t\tlet textures = {};\r\n\t\tfor (let action of action_list) {\r\n\t\t\tif (typeof this._raw_textures[action] == "object" && "0" in this._raw_textures[action]) {\r\n\t\t\t\tlet _url = this._base_path + action;\r\n\r\n\t\t\t\ttextures[action] = this.__load_frame_textures(this._raw_textures[action], _url);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet fragment_textures = {};\r\n\t\tfor (let action in textures) {\r\n\t\t\tfor (let frame in textures[action]) {\r\n\t\t\t\tfor (let place in textures[action][frame]) {\r\n\t\t\t\t\tif (!(place in fragment_textures)) {\r\n\t\t\t\t\t\tfragment_textures[place] = {};\r\n\t\t\t\t\t\t//fragment_textures[place].visible = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!(action in fragment_textures[place])) {\r\n\t\t\t\t\t\tfragment_textures[place][action] = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfragment_textures[place][action][frame] = textures[action][frame][place];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet fragments = {};\r\n\t\tfor (let frag in fragment_textures) {\r\n\t\t\tfragments[frag] = new FragmentConstructor(fragment_textures[frag]);\r\n\t\t}\r\n\t\tthis.fragments = fragments;\r\n\t}\r\n\t/**\r\n\t * @param {string} _url\r\n\t * @returns {{[place:string]:FragmentTexture}[]} - array - textures[frame][place]\r\n\t */\r\n\t__load_frame_textures(_raw, _url) {\r\n\t\tlet textures = [];\r\n\t\tfor (let frame = 0; frame in _raw; ++frame) {\r\n\t\t\tlet url = `${_url}/${frame}`;\r\n\t\t\ttextures[frame] = this.__load_place_textures(_raw[frame], url);\r\n\t\t}\r\n\t\treturn textures;\r\n\t}\r\n\t/**\r\n\t * @param {string} _url\r\n\t * @returns {{[place:string]:FragmentTexture}} - object - textures[place]\r\n\t */\r\n\t__load_place_textures(_raw, _url) {\r\n\t\tlet textures = {};\r\n\t\tfor (let place in _raw) {\r\n\t\t\tlet path = `${_url}/${place}`;\r\n\t\t\tlet raw = _raw[place];\r\n\r\n\t\t\tif (raw) {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tconst FragmentTextureConstructor = this.FragmentTextureConstructor;\r\n\t\t\t\tlet ft;\r\n\t\t\t\tif (raw[""] == "") {\r\n\t\t\t\t\tft._url = path;\r\n\t\t\t\t\t//ft._url = path;\r\n\t\t\t\t\ttextures[place] = ft\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof raw[""] == \'string\') {\r\n\t\t\t\t\tft = new FragmentTextureConstructor(raw);\r\n\t\t\t\t\t//ft._url = raw[""];\r\n\t\t\t\t\ttextures[place] = ft;\r\n\t\t\t\t}\r\n\t\t\t\telse if (place == "hairShade") {\r\n\t\t\t\t\tft = new FragmentTextureConstructor(raw[0]);\r\n\t\t\t\t\t//ft._url = path + "/0";\r\n\t\t\t\t\ttextures[place] = ft;\r\n\t\t\t\t}\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tft._slot = this.categoryInfo.slot;\r\n\t\t\t\t\tft._place = place;\r\n\r\n\t\t\t\t\tft.classList = [\r\n\t\t\t\t\t\tft._slot,\r\n\t\t\t\t\t\t"item" + this.id,\r\n\t\t\t\t\t\tft._place,\r\n\t\t\t\t\t\tft._raw.z,\r\n\t\t\t\t\t\t\'z\' + ft.z\r\n\t\t\t\t\t].join(\' \');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn textures;\r\n\t}\r\n\t__load_slot() {\r\n\t\tif (!this._raw.info.islot) {\r\n\t\t\tdebugger;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet islots = this._raw.info.islot.match(/([A-Z][a-z0-9])/g);\r\n\t\tfor (let i in islots) {\r\n\t\t\tconst slot = islots[i];\r\n\t\t\tconst slot_order = zMap[slot];\r\n\t\t\tthis.islot[slot] = slot_order;\r\n\t\t\t\t\r\n\t\t\tif (slot_order > this.slot_order) {//this.slot_order = Math.max(this.slot_order, slot_order);\r\n\t\t\t\tthis.slot_order = slot_order;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet vslots = this._raw.info.vslot.match(/([A-Z][a-z0-9])/g);\r\n\t\tfor (let i in vslots) {\r\n\t\t\tconst slot = vslots[i];\r\n\t\t\tthis.vslot[slot] = slot;\r\n\t\t}\r\n\t}\r\n\r\n\t_unload() {\r\n\t\tthis.fragments = null;\r\n\t\tthis.effect == null;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @param {string} [animationName] - action animation\r\n\t */\r\n\ttoJSON(animationName = "stand1") {\r\n\t\tlet region, version;\r\n\t\tif (this._raw.info.__v) {\r\n\t\t\tconst m = this._raw.info.__v.toUpperCase().match(/([A-Z]*)([0-9]*)/);\r\n\t\t\tregion = (function (r) {\r\n\t\t\t\tconst mm = {\r\n\t\t\t\t\t"GMS": "GMS",\r\n\t\t\t\t\t"CMS": "CMS",\r\n\t\t\t\t\t"KMS": "KMS",\r\n\t\t\t\t\t"JMS": "JMS",\r\n\t\t\t\t\t"SEA": "SEA",\r\n\t\t\t\t\t"TMS": "TMS",\r\n\t\t\t\t\t"THMS": "THMS",\r\n\t\t\t\t\t"TWMS": "TWMS",\r\n\t\t\t\t};\r\n\t\t\t\tlet result = mm[r];\r\n\t\t\t\tif (!result) {\r\n\t\t\t\t\tresult = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "c"].dataRegion;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t})([m[1]]);\r\n\t\t\tversion = m[2] || _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "c"].dataVersion;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tregion = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "c"].dataRegion;\r\n\t\t\tversion = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "c"].dataVersion;\r\n\t\t}\r\n\t\tconst filter = this.filter;\r\n\r\n\t\tlet obj = {\r\n\t\t\titemId: Number(this.id),\r\n\t\t\tregion: region,\r\n\t\t\tversion: version,\r\n\t\t\thue: filter.hue,\r\n\t\t\tsaturation: fixedNum(filter.sat),\r\n\t\t\tbrightness: fixedNum(filter.bri),\r\n\t\t\tcontrast: fixedNum(filter.contrast),\r\n\t\t\talpha: Number((this.opacity).toFixed(1)),\r\n\t\t};\r\n\t\tif (animationName) {\r\n\t\t\tobj.animationName = animationName;\r\n\t\t}\r\n\t\treturn obj;\r\n\r\n\t\tfunction fixedNum(val) {\r\n\t\t\treturn Number((val / 100).toFixed(1));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * another format\r\n\t * @param {{alpha: number, hue: number, saturation: number, brightness: number, contrast: number}} data\r\n\t */\r\n\tparse(data) {\r\n\t\tlet { alpha = 1 } = data;\r\n\t\tthis.filter.parse(data);\r\n\t\tthis.opacity = Math.max(0, Math.min(alpha, 1));\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Partial<{opacity:number,hue:number,sat:number,bri:number,contrast:number}>} option\r\n\t */\r\n\tset(option) {\r\n\t\tconst { opacity = 1, hue = 0, sat = 100, bri = 100, contrast = 100 } = option;\r\n\t\tthis.opacity = opacity;\r\n\t\tthis.filter.hue = hue;\r\n\t\tthis.filter.sat = sat;\r\n\t\tthis.filter.bri = bri;\r\n\t\tthis.filter.contrast = contrast;\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * @returns {number}\r\n\t */\r\n\tget opacity() {\r\n\t\tfor (let i in this.fragments) {\r\n\t\t\tfor (let j in this.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < this.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = this.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.opacity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 1;\r\n\t}\r\n\t/**\r\n\t * @param {number} opacity\r\n\t */\r\n\tset opacity(opacity) {\r\n\t\tfor (let i in this.fragments) {\r\n\t\t\tfor (let j in this.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < this.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = this.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.opacity = opacity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} hue 0 ~ 360\r\n\t * @param {number} sat 0 ~ 100\r\n\t * @param {number} bri 0 ~ 100\r\n\t */\r\n\tsetFilter(hue, sat, bri) {\r\n\t\tfor (let i in this.fragments) {\r\n\t\t\tfor (let j in this.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < this.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = this.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.hue = hue;\r\n\t\t\t\t\t\tft.filter.sat = sat;\r\n\t\t\t\t\t\tft.filter.bri = bri;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * get icon url\r\n\t * @see {@link ItemCategoryInfo.getIconUrl}\r\n\t * @returns {string}\r\n\t */\r\n\tgetIconUrl() {\r\n\t\tconst icon = this._raw.info.icon;\r\n\t\tif (icon) {\r\n\t\t\treturn icon[""];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdebugger;\r\n\t\t\treturn _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].getIconUrl(this.id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * get iconRaw url\r\n\t * @see {@link ItemCategoryInfo.getIconRawUrl}\r\n\t * @returns {string}\r\n\t */\r\n\tgetIconRawUrl() {\r\n\t\tconst iconRaw = this._raw.info.iconRaw;\r\n\t\tif (iconRaw) {\r\n\t\t\treturn iconRaw[""];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdebugger;\r\n\t\t\treturn _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].getIconRawUrl(this.id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @type {string}\r\n\t */\r\n\tget _animation_type() {\r\n\t\tthrow new Error("Not Implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @returns {typeof CharacterFragmentBase}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @returns {typeof FragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {{[actions:string]:{["0"]:Sprite,[frames:string]:Sprite}}} raw_textures[...actions][...frames][...fragments]\r\n\t */\r\n\tget _raw_textures() {\r\n\t\treturn this._raw;\r\n\t}\r\n\r\n\tget _base_path() {\r\n\t\treturn this._url;\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract\r\n */\r\nclass CharacterAppearance extends CharacterAppearanceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\t//__is_texture(k) {\r\n\t//\treturn (!(k == "face" || k == "delay" || k == "default"));\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\treturn chara.slots.body.fragments.body.textures[chara.action].length;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tconst d = this._raw[chara.action][chara.action_frame].delay;\r\n\t\tif (Number.isSafeInteger(d)) {\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn 120;\r\n\t}\r\n}\r\n\r\nclass CharacterBody extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof BodyFragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn BodyFragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterEquip extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof BodyFragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn BodyFragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterEquipCashWeapon extends CharacterEquip {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.use_category = null;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {string} id\r\n\t * @param {ItemCategoryInfo} cateInfo\r\n\t * @param {string} use_category - cash-weapon as [category]\r\n\t * @returns {Promise<boolean>} - true if item exist\r\n\t */\r\n\tasync load(url, id, cateInfo, use_category) {\r\n\t\tif (!use_category && use_category != "") {\r\n\t\t\tthrow new TypeError("use_category");\r\n\t\t}\r\n\r\n\t\tthis.use_category = use_category.slice(2, 4);\r\n\r\n\t\treturn super.load(url, id, cateInfo);\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {object} raw_textures[...actions][...frames][...fragments]\r\n\t */\r\n\tget _raw_textures() {\r\n\t\treturn this._raw[this.use_category];\r\n\t}\r\n\r\n\tget _base_path() {\r\n\t\treturn this._url + this.use_category;\r\n\t}\r\n}\r\n\r\n\r\nclass CharacterHeadBase extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof FragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn FragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterHead extends CharacterHeadBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.elfEarFragment = null;\r\n\t\tthis.lefEarFragment = null;\r\n\t\tthis.highlefEarFragment = null;\r\n\t}\r\n\t__load_fragments() {\r\n\t\tsuper.__load_fragments()\r\n\t\t\r\n\t\tif (this.fragments) {\r\n\t\t\tif (this.fragments.ear) {\r\n\t\t\t\tthis.elfEarFragment = this.fragments.ear;\r\n\t\t\t\tdelete this.fragments.ear;\r\n\t\t\t}\r\n\t\t\tif (this.fragments.lefEar) {\r\n\t\t\t\tthis.lefEarFragment = this.fragments.lefEar;\r\n\t\t\t\tdelete this.fragments.lefEar;\r\n\t\t\t}\r\n\t\t\tif (this.fragments.highlefEar) {\r\n\t\t\t\tthis.highlefEarFragment = this.fragments.highlefEar;\r\n\t\t\t\tdelete this.fragments.highlefEar;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget elfEar() {\r\n\t\treturn this.fragments.ear != null;\r\n\t}\r\n\tset elfEar(value) {\r\n\t\tif (!this.elfEarFragment) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (value) {\r\n\t\t\tthis.fragments.ear = this.elfEarFragment;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete this.fragments.ear;\r\n\t\t}\r\n\t}\r\n\r\n\tget lefEar() {\r\n\t\treturn this.fragments.lefEar != null;\r\n\t}\r\n\tset lefEar(value) {\r\n\t\tif (!this.lefEarFragment) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (value) {\r\n\t\t\tthis.fragments.lefEar = this.lefEarFragment;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete this.fragments.lefEar;\r\n\t\t}\r\n\t}\r\n\r\n\tget highlefEar() {\r\n\t\treturn this.fragments.highlefEar != null;\r\n\t}\r\n\tset highlefEar(value) {\r\n\t\tif (!this.highlefEarFragment) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (value) {\r\n\t\t\tthis.fragments.highlefEar = this.highlefEarFragment;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete this.fragments.highlefEar;\r\n\t\t}\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n}\r\n\r\nclass CharacterHair extends CharacterHeadBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * hair color mix\r\n\t * @override\r\n\t * @returns {typeof HairFragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn HairFragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterFaceBase extends CharacterHeadBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\t//__is_texture(k) {\r\n\t//\treturn (!(k == "delay" || k == "default"));\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\treturn chara.slots.face.fragments.face.textures[chara.emotion].length;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tconst d = this._raw[chara.emotion][chara.emotion_frame].delay;\r\n\t\tif (d != null) {//!isNaN(d) && isFinite(d)\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn 60;\r\n\t}\r\n}\r\nclass CharacterFace extends CharacterFaceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "emotion";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterFaceFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterFaceFragment;\r\n\t}\r\n}\r\nclass CharacterFaceAcc extends CharacterFaceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "emotion";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterFaceFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterFaceFragment;\r\n\t}\r\n}\r\n\r\nclass CharacterTamingMob extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {number}\r\n\t */\r\n\tget type() {\r\n\t\treturn this._raw.info.tamingMob;\r\n\t}\r\n\r\n\tget actionMap() {\r\n\t\treturn this._raw.characterAction;\r\n\t}\r\n\r\n\tget emotionMap() {\r\n\t\treturn this._raw.characterEmotion;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Vec2} relative\r\n\t * @param {FragmentTexture} body\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {Vec2}\r\n\t */\r\n\tadj_pos(relative, body, chara) {\r\n\t\tconst frag = this.fragments[0];//default\r\n\t\tif (frag) {\r\n\t\t\tconst tm = frag.getTexture(chara);\r\n\t\t\tif (tm) {\r\n\t\t\t\treturn relative.plus(tm.navel.minus(body.navel));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn relative;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\treturn chara.slots.body.fragments.body.textures[chara._ride_action].length;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tconst d = Math.trunc(this._raw[chara._ride_action][chara.action_frame].delay);//?? _ride_action_frame => action_frame\r\n\t\tif (Number.isSafeInteger(d)) {\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn 120;\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "_ride_action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterTamingMobFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterTamingMobFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof FragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn FragmentTexture;\r\n\t}\r\n}\r\n\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0000\'].FragmentType = CharacterBody;\t\t//\tbody\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0001\'].FragmentType = CharacterHead;\t\t//\telfEar\t\t\t-> CharacterHeadBase -> CharacterHead\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0002\'].FragmentType = CharacterFace;\t\t//\tFace\t\t\t-> CharacterHeadBase -> CharacterFaceBase -> CharacterFace\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0003\'].FragmentType = CharacterHair;\t\t//\tHair\t\t\t-> CharacterHeadBase -> CharacterHair\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0004\'].FragmentType = CharacterHair;\t\t//\tHair\t\t\t-> CharacterHeadBase -> CharacterHair\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0100\'].FragmentType = CharacterEquip;\t\t//\tCap\t\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0101\'].FragmentType = CharacterFaceAcc;\t\t//\taccessoryFace\t-> CharacterHeadBase -> CharacterFaceBase -> CharacterFaceAcc\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0102\'].FragmentType = CharacterEquip;\t\t//\taccessoryEyes\t-> CharacterEquip\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0103\'].FragmentType = CharacterEquip;\t\t//\taccessoryEars\t-> CharacterEquip\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0104\'].FragmentType = CharacterEquip;\t\t//\tCoat\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0105\'].FragmentType = CharacterEquip;\t\t//\tLongcoat\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0106\'].FragmentType = CharacterEquip;\t\t//\tPants\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0107\'].FragmentType = CharacterEquip;\t\t//\tShoes\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0108\'].FragmentType = CharacterEquip;\t\t//\tGlove\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0109\'].FragmentType = CharacterEquip;\t\t//\tShield\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0110\'].FragmentType = CharacterEquip;\t\t//\tCape\t\t\t-> CharacterBody\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0170\'].FragmentType = CharacterEquipCashWeapon;\t//\tcash-weapon\t-> CharacterEquip\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'019\'].FragmentType = CharacterTamingMob;\t//\tTamingMob\t\t-> CharacterTamingMob\r\n\r\n\r\nclass CharacterSlots {\r\n\tconstructor() {\r\n\t\t\t\r\n\t\t/** @type {CharacterAppearanceBase[]} */\r\n\t\tthis._ordered_slot = [];\r\n\r\n\r\n\t\t/** @type {CharacterBody} */\r\n\t\tthis.body = null;\r\n\r\n\t\t/** @type {CharacterHead} */\r\n\t\tthis.head = null;\r\n\r\n\t\t/** @type {CharacterFace} */\r\n\t\tthis.face = null;\r\n\r\n\r\n\t\t/** @type {CharacterHair} */\r\n\t\tthis.hair = null;\r\n\t\t\r\n\t\t/** @type {CharacterHair} */\r\n\t\tthis._hair2 = null;\r\n\t\t/** @type {number} 0~1.0 */\r\n\t\tthis._hairMix2 = null;\r\n\t\t/** @type {CharacterHair} */\r\n\t\tthis._hair3 = null;\r\n\t\t/** @type {number} 0~1.0 */\r\n\t\tthis._hairMix3 = null;\r\n\r\n\r\n\t\t/** @type {CharacterEquip} - 1 */\r\n\t\tthis.cap = null;\r\n\r\n\t\t/** @type {CharacterFaceAcc} - 2 */\r\n\t\tthis.accessoryFace = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 3*/\r\n\t\tthis.accessoryEyes = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 4 */\r\n\t\tthis.accessoryEars = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 5 */\r\n\t\tthis.coat = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 5 */\r\n\t\tthis.longcoat = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 6 */\r\n\t\tthis.pants = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 7 */\r\n\t\tthis.shoes = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 8 */\r\n\t\tthis.glove = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 9 */\r\n\t\tthis.cape = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 10 */\r\n\t\tthis.shield = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 11 */\r\n\t\tthis.weapon = null;\r\n\t\t\r\n\t\t/** @type {CharacterTamingMob} */\r\n\t\tthis.tamingMob = null;\r\n\t\t\r\n\t\t{\r\n\t\t\tObject.defineProperty(this, "_ordered_slot", {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: []\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tObject.defineProperty(this, "_hair", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "hair", {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tget: function () {\r\n\t\t\t\t\treturn this._hair;\r\n\t\t\t\t},\r\n\t\t\t\tset: function (value) {\r\n\t\t\t\t\tthis._hair = value;\r\n\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\tif (this._hair2 && this._hairMix2) {\r\n\t\t\t\t\t\t\tthis.hairColor2 = this.hairColor2;//force reload\r\n\t\t\t\t\t\t\tthis.hairMix2 = this.hairMix2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this._hair3 && this._hairMix3) {\r\n\t\t\t\t\t\t\tthis.hairColor3 = this.hairColor3;//force reload\r\n\t\t\t\t\t\t\tthis.hairMix3 = this.hairMix3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tObject.defineProperty(this, "_hair", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hair2", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hairMix2", {\t// 0~1.0\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hair3", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hairMix3", {\t// 0~1.0\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tasync __loadColoredHair(color) {\r\n\t\tconst id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getColorHairID(this.hair.id, color);\r\n\t\tconst cateInfo = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(id);\r\n\r\n\t\tif (cateInfo) {\r\n\t\t\tconst url = `/Character/${cateInfo.path + (cateInfo.path ? "/" : "") + id}`;\r\n\t\t\tconst use_category = undefined;\r\n\r\n\t\t\tlet hair = new CharacterHair();\r\n\r\n\t\t\tawait hair.load(url, id, cateInfo, use_category);\r\n\r\n\t\t\treturn hair;\r\n\t\t}\r\n\t}\r\n\r\n\t/** @returns {number} */\r\n\tget hairColor2() {\r\n\t\tif (this._hair2) {\r\n\t\t\treturn Number(_public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getHairColor(this._hair2.id));\r\n\t\t}\r\n\t}\r\n\tset hairColor2(color) {\r\n\t\tif (!color) {\r\n\t\t\tconsole.error(new TypeError());\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet hc2Id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getColorHairID(this.hair.id, color);\r\n\r\n\t\tif (!this._hair2 || hc2Id != this._hair2.id) {\r\n\t\t\tif (hc2Id == this._hair.id) {\r\n\t\t\t\tthis._hair2 = null;\r\n\t\t\t\tthis.hairMix2 = 0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.hair.$promise_hair2 = this.__loadColoredHair(color);\r\n\r\n\t\t\t\tthis.hair.$promise_hair2.then(hair2 => {\r\n\t\t\t\t\tdelete this.hair.$promise_hair2;\r\n\r\n\t\t\t\t\tthis._hair2 = hair2;\r\n\t\t\t\t\tif (this._hair2 && this.hairMix2 != null) {\r\n\t\t\t\t\t\tthis.hairMix2 = this.hairMix2;//force update\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//else {\r\n\t\t\t\t\t//\tthis.hairMix2 = 0;//disable\r\n\t\t\t\t\t//}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/** @returns {number} 0~1.0 */\r\n\tget hairMix2() {\r\n\t\treturn this._hairMix2;\r\n\t}\r\n\tset hairMix2(value) {\r\n\t\tvalue = Number(value);\r\n\r\n\t\tPromise.resolve(this.hair.$promise_hair2).then(() => {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this._hair2;\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet base = this.hair;\r\n\r\n\t\t\tif (!item || !base) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let j in item.fragments) {\r\n\t\t\t\tfor (let k in item.fragments[j].textures) {\r\n\t\t\t\t\tfor (let i = 0; i < item.fragments[j].textures[k].length; ++i) {\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ft = item.fragments[j].textures[k][i];\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ori = base.fragments[j].textures[k][i];\r\n\t\t\t\t\t\tif (ori) {\r\n\t\t\t\t\t\t\tori.graph2 = ft;\r\n\t\t\t\t\t\t\tori.graph2.opacity = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._hairMix2 = value;\r\n\t\t});\r\n\t}\r\n\r\n\t/** @returns {number} 0~1.0 */\r\n\tget hairColor3() {\r\n\t\tif (this._hair3) {\r\n\t\t\treturn Number(_public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getHairColor(this._hair3.id));\r\n\t\t}\r\n\t}\r\n\tset hairColor3(color) {\r\n\t\tif (!color) {\r\n\t\t\tconsole.error(new TypeError());\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet hc3Id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getColorHairID(this.hair.id, color);\r\n\r\n\t\tif (!this._hair3 || this._hair3.id != hc3Id) {\r\n\t\t\tif (this._hair.id == hc3Id || this._hair2.id == hc3Id) {\r\n\t\t\t\tthis._hair3 = null;\r\n\t\t\t\tthis.hairMix3 = 0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.hair.$promise_hair3 = this.__loadColoredHair(color);\r\n\r\n\t\t\t\tthis.hair.$promise_hair3.then(hair3 => {\r\n\t\t\t\t\tdelete this.hair.$promise_hair3;\r\n\r\n\t\t\t\t\tthis._hair3 = hair3;\r\n\t\t\t\t\tif (this._hair3 && this.hairMix3 != null) {\r\n\t\t\t\t\t\tthis.hairMix3 = this.hairMix3;//force update\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//else {\r\n\t\t\t\t\t//\tthis.hairMix3 = 0;//disable\r\n\t\t\t\t\t//}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/** @returns {number} */\r\n\tget hairMix3() {\r\n\t\treturn this._hairMix3;\r\n\t}\r\n\tset hairMix3(value) {\r\n\t\tvalue = Number(value);\r\n\r\n\t\tPromise.resolve(this.hair.$promise_hair3).then(() => {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this._hair3;\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet base = this.hair;\r\n\r\n\t\t\tif (!item || !base) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let j in item.fragments) {\r\n\t\t\t\tfor (let k in item.fragments[j].textures) {\r\n\t\t\t\t\tfor (let i = 0; i < item.fragments[j].textures[k].length; ++i) {\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ft = item.fragments[j].textures[k][i];\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ori = base.fragments[j].textures[k][i];\r\n\t\t\t\t\t\tif (ori) {\r\n\t\t\t\t\t\t\tori.graph3 = ft;\r\n\t\t\t\t\t\t\tori.graph3.opacity = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._hairMix3 = value;\r\n\t\t});\r\n\t}\r\n\r\n\t//__order_slot() {\r\n\t//\tlet slot_map = new Map();\r\n\t//\r\n\t//\tfor (let i in this) {\r\n\t//\t\tlet equip = this[i];\r\n\t//\r\n\t//\t\tequip.cs\r\n\t//\t}\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @param {CharacterAppearanceBase} loadedEquip\r\n\t * @param {string} use_category - category which used of cash-weapon\r\n\t */\r\n\tasync _use(id, loadedEquip, use_category) {\r\n\t\tif (!id) {\r\n\t\t\tdebugger\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst cateInfo = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(id);\r\n\r\n\t\tif (cateInfo) {\r\n\t\t\tlet url = `/Character/${cateInfo.path + (cateInfo.path ? "/":"") + id}`;\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item;\r\n\r\n\t\t\tif (loadedEquip instanceof CharacterAppearanceBase) {\r\n\t\t\t\talert("CharacterSlots # _use: param loadedEquip ??");\r\n\t\t\t\tdebugger;\r\n\t\t\t\titem = loadedEquip;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (loadedEquip) {\r\n\t\t\t\t\talert("CharacterSlots # _use: param loadedEquip ??");\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t}\r\n\t\t\t\tconst fragmentType = cateInfo.FragmentType || CharacterEquip;\r\n\r\n\t\t\t\titem = new fragmentType();\r\n\t\t\t}\r\n\t\t\t/** _use_loaded_equip */\r\n\t\t\tif (0) {}\r\n\r\n\t\t\tlet is_exist = loadedEquip || await item.load(url, id, cateInfo, use_category);\r\n\t\t\tif (is_exist) {\r\n\t\t\t\t/** _use_loaded_equip */\r\n\t\t\t\tif (1) {\r\n\t\t\t\t\tif (this[cateInfo.slot]) {\r\n\t\t\t\t\t\tthis[cateInfo.slot]._unload();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis[cateInfo.slot] = item;\r\n\r\n\t\t\t\t\tthis._ordered_slot[item.slot_order] = item;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconsole.warn("item(" + id + ") is not exist");\r\n\t\t\t}\r\n\r\n\t\t\treturn item;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {boolean}\r\n\t */\r\n\t_unuse(id) {\r\n\t\tif (!id) {\r\n\t\t\tdebugger\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet cateInfo, equip;\r\n\r\n\t\tif (id instanceof CharacterAppearanceBase) {\r\n\t\t\tequip = id;\r\n\t\t\tid = equip.id;\r\n\t\t\tcateInfo = equip.categoryInfo;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcateInfo = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(id);\r\n\t\t}\r\n\t\t\r\n\t\tconst slotName = cateInfo.slot;\r\n\r\n\t\tif (slotName != "head" && slotName != "body") {\r\n\t\t\tif (this[slotName] && this[slotName].id == id) {\r\n\t\t\t\tequip = this[slotName];\r\n\t\t\t\tfor (let slot in equip.islot) {\r\n\t\t\t\t\tlet order = equip.islot[slot];\r\n\t\t\t\t\tif (this._ordered_slot[order]) {\r\n\t\t\t\t\t\tthis._ordered_slot[order]._unload();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete this._ordered_slot[order];\r\n\t\t\t\t}\r\n\t\t\t\tthis[slotName] = null;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t_clear() {\r\n\t\t//this.body = null;\r\n\t\t//this.head = null;\r\n\t\tthis.face = null;\r\n\t\tthis.hair = null;\r\n\t\tthis.cap = null;\r\n\t\tthis.accessoryFace = null;\r\n\t\tthis.accessoryEyes = null;\r\n\t\tthis.accessoryEars = null;\r\n\t\tthis.coat = null;\r\n\t\tthis.longcoat = null;\r\n\t\tthis.pants = null;\r\n\t\tthis.shoes = null;\r\n\t\tthis.glove = null;\r\n\t\tthis.cape = null;\r\n\t\tthis.shield = null;\r\n\r\n\t\t//temp\r\n\t\tlet head = this.head;\r\n\t\tlet body = this.body;\r\n\r\n\t\t//clear\r\n\t\tthis._ordered_slot = [];\r\n\r\n\t\t//restore\r\n\t\tif (head) {\r\n\t\t\tthis._ordered_slot[head.slot_order] = head;\r\n\t\t}\r\n\t\tif (body) {\r\n\t\t\tthis._ordered_slot[body.slot_order] = body;\r\n\t\t}\r\n\t}\r\n\r\n\t_stringify() {\r\n\t\tlet slots = ["c"];\r\n\t\t\t\r\n\t\tif (this.body) slots.push(this.body.id);\r\n\t\tif (this.head) slots.push(this.head.id);\r\n\t\tif (this.face) slots.push(this.face.id + "|" + this.face.id);\r\n\t\tif (this.hair) {\r\n\t\t\tlet ha = [];\r\n\t\t\tha.push(this.hair.id);\r\n\t\t\tif (this.hairColor2 && this.hairMix2 > 0) ha.push(this.hairColor2 + "%" + Math.trunc(this.hairMix2 * 100));\r\n\t\t\tif (this.hairColor3 && this.hairMix3 > 0) ha.push(this.hairColor3 + "%" + Math.trunc(this.hairMix3 * 100));\r\n\t\t\tslots.push(ha.join("|"));\r\n\t\t}\r\n\t\tif (this.cap) slots.push(this.cap.id);\r\n\t\tif (this.accessoryFace) slots.push(this.accessoryFace.id);\r\n\t\tif (this.accessoryEyes) slots.push(this.accessoryEyes.id);\r\n\t\tif (this.accessoryEars) slots.push(this.accessoryEars.id);\r\n\t\tif (this.coat) slots.push(this.coat.id);\r\n\t\tif (this.longcoat) slots.push(this.longcoat.id);\r\n\t\tif (this.pants) slots.push(this.pants.id);\r\n\t\tif (this.shoes) slots.push(this.shoes.id);\r\n\t\tif (this.glove) slots.push(this.glove.id);\r\n\t\tif (this.shield) slots.push(this.shield.id);\r\n\t\tif (this.cape) slots.push(this.cape.id);\r\n\t\tif (this.weapon) slots.push(this.weapon.id);\r\n\r\n\t\treturn slots.join(",");\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet slots = [];\r\n\r\n\t\tif (this.body) slots.push(this.body);\r\n\t\tif (this.head) slots.push(this.head);\r\n\t\tif (this.face) slots.push(this.face);\r\n\t\tif (this.hair) slots.push(this.hair);\r\n\t\t//if (this._hair2) slots.push(this._hair2);\r\n\t\t//if (this._hair3) slots.push(this._hair3);\r\n\t\tif (this.cap) slots.push(this.cap);\r\n\t\tif (this.accessoryFace) slots.push(this.accessoryFace);\r\n\t\tif (this.accessoryEyes) slots.push(this.accessoryEyes);\r\n\t\tif (this.accessoryEars) slots.push(this.accessoryEars);\r\n\t\tif (this.coat) slots.push(this.coat);\r\n\t\tif (this.longcoat) slots.push(this.longcoat);\r\n\t\tif (this.pants) slots.push(this.pants);\r\n\t\tif (this.shoes) slots.push(this.shoes);\r\n\t\tif (this.glove) slots.push(this.glove);\r\n\t\tif (this.shield) slots.push(this.shield);\r\n\t\tif (this.cape) slots.push(this.cape);\r\n\t\tif (this.weapon) slots.push(this.weapon);\r\n\r\n\t\treturn slots;\r\n\t}\r\n\r\n\t/**\r\n\t * returns: [face, hair, cap, ..., weapon]\r\n\t */\r\n\t*enumerate() {\r\n\t\tif (this.face) yield this.face;\r\n\t\tif (this.hair) yield this.hair;\r\n\r\n\t\tyield* this.enumerate_equip();\r\n\t}\r\n\t*enumerate_equip() {\r\n\t\tif (this.cap) yield this.cap;\r\n\t\tif (this.accessoryFace) yield this.accessoryFace;\r\n\t\tif (this.accessoryEyes) yield this.accessoryEyes;\r\n\t\tif (this.accessoryEars) yield this.accessoryEars;\r\n\t\tif (this.coat) yield this.coat;\r\n\t\tif (this.longcoat) yield this.longcoat;\r\n\t\tif (this.pants) yield this.pants;\r\n\t\tif (this.shoes) yield this.shoes;\r\n\t\tif (this.glove) yield this.glove;\r\n\t\tif (this.shield) yield this.shield;\r\n\t\tif (this.cape) yield this.cape;\r\n\t\tif (this.weapon) yield this.weapon;\r\n\t}\r\n\t*enumerate_face() {\r\n\t\tif (this.face) yield this.face;\r\n\t\tif (this.accessoryFace) yield this.accessoryFace;\r\n\t}\r\n}\r\n\r\nclass CharacterChangeLog {\r\n\tconstructor() {\r\n\t\t/** @type {"human"|"elf"|"lef"|"highlef"} */\r\n\t\tthis.ear = undefined;\r\n\r\n\t\t/** @type {string[]} */\r\n\t\tthis.useEquip = [];\r\n\r\n\t\t/** @type {string[]} */\r\n\t\tthis.unuseEquip = [];\r\n\t\t\r\n\t\t/** @type {string} - hair2 id */\r\n\t\tthis.hair2 = undefined;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.hairMix2 = undefined;\r\n\r\n\t\t///** @type {string} */\r\n\t\t//this.hair3 = undefined;\r\n\r\n\t\t///** @type {string} */\r\n\t\t//this.hairMix3 = undefined;\r\n\r\n\t\t/** @type {string} weapon => equip id */\r\n\t\tthis.weapon = undefined;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.weaponType = undefined;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.ear = undefined;\r\n\t\tthis.useEquip = [];\r\n\t\tthis.unuseEquip = [];\r\n\t\tthis.hair2 = undefined;\r\n\t\tthis.hairMix2 = undefined;\r\n\t\t//this.hair3 = undefined;\r\n\t\t//this.hairMix3 = undefined;\r\n\t\tthis.weaponType = undefined;\r\n\t}\r\n}\r\n\r\nclass CharacterAnimationBase {\r\n\tconstructor() {\r\n\t\tthis._$dirty = 0;//force update vue\r\n\r\n\t\t/** @type {string} - 未完成 */\r\n\t\tthis.job = null;\r\n\t\t/** @type {string} - 未完成 */\r\n\t\tthis.subJob = null;\r\n\r\n\r\n\t\t/** @type {ActionAnimation} */\r\n\t\tthis.actani = new _CharacterActionAnimation_js__WEBPACK_IMPORTED_MODULE_8__[/* ActionAnimation */ "a"]();\r\n\r\n\t\t/** @type {number} - animation speed rate */\r\n\t\tthis.speed = 1;\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis.fixed_speed = false;\r\n\r\n\t\t/** @type {boolean} - pause animation */\r\n\t\tthis.pause = false;\r\n\r\n\r\n\t\tthis.hideBody = false;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._ride_action = "stand1";\r\n\r\n\t\t//\taction\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._action = "stand1";\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._action_frame = 0;\r\n\r\n\t\t//\temotion\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._emotion = "blink";\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_frame = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_time = 0;\r\n\r\n\t\t//\r\n\r\n\t\tthis._generator_emotion_frame = this.emotion_frame_sequence_generator(3, 0);//[0,1,2].length\r\n\t\t\r\n\t\tthis.blinkRate = 0.015;\r\n\r\n\t\t/** @type {CharacterSlots} */\r\n\t\tthis.slots = new CharacterSlots();\r\n\r\n\t\t/**\r\n\t\t * is require update render data\r\n\t\t * @type {boolean}\r\n\t\t */\r\n\t\tthis.__require_update = true;\r\n\r\n\t\t/** @type {FragmentTexture[]} */\r\n\t\tthis.__frag_list = [];\r\n\r\n\t\t/** @type {CharacterChangeLog} **/\r\n\t\tthis.$$changeLog = new CharacterChangeLog();\r\n\t}\r\n\r\n\t_clone() {\r\n\t\talert(this.constructor.name + "::_clone");\r\n\r\n\t\t/** @type {CharacterAnimationBase} */\r\n\t\tlet nc = new this.constructor();//not must CharacterRender\r\n\t\tif (!nc) {\r\n\t\t\tdebugger;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tnc.speed = 0;\r\n\r\n\t\tnc.x = this.x;\r\n\t\tnc.y = this.y;\r\n\t\tnc.angle = this.angle;\r\n\r\n\t\tnc.action = this.action;\r\n\t\tnc.action_frame = this.action_frame;\r\n\r\n\t\tnc.emotion = this._emotion;\r\n\t\tnc.emotion_frame = this.emotion_frame;\r\n\r\n\t\tfor (let i in this.slots) {\r\n\t\t\tlet item = this.slots[i];\r\n\t\t\tif (item) {\r\n\t\t\t\tnc.slots[i] = this.slots[i];//not need colne ?\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn nc;\r\n\t}\r\n\t\t\r\n\t_waitFrameTexturesLoaded() {\r\n\t\tlet tasks = [];\r\n\t\tfor (let i in this.slots) {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this.slots[i];\r\n\t\t\tif (item) {\r\n\t\t\t\tfor (let j in item.fragments) {\r\n\t\t\t\t\tlet frag = item.fragments[j];\r\n\t\t\t\t\tlet count = frag.getFrameCount(this);\r\n\t\t\t\t\tfor (let k = 0; k < count; ++k) {\r\n\t\t\t\t\t\tlet ft = frag.getFrameTexture(this, k);\r\n\t\t\t\t\t\tif (ft && !ft._isLoaded_or_doload()) {\r\n\t\t\t\t\t\t\ttasks.push(ft.$promise);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Promise.all(tasks);\r\n\t}\r\n\r\n\t/**\r\n\t * init animation status\r\n\t */\r\n\tinitAnimation() {\r\n\t\t/** @type {string} */\r\n\t\tthis.action = "stand1";\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._action_frame = 0;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.emotion = "blink";\r\n\t\t\t\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_time = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_frame = 0;\r\n\t}\r\n\r\n\t/** @type {number} - 0~1 */\r\n\tgetSpeed() {\r\n\t\tif (this.pause) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this.fixed_speed ? 1 : this.speed;\r\n\t}\r\n\r\n\t/**\r\n\t * @type {boolean}\r\n\t */\r\n\tget elfEar() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.elfEar;\r\n\t\t}\r\n\t}\r\n\tset elfEar(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tthis.slots.head.elfEar = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @type {boolean}\r\n\t */\r\n\tget lefEar() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.lefEar;\r\n\t\t}\r\n\t}\r\n\tset lefEar(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tthis.slots.head.lefEar = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @type {boolean}\r\n\t */\r\n\tget highlefEar() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.highlefEar;\r\n\t\t}\r\n\t}\r\n\tset highlefEar(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tthis.slots.head.highlefEar = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/** @returns {"human"|"elf"|"lef"|"highlef"} */\r\n\tget ear() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.lefEar ? "lef" : (this.slots.head.elfEar ? "elf" : (this.slots.head.highlefEar ? "highlef" : "human"));\r\n\t\t}\r\n\t}\r\n\tset ear(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tif (value == "elf") {\r\n\t\t\t\tthis.slots.head.elfEar = true;\r\n\t\t\t\tthis.slots.head.lefEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = false;\r\n\t\t\t\tthis.$$changeLog.ear = value;\r\n\t\t\t}\r\n\t\t\telse if (value == "lef") {\r\n\t\t\t\tthis.slots.head.lefEar = true;\r\n\t\t\t\tthis.slots.head.elfEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = false;\r\n\t\t\t\tthis.$$changeLog.ear = value;\r\n\t\t\t}\r\n\t\t\telse if (value == "highlef") {\r\n\t\t\t\tthis.slots.head.elfEar = false;\r\n\t\t\t\tthis.slots.head.lefEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = true;\r\n\t\t\t\tthis.$$changeLog.ear = value;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.slots.head.elfEar = false;\r\n\t\t\t\tthis.slots.head.lefEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = false;\r\n\t\t\t\tthis.$$changeLog.ear = "human";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.$$changeLog.ear = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\t/** @type {string} */\r\n\tget action() {\r\n\t\t//if (this.slots.tamingMob) {\r\n\t\t//\tconst actmap = this.slots.tamingMob.actionMap;\r\n\t\t//\tif (actmap) {\r\n\t\t//\t\treturn actmap[this._action];\r\n\t\t//\t}\r\n\t\t//\treturn "sit";//default\r\n\t\t//}\r\n\t\treturn this._action;\r\n\t}\r\n\tset action(act) {\r\n\t\tif (this.slots.tamingMob) {\r\n\t\t\tlet _act;\r\n\r\n\t\t\tthis._ride_action = act;\r\n\r\n\t\t\tif (this.slots.tamingMob.actionMap) {\r\n\t\t\t\t_act = this.slots.tamingMob.actionMap[act];\r\n\r\n\t\t\t\tif (_act == "hideBody") {\r\n\t\t\t\t\tthis.hideBody = true;\r\n\r\n\t\t\t\t\t//TODO: hideBody act=?\r\n\r\n\t\t\t\t\tthis._action = act;\r\n\t\t\t\t\tif (this.actani._action != act) {\r\n\t\t\t\t\t\tthis.actani.reload(act);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__require_update |= true;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.hideBody = false;\r\n\r\n\t\t\t\t\tthis._action = _act;\r\n\t\t\t\t\tif (this.actani._action != _act) {\r\n\t\t\t\t\t\tthis.actani.reload(_act);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__require_update |= true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (act == "rope") {\r\n\t\t\t\t\tthis._action = "rope";//default\r\n\t\t\t\t}\r\n\t\t\t\telse if (act == "ladder") {\r\n\t\t\t\t\tthis._action = "ladder";//default\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._action = "sit";//default\r\n\t\t\t\t\tthis._action_frame = 0;//default\r\n\t\t\t\t}\r\n\t\t\t\tif (this.actani._action != act) {\r\n\t\t\t\t\tthis.actani.reload(act);\r\n\t\t\t\t}\r\n\t\t\t\tthis.__require_update |= true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.hideBody = false;\r\n\t\t\tthis._ride_action = null;\r\n\r\n\t\t\tif (this.actani._action != act && this.slots.body) {\r\n\t\t\t\tthis._action = act;\r\n\t\t\t\tthis.actani.reload(act);\r\n\r\n\t\t\t\tthis.__require_update |= true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget action_frame() {\r\n\t\treturn this._action_frame;\r\n\t}\r\n\tset action_frame(value) {\r\n\t\tif (value === "") {//from $("input")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (false) {}\r\n\r\n\t\tthis._action_frame = value;\r\n\t\tthis.__require_update |= true;\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget action_frame_count() {\r\n\t\ttry {\r\n\t\t\tif (this.slots.body) {\r\n\t\t\t\treturn this.slots.body.getFrameCount(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t/** @type {string} */\r\n\tget emotion() {\r\n\t\treturn this._emotion;\r\n\t}\r\n\tset emotion(emo) {\r\n\t\tif (this._emotion != emo && this.slots.face && this.slots.face.fragments.face.textures[emo]) {\r\n\t\t\tthis._emotion = emo;\r\n\t\t\tthis._emotion_frame = 0;\r\n\t\t\tthis._emotion_time = 0;\r\n\r\n\t\t\tif (emo == "blink") {\r\n\t\t\t\tthis.blinkRate = 0.015;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.blinkRate = 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._generator_emotion_frame = this.emotion_frame_sequence_generator(this.emotion_frame_count, 0);\r\n\r\n\t\t\tthis.__require_update |= true;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} count of frame\r\n\t * @param {number} start frame\r\n\t */\r\n\t*emotion_frame_sequence_generator(length, start) {\r\n\t\twhile (true) {\r\n\t\t\tif (Math.random() < this.blinkRate) {\r\n\t\t\t\tyield* linearSequence(length, start);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tyield 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/** @type {number} */\r\n\tget emotion_frame() {\r\n\t\treturn this._emotion_frame;\r\n\t}\r\n\tset emotion_frame(value) {\r\n\t\tif (value === "") {//from $("input")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (false) {}\r\n\r\n\t\tthis._emotion_frame = value;\r\n\t\tthis._emotion_time = 0;\r\n\t\tthis.__require_update |= true;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} next\r\n\t */\r\n\t_get_emotion_next_frame(next) {\r\n\t\tlet r = this._generator_emotion_frame.next().value;\r\n\t\t\r\n\t\tthis._generator_emotion_frame = this.emotion_frame_sequence_generator(this.emotion_frame_count, this._emotion_frame);\r\n\t\t\r\n\t\treturn r;\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget emotion_time() {\r\n\t\treturn this._emotion_time;\r\n\t}\r\n\tset emotion_time(time) {\r\n\t\tif (this.emotion_frame_count) {\r\n\t\t\tif (time < this.emotion_delay) {\r\n\t\t\t\tthis._emotion_time = time;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._emotion_time = 0;\r\n\r\n\t\t\t\tthis._emotion_frame = this._generator_emotion_frame.next().value;\r\n\r\n\t\t\t\tthis.__require_update |= true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {number}\r\n\t */\r\n\tget emotion_delay() {\r\n\t\tif (this.slots.face) {\r\n\t\t\treturn this.slots.face.getDelay(this);\r\n\t\t}\r\n\t\treturn 60;\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget emotion_frame_count() {\r\n\t\ttry {\r\n\t\t\tif (this.slots.face) {\r\n\t\t\t\treturn this.slots.face.getFrameCount(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} stamp - 0 <= stamp < Infinity\r\n\t */\r\n\t_update(_stamp) {\r\n\t\tif (this.pause) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet stamp = _stamp * this.getSpeed();\r\n\t\t\r\n\t\tif (this.actani) {\r\n\t\t\tif (this.actani.isEnd() && this.actani.loop) {\r\n\t\t\t\tthis.actani.reset();\r\n\t\t\t}\r\n\r\n\t\t\tthis.actani.update(stamp, this);\r\n\t\t}\r\n\r\n\t\tthis.emotion_time += _stamp;\r\n\r\n\t\tfor (let i in this.slots) {\r\n\t\t\tlet equip = this.slots[i];\r\n\t\t\tif (equip && equip.effect && equip.effect.enable) {\r\n\t\t\t\tequip.effect.update(stamp);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {any} number  0 < stamp * speed < Infinity\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tthis._update(stamp);\r\n\t}\r\n\r\n\t/**\r\n\t * use await this.__synchronize(stamp) update and force wait all resource load\r\n\t * @param {number}\r\n\t */\r\n\t__forceUpdate(stamp) {\r\n\t\tthis._$dirty = Math.random();\r\n\t\tthis._update(stamp | 0);\r\n\t\tthis.__update_frag_list();\r\n\t}\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {number} x\r\n\t * @param {number} y, \r\n\t * @param {number} angle\r\n\t * @param {boolean} flip\r\n\t */\r\n\t_draw(renderer, x, y, angle, flip) {\r\n\t\trenderer.pushGlobalAlpha();\r\n\r\n\t\t//list.filter(a=>a&&a._raw.map).forEach(a=>{ for (let i in a._raw.map) { if (q[i]) { q[i].push(a); } else { q[i] = [a]; } } })\r\n\t\tthis.__draw_list(renderer, this.__frag_list, x, y, angle, flip);\r\n\r\n\t\trenderer.popGlobalAlpha();\r\n\t}\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {FragmentTexture[]} list\r\n\t */\r\n\t__draw_list(renderer, list, x, y, angle, flip) {\r\n\t\trenderer.pushMatrix();\r\n\r\n\t\trenderer.translate(x, y);\r\n\t\t\r\n\t\tif (0) {}\r\n\r\n\t\trenderer.rotate(window.m_a || angle);\r\n\r\n\t\tif (flip) {\r\n\t\t\trenderer.scale(-1, 1);\r\n\t\t}\r\n\t\t//{\r\n\t\t//\tlet ctx = renderer.ctx;\r\n\t\t//\tctx.beginPath();\r\n\t\t//\tctx.moveTo(0, 0);\r\n\t\t//\tctx.lineTo(100, 0);\r\n\t\t//\tctx.strokeStyle = "#F00";\r\n\t\t//\tctx.stroke();\r\n\t\t//\tctx.beginPath();\r\n\t\t//\tctx.moveTo(0, 0);\r\n\t\t//\tctx.lineTo(0, 100);\r\n\t\t//\tctx.strokeStyle = "#0F0";\r\n\t\t//\tctx.stroke();\r\n\t\t//}\r\n\r\n\t\t{\r\n\t\t\tfor (let i in this.slots) {\r\n\t\t\t\tlet equip = this.slots[i];\r\n\t\t\t\tif (equip && equip.effect) {\r\n\t\t\t\t\tequip.effect.render(renderer, this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i in list) {\r\n\t\t\t\tlet ft = list[i];\r\n\t\t\t\tft.render(renderer, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\trenderer.popMatrix();\r\n\t}\r\n\t__update_frag_list() {\r\n\t\tthis.__frag_list = [];\r\n\t\t\r\n\t\t/** @type {Array<CharacterAppearanceBase>[]} */\r\n\t\tlet slots = {};\r\n\t\t\r\n\t\tfor (let i = 2; i <= 3; ++i) {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this.slots["_hair" + i];\r\n\t\t\t\r\n\t\t\tthis.__add_equip_to_frag_list(slots, item);\r\n\t\t}\r\n\t\tfor (let i in this.slots._ordered_slot) {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this.slots._ordered_slot[i];\r\n\t\t\t\r\n\t\t\tthis.__add_equip_to_frag_list(slots, item);\r\n\t\t}\r\n\t\t\r\n\t\t{//back\r\n\t\t\tlet is_back = false;\r\n\t\t\t\r\n\t\t\tfor (let i in slots) {\r\n\t\t\t\t/** @type {FragmentTexture[]} */\r\n\t\t\t\tlet fts = slots[i];\r\n\t\t\t\tfor (let j in fts) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = fts[j];\r\n\t\t\t\t\tif (is_back) {\r\n\t\t\t\t\t\tif (ft._place.startsWith("face")) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (ft._place.startsWith("backHair")) {\r\n\t\t\t\t\t\tis_back = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__add_frag_to_list(ft);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t{\r\n\t\t\tlet ae = this.__frag_list[114];//HACK: Ae\r\n\t\t\tif (ae) {\r\n\t\t\t\tthis.__frag_list.push(ae);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._calcBoundBox();\r\n\t}\r\n\t/**\r\n\t * @param {Array<CharacterAppearanceBase>[]} slots\r\n\t * @param {CharacterAppearanceBase} item\r\n\t */\r\n\t__add_equip_to_frag_list(slots, item) {\r\n\t\t// if equip not use then value is mumber(slot_order) where this.slots._ordered_slot\r\n\t\tif (item == null) {\r\n\t\t\treturn;//debugger;\r\n\t\t}\r\n\t\telse if (item > 0) {// typeof item == \'number\'; item != null && (item instanceof CharacterAppearanceBase || item >= 0)\r\n\t\t\treturn;//continue;\r\n\t\t}\r\n\r\n\t\t// init slots\r\n\t\tfor (let j in item.vslot) {\r\n\t\t\tlet slot = item.vslot[j];\r\n\t\t\tslots[slot] = [];\r\n\t\t}\r\n\r\n\t\tfor (let j in item.fragments) {//foreach equip place\r\n\t\t\tlet slot = sMap[j];\r\n\t\t\tif (slot != null) {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tlet ft = item.fragments[j].getTexture(this);\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tif (!slots[slot]) {\r\n\t\t\t\t\t\tslots[slot] = [ft];//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tslots[slot].push(ft);//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (j == "default") {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tlet ft = item.fragments[j].getTexture(this);\r\n\t\t\t\tslot = item._raw.info.islot;\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tif (!slots[slot]) {\r\n\t\t\t\t\t\tslots[slot] = [ft];//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tslots[slot].push(ft);//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tlet ft = item.fragments[j].getTexture(this);\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tthis.__add_frag_to_list(ft);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//item.fragments[j].visible = true;\r\n\t\t}\r\n\t}\r\n\t/** @param {FragmentTexture} ft */\r\n\t__add_frag_to_list(ft) {\r\n\t\tft.update(this);\r\n\t\tthis.__frag_list[ft.z] = ft;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * calc current frame bound box and restore result\r\n\t * @returns {Rectangle}\r\n\t */\r\n\tcalcBoundBox() {\r\n\t\tif (this.__require_update) {\r\n\t\t\treturn this._calcBoundBox();\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this._boundBox;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * calc current frame bound box and restore result\r\n\t * @returns {Rectangle}\r\n\t */\r\n\t_calcBoundBox() {\r\n\t\tlet left = 0, top = 0, right = 0, bottom = 0;\r\n\r\n\t\tfor (let i in this.__frag_list) {\r\n\t\t\tlet ft = this.__frag_list[i];\r\n\t\t\tif (ft.texture && ft.relative) {\r\n\t\t\t\tlet x0 = ft.relative.x;\r\n\t\t\t\tlet y0 = ft.relative.y;\r\n\t\t\t\tlet x1 = x0 + ft.width;\r\n\t\t\t\tlet y1 = y0 + ft.height;\r\n\r\n\t\t\t\tleft = Math.min(left, x0);\r\n\t\t\t\ttop = Math.min(top, y0);\r\n\t\t\t\tright = Math.max(right, x1);\r\n\t\t\t\tbottom = Math.max(bottom, y1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._boundBox = new _math_js__WEBPACK_IMPORTED_MODULE_7__["Rectangle"](\r\n\t\t\tMath.trunc(left),\r\n\t\t\tMath.trunc(top),\r\n\t\t\tMath.trunc(right - left),\r\n\t\t\tMath.trunc(bottom - top)\r\n\t\t);\r\n\t\treturn this._boundBox;\r\n\t}\r\n\t\r\n\ttoJSON() {\r\n\t\tlet obj = {\r\n\t\t\tslots: this.slots.toJSON(),\r\n\t\t};\r\n\t\tif (this.slots._hair2) {\r\n\t\t\tobj.hair2 = this.slots._hair2.id;\r\n\t\t\tobj.hairMix2 = this.slots.hairMix2;\r\n\t\t}\r\n\r\n\t\tif (this.slots.head.elfEar) {\r\n\t\t\tobj.ear = "elf";\r\n\t\t}\r\n\t\telse if (this.slots.head.lefEar) {\r\n\t\t\tobj.ear = "lef";\r\n\t\t}\r\n\t\telse if (this.slots.head.highlefEar) {\r\n\t\t\tobj.ear = "highlef";\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n}\r\n\r\nclass CharacterRenderer extends CharacterAnimationBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t/** @type {number} - position x */\r\n\t\tthis.x = 0;\r\n\t\t/** @type {number} - position y */\r\n\t\tthis.y = 0;\r\n\r\n\t\t/** @type {number} - where layer */\r\n\t\tthis.z = 5;\r\n\r\n\t\t/** @type {number} - translate x once frame */\r\n\t\tthis.tx = 0;\r\n\t\t/** @type {number} - translate y once frame */\r\n\t\tthis.ty = 0;\r\n\t\t\r\n\t\tthis.angle = 0;\r\n\t\tthis.front = -1;\r\n\r\n\t\t/** @type {Promise<void>[]} */\r\n\t\tthis.__load_task = [];\r\n\r\n\t\t/** @type {function(IRenderer)} */\r\n\t\tthis.render = function (renderer) {\r\n\t\t\t//not ready to render\r\n\t\t\t//if load then set load render = _render\r\n\t\t}\r\n\r\n\t\t/** @type {Rectangle} */\r\n\t\tthis._boundBox = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._$old_action = null;\r\n\t\t/** @type {string} */\r\n\t\tthis._$old_emotion = null;\r\n\t}\r\n\r\n\tstatic async Init() {\r\n\t\tlet result = await Promise.all([\r\n\t\t\t$get.data("/zmap"),\r\n\t\t\t$get.data("/smap"),\r\n\t\t\tItemEffect.Init(),\r\n\t\t\t_CharacterActionAnimation_js__WEBPACK_IMPORTED_MODULE_8__[/* ActionAnimation */ "a"].Init(),//action definition\r\n\t\t]);\r\n\t\t\r\n\t\tzMap = {};\r\n\t\tObject.keys(result[0]).reverse().forEach((k, i) => zMap[k] = i + 1);\r\n\r\n\t\tsMap = result[1];\r\n\t}\r\n\r\n\tload() {\r\n\t\t//load body and head for calc relative position\r\n\t\tthis.use("00002012");\r\n\t\tthis.use("00012012");\r\n\r\n\t\tlet $promise = Promise.all([...this.__load_task]);\r\n\t\t(function (that, $promise) {\r\n\t\t\t$promise.then(function (result) {\r\n\t\t\t\tthat.initAnimation();\r\n\t\t\t\tthat.render = that._render;\r\n\t\t\t});\r\n\t\t})(this, $promise);\r\n\r\n\t\treturn $promise;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {any} number  0 < stamp * speed < Infinity\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tthis._$old_action = this._action;\r\n\t\tthis._$old_emotion = this.emotion;\r\n\r\n\t\tthis.waitLoaded();\r\n\t\tsuper.update(stamp);\r\n\r\n\t\tif (this.__require_update) {\r\n\t\t\tthis.__update_frag_list();\r\n\t\t\tthis.__require_update = false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t */\r\n\t_render(renderer) {\r\n\t\tconst x = Math.trunc(this.x + this.tx);\r\n\t\tconst y = Math.trunc(this.y + this.ty);\r\n\t\t\r\n\t\tthis._draw(renderer, x, y, this.angle, this.front > 0);\r\n\t\t\r\n\t\t//this.tx = 0;//auto clear\r\n\t\t//this.ty = 0;//auto clear\r\n\t}\r\n\t\r\n\t_setup_test() {\r\n\t\tif (0) {}\r\n\t\telse {\r\n\t\t\tthis.use("00026509");\r\n\r\n\t\t\tthis.use("00041526");\r\n\r\n\t\t\tthis.use("01051429");\r\n\r\n\t\t\tthis.use("01071110");\r\n\r\n\t\t\tthis.elfEar = true;\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * update and force wait all resource load\r\n\t * @param {number}\r\n\t */\r\n\tasync __synchronize(stamp) {\r\n\t\tthis.__forceUpdate(stamp);\r\n\t\r\n\t\tawait this.waitLoaded();\r\n\t\tawait this._waitFrameTexturesLoaded();\r\n\t}\r\n\tasync waitLoaded() {\r\n\t\tlet tasks = this.__load_task;\r\n\t\tif (tasks && tasks.length) {\r\n\t\t\tawait Promise.all(tasks).then(() => {\r\n\t\t\t\tthis.__load_task = [];\r\n\t\t\t}, function (err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t//isLoading() {\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @param {string} category - category of cash-weapon\r\n\t */\r\n\tasync use(id, category) {\r\n\t\tif (!category) {\r\n\t\t\tcategory = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].getJobWeaponCategory(this.job);\r\n\t\t}\r\n\t\tif (!(id && typeof id == "string")) {\r\n\t\t\tthrow new TypeError("id: string");\r\n\t\t}\r\n\t\tconst item_type = id[0];\r\n\t\tswitch (item_type) {\r\n\t\t\tcase "0"://equip\r\n\t\t\t\t{\r\n\t\t\t\t\tif (_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].isCashWeapon(id)) {\r\n\t\t\t\t\t\t//this.$$changeLog.weaponType = ss[1];/??\r\n\t\t\t\t\t\tthis.$$changeLog.weapon = id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.$$changeLog.useEquip.push(id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//\r\n\t\t\t\t\tlet task = this.slots._use(id, null, category);\r\n\t\t\t\t\tthis.__load_task.push(task);\r\n\t\t\t\t\tlet item = await task;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (id.startsWith("019")) {\r\n\t\t\t\t\t\tthis.action = this.action;//force update action\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.__update_frag_list();\r\n\t\t\t\t\tthis._calcBoundBox();\r\n\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t */\r\n\tunuse(id) {\r\n\t\tdebugger;\r\n\t\tif (id[0] == "0") {//equip\r\n\t\t\tlet result = this.slots._unuse(id);\r\n\t\t\tif (result) {\r\n\t\t\t\tthis.$$changeLog.unuseEquip.push(id);\r\n\t\t\t\tthis._calcBoundBox();\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {{showears:boolean,showLefEars:boolean,showHighLefEars:boolean,items:[]}} option\r\n\t */\r\n\tset(option) {\r\n\t\tthis.ear = Boolean(option.showears);\r\n\t\tthis.lefEar = Boolean(option.showLefEars);\r\n\t\tthis.highlefEar = Boolean(option.showHighLefEars);\r\n\r\n\t\toption.items.forEach(async (itemData) => {\r\n\t\t\ttry {\r\n\t\t\t\tlet itemId = Number(itemData.itemId | 0).toString().padStart(8, "0");\r\n\t\t\t\tlet item = await this.use(itemId);\r\n\t\t\t\titem.set(itemData);\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\tconsole.error("itemId:", itemData.itemId, ex, itemData);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * another format\r\n\t * @param {{alpha: number, hue: number, saturation: number, brightness: number, contrast: number}[]} equipDataArray\r\n\t */\r\n\tparse(equipDataArray) {\r\n\t\tequipDataArray.forEach(async (itemData) => {\r\n\t\t\ttry {\r\n\t\t\t\tlet itemId = Number(itemData.itemId | 0).toString().padStart(8, "0");\r\n\t\t\t\tlet equip = await this.use(itemId);\r\n\t\t\t\tequip.parse(itemData);\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\tconsole.error("itemId:", itemData.itemId, ex, itemData);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t_parse(code) {\r\n\t\tif (!code) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet es = code.split(",");\r\n\t\tthis.slots._clear();\r\n\t\tes.forEach((v, i, a) => {\r\n\t\t\tif (v.indexOf("|") >= 0) {\r\n\t\t\t\tconst ss = v.split("|");\r\n\t\t\t\tconst cate = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(ss[0]);\r\n\t\t\t\tlet id;\r\n\t\t\t\tif (cate.slot == "face") {\r\n\t\t\t\t\tid = ss[1].trim().padStart(8, 0);\r\n\t\t\t\t\tthis.$$changeLog.useEquip.push(id);\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.use(id);\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse if (cate.slot == "hair") {\r\n\t\t\t\t\tconst slots = this.slots;\r\n\t\t\t\t\tlet h2 = ss[1];\r\n\t\t\t\t\tlet h3 = ss[2];\r\n\t\t\t\t\t//\r\n\t\t\t\t\tid = ss[0].trim().padStart(8, 0);\r\n\t\t\t\t\tthis.$$changeLog.useEquip.push(id);\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.use(id).then(() => {\r\n\t\t\t\t\t\tif (h2 && h2.indexOf("%") >= 0) {\r\n\t\t\t\t\t\t\tlet hc = h2.split("%");\r\n\t\t\t\t\t\t\tconst c2 = hc[0];\r\n\t\t\t\t\t\t\tconst m2 = hc[1] / 100;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tthis.$$changeLog.hair2 = c2;\r\n\t\t\t\t\t\t\tthis.$$changeLog.hairMix2 = m2;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tslots.hairColor2 = c2;\r\n\t\t\t\t\t\t\tslots.hairMix2 = m2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (h3 && h3.indexOf("%") >= 0) {\r\n\t\t\t\t\t\t\tlet hc = h3.split("%");\r\n\t\t\t\t\t\t\tconst c3 = hc[0];\r\n\t\t\t\t\t\t\tconst m3 = hc[1] / 100;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tthis.$$changeLog.hair3 = c3;\r\n\t\t\t\t\t\t\tthis.$$changeLog.hairMix3 = m3;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tslots.hairColor3 = hc[0];\r\n\t\t\t\t\t\t\tslots.hairMix4 = hc[1] / 100;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse if (cate.slot == "weapon") {\r\n\t\t\t\t\tthis.$$changeLog.weaponType = ss[1];\r\n\t\t\t\t\tthis.$$changeLog.weapon = id;\r\n\t\t\t\t\tthis.use.apply(this, ss, ss[1]);//this.use(ss[0], ss[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (Number.isFinite(parseInt(v, 10))) {\r\n\t\t\t\t\tlet id = v.trim().padStart(8, 0);\r\n\t\t\t\t\tthis.use(id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @type {string} col\r\n\t */\r\n\tget hairColor() {\r\n\t\tif (this.slots.hair) {\r\n\t\t\treturn _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getHairColor(this.slots.hair.id);\r\n\t\t}\r\n\t\treturn "0";\r\n\t}\r\n\tset hairColor(col) {\r\n\t\tif (this.slots.hair && col != this.hairColor) {\r\n\t\t\tlet id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getColorHairID(this.slots.hair.id, col);\r\n\t\t\tthis.use(id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} col\r\n\t */\r\n\tget faceColor() {\r\n\t\tif (this.slots.face) {\r\n\t\t\treturn _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getFaceColor(this.slots.face.id);\r\n\t\t}\r\n\t\treturn "0";\r\n\t}\r\n\tset faceColor(col) {\r\n\t\tif (this.slots.face && col != this.faceColor) {\r\n\t\t\tlet id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "a"].getColorFaceID(this.slots.face.id, col);\r\n\t\t\tthis.use(id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterChangeLog} changeLog\r\n\t */\r\n\tcommitChange(changeLog) {\r\n\t\tif (changeLog.ear) {\r\n\t\t\tthis.ear = changeLog.ear;\r\n\t\t}\r\n\r\n\t\tif (this.useEquip) {\r\n\t\t\tfor (let id of this.useEquip) {\r\n\t\t\t\tthis.use(id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.unuseEquip) {\r\n\t\t\tfor (let id of this.unuseEquip) {\r\n\t\t\t\tthis.unuse(id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (changeLog.hair2 && changeLog.hairMix2) {\r\n\t\t\tthis.slots.hairColor2 = changeLog.hair2;\r\n\t\t\tthis.slots.hairMix2 = changeLog.hairMix2;\r\n\t\t}\r\n\r\n\t\tif (changeLog.hair3 && changeLog.hairMix3) {\r\n\t\t\t//this.slots.hairColor3 = changeLog.hair3;\r\n\t\t\t//this.slots.hairMix3 = changeLog.hairMix3;\r\n\t\t}\r\n\t\t\r\n\t\tif (changeLog.weapon && changeLog.weaponType) {\r\n\t\t\tthis.use(changeLog.weapon, changeLog.weaponType);\r\n\t\t}\r\n\t}\r\n\r\n\t_stringify(genCode) {\r\n\t\tlet result = this.slots._stringify();\r\n\t\tif (genCode) {\r\n\t\t\treturn `chara._parse(\'${result}\')`;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t_outlink_old() {\r\n\t\tif (this.slots.body && this.slots.body.id && this.slots.face && this.slots.face.id && this.action && this.emotion) {\r\n\t\t\tlet link = "https://maplestory.io/api/GMS/latest/character/center/" + this.slots.body.id + "/";\r\n\t\t\tlet slots = [...this.slots.enumerate()].map(a => parseInt(a.id, 10));\r\n\r\n\t\t\tslots[0] = this.slots.face.id + ":" + this.emotion;\r\n\r\n\t\t\tlink += slots.join(",");\r\n\r\n\t\t\tlink += "/" + this.action + "?showears=" + (this.elfEar ? "true" : "false");\r\n\r\n\t\t\tlink += "&showLefEars=" + (this.lefEar ? "true" : "false");\r\n\r\n\t\t\treturn link;\r\n\t\t}\r\n\t\tconsole.log("character need body, face, action, emotion");\r\n\t}\r\n\t\r\n\t_outlink(name) {\r\n\t\tconst animationName = this.action;\r\n\t\tconst frame = this.action_frame;\r\n\t\tconst slots = this.slots;\r\n\t\tconst itemList = makeItemList.call();\r\n\t\treturn "https://maplestory.io/api/character/" +\r\n\t\t\t\titemList +    // not array\r\n\t\t\t\t"/" + animationName + "/" + frame + "?" +\r\n\t\t\t\t"showears=" + this.elfEar +\r\n\t\t\t\t"&showLefEars=" + this.lefEar +\r\n\t\t\t\t"&resize=1" +\r\n\t\t\t\t(name ? ("&name=" + name) : "") +\r\n\t\t\t\t"&flipX=" + Boolean(this.front > 0) +\r\n\t\t\t\t"&bgColor=0,0,0,0";\r\n\t\tfunction makeItemList() {\r\n\t\t\treturn Object.values(slots).filter(a => a).map(item => {\r\n\t\t\t\treturn encodeURIComponent(JSON.stringify(item.toJSON(animationName)));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t_download() {\r\n\t\twindow.open(this._outlink());\r\n\t}\r\n\r\n\t_save_as_svg(renderer, filename) {\r\n\t\tthis.__texture_to_base64().then(frag_list => {\r\n\t\t\tlet file_name = `${filename ? (filename+"."):""}${this.action}[${this.action_frame}].${this.emotion}[${this.emotion_frame}].svg`;\r\n\t\t\tlet bound = this.calcBoundBox();\r\n\t\t\tlet size = bound.size;\r\n\t\t\tlet [cx, cy] = [-bound.left, bound.height];\r\n\t\r\n\t\t\tlet svg = \'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" >\';\r\n\r\n\t\t\tsvg += `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink= "http://www.w3.org/1999/xlink" width="${size.x}" height="${size.y}">\\n`;\r\n\r\n\t\t\tsvg += `<g transform="translate(${cx}, ${cy})">`;\r\n\t\t\tfrag_list.forEach(function (ft) {\r\n\t\t\t\tif (ft && ft.relative) {\r\n\t\t\t\t\tlet clz = ft.classList;\r\n\t\t\t\t\tsvg += `\\t<image class="${clz}" opacity="${ft.visible ? ft.opacity : 0}" x="${ft.relative.x}" y="${ft.relative.y}" width="${ft.width}" height="${ft.height}" xlink:href="${ft._url}"></image>\\n`;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tsvg += \'</g>\';\r\n\r\n\t\t\tsvg += \'<text x="0" y="122" fill="transparent">\' + this._stringify(false) + \'</text>\';\r\n\t\t\tsvg += \'<text x="0" y="144" fill="transparent">\' + JSON.stringify(this) + \'</text>\';\r\n\r\n\t\t\tsvg += \'</svg>\';\r\n\r\n\t\t\t//let url = "data:text/plain;utf8," + svg;\r\n\r\n\t\t\tdebugger;\r\n\r\n\t\t\t//window.open(url);\r\n\t\t\tDownloadData(svg, "image/svg+xml;utf8", file_name);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * "data:image/png;base64,[...]"\r\n\t * @param {IRenderer} renderer\r\n\t * @param {string} filename\r\n\t * @returns {string}\r\n\t */\r\n\t_save_as_png(renderer, filename) {\r\n\t\tlet bound = this._calcBoundBox();\r\n\t\tlet size = bound.size;\r\n\t\tlet [x, y] = [-bound.left, bound.height];\r\n\t\tlet angle = 0;\r\n\t\tlet front = false;\r\n\r\n\t\t// use Canvas2, must not fail\r\n\t\ttry {\r\n\t\t\trenderer.$swapCanvas();\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//save Canvas2 size, current ctx is _ctx2\r\n\t\tconst c2w = renderer._ctx2.canvas.width;\r\n\t\tconst c2h = renderer._ctx2.canvas.height;\r\n\t\t//\r\n\t\trenderer.ctx.canvas.width = size.x;\r\n\t\trenderer.ctx.canvas.height = size.y;\r\n\r\n\t\ttry {\r\n\t\t\tthis._draw(renderer, x, y, angle, front);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\t// nothing\r\n\t\t}\r\n\r\n\t\tlet base64 = renderer.ctx.canvas.toDataURL("image/png");\r\n\t\t{\r\n\t\t\tlet elem = document.createElement("a");\r\n\r\n\t\t\tlet name = `${filename ? (filename+"."):""}${this.action}[${this.action_frame}].${this.emotion}[${this.emotion_frame}].png`;\r\n\r\n\t\t\telem.id = name;\r\n\t\t\telem.download = name;\r\n\t\t\telem.href = base64;\r\n\r\n\t\t\tdocument.body.appendChild(elem);\r\n\t\t\telem.click();\r\n\t\t\tdocument.body.removeChild(elem);\r\n\t\t}\r\n\r\n\t\t//restore Canvas2 size, current ctx is _ctx2\r\n\t\trenderer.ctx.canvas.width = c2w;\r\n\t\trenderer.ctx.canvas.height = c2h;\r\n\r\n\t\t// restore Canvas, must not fail\r\n\t\ttry {\r\n\t\t\trenderer.$swapCanvas();\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\t// nothing\r\n\t\t}\r\n\r\n\t\treturn base64;\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {Promise<FragmentTexture[]>}\r\n\t */\r\n\tasync __texture_to_base64() {\r\n\t\tlet frag_list = this.__frag_list;\r\n\t\tlet tasks = [];\r\n\r\n\t\tfrag_list.forEach(function (ft) {\r\n\t\t\tif (!ft) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!ft._url.startsWith("data:")) {\r\n\t\t\t\ttasks.push((async function () {\r\n\t\t\t\t\t//ft.texture.$src = ft._url;\r\n\t\t\t\t\tft._url = await toDataURL(ft.texture.src);\r\n\t\t\t\t\treturn ft;\r\n\t\t\t\t})());\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttasks.push(ft);\r\n\t\t\t}\r\n\t\t\tif (ft.graph2) {\r\n\t\t\t\tlet src = ft.graph2.texture.src;\r\n\t\t\t\tif (!src.startsWith("data:")) {\r\n\t\t\t\t\ttasks.push((async function () {\r\n\t\t\t\t\t\t//ft.texture.$src = ft._url;\r\n\t\t\t\t\t\tft.graph2._url = await toDataURL(src);\r\n\t\t\t\t\t\treturn ft.graph2;\r\n\t\t\t\t\t})());\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttasks.push(ft.graph2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (ft.graph3) {\r\n\t\t\t\tlet src = ft.graph3.texture.src;\r\n\t\t\t\tif (!src.startsWith("data:")) {\r\n\t\t\t\t\ttasks.push((async function () {\r\n\t\t\t\t\t\t//ft.texture.$src = ft._url;\r\n\t\t\t\t\t\tft.graph3._url = await toDataURL(src);\r\n\t\t\t\t\t\treturn ft.graph3;\r\n\t\t\t\t\t})());\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttasks.push(ft.graph3);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn Promise.all(tasks);\r\n\t}\r\n}\r\nObject(_init_js__WEBPACK_IMPORTED_MODULE_2__[/* AddInitTask */ "a"])(CharacterRenderer.Init);\r\n\r\nfunction* circularSequence(length, start=0) {\r\n\tlet i = start;\r\n\tfor (; i < length; ++i) {//a: 0, 1, 2, 3, ...b\r\n\t\tyield i;\r\n\t}\r\n\tfor (i -= 2; i > 0; --i) {//b: 2, 1, ...a\r\n\t\tyield i;\r\n\t}\r\n}\r\n\r\nfunction* linearSequence(length, start=0) {\r\n\tfor (let i = start; i < length; ++i) {\r\n\t\tyield i;\r\n\t}\r\n}\r\n\r\nfunction extract_number(input) {\r\n\treturn String(input).match(/(-?\\d+\\.?\\d*)|(\\.\\d*)/g);\r\n}\r\n\r\n/**\r\n * image href to data url\r\n */\r\nfunction toDataURL(url) {\r\n\treturn new Promise(function (resolve, reject) {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.onload = function () {\r\n\t\t\tlet reader = new FileReader();\r\n\t\t\treader.onloadend = function () {\r\n\t\t\t\tresolve(reader.result);\r\n\t\t\t}\r\n\t\t\treader.onerror = function (ev) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\treject(ev);\r\n\t\t\t}\r\n\t\t\treader.readAsDataURL(xhr.response);\r\n\t\t};\r\n\t\txhr.open(\'GET\', url);\r\n\t\txhr.responseType = \'blob\';\r\n\t\txhr.send();\r\n\t});\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvUmVuZGVyZXIvQ2hhcmFjdGVyUmVuZGVyZXIuanM/MjcyOSJdLCJzb3VyY2VzQ29udGVudCI6WyLvu79cclxuaW1wb3J0IHsgQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLCBSZXNvdXJjZU1hbmFnZXIgfSBmcm9tIFwiLi4vLi4vLi4vcHVibGljL2phdmFzY3JpcHRzL3Jlc291cmNlLmpzXCI7XHJcbmltcG9ydCB7IEl0ZW1DYXRlZ29yeUluZm8gfSBmcm9tIFwiLi4vLi4vQ29tbW9uL0l0ZW1DYXRlZ29yeUluZm8uanNcIjtcclxuaW1wb3J0IHsgQWRkSW5pdFRhc2sgfSBmcm9tIFwiLi4vLi4vaW5pdC5qc1wiO1xyXG5pbXBvcnQgeyBBbmltYXRpb24gfSBmcm9tIFwiLi4vQW5pbWF0aW9uXCI7XHJcbmltcG9ydCB7IGVuZ2luZSB9IGZyb20gXCIuLi9FbmdpbmUuanNcIjtcclxuaW1wb3J0IHsgSVJlbmRlcmVyLCBJbWFnZUZpbHRlciB9IGZyb20gXCIuLi9JUmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IHsgU3ByaXRlLCBTcHJpdGVCYXNlIH0gZnJvbSBcIi4uL1Nwcml0ZS5qc1wiO1xyXG5pbXBvcnQgeyBSZWN0YW5nbGUsIFZlYzIgfSBmcm9tIFwiLi4vbWF0aC5qc1wiO1xyXG5pbXBvcnQgeyBBY3Rpb25BbmltYXRpb24gfSBmcm9tIFwiLi9DaGFyYWN0ZXJBY3Rpb25BbmltYXRpb24uanNcIjtcclxuXHJcblxyXG5sZXQgek1hcCA9IHt9O1xyXG5sZXQgc01hcCA9IHt9O1xyXG5cclxuXHJcbi8qKlxyXG4gKiAwMDAyNjYyMy5ibGlua1sxXS5icm93IGhhcyBidWdcclxuICogJ1dlYXBvbi8wMTcwMjY5NCcgaXMgTG9uZ2NvYXQoaXNsb3QpXHJcbiAqIGhvdyB0byB1c2UgY2FzaC13ZWFwb24gKGV4OiAwMTcwMjUwNHwwMTUyKVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBtdWx0aS1pbWFnZS1zcHJpdGVcclxuICovXHJcbmNsYXNzIEZyYWdtZW50VGV4dHVyZSBleHRlbmRzIFNwcml0ZUJhc2Uge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7d3pwcm9wZXJ0eX0gcmF3XHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGZ1bGxfcGF0aFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgZnVsbF9wYXRoKSB7XHJcblx0XHRzdXBlcihyYXcsIGZ1bGxfcGF0aCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Jhdy5vcmlnaW4pIHtcclxuXHRcdFx0dGhpcy5fcmF3Lm9yaWdpbi5fX3Byb3RvX18gPSBWZWMyLnByb3RvdHlwZTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuX3Jhdy5tYXApIHtcclxuXHRcdFx0dGhpcy5fcmF3Lm1hcFtpXS5fX3Byb3RvX18gPSBWZWMyLnByb3RvdHlwZTtcclxuXHRcdH1cclxuXHJcblx0XHQvKipcclxuXHRcdCAqIGlmIHRoaXMucmVsYXRpdmUgPT0gbnVsbCB0aGVuIHJlbW92ZSB0aGlzXHJcblx0XHQgKiBAdHlwZSB7VmVjMn1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5yZWxhdGl2ZSA9IG5ldyBWZWMyKDAsIDApO1xyXG5cdFx0XHJcblx0XHR0aGlzLmNhbGNSZWxhdGl2ZSA9IHRoaXMuX2NhbGNSZWxhdGl2ZTsvL3RoaXMuX2dldFJlbGF0aXZlRnVuY3Rpb24oKTsvL3RoaXMuX19vbGRfY2FsY1JlbGF0aXZlOy8vXHJcblxyXG5cdFx0dGhpcy5maWx0ZXIgPSBuZXcgSW1hZ2VGaWx0ZXIoKTtcclxuXHRcdHRoaXMub3BhY2l0eSA9IDE7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xyXG5cdFx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcclxuXHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9IC0gZXh0cmEgcHJvcGVydHkuICovXHJcblx0XHR0aGlzLl9zbG90ID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gLSBleHRyYSBwcm9wZXJ0eS4g5Zyo5ZOq5YCL6YOo5L2NICovXHJcblx0XHR0aGlzLl9wbGFjZSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9IC0gZXh0cmEgcHJvcGVydHk6IF9zbG90IGl0ZW1JZCwgX3BsYWNlLCBfcmF3LnogeiAqL1xyXG5cdFx0dGhpcy5jbGFzc0xpc3QgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgeigpIHtcclxuXHRcdHJldHVybiB6TWFwW3RoaXMuX3Jhdy56XSB8fCAxO1xyXG5cdH1cclxuXHRzZXQgeihub3RfdmFsdWUpIHtcclxuXHRcdGNvbnNvbGUuZXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgb3JkZXIoKSB7XHJcblx0XHRkZWJ1Z2dlcjtcclxuXHRcdHJldHVybiB0aGlzLno7XHJcblx0fVxyXG5cdHNldCBvcmRlcihub3RfdmFsdWUpIHtcclxuXHRcdGRlYnVnZ2VyO1xyXG5cdFx0Y29uc29sZS5lcnJvcihuZXcgVHlwZUVycm9yKFwiTm90IGltcGxlbWVudFwiKSk7XHJcblx0fVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IG9yaWdpbigpIHsgcmV0dXJuIHRoaXMuX3Jhdy5vcmlnaW4gfHwgVmVjMi5lbXB0eTsgfVxyXG5cclxuXHRpc0hhc0FuY2hvcigpIHsgcmV0dXJuICEhdGhpcy5fcmF3Lm1hcDsgfVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IGJyb3coKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLmJyb3c7IH1cclxuXHRpc0FuY2hvckJyb3coKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAuYnJvdzsgfVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IG5lY2soKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLm5lY2s7IH1cclxuXHRpc0FuY2hvck5lY2soKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAubmVjazsgfVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IG5hdmVsKCkgeyByZXR1cm4gdGhpcy5fcmF3Lm1hcC5uYXZlbDsgfVxyXG5cdGlzQW5jaG9yTmF2ZWwoKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAubmF2ZWw7IH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtWZWMyfSAqL1xyXG5cdGdldCBoYW5kKCkgeyByZXR1cm4gdGhpcy5fcmF3Lm1hcC5oYW5kOyB9XHJcblx0aXNBbmNob3JIYW5kKCkgeyByZXR1cm4gISF0aGlzLl9yYXcubWFwLmhhbmQ7IH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtWZWMyfSAqL1xyXG5cdGdldCBoYW5kTW92ZSgpIHsgcmV0dXJuIHRoaXMuX3Jhdy5tYXAuaGFuZE1vdmU7IH1cclxuXHRpc0FuY2hvckhhbmRNb3ZlKCkgeyByZXR1cm4gISF0aGlzLl9yYXcubWFwLmhhbmRNb3ZlOyB9XHJcblxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IF9lYXJCZWxvd0hlYWQoKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLmVhckJlbG93SGVhZDsgfVxyXG5cdGlzQW5jaG9yX0VhckJlbG93SGVhZCgpIHsgcmV0dXJuICEhdGhpcy5fcmF3Lm1hcC5lYXJCZWxvd0hlYWQ7IH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtWZWMyfSAqL1xyXG5cdGdldCBfZWFyT3ZlckhlYWQoKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLmVhck92ZXJIZWFkOyB9XHJcblx0aXNBbmNob3JfRWFyT3ZlckhlYWQoKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAuZWFyT3ZlckhlYWQ7IH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IHRoYXQgLSB0aGlzXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJhc2UgLSBwYXJlbnRcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYW5jaG9yIC0gYW5jaG9yIG5hbWVcclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfYW5jaG9yKHRoYXQsIGJhc2UsIGFuY2hvcikge1xyXG5cdFx0cmV0dXJuIGJhc2VbYW5jaG9yXS5taW51cyh0aGF0W2FuY2hvcl0pLnBsdXMoYmFzZS5vcmlnaW4ubWludXModGhhdC5vcmlnaW4pKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlKGNoYXJhLCBib2R5LCBoZWFkKSB7XHJcblx0XHR0aGlzLmNhbGNSZWxhdGl2ZSA9IHRoaXMuX2dldFJlbGF0aXZlRnVuY3Rpb24oY2hhcmEpO1xyXG5cdFx0cmV0dXJuIHRoaXMuY2FsY1JlbGF0aXZlKGNoYXJhLCBib2R5LCBoZWFkKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtmdW5jdGlvbihDaGFyYWN0ZXJBbmltYXRpb25CYXNlLEZyYWdtZW50VGV4dHVyZSxGcmFnbWVudFRleHR1cmUpOlZlYzJ9XHJcblx0ICovXHJcblx0X2dldFJlbGF0aXZlRnVuY3Rpb24oY2hhcmEpIHtcclxuXHRcdGlmICghdGhpcy5pc0hhc0FuY2hvcigpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVFbXB0eTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmlzQW5jaG9yTmVjaygpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVfbmVjaztcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmlzQW5jaG9yQnJvdygpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVfYnJvdztcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmlzQW5jaG9yTmF2ZWwoKSkge1xyXG5cdFx0XHRpZiAodGhpcyA9PSBjaGFyYS5zbG90cy5ib2R5KSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2dldE9yaWdpbjtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdGhpcy5fY2FsY1JlbGF0aXZlX25hdmVsO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuaXNBbmNob3JIYW5kKCkpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2NhbGNSZWxhdGl2ZV9oYW5kO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuaXNBbmNob3JIYW5kTW92ZSgpKSB7XHJcblx0XHRcdGlmICh0aGlzLl91cmwubGFzdEluZGV4T2YoXCJsSGFuZFwiKSA+IDApIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY2FsY1JlbGF0aXZlX2hhbmRNb3ZlX2xIYW5kO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVfaGFuZE1vdmU7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlRW1wdHkoY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdHJldHVybiBWZWMyLmVtcHR5O1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJvZHlcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gW2hlYWRdXHJcblx0ICogQHJldHVybnMge1ZlYzJ9XHJcblx0ICovXHJcblx0X2dldE9yaWdpbihjaGFyYSwgYm9keSwgaGVhZCkge1xyXG5cdFx0cmV0dXJuIHRoaXMub3JpZ2luO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBuZWNrIG9uIHRoZSBuYXZlbFxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX25lY2soY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdHJldHVybiB0aGlzLl9hbmNob3IodGhpcywgYm9keSwgXCJuZWNrXCIpLm1pbnVzKGJvZHkub3JpZ2luKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogYnJvdyBvbiB0aGUgaGVhZCAmIGhlYWQgb24gdGhlIG5lY2sgJiBuZWNrIG9uIHRoZSBuYXZlbFxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX2Jyb3coY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdHJldHVybiB0aGlzLl9hbmNob3IodGhpcywgaGVhZCwgXCJicm93XCIpLnBsdXModGhpcy5fYW5jaG9yKGhlYWQsIGJvZHksIFwibmVja1wiKSkubWludXMoYm9keS5vcmlnaW4pOy8vYW5jaG9yX2Jyb3crKC03LC0zMylcclxuXHR9XHJcblx0LyoqXHJcblx0ICogdGhpcyBpcyBvcmlnaW4gcG9pbnQsIG5vIGFuY2hvclxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX25hdmVsKGNoYXJhLCBib2R5LCBoZWFkKSB7XHJcblx0XHRyZXR1cm4gYm9keS5uYXZlbC5taW51cyh0aGlzLm5hdmVsKS5taW51cyh0aGlzLm9yaWdpbik7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX2hhbmQoY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdGNvbnN0IGhhbmQgPSBjaGFyYS5zbG90cy5ib2R5LmZyYWdtZW50cy5hcm0uZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRpZiAoaGFuZCA9PSBudWxsKSB7XHJcblx0XHRcdHJldHVybiBWZWMyLmVtcHR5Lm1pbnVzKHRoaXMuaGFuZCkubWludXModGhpcy5vcmlnaW4pLm1pbnVzKGJvZHkub3JpZ2luKTtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5fYW5jaG9yKHRoaXMsIGhhbmQsIFwiaGFuZFwiKS5taW51cyh0aGlzLl9hbmNob3IoYm9keSwgaGFuZCwgXCJuYXZlbFwiKSkubWludXMoYm9keS5vcmlnaW4pO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJvZHlcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gW2hlYWRdXHJcblx0ICogQHJldHVybnMge1ZlYzJ9XHJcblx0ICovXHJcblx0X2NhbGNSZWxhdGl2ZV9oYW5kTW92ZShjaGFyYSwgYm9keSwgaGVhZCkge1xyXG5cdFx0cmV0dXJuIFZlYzIuZW1wdHkubWludXModGhpcy5vcmlnaW4pLm1pbnVzKHRoaXMuaGFuZE1vdmUpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJvZHlcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gW2hlYWRdXHJcblx0ICogQHJldHVybnMge1ZlYzJ9XHJcblx0ICovXHJcblx0X2NhbGNSZWxhdGl2ZV9oYW5kTW92ZV9sSGFuZChjaGFyYSwgYm9keSwgaGVhZCkge1xyXG5cdFx0cmV0dXJuIFZlYzIuZW1wdHkubWludXModGhpcy5vcmlnaW4pO1xyXG5cdH1cclxuXHRcclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqL1xyXG5cdHVwZGF0ZShjaGFyYSkge1xyXG5cdFx0aWYgKGNoYXJhLnNsb3RzLmJvZHkgJiYgY2hhcmEuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHRjb25zdCBib2R5ID0gY2hhcmEuc2xvdHMuYm9keS5mcmFnbWVudHMuYm9keS5nZXRUZXh0dXJlKGNoYXJhKTtcclxuXHRcdFx0Y29uc3QgaGVhZCA9IGNoYXJhLnNsb3RzLmhlYWQuZnJhZ21lbnRzLmhlYWQuZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRcdGlmIChib2R5ICYmIGhlYWQpIHtcclxuXHRcdFx0XHR0aGlzLnJlbGF0aXZlID0gdGhpcy5jYWxjUmVsYXRpdmUoY2hhcmEsIGJvZHksIGhlYWQpO1xyXG5cclxuXHRcdFx0XHRjb25zdCB0YW1pbmdNb2IgPSBjaGFyYS5zbG90cy50YW1pbmdNb2I7XHJcblx0XHRcdFx0aWYgKHRhbWluZ01vYikge1xyXG5cdFx0XHRcdFx0dGhpcy5yZWxhdGl2ZSA9IHRhbWluZ01vYi5hZGpfcG9zKHRoaXMucmVsYXRpdmUsIGJvZHksIGNoYXJhKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKi9cclxuXHRyZW5kZXIocmVuZGVyZXIsIGNoYXJhKSB7XHJcblx0XHRpZiAoISh0aGlzLnJlbGF0aXZlICYmIHRoaXMudmlzaWJsZSkpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0Y29uc3QgeCA9IHRoaXMucmVsYXRpdmUueDtcclxuXHRcdGNvbnN0IHkgPSB0aGlzLnJlbGF0aXZlLnk7XHJcblxyXG5cdFx0cmVuZGVyZXIuZ2xvYmFsQWxwaGEgPSB0aGlzLm9wYWNpdHk7XHJcblx0XHRpZiAodGhpcy5maWx0ZXIuaXNFbXB0eSkge1xyXG5cdFx0XHRyZW5kZXJlci5kcmF3R3JhcGgyKHRoaXMsIHgsIHkpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJlbmRlcmVyLmN0eC5maWx0ZXIgPSB0aGlzLmZpbHRlci50b1N0cmluZygpO1xyXG5cdFx0XHRyZW5kZXJlci5kcmF3R3JhcGgyKHRoaXMsIHgsIHkpO1xyXG5cdFx0XHRyZW5kZXJlci5jdHguZmlsdGVyID0gXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBCb2R5RnJhZ21lbnRUZXh0dXJlIGV4dGVuZHMgRnJhZ21lbnRUZXh0dXJlIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICovXHJcblx0dXBkYXRlKGNoYXJhKSB7XHJcblx0XHRzdXBlci51cGRhdGUoY2hhcmEpO1xyXG5cdFx0dGhpcy52aXNpYmxlID0gIWNoYXJhLmhpZGVCb2R5O1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgSGFpckZyYWdtZW50VGV4dHVyZSBleHRlbmRzIEZyYWdtZW50VGV4dHVyZSB7XHJcblx0Y29uc3RydWN0b3IoLi4uYXJncykge1xyXG5cdFx0c3VwZXIoLi4uYXJncyk7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtIYWlyRnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0dGhpcy5ncmFwaDIgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7SGFpckZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdHRoaXMuZ3JhcGgzID0gbnVsbDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKi9cclxuXHR1cGRhdGUoY2hhcmEpIHtcclxuXHRcdGlmIChjaGFyYS5zbG90cy5ib2R5ICYmIGNoYXJhLnNsb3RzLmhlYWQpIHtcclxuXHRcdFx0Y29uc3QgYm9keSA9IGNoYXJhLnNsb3RzLmJvZHkuZnJhZ21lbnRzLmJvZHkuZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRcdGNvbnN0IGhlYWQgPSBjaGFyYS5zbG90cy5oZWFkLmZyYWdtZW50cy5oZWFkLmdldFRleHR1cmUoY2hhcmEpO1xyXG5cdFx0XHRpZiAoYm9keSAmJiBoZWFkKSB7XHJcblx0XHRcdFx0dGhpcy5yZWxhdGl2ZSA9IHRoaXMuY2FsY1JlbGF0aXZlKGNoYXJhLCBib2R5LCBoZWFkKTtcclxuXHJcblx0XHRcdFx0Y29uc3QgdGFtaW5nTW9iID0gY2hhcmEuc2xvdHMudGFtaW5nTW9iO1xyXG5cdFx0XHRcdGlmICh0YW1pbmdNb2IpIHtcclxuXHRcdFx0XHRcdHRoaXMucmVsYXRpdmUgPSB0YW1pbmdNb2IuYWRqX3Bvcyh0aGlzLnJlbGF0aXZlLCBib2R5LCBjaGFyYSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAodGhpcy5ncmFwaDIpIHtcclxuXHRcdFx0XHRcdHRoaXMuZ3JhcGgyLnJlbGF0aXZlID0gdGhpcy5yZWxhdGl2ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRoaXMuZ3JhcGgzKSB7XHJcblx0XHRcdFx0XHR0aGlzLmdyYXBoMy5yZWxhdGl2ZSA9IHRoaXMucmVsYXRpdmU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICovXHJcblx0cmVuZGVyKHJlbmRlcmVyLCBjaGFyYSkge1xyXG5cdFx0aWYgKCF0aGlzLnJlbGF0aXZlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRyZW5kZXJlci5nbG9iYWxBbHBoYSA9IHRoaXMub3BhY2l0eSB8fCAxO1xyXG5cdFx0aWYgKHRoaXMuZmlsdGVyLmlzRW1wdHkpIHtcclxuXHRcdFx0dGhpcy5fcmVuZGVyKHJlbmRlcmVyKTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZW5kZXJlci5jdHguZmlsdGVyID0gdGhpcy5maWx0ZXIudG9TdHJpbmcoKTtcclxuXHRcdFx0dGhpcy5fcmVuZGVyKHJlbmRlcmVyKTtcclxuXHRcdFx0cmVuZGVyZXIuY3R4LmZpbHRlciA9IFwibm9uZVwiO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRfcmVuZGVyKHJlbmRlcmVyKSB7XHJcblx0XHRjb25zdCB4ID0gdGhpcy5yZWxhdGl2ZS54O1xyXG5cdFx0Y29uc3QgeSA9IHRoaXMucmVsYXRpdmUueTtcclxuXHJcblx0XHRyZW5kZXJlci5kcmF3R3JhcGgyKHRoaXMsIHgsIHkpO1xyXG5cclxuXHRcdGlmICh0aGlzLmdyYXBoMiAmJiB0aGlzLmdyYXBoMi5vcGFjaXR5KSB7Ly9jb2xvcjJcclxuXHRcdFx0cmVuZGVyZXIuZ2xvYmFsQWxwaGEgPSB0aGlzLmdyYXBoMi5vcGFjaXR5O1xyXG5cclxuXHRcdFx0cmVuZGVyZXIuZHJhd0dyYXBoMih0aGlzLmdyYXBoMiwgeCwgeSk7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5ncmFwaDMgJiYgdGhpcy5ncmFwaDMub3BhY2l0eSkgey8vY29sb3IzXHJcblx0XHRcdHJlbmRlcmVyLmdsb2JhbEFscGhhID0gdGhpcy5ncmFwaDMub3BhY2l0eTtcclxuXHJcblx0XHRcdHJlbmRlcmVyLmRyYXdHcmFwaDIodGhpcy5ncmFwaDMsIHgsIHkpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuXHJcbmNsYXNzIEl0ZW1FZmZlY3RBbmltYXRpb24gZXh0ZW5kcyBBbmltYXRpb24ge1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHRzdXBlcihyYXcsIHVybCk7XHJcblx0XHRcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9yYXdcIiwge1xyXG5cdFx0XHR2YWx1ZTogcmF3LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly90aGlzLl91cmwgPSB0aGlzLl91cmw7XHJcblxyXG5cdFx0dGhpcy5fX2dldEF0dHIoXCJ6XCIsIC0xKTtcclxuXHRcdHRoaXMuX19nZXRBdHRyKFwicG9zXCIsIDEpO1xyXG5cclxuXHRcdHN1cGVyLmxvYWQoKTtcclxuXHR9XHJcblx0X19nZXRBdHRyKGF0dHIsIGRlZlZhbCkge1xyXG5cdFx0aWYgKGF0dHIgaW4gdGhpcy5fcmF3KSB7XHJcblx0XHRcdHRoaXNbYXR0cl0gPSB0aGlzLl9yYXdbYXR0cl07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpc1thdHRyXSA9IGRlZlZhbDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbn0gYWN0aW9uRXhjZXB0Um90YXRpb25cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gYW5nbGVcclxuXHQgKiBAcGFyYW0ge2Jvb2xlYW59IGZsaXBcclxuXHQgKi9cclxuXHRyZW5kZXIocmVuZGVyZXIsIGFjdGlvbkV4Y2VwdFJvdGF0aW9uLCBhbmdsZSwgZmxpcCkge1xyXG5cdFx0aWYgKGFjdGlvbkV4Y2VwdFJvdGF0aW9uKSB7XHJcblx0XHRcdHRoaXMuZHJhdyhyZW5kZXJlciwgMCwgMCwgLWFuZ2xlLCBmbGlwKTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRjb25zdCBveSA9IC10aGlzLnRleHR1cmUuaGVpZ2h0ICogMC4yNTtcclxuXHRcdFx0dGhpcy5kcmF3KHJlbmRlcmVyLCAwLCBveSwgMCwgZmxpcCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vL1x0L2RhdGEvRWZmZWN0L0l0ZW1FZmYvMTEwMjkxOFxyXG5jbGFzcyBJdGVtRWZmZWN0IHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMuX3VybCA9IG51bGw7XHJcblx0XHR0aGlzLl9yYXcgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7e1thbmltYXRpb25OYW1lOnN0cmluZ106SXRlbUVmZmVjdEFuaW1hdGlvbn19ICovXHJcblx0XHR0aGlzLmFuaW1hdGlvbiA9IHt9O1xyXG5cclxuXHRcdHRoaXMuYWN0aW9uID0gbnVsbDtcclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblx0XHR0aGlzLmZyYW1lID0gMDtcclxuXHJcblx0XHR0aGlzLmZpeGVkID0gMDtcclxuXHRcdHRoaXMueiA9IC0yO1xyXG5cdFx0dGhpcy5hY3Rpb24gPSAxO1xyXG5cdFx0dGhpcy5hY3Rpb25FeGNlcHRSb3RhdGlvbiA9IDA7XHJcblx0XHRcclxuXHRcdHRoaXMuZW5hYmxlID0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBhc3luYyBJbml0KCkge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0LyoqIEB0eXBlIHtTZXQ8c3RyaW5nPn0gKi9cclxuXHRcdFx0bGV0IGl0ZW1FZmZlY3RMaXN0ID0gSXRlbUVmZmVjdC5fbGlzdDtcclxuXHJcblx0XHRcdC8qKiBAdHlwZSB7c3RyaW5nW119ICovXHJcblx0XHRcdGxldCByYXcgPSBhd2FpdCAkZ2V0Lmxpc3QoXCIvRWZmZWN0L0l0ZW1FZmZcIik7XHJcblxyXG5cdFx0XHRpdGVtRWZmZWN0TGlzdC5jbGVhcigpO1xyXG5cclxuXHRcdFx0cmF3LmZvckVhY2goaWQgPT4ge1xyXG5cdFx0XHRcdGl0ZW1FZmZlY3RMaXN0LmFkZChwYXJzZUludChpZCwgMTApKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogaWYgKCFleGlzdCkgcmV0dXJuIG51bGxcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZXF1aXBJRFxyXG5cdCAqIEByZXR1cm5zIHtQcm9taXNlPEl0ZW1FZmZlY3Q+fVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBhc3luYyBsb2FkKGVxdWlwSUQpIHtcclxuXHRcdGNvbnN0IGlkID0gTnVtYmVyKGVxdWlwSUQpO1xyXG5cclxuXHRcdGlmIChJdGVtRWZmZWN0Ll9saXN0LmhhcyhpZCkpIHtcclxuXHRcdFx0bGV0IGVmZiA9IG5ldyBJdGVtRWZmZWN0KCk7XHJcblx0XHRcdGF3YWl0IGVmZi5sb2FkKGVxdWlwSUQpO1xyXG5cdFx0XHRyZXR1cm4gZWZmO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogaWYgKCFleGlzdCkgcmV0dXJuIG51bGxcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZXF1aXBJRFxyXG5cdCAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxyXG5cdCAqL1xyXG5cdGFzeW5jIGxvYWQoZXF1aXBJRCkge1xyXG5cdFx0Y29uc3QgaWQgPSBOdW1iZXIoZXF1aXBJRCk7XHJcblx0XHRjb25zdCB1cmwgPSBgL0VmZmVjdC9JdGVtRWZmLyR7aWR9L2VmZmVjdGA7XHJcblx0XHRsZXQgcmF3O1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdHJhdyA9IGF3YWl0ICRnZXQuZGF0YSh1cmwpO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdHRocm93IGV4O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChyYXcpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2xvYWQoZXF1aXBJRCwgdXJsLCByYXcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YW1wXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFjdGlvblxyXG5cdCAqL1xyXG5cdHVwZGF0ZShzdGFtcCwgYWN0aW9uKSB7XHJcblx0XHRpZiAoYWN0aW9uIGluIHRoaXMuYW5pbWF0aW9uKSB7XHJcblx0XHRcdHRoaXMuYWN0aW9uID0gYWN0aW9uO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuYWN0aW9uID0gXCJkZWZhdWx0XCI7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuYW5pbWF0aW9uW3RoaXMuYWN0aW9uXSkge1xyXG5cdFx0XHR0aGlzLmFuaW1hdGlvblt0aGlzLmFjdGlvbl0udXBkYXRlKHN0YW1wKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyUmVuZGVyZXJ9IGNoYXJhXHJcblx0ICovXHJcblx0cmVuZGVyKHJlbmRlcmVyLCBjaGFyYSkge1xyXG5cdFx0aWYgKHRoaXMuYW5pbWF0aW9uICYmIHRoaXMuYW5pbWF0aW9uW3RoaXMuYWN0aW9uXSkge1xyXG5cdFx0XHR0aGlzLmFuaW1hdGlvblt0aGlzLmFjdGlvbl0ucmVuZGVyKHJlbmRlcmVyLCB0aGlzLmFjdGlvbkV4Y2VwdFJvdGF0aW9uLCBjaGFyYS5hbmdsZSwgY2hhcmEuZnJvbnQgPiAwKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcElEXHJcblx0ICogQHBhcmFtIHtvYmplY3R9IHJhd19kYXRhXHJcblx0ICovXHJcblx0X2xvYWQoZXF1aXBJRCwgdXJsLCByYXcpIHtcclxuXHRcdHRoaXMuaWQgPSBlcXVpcElEO1xyXG5cclxuXHRcdGlmICghcmF3KSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0fVxyXG5cdFx0Ly90aGlzLl91cmwgPSB1cmw7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfcmF3XCIsIHtcclxuXHRcdFx0dmFsdWU6IHJhdyxcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuX19jb25zdHJ1Y3QoKTtcclxuXHR9XHJcblx0X19jb25zdHJ1Y3QoKSB7XHJcblx0XHR0aGlzLl9fZ2V0QXR0cihcImZpeGVkXCIsIDApO1xyXG5cdFx0dGhpcy5fX2dldEF0dHIoXCJ6XCIsIC0xKTtcclxuXHRcdHRoaXMuX19nZXRBdHRyKFwiYWN0aW9uXCIsIDEpO1xyXG5cdFx0dGhpcy5fX2dldEF0dHIoXCJhY3Rpb25FeGNlcHRSb3RhdGlvblwiLCAwKTtcclxuXHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuX3Jhdykge1xyXG5cdFx0XHRpZiAodGhpcy5fcmF3W2ldICYmIHR5cGVvZiB0aGlzLl9yYXdbaV0gPT0gXCJvYmplY3RcIiAmJiAnMCcgaW4gdGhpcy5fcmF3W2ldKSB7Ly9hbmltYXRpb24gaGFzIGZyYW1lc1xyXG5cdFx0XHRcdHRoaXMuYW5pbWF0aW9uW2ldID0gbmV3IEl0ZW1FZmZlY3RBbmltYXRpb24odGhpcy5fcmF3W2ldLCBbdGhpcy5fdXJsLCBpXS5qb2luKFwiL1wiKSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0X19nZXRBdHRyKGF0dHIsIGRlZlZhbCkge1xyXG5cdFx0aWYgKGF0dHIgaW4gdGhpcy5fcmF3KSB7XHJcblx0XHRcdHRoaXNbYXR0cl0gPSB0aGlzLl9yYXdbYXR0cl07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpc1thdHRyXSA9IGRlZlZhbDtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuLyoqIEB0eXBlIHtTZXQ8c3RyaW5nPn0gKi9cclxuSXRlbUVmZmVjdC5fbGlzdCA9IG5ldyBTZXQoKTtcclxuXHJcbmNsYXNzIENoYXJhY3RlckZyYWdtZW50QmFzZSB7XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHt7W2FjdGlvbjpzdHJpbmddOiBGcmFnbWVudFRleHR1cmVbXX19IHRleHR1cmVzXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IodGV4dHVyZXMpIHtcclxuXHRcdC8qKiBAdHlwZSB7e1thY3Rpb246c3RyaW5nXTogRnJhZ21lbnRUZXh0dXJlW119fSAtIHRleHR1cmVzW2FjdGlvbjpzdHJpbmddW2ZyYW1lOm51bWJlcl0gKi9cclxuXHRcdHRoaXMudGV4dHVyZXMgPSB0ZXh0dXJlcztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0VGV4dHVyZShjaGFyYSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBmcmFtZVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBmcmFtZSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVDb3VudChjaGFyYSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAZmluYWwgXHJcbiAqL1xyXG5jbGFzcyBDaGFyYWN0ZXJCb2R5RnJhZ21lbnQgZXh0ZW5kcyBDaGFyYWN0ZXJGcmFnbWVudEJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKHRleHR1cmVzKSB7XHJcblx0XHRzdXBlcih0ZXh0dXJlcyk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge0ZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXRUZXh0dXJlKGNoYXJhKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRGcmFtZVRleHR1cmUoY2hhcmEsIGNoYXJhLmFjdGlvbl9mcmFtZSk7XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gZnJhbWVcclxuXHQgKiBAcmV0dXJucyB7RnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lVGV4dHVyZShjaGFyYSwgZnJhbWUpIHtcclxuXHRcdGlmICghKGNoYXJhLmFjdGlvbiBpbiB0aGlzLnRleHR1cmVzKSkge1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHRcdGxldCBmdCA9IHRoaXMudGV4dHVyZXNbY2hhcmEuYWN0aW9uXVtmcmFtZV07Ly9pZiBmcmFtZSBub3QgZXhpc3QgdGhlbiByZXR1cm4gdW5kZWZpbmVkXHJcblx0XHRyZXR1cm4gZnQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXRGcmFtZUNvdW50KGNoYXJhKSB7XHJcblx0XHRpZiAodGhpcy50ZXh0dXJlc1tjaGFyYS5hY3Rpb25dKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnRleHR1cmVzW2NoYXJhLmFjdGlvbl0ubGVuZ3RoO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDA7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQGZpbmFsIFxyXG4gKi9cclxuY2xhc3MgQ2hhcmFjdGVyRmFjZUZyYWdtZW50IGV4dGVuZHMgQ2hhcmFjdGVyRnJhZ21lbnRCYXNlIHtcclxuXHRjb25zdHJ1Y3Rvcih0ZXh0dXJlcykge1xyXG5cdFx0c3VwZXIodGV4dHVyZXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0VGV4dHVyZShjaGFyYSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBjaGFyYS5lbW90aW9uX2ZyYW1lKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gZnJhbWVcclxuXHQgKiBAcmV0dXJucyB7RnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lVGV4dHVyZShjaGFyYSwgZnJhbWUpIHtcclxuXHRcdGlmICghKGNoYXJhLmVtb3Rpb24gaW4gdGhpcy50ZXh0dXJlcykpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRsZXQgZnQgPSB0aGlzLnRleHR1cmVzW2NoYXJhLmVtb3Rpb25dW2ZyYW1lXTtcclxuXHRcdHJldHVybiBmdDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lQ291bnQoY2hhcmEpIHtcclxuXHRcdGlmICh0aGlzLnRleHR1cmVzW2NoYXJhLmVtb3Rpb25dKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnRleHR1cmVzW2NoYXJhLmVtb3Rpb25dLmxlbmd0aDtcclxuXHRcdH1cclxuXHRcdHJldHVybiAwO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEBmaW5hbCBcclxuICovXHJcbmNsYXNzIENoYXJhY3RlclRhbWluZ01vYkZyYWdtZW50IGV4dGVuZHMgQ2hhcmFjdGVyRnJhZ21lbnRCYXNlIHtcclxuXHRjb25zdHJ1Y3Rvcih0ZXh0dXJlcykge1xyXG5cdFx0c3VwZXIodGV4dHVyZXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0VGV4dHVyZShjaGFyYSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBjaGFyYS5hY3RhbmkuYWN0aW9uRnJhbWUpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBmcmFtZSAtIG5vdCBzeW5jIGNoYXJhLl9mcmFtZVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBmcmFtZSkge1xyXG5cdFx0aWYgKCEoY2hhcmEuX3JpZGVfYWN0aW9uIGluIHRoaXMudGV4dHVyZXMpKSB7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdFx0bGV0IGZ0ID0gdGhpcy50ZXh0dXJlc1tjaGFyYS5fcmlkZV9hY3Rpb25dW2ZyYW1lXTsvL2lmIGZyYW1lIG5vdCBleGlzdCB0aGVuIHJldHVybiB1bmRlZmluZWRcclxuXHRcdHJldHVybiBmdDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lQ291bnQoY2hhcmEpIHtcclxuXHRcdGlmICh0aGlzLnRleHR1cmVzW2NoYXJhLl9yaWRlX2FjdGlvbl0pIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMudGV4dHVyZXNbY2hhcmEuX3JpZGVfYWN0aW9uXS5sZW5ndGg7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIEVxdWlwSW1hZ2VGaWx0ZXIge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9IGVxdWlwXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IoZXF1aXApIHtcclxuXHRcdHRoaXMuZXF1aXAgPSBlcXVpcDtcclxuXHR9XHJcblxyXG5cdGdldCBodWUoKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRpZiAoIWVxdWlwKSB7XHJcblx0XHRcdHJldHVybiAwO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZ0LmZpbHRlci5odWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcblx0c2V0IGh1ZSh2YWx1ZSkge1xyXG5cdFx0Y29uc3QgZXF1aXAgPSB0aGlzLmVxdWlwO1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0ZnQuZmlsdGVyLmh1ZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Z2V0IHNhdCgpIHtcclxuXHRcdGNvbnN0IGVxdWlwID0gdGhpcy5lcXVpcDtcclxuXHRcdGlmICghZXF1aXApIHtcclxuXHRcdFx0cmV0dXJuIDEwMDtcclxuXHRcdH1cclxuXHRcdGZvciAobGV0IGkgaW4gZXF1aXAuZnJhZ21lbnRzKSB7XHJcblx0XHRcdGZvciAobGV0IGogaW4gZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal0ubGVuZ3RoOyArK2spIHtcclxuXHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0bGV0IGZ0ID0gZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdW2tdO1xyXG5cdFx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmdC5maWx0ZXIuc2F0O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDEwMDtcclxuXHR9XHJcblx0c2V0IHNhdCh2YWx1ZSkge1xyXG5cdFx0Y29uc3QgZXF1aXAgPSB0aGlzLmVxdWlwO1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0ZnQuZmlsdGVyLnNhdCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRnZXQgYnJpKCkge1xyXG5cdFx0Y29uc3QgZXF1aXAgPSB0aGlzLmVxdWlwO1xyXG5cdFx0aWYgKCFlcXVpcCkge1xyXG5cdFx0XHRyZXR1cm4gMTAwO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZ0LmZpbHRlci5icmk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMTAwO1xyXG5cdH1cclxuXHRzZXQgYnJpKHZhbHVlKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRmb3IgKGxldCBpIGluIGVxdWlwLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuYnJpID0gdmFsdWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRnZXQgY29udHJhc3QoKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRpZiAoIWVxdWlwKSB7XHJcblx0XHRcdHJldHVybiAxMDA7XHJcblx0XHR9XHJcblx0XHRmb3IgKGxldCBpIGluIGVxdWlwLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZnQuZmlsdGVyLmNvbnRyYXN0O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDEwMDtcclxuXHR9XHJcblx0c2V0IGNvbnRyYXN0KHZhbHVlKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRmb3IgKGxldCBpIGluIGVxdWlwLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuY29udHJhc3QgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHRvSlNPTigpIHtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGh1ZTogdGhpcy5odWUsXHJcblx0XHRcdHNhdHVyYXRpb246IGZpeGVkTnVtKHRoaXMuc2F0KSxcclxuXHRcdFx0YnJpZ2h0bmVzczogZml4ZWROdW0odGhpcy5icmkpLFxyXG5cdFx0XHRjb250cmFzdDogZml4ZWROdW0odGhpcy5jb250cmFzdCksXHJcblx0XHR9O1xyXG5cdFx0ZnVuY3Rpb24gZml4ZWROdW0odmFsKSB7XHJcblx0XHRcdHJldHVybiBOdW1iZXIoKHZhbCAvIDEwMCkudG9GaXhlZCgxKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3todWU6IG51bWJlciwgc2F0dXJhdGlvbjogbnVtYmVyLCBicmlnaHRuZXNzOiBudW1iZXIsIGNvbnRyYXN0OiBudW1iZXJ9fSBkYXRhXHJcblx0ICovXHJcblx0cGFyc2UoZGF0YSkge1xyXG5cdFx0bGV0IHsgaHVlID0gMCwgc2F0dXJhdGlvbiA9IDEsIGJyaWdodG5lc3MgPSAxLCBjb250cmFzdCA9IDEgfSA9IGRhdGE7XHJcblx0XHR0aGlzLmh1ZSA9IE51bWJlcihodWUpO1xyXG5cdFx0dGhpcy5zYXQgPSBOdW1iZXIoc2F0dXJhdGlvbikgKiAxMDA7XHJcblx0XHR0aGlzLmJyaSA9IE51bWJlcihicmlnaHRuZXNzKSAqIDEwMDtcclxuXHRcdHRoaXMuY29udHJhc3QgPSBOdW1iZXIoY29udHJhc3QpICogMTAwO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEBpbnRlcmZhY2VcclxuICovXHJcbmNsYXNzIElDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdmlydHVhbFxyXG5cdCAqL1xyXG5cdGlzTG9hZGVkKCkge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKi9cclxuXHRfdW5sb2FkKCkge1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXRGcmFtZUNvdW50KGNoYXJhKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXREZWxheShjaGFyYSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICovXHJcblx0dG9KU09OKCkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGlkOiAtMSwvL2ludmFsaWQgSURcclxuXHRcdH07XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogPz9cclxuICovXHJcbmNsYXNzIF9DaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZVNsb3RMaW5rIGV4dGVuZHMgSUNoYXJhY3RlckFwcGVhcmFuY2VCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcihzbG90X2xpbmspIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0XHR0aGlzLnNsb3RfbGluayA9IHNsb3RfbGluazsvLz8/XHJcblx0fVxyXG5cclxuXHR0b0pTT04oKSB7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRpZDogc2xvdF9saW5rLC8vPz9cclxuXHRcdH07XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogY2hhcmFjdGVyIGxvYWRlclxyXG4gKi9cclxuY2xhc3MgQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2UgZXh0ZW5kcyBJQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHRcdFx0XHJcblx0XHR0aGlzLl9yYXcgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0Ly90aGlzLl91cmwgPSBudWxsO1xyXG5cdFx0XHRcclxuXHRcdC8qKiBAdHlwZSB7SXRlbUVmZmVjdH0gKi9cclxuXHRcdHRoaXMuZWZmZWN0ID0gbnVsbDtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEB0eXBlIHt7W3BsYWNlOnN0cmluZ106Q2hhcmFjdGVyRnJhZ21lbnRCYXNlfX1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5mcmFnbWVudHMgPSBudWxsO1xyXG5cclxuXHRcdHRoaXMuX29ubG9hZCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmlkID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0l0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0XHR0aGlzLmNhdGVnb3J5SW5mbyA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLnNsb3Rfb3JkZXIgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7b2JqZWN0PHN0cmluZywgbnVtYmVyPn0gKi9cclxuXHRcdHRoaXMuaXNsb3QgPSB7fTtcclxuXHJcblx0XHQvKiogQHR5cGUge29iamVjdDxzdHJpbmcsIG51bWJlcj59ICovXHJcblx0XHR0aGlzLnZzbG90ID0ge307XHJcblxyXG5cdFx0dGhpcy5maWx0ZXIgPSBuZXcgRXF1aXBJbWFnZUZpbHRlcih0aGlzKTtcclxuXHR9XHJcblxyXG5cdGlzTG9hZGVkKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZnJhZ21lbnRzICE9IG51bGw7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge2Z1bmN0aW9uKENoYXJhY3RlckFwcGVhcmFuY2VCYXNlKTp2b2lkfSAqL1xyXG5cdGdldCBfb25sb2FkKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX19vbmxvYWQ7XHJcblx0fVxyXG5cdHNldCBfb25sb2FkKGZ1bmMpIHtcclxuXHRcdHRoaXMuX19vbmxvYWQgPSBmdW5jO1xyXG5cdFx0aWYgKHRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHR0aGlzLl9fb25sb2FkLmNhbGwodGhpcywgdGhpcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHBhcmFtIHtJdGVtQ2F0ZWdvcnlJbmZvfSBjYXRlSW5mb1xyXG5cdCAqIEBwYXJhbSB7dm9pZH0gdXNlX2NhdGVnb3J5IC0gbm8gdXNlXHJcblx0ICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gdHJ1ZSBpZiBpdGVtIGV4aXN0XHJcblx0ICovXHJcblx0YXN5bmMgbG9hZCh1cmwsIGlkLCBjYXRlSW5mbywgdXNlX2NhdGVnb3J5KSB7XHJcblx0XHRsZXQgcmF3O1xyXG5cclxuXHRcdHRoaXMuaWQgPSBpZDtcclxuXHRcdHRoaXMuY2F0ZWdvcnlJbmZvID0gY2F0ZUluZm87XHJcblx0XHRcclxuXHRcdHRyeSB7XHJcblx0XHRcdGlmIChSZXNvdXJjZU1hbmFnZXIuaXNFcXVpcEV4aXN0KGlkLCBjYXRlSW5mbykpIHtcclxuXHRcdFx0XHRyYXcgPSBhd2FpdCBSZXNvdXJjZU1hbmFnZXIuZ2V0SXRlbShpZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHR0aHJvdyBleDtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aWYgKCFyYXcgJiYgbG9hZF9leHRlcm5faXRlbV9kYXRhKSB7XHJcblx0XHRcdFx0cmF3ID0gYXdhaXQgbG9hZF9leHRlcm5faXRlbV9kYXRhKGlkKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdHRocm93IGV4O1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vdGhpcy5fdXJsID0gdXJsO1xyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX3Jhd1wiLCB7XHJcblx0XHRcdHZhbHVlOiByYXcsXHJcblx0XHR9KTtcclxuXHJcblx0XHR0aGlzLl9fbG9hZF9zbG90KCk7XHJcblxyXG5cdFx0dGhpcy5fX2xvYWRfZnJhZ21lbnRzKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX29ubG9hZCkge1xyXG5cdFx0XHR0aGlzLl9vbmxvYWQuY2FsbCh0aGlzLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHQvLy8vIGlmIG5vdCBib2R5LCBoZWFkLCBmYWNlLCBoYWlyIHRoZW4gdHJ5IGxvYWQgZWZmZWN0XHJcblx0XHQvL2lmIChpZCA+PSBcIjAwMDUwMDAwXCIpIHtcclxuXHRcdFx0Ly8gbG9hZCBpZiBleGlzdFxyXG5cdFx0XHRJdGVtRWZmZWN0LmxvYWQodGhpcy5pZCkudGhlbihhID0+IHRoaXMuZWZmZWN0ID0gYSk7Ly8wMTEwMjkxOFx0Ly8wMTEwMjkxNVxyXG5cdFx0Ly99XHJcblxyXG5cdFx0cmV0dXJuIHRydWU7XHJcblx0fVxyXG5cdF9fbG9hZF9mcmFnbWVudHMoKSB7XHJcblx0XHRjb25zdCBGcmFnbWVudENvbnN0cnVjdG9yID0gdGhpcy5GcmFnbWVudENvbnN0cnVjdG9yO1xyXG5cclxuXHRcdC8vT2JqZWN0LmtleXModGhpcy5fcmF3X3RleHR1cmVzKS5tYXAoayA9PiB7IHJldHVybiAnMCcgaW4gdGhpcy5fcmF3X3RleHR1cmVzW2tdOyB9KVxyXG5cclxuXHRcdGxldCBhY3Rpb25fbGlzdCA9IE9iamVjdC5rZXlzKHRoaXMuX3Jhd190ZXh0dXJlcyk7XHJcblxyXG5cdFx0bGV0IHRleHR1cmVzID0ge307XHJcblx0XHRmb3IgKGxldCBhY3Rpb24gb2YgYWN0aW9uX2xpc3QpIHtcclxuXHRcdFx0aWYgKHR5cGVvZiB0aGlzLl9yYXdfdGV4dHVyZXNbYWN0aW9uXSA9PSBcIm9iamVjdFwiICYmIFwiMFwiIGluIHRoaXMuX3Jhd190ZXh0dXJlc1thY3Rpb25dKSB7XHJcblx0XHRcdFx0bGV0IF91cmwgPSB0aGlzLl9iYXNlX3BhdGggKyBhY3Rpb247XHJcblxyXG5cdFx0XHRcdHRleHR1cmVzW2FjdGlvbl0gPSB0aGlzLl9fbG9hZF9mcmFtZV90ZXh0dXJlcyh0aGlzLl9yYXdfdGV4dHVyZXNbYWN0aW9uXSwgX3VybCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRsZXQgZnJhZ21lbnRfdGV4dHVyZXMgPSB7fTtcclxuXHRcdGZvciAobGV0IGFjdGlvbiBpbiB0ZXh0dXJlcykge1xyXG5cdFx0XHRmb3IgKGxldCBmcmFtZSBpbiB0ZXh0dXJlc1thY3Rpb25dKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgcGxhY2UgaW4gdGV4dHVyZXNbYWN0aW9uXVtmcmFtZV0pIHtcclxuXHRcdFx0XHRcdGlmICghKHBsYWNlIGluIGZyYWdtZW50X3RleHR1cmVzKSkge1xyXG5cdFx0XHRcdFx0XHRmcmFnbWVudF90ZXh0dXJlc1twbGFjZV0gPSB7fTtcclxuXHRcdFx0XHRcdFx0Ly9mcmFnbWVudF90ZXh0dXJlc1twbGFjZV0udmlzaWJsZSA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRpZiAoIShhY3Rpb24gaW4gZnJhZ21lbnRfdGV4dHVyZXNbcGxhY2VdKSkge1xyXG5cdFx0XHRcdFx0XHRmcmFnbWVudF90ZXh0dXJlc1twbGFjZV1bYWN0aW9uXSA9IFtdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZnJhZ21lbnRfdGV4dHVyZXNbcGxhY2VdW2FjdGlvbl1bZnJhbWVdID0gdGV4dHVyZXNbYWN0aW9uXVtmcmFtZV1bcGxhY2VdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBmcmFnbWVudHMgPSB7fTtcclxuXHRcdGZvciAobGV0IGZyYWcgaW4gZnJhZ21lbnRfdGV4dHVyZXMpIHtcclxuXHRcdFx0ZnJhZ21lbnRzW2ZyYWddID0gbmV3IEZyYWdtZW50Q29uc3RydWN0b3IoZnJhZ21lbnRfdGV4dHVyZXNbZnJhZ10pO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy5mcmFnbWVudHMgPSBmcmFnbWVudHM7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBfdXJsXHJcblx0ICogQHJldHVybnMge3tbcGxhY2U6c3RyaW5nXTpGcmFnbWVudFRleHR1cmV9W119IC0gYXJyYXkgLSB0ZXh0dXJlc1tmcmFtZV1bcGxhY2VdXHJcblx0ICovXHJcblx0X19sb2FkX2ZyYW1lX3RleHR1cmVzKF9yYXcsIF91cmwpIHtcclxuXHRcdGxldCB0ZXh0dXJlcyA9IFtdO1xyXG5cdFx0Zm9yIChsZXQgZnJhbWUgPSAwOyBmcmFtZSBpbiBfcmF3OyArK2ZyYW1lKSB7XHJcblx0XHRcdGxldCB1cmwgPSBgJHtfdXJsfS8ke2ZyYW1lfWA7XHJcblx0XHRcdHRleHR1cmVzW2ZyYW1lXSA9IHRoaXMuX19sb2FkX3BsYWNlX3RleHR1cmVzKF9yYXdbZnJhbWVdLCB1cmwpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRleHR1cmVzO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gX3VybFxyXG5cdCAqIEByZXR1cm5zIHt7W3BsYWNlOnN0cmluZ106RnJhZ21lbnRUZXh0dXJlfX0gLSBvYmplY3QgLSB0ZXh0dXJlc1twbGFjZV1cclxuXHQgKi9cclxuXHRfX2xvYWRfcGxhY2VfdGV4dHVyZXMoX3JhdywgX3VybCkge1xyXG5cdFx0bGV0IHRleHR1cmVzID0ge307XHJcblx0XHRmb3IgKGxldCBwbGFjZSBpbiBfcmF3KSB7XHJcblx0XHRcdGxldCBwYXRoID0gYCR7X3VybH0vJHtwbGFjZX1gO1xyXG5cdFx0XHRsZXQgcmF3ID0gX3Jhd1twbGFjZV07XHJcblxyXG5cdFx0XHRpZiAocmF3KSB7XHJcblx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0Y29uc3QgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IgPSB0aGlzLkZyYWdtZW50VGV4dHVyZUNvbnN0cnVjdG9yO1xyXG5cdFx0XHRcdGxldCBmdDtcclxuXHRcdFx0XHRpZiAocmF3W1wiXCJdID09IFwiXCIpIHtcclxuXHRcdFx0XHRcdGZ0Ll91cmwgPSBwYXRoO1xyXG5cdFx0XHRcdFx0Ly9mdC5fdXJsID0gcGF0aDtcclxuXHRcdFx0XHRcdHRleHR1cmVzW3BsYWNlXSA9IGZ0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYgKHR5cGVvZiByYXdbXCJcIl0gPT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdGZ0ID0gbmV3IEZyYWdtZW50VGV4dHVyZUNvbnN0cnVjdG9yKHJhdyk7XHJcblx0XHRcdFx0XHQvL2Z0Ll91cmwgPSByYXdbXCJcIl07XHJcblx0XHRcdFx0XHR0ZXh0dXJlc1twbGFjZV0gPSBmdDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAocGxhY2UgPT0gXCJoYWlyU2hhZGVcIikge1xyXG5cdFx0XHRcdFx0ZnQgPSBuZXcgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IocmF3WzBdKTtcclxuXHRcdFx0XHRcdC8vZnQuX3VybCA9IHBhdGggKyBcIi8wXCI7XHJcblx0XHRcdFx0XHR0ZXh0dXJlc1twbGFjZV0gPSBmdDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRmdC5fc2xvdCA9IHRoaXMuY2F0ZWdvcnlJbmZvLnNsb3Q7XHJcblx0XHRcdFx0XHRmdC5fcGxhY2UgPSBwbGFjZTtcclxuXHJcblx0XHRcdFx0XHRmdC5jbGFzc0xpc3QgPSBbXHJcblx0XHRcdFx0XHRcdGZ0Ll9zbG90LFxyXG5cdFx0XHRcdFx0XHRcIml0ZW1cIiArIHRoaXMuaWQsXHJcblx0XHRcdFx0XHRcdGZ0Ll9wbGFjZSxcclxuXHRcdFx0XHRcdFx0ZnQuX3Jhdy56LFxyXG5cdFx0XHRcdFx0XHQneicgKyBmdC56XHJcblx0XHRcdFx0XHRdLmpvaW4oJyAnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiB0ZXh0dXJlcztcclxuXHR9XHJcblx0X19sb2FkX3Nsb3QoKSB7XHJcblx0XHRpZiAoIXRoaXMuX3Jhdy5pbmZvLmlzbG90KSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRsZXQgaXNsb3RzID0gdGhpcy5fcmF3LmluZm8uaXNsb3QubWF0Y2goLyhbQS1aXVthLXowLTldKS9nKTtcclxuXHRcdGZvciAobGV0IGkgaW4gaXNsb3RzKSB7XHJcblx0XHRcdGNvbnN0IHNsb3QgPSBpc2xvdHNbaV07XHJcblx0XHRcdGNvbnN0IHNsb3Rfb3JkZXIgPSB6TWFwW3Nsb3RdO1xyXG5cdFx0XHR0aGlzLmlzbG90W3Nsb3RdID0gc2xvdF9vcmRlcjtcclxuXHRcdFx0XHRcclxuXHRcdFx0aWYgKHNsb3Rfb3JkZXIgPiB0aGlzLnNsb3Rfb3JkZXIpIHsvL3RoaXMuc2xvdF9vcmRlciA9IE1hdGgubWF4KHRoaXMuc2xvdF9vcmRlciwgc2xvdF9vcmRlcik7XHJcblx0XHRcdFx0dGhpcy5zbG90X29yZGVyID0gc2xvdF9vcmRlcjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGxldCB2c2xvdHMgPSB0aGlzLl9yYXcuaW5mby52c2xvdC5tYXRjaCgvKFtBLVpdW2EtejAtOV0pL2cpO1xyXG5cdFx0Zm9yIChsZXQgaSBpbiB2c2xvdHMpIHtcclxuXHRcdFx0Y29uc3Qgc2xvdCA9IHZzbG90c1tpXTtcclxuXHRcdFx0dGhpcy52c2xvdFtzbG90XSA9IHNsb3Q7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRfdW5sb2FkKCkge1xyXG5cdFx0dGhpcy5mcmFnbWVudHMgPSBudWxsO1xyXG5cdFx0dGhpcy5lZmZlY3QgPT0gbnVsbDtcclxuXHR9XHJcblxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gW2FuaW1hdGlvbk5hbWVdIC0gYWN0aW9uIGFuaW1hdGlvblxyXG5cdCAqL1xyXG5cdHRvSlNPTihhbmltYXRpb25OYW1lID0gXCJzdGFuZDFcIikge1xyXG5cdFx0bGV0IHJlZ2lvbiwgdmVyc2lvbjtcclxuXHRcdGlmICh0aGlzLl9yYXcuaW5mby5fX3YpIHtcclxuXHRcdFx0Y29uc3QgbSA9IHRoaXMuX3Jhdy5pbmZvLl9fdi50b1VwcGVyQ2FzZSgpLm1hdGNoKC8oW0EtWl0qKShbMC05XSopLyk7XHJcblx0XHRcdHJlZ2lvbiA9IChmdW5jdGlvbiAocikge1xyXG5cdFx0XHRcdGNvbnN0IG1tID0ge1xyXG5cdFx0XHRcdFx0XCJHTVNcIjogXCJHTVNcIixcclxuXHRcdFx0XHRcdFwiQ01TXCI6IFwiQ01TXCIsXHJcblx0XHRcdFx0XHRcIktNU1wiOiBcIktNU1wiLFxyXG5cdFx0XHRcdFx0XCJKTVNcIjogXCJKTVNcIixcclxuXHRcdFx0XHRcdFwiU0VBXCI6IFwiU0VBXCIsXHJcblx0XHRcdFx0XHRcIlRNU1wiOiBcIlRNU1wiLFxyXG5cdFx0XHRcdFx0XCJUSE1TXCI6IFwiVEhNU1wiLFxyXG5cdFx0XHRcdFx0XCJUV01TXCI6IFwiVFdNU1wiLFxyXG5cdFx0XHRcdH07XHJcblx0XHRcdFx0bGV0IHJlc3VsdCA9IG1tW3JdO1xyXG5cdFx0XHRcdGlmICghcmVzdWx0KSB7XHJcblx0XHRcdFx0XHRyZXN1bHQgPSBSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0cmV0dXJuIHJlc3VsdDtcclxuXHRcdFx0fSkoW21bMV1dKTtcclxuXHRcdFx0dmVyc2lvbiA9IG1bMl0gfHwgUmVzb3VyY2VNYW5hZ2VyLmRhdGFWZXJzaW9uO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJlZ2lvbiA9IFJlc291cmNlTWFuYWdlci5kYXRhUmVnaW9uO1xyXG5cdFx0XHR2ZXJzaW9uID0gUmVzb3VyY2VNYW5hZ2VyLmRhdGFWZXJzaW9uO1xyXG5cdFx0fVxyXG5cdFx0Y29uc3QgZmlsdGVyID0gdGhpcy5maWx0ZXI7XHJcblxyXG5cdFx0bGV0IG9iaiA9IHtcclxuXHRcdFx0aXRlbUlkOiBOdW1iZXIodGhpcy5pZCksXHJcblx0XHRcdHJlZ2lvbjogcmVnaW9uLFxyXG5cdFx0XHR2ZXJzaW9uOiB2ZXJzaW9uLFxyXG5cdFx0XHRodWU6IGZpbHRlci5odWUsXHJcblx0XHRcdHNhdHVyYXRpb246IGZpeGVkTnVtKGZpbHRlci5zYXQpLFxyXG5cdFx0XHRicmlnaHRuZXNzOiBmaXhlZE51bShmaWx0ZXIuYnJpKSxcclxuXHRcdFx0Y29udHJhc3Q6IGZpeGVkTnVtKGZpbHRlci5jb250cmFzdCksXHJcblx0XHRcdGFscGhhOiBOdW1iZXIoKHRoaXMub3BhY2l0eSkudG9GaXhlZCgxKSksXHJcblx0XHR9O1xyXG5cdFx0aWYgKGFuaW1hdGlvbk5hbWUpIHtcclxuXHRcdFx0b2JqLmFuaW1hdGlvbk5hbWUgPSBhbmltYXRpb25OYW1lO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIG9iajtcclxuXHJcblx0XHRmdW5jdGlvbiBmaXhlZE51bSh2YWwpIHtcclxuXHRcdFx0cmV0dXJuIE51bWJlcigodmFsIC8gMTAwKS50b0ZpeGVkKDEpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGFub3RoZXIgZm9ybWF0XHJcblx0ICogQHBhcmFtIHt7YWxwaGE6IG51bWJlciwgaHVlOiBudW1iZXIsIHNhdHVyYXRpb246IG51bWJlciwgYnJpZ2h0bmVzczogbnVtYmVyLCBjb250cmFzdDogbnVtYmVyfX0gZGF0YVxyXG5cdCAqL1xyXG5cdHBhcnNlKGRhdGEpIHtcclxuXHRcdGxldCB7IGFscGhhID0gMSB9ID0gZGF0YTtcclxuXHRcdHRoaXMuZmlsdGVyLnBhcnNlKGRhdGEpO1xyXG5cdFx0dGhpcy5vcGFjaXR5ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oYWxwaGEsIDEpKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7UGFydGlhbDx7b3BhY2l0eTpudW1iZXIsaHVlOm51bWJlcixzYXQ6bnVtYmVyLGJyaTpudW1iZXIsY29udHJhc3Q6bnVtYmVyfT59IG9wdGlvblxyXG5cdCAqL1xyXG5cdHNldChvcHRpb24pIHtcclxuXHRcdGNvbnN0IHsgb3BhY2l0eSA9IDEsIGh1ZSA9IDAsIHNhdCA9IDEwMCwgYnJpID0gMTAwLCBjb250cmFzdCA9IDEwMCB9ID0gb3B0aW9uO1xyXG5cdFx0dGhpcy5vcGFjaXR5ID0gb3BhY2l0eTtcclxuXHRcdHRoaXMuZmlsdGVyLmh1ZSA9IGh1ZTtcclxuXHRcdHRoaXMuZmlsdGVyLnNhdCA9IHNhdDtcclxuXHRcdHRoaXMuZmlsdGVyLmJyaSA9IGJyaTtcclxuXHRcdHRoaXMuZmlsdGVyLmNvbnRyYXN0ID0gY29udHJhc3Q7XHJcblx0fVxyXG5cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldCBvcGFjaXR5KCkge1xyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZnQub3BhY2l0eTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiAxO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gb3BhY2l0eVxyXG5cdCAqL1xyXG5cdHNldCBvcGFjaXR5KG9wYWNpdHkpIHtcclxuXHRcdGZvciAobGV0IGkgaW4gdGhpcy5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgdGhpcy5mcmFnbWVudHNbaV0udGV4dHVyZXNbal0ubGVuZ3RoOyArK2spIHtcclxuXHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0bGV0IGZ0ID0gdGhpcy5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0ZnQub3BhY2l0eSA9IG9wYWNpdHk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaHVlIDAgfiAzNjBcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc2F0IDAgfiAxMDBcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gYnJpIDAgfiAxMDBcclxuXHQgKi9cclxuXHRzZXRGaWx0ZXIoaHVlLCBzYXQsIGJyaSkge1xyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuaHVlID0gaHVlO1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuc2F0ID0gc2F0O1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuYnJpID0gYnJpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogZ2V0IGljb24gdXJsXHJcblx0ICogQHNlZSB7QGxpbmsgSXRlbUNhdGVnb3J5SW5mby5nZXRJY29uVXJsfVxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9XHJcblx0ICovXHJcblx0Z2V0SWNvblVybCgpIHtcclxuXHRcdGNvbnN0IGljb24gPSB0aGlzLl9yYXcuaW5mby5pY29uO1xyXG5cdFx0aWYgKGljb24pIHtcclxuXHRcdFx0cmV0dXJuIGljb25bXCJcIl07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdHJldHVybiBJdGVtQ2F0ZWdvcnlJbmZvLmdldEljb25VcmwodGhpcy5pZCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBnZXQgaWNvblJhdyB1cmxcclxuXHQgKiBAc2VlIHtAbGluayBJdGVtQ2F0ZWdvcnlJbmZvLmdldEljb25SYXdVcmx9XHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRnZXRJY29uUmF3VXJsKCkge1xyXG5cdFx0Y29uc3QgaWNvblJhdyA9IHRoaXMuX3Jhdy5pbmZvLmljb25SYXc7XHJcblx0XHRpZiAoaWNvblJhdykge1xyXG5cdFx0XHRyZXR1cm4gaWNvblJhd1tcIlwiXTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0cmV0dXJuIEl0ZW1DYXRlZ29yeUluZm8uZ2V0SWNvblJhd1VybCh0aGlzLmlkKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHR5cGUge3N0cmluZ31cclxuXHQgKi9cclxuXHRnZXQgX2FuaW1hdGlvbl90eXBlKCkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IEltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJGcmFnbWVudEJhc2V9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIEZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IoKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHJldHVybnMge3tbYWN0aW9uczpzdHJpbmddOntbXCIwXCJdOlNwcml0ZSxbZnJhbWVzOnN0cmluZ106U3ByaXRlfX19IHJhd190ZXh0dXJlc1suLi5hY3Rpb25zXVsuLi5mcmFtZXNdWy4uLmZyYWdtZW50c11cclxuXHQgKi9cclxuXHRnZXQgX3Jhd190ZXh0dXJlcygpIHtcclxuXHRcdHJldHVybiB0aGlzLl9yYXc7XHJcblx0fVxyXG5cclxuXHRnZXQgX2Jhc2VfcGF0aCgpIHtcclxuXHRcdHJldHVybiB0aGlzLl91cmw7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQGFic3RyYWN0XHJcbiAqL1xyXG5jbGFzcyBDaGFyYWN0ZXJBcHBlYXJhbmNlIGV4dGVuZHMgQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblx0Ly9fX2lzX3RleHR1cmUoaykge1xyXG5cdC8vXHRyZXR1cm4gKCEoayA9PSBcImZhY2VcIiB8fCBrID09IFwiZGVsYXlcIiB8fCBrID09IFwiZGVmYXVsdFwiKSk7XHJcblx0Ly99XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lQ291bnQoY2hhcmEpIHtcclxuXHRcdHJldHVybiBjaGFyYS5zbG90cy5ib2R5LmZyYWdtZW50cy5ib2R5LnRleHR1cmVzW2NoYXJhLmFjdGlvbl0ubGVuZ3RoO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RGVsYXkoY2hhcmEpIHtcclxuXHRcdGNvbnN0IGQgPSB0aGlzLl9yYXdbY2hhcmEuYWN0aW9uXVtjaGFyYS5hY3Rpb25fZnJhbWVdLmRlbGF5O1xyXG5cdFx0aWYgKE51bWJlci5pc1NhZmVJbnRlZ2VyKGQpKSB7XHJcblx0XHRcdHJldHVybiBkO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDEyMDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENoYXJhY3RlckJvZHkgZXh0ZW5kcyBDaGFyYWN0ZXJBcHBlYXJhbmNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHRnZXQgX2FuaW1hdGlvbl90eXBlKCkge1xyXG5cdFx0cmV0dXJuIFwiYWN0aW9uXCI7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIENoYXJhY3RlckJvZHlGcmFnbWVudH1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIEJvZHlGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50VGV4dHVyZUNvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIEJvZHlGcmFnbWVudFRleHR1cmU7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBDaGFyYWN0ZXJFcXVpcCBleHRlbmRzIENoYXJhY3RlckFwcGVhcmFuY2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJhY3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyQm9keUZyYWdtZW50fVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudENvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlckJvZHlGcmFnbWVudDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQm9keUZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQm9keUZyYWdtZW50VGV4dHVyZTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENoYXJhY3RlckVxdWlwQ2FzaFdlYXBvbiBleHRlbmRzIENoYXJhY3RlckVxdWlwIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0XHR0aGlzLnVzZV9jYXRlZ29yeSA9IG51bGw7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHBhcmFtIHtJdGVtQ2F0ZWdvcnlJbmZvfSBjYXRlSW5mb1xyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB1c2VfY2F0ZWdvcnkgLSBjYXNoLXdlYXBvbiBhcyBbY2F0ZWdvcnldXHJcblx0ICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gdHJ1ZSBpZiBpdGVtIGV4aXN0XHJcblx0ICovXHJcblx0YXN5bmMgbG9hZCh1cmwsIGlkLCBjYXRlSW5mbywgdXNlX2NhdGVnb3J5KSB7XHJcblx0XHRpZiAoIXVzZV9jYXRlZ29yeSAmJiB1c2VfY2F0ZWdvcnkgIT0gXCJcIikge1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKFwidXNlX2NhdGVnb3J5XCIpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMudXNlX2NhdGVnb3J5ID0gdXNlX2NhdGVnb3J5LnNsaWNlKDIsIDQpO1xyXG5cclxuXHRcdHJldHVybiBzdXBlci5sb2FkKHVybCwgaWQsIGNhdGVJbmZvKTtcclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJhY3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyQm9keUZyYWdtZW50fVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudENvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlckJvZHlGcmFnbWVudDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEByZXR1cm5zIHtvYmplY3R9IHJhd190ZXh0dXJlc1suLi5hY3Rpb25zXVsuLi5mcmFtZXNdWy4uLmZyYWdtZW50c11cclxuXHQgKi9cclxuXHRnZXQgX3Jhd190ZXh0dXJlcygpIHtcclxuXHRcdHJldHVybiB0aGlzLl9yYXdbdGhpcy51c2VfY2F0ZWdvcnldO1xyXG5cdH1cclxuXHJcblx0Z2V0IF9iYXNlX3BhdGgoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fdXJsICsgdGhpcy51c2VfY2F0ZWdvcnk7XHJcblx0fVxyXG59XHJcblxyXG5cclxuY2xhc3MgQ2hhcmFjdGVySGVhZEJhc2UgZXh0ZW5kcyBDaGFyYWN0ZXJBcHBlYXJhbmNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHRnZXQgX2FuaW1hdGlvbl90eXBlKCkge1xyXG5cdFx0cmV0dXJuIFwiYWN0aW9uXCI7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIENoYXJhY3RlckJvZHlGcmFnbWVudH1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIEZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gRnJhZ21lbnRUZXh0dXJlO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgQ2hhcmFjdGVySGVhZCBleHRlbmRzIENoYXJhY3RlckhlYWRCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0XHR0aGlzLmVsZkVhckZyYWdtZW50ID0gbnVsbDtcclxuXHRcdHRoaXMubGVmRWFyRnJhZ21lbnQgPSBudWxsO1xyXG5cdFx0dGhpcy5oaWdobGVmRWFyRnJhZ21lbnQgPSBudWxsO1xyXG5cdH1cclxuXHRfX2xvYWRfZnJhZ21lbnRzKCkge1xyXG5cdFx0c3VwZXIuX19sb2FkX2ZyYWdtZW50cygpXHJcblx0XHRcclxuXHRcdGlmICh0aGlzLmZyYWdtZW50cykge1xyXG5cdFx0XHRpZiAodGhpcy5mcmFnbWVudHMuZWFyKSB7XHJcblx0XHRcdFx0dGhpcy5lbGZFYXJGcmFnbWVudCA9IHRoaXMuZnJhZ21lbnRzLmVhcjtcclxuXHRcdFx0XHRkZWxldGUgdGhpcy5mcmFnbWVudHMuZWFyO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0aGlzLmZyYWdtZW50cy5sZWZFYXIpIHtcclxuXHRcdFx0XHR0aGlzLmxlZkVhckZyYWdtZW50ID0gdGhpcy5mcmFnbWVudHMubGVmRWFyO1xyXG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmZyYWdtZW50cy5sZWZFYXI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRoaXMuZnJhZ21lbnRzLmhpZ2hsZWZFYXIpIHtcclxuXHRcdFx0XHR0aGlzLmhpZ2hsZWZFYXJGcmFnbWVudCA9IHRoaXMuZnJhZ21lbnRzLmhpZ2hsZWZFYXI7XHJcblx0XHRcdFx0ZGVsZXRlIHRoaXMuZnJhZ21lbnRzLmhpZ2hsZWZFYXI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0Z2V0IGVsZkVhcigpIHtcclxuXHRcdHJldHVybiB0aGlzLmZyYWdtZW50cy5lYXIgIT0gbnVsbDtcclxuXHR9XHJcblx0c2V0IGVsZkVhcih2YWx1ZSkge1xyXG5cdFx0aWYgKCF0aGlzLmVsZkVhckZyYWdtZW50KSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmICh2YWx1ZSkge1xyXG5cdFx0XHR0aGlzLmZyYWdtZW50cy5lYXIgPSB0aGlzLmVsZkVhckZyYWdtZW50O1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGRlbGV0ZSB0aGlzLmZyYWdtZW50cy5lYXI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRnZXQgbGVmRWFyKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZnJhZ21lbnRzLmxlZkVhciAhPSBudWxsO1xyXG5cdH1cclxuXHRzZXQgbGVmRWFyKHZhbHVlKSB7XHJcblx0XHRpZiAoIXRoaXMubGVmRWFyRnJhZ21lbnQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdHRoaXMuZnJhZ21lbnRzLmxlZkVhciA9IHRoaXMubGVmRWFyRnJhZ21lbnQ7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0ZGVsZXRlIHRoaXMuZnJhZ21lbnRzLmxlZkVhcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGdldCBoaWdobGVmRWFyKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZnJhZ21lbnRzLmhpZ2hsZWZFYXIgIT0gbnVsbDtcclxuXHR9XHJcblx0c2V0IGhpZ2hsZWZFYXIodmFsdWUpIHtcclxuXHRcdGlmICghdGhpcy5oaWdobGVmRWFyRnJhZ21lbnQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdHRoaXMuZnJhZ21lbnRzLmhpZ2hsZWZFYXIgPSB0aGlzLmhpZ2hsZWZFYXJGcmFnbWVudDtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWxldGUgdGhpcy5mcmFnbWVudHMuaGlnaGxlZkVhcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJhY3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyQm9keUZyYWdtZW50fVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudENvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlckJvZHlGcmFnbWVudDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENoYXJhY3RlckhhaXIgZXh0ZW5kcyBDaGFyYWN0ZXJIZWFkQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRzdXBlcigpO1xyXG5cdH1cclxuXHJcblx0Z2V0IF9hbmltYXRpb25fdHlwZSgpIHtcclxuXHRcdHJldHVybiBcImFjdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyQm9keUZyYWdtZW50O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogaGFpciBjb2xvciBtaXhcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIEhhaXJGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50VGV4dHVyZUNvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIEhhaXJGcmFnbWVudFRleHR1cmU7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBDaGFyYWN0ZXJGYWNlQmFzZSBleHRlbmRzIENoYXJhY3RlckhlYWRCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cdC8vX19pc190ZXh0dXJlKGspIHtcclxuXHQvL1x0cmV0dXJuICghKGsgPT0gXCJkZWxheVwiIHx8IGsgPT0gXCJkZWZhdWx0XCIpKTtcclxuXHQvL31cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVDb3VudChjaGFyYSkge1xyXG5cdFx0cmV0dXJuIGNoYXJhLnNsb3RzLmZhY2UuZnJhZ21lbnRzLmZhY2UudGV4dHVyZXNbY2hhcmEuZW1vdGlvbl0ubGVuZ3RoO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RGVsYXkoY2hhcmEpIHtcclxuXHRcdGNvbnN0IGQgPSB0aGlzLl9yYXdbY2hhcmEuZW1vdGlvbl1bY2hhcmEuZW1vdGlvbl9mcmFtZV0uZGVsYXk7XHJcblx0XHRpZiAoZCAhPSBudWxsKSB7Ly8haXNOYU4oZCkgJiYgaXNGaW5pdGUoZClcclxuXHRcdFx0cmV0dXJuIGQ7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gNjA7XHJcblx0fVxyXG59XHJcbmNsYXNzIENoYXJhY3RlckZhY2UgZXh0ZW5kcyBDaGFyYWN0ZXJGYWNlQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRzdXBlcigpO1xyXG5cdH1cclxuXHJcblx0Z2V0IF9hbmltYXRpb25fdHlwZSgpIHtcclxuXHRcdHJldHVybiBcImVtb3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyRmFjZUZyYWdtZW50fVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudENvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlckZhY2VGcmFnbWVudDtcclxuXHR9XHJcbn1cclxuY2xhc3MgQ2hhcmFjdGVyRmFjZUFjYyBleHRlbmRzIENoYXJhY3RlckZhY2VCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHRnZXQgX2FuaW1hdGlvbl90eXBlKCkge1xyXG5cdFx0cmV0dXJuIFwiZW1vdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJGYWNlRnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyRmFjZUZyYWdtZW50O1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgQ2hhcmFjdGVyVGFtaW5nTW9iIGV4dGVuZHMgQ2hhcmFjdGVyQXBwZWFyYW5jZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRzdXBlcigpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgdHlwZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9yYXcuaW5mby50YW1pbmdNb2I7XHJcblx0fVxyXG5cclxuXHRnZXQgYWN0aW9uTWFwKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3Jhdy5jaGFyYWN0ZXJBY3Rpb247XHJcblx0fVxyXG5cclxuXHRnZXQgZW1vdGlvbk1hcCgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9yYXcuY2hhcmFjdGVyRW1vdGlvbjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7VmVjMn0gcmVsYXRpdmVcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRhZGpfcG9zKHJlbGF0aXZlLCBib2R5LCBjaGFyYSkge1xyXG5cdFx0Y29uc3QgZnJhZyA9IHRoaXMuZnJhZ21lbnRzWzBdOy8vZGVmYXVsdFxyXG5cdFx0aWYgKGZyYWcpIHtcclxuXHRcdFx0Y29uc3QgdG0gPSBmcmFnLmdldFRleHR1cmUoY2hhcmEpO1xyXG5cdFx0XHRpZiAodG0pIHtcclxuXHRcdFx0XHRyZXR1cm4gcmVsYXRpdmUucGx1cyh0bS5uYXZlbC5taW51cyhib2R5Lm5hdmVsKSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiByZWxhdGl2ZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lQ291bnQoY2hhcmEpIHtcclxuXHRcdHJldHVybiBjaGFyYS5zbG90cy5ib2R5LmZyYWdtZW50cy5ib2R5LnRleHR1cmVzW2NoYXJhLl9yaWRlX2FjdGlvbl0ubGVuZ3RoO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RGVsYXkoY2hhcmEpIHtcclxuXHRcdGNvbnN0IGQgPSBNYXRoLnRydW5jKHRoaXMuX3Jhd1tjaGFyYS5fcmlkZV9hY3Rpb25dW2NoYXJhLmFjdGlvbl9mcmFtZV0uZGVsYXkpOy8vPz8gX3JpZGVfYWN0aW9uX2ZyYW1lID0+IGFjdGlvbl9mcmFtZVxyXG5cdFx0aWYgKE51bWJlci5pc1NhZmVJbnRlZ2VyKGQpKSB7XHJcblx0XHRcdHJldHVybiBkO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDEyMDtcclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJfcmlkZV9hY3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyVGFtaW5nTW9iRnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyVGFtaW5nTW9iRnJhZ21lbnQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIEZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gRnJhZ21lbnRUZXh0dXJlO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAwMDAnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJCb2R5O1x0XHQvL1x0Ym9keVx0XHRcdC0+IENoYXJhY3RlckJvZHlcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDAwMSddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckhlYWQ7XHRcdC8vXHRlbGZFYXJcdFx0XHQtPiBDaGFyYWN0ZXJIZWFkQmFzZSAtPiBDaGFyYWN0ZXJIZWFkXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAwMDInXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJGYWNlO1x0XHQvL1x0RmFjZVx0XHRcdC0+IENoYXJhY3RlckhlYWRCYXNlIC0+IENoYXJhY3RlckZhY2VCYXNlIC0+IENoYXJhY3RlckZhY2VcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDAwMyddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckhhaXI7XHRcdC8vXHRIYWlyXHRcdFx0LT4gQ2hhcmFjdGVySGVhZEJhc2UgLT4gQ2hhcmFjdGVySGFpclxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMDA0J10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVySGFpcjtcdFx0Ly9cdEhhaXJcdFx0XHQtPiBDaGFyYWN0ZXJIZWFkQmFzZSAtPiBDaGFyYWN0ZXJIYWlyXHJcblxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTAwJ10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRXF1aXA7XHRcdC8vXHRDYXBcdFx0XHRcdC0+IENoYXJhY3RlckJvZHlcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwMSddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckZhY2VBY2M7XHRcdC8vXHRhY2Nlc3NvcnlGYWNlXHQtPiBDaGFyYWN0ZXJIZWFkQmFzZSAtPiBDaGFyYWN0ZXJGYWNlQmFzZSAtPiBDaGFyYWN0ZXJGYWNlQWNjXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDInXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdGFjY2Vzc29yeUV5ZXNcdC0+IENoYXJhY3RlckVxdWlwXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDMnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdGFjY2Vzc29yeUVhcnNcdC0+IENoYXJhY3RlckVxdWlwXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDQnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdENvYXRcdFx0XHQtPiBDaGFyYWN0ZXJCb2R5XHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDUnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdExvbmdjb2F0XHRcdC0+IENoYXJhY3RlckJvZHlcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwNiddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0UGFudHNcdFx0XHQtPiBDaGFyYWN0ZXJCb2R5XHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDcnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdFNob2VzXHRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTA4J10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRXF1aXA7XHRcdC8vXHRHbG92ZVx0XHRcdC0+IENoYXJhY3RlckJvZHlcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwOSddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0U2hpZWxkXHRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTEwJ10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRXF1aXA7XHRcdC8vXHRDYXBlXHRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5cclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDE3MCddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwQ2FzaFdlYXBvbjtcdC8vXHRjYXNoLXdlYXBvblx0LT4gQ2hhcmFjdGVyRXF1aXBcclxuXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxOSddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlclRhbWluZ01vYjtcdC8vXHRUYW1pbmdNb2JcdFx0LT4gQ2hhcmFjdGVyVGFtaW5nTW9iXHJcblxyXG5cclxuY2xhc3MgQ2hhcmFjdGVyU2xvdHMge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0XHRcclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2VbXX0gKi9cclxuXHRcdHRoaXMuX29yZGVyZWRfc2xvdCA9IFtdO1xyXG5cclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckJvZHl9ICovXHJcblx0XHR0aGlzLmJvZHkgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVySGVhZH0gKi9cclxuXHRcdHRoaXMuaGVhZCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJGYWNlfSAqL1xyXG5cdFx0dGhpcy5mYWNlID0gbnVsbDtcclxuXHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJIYWlyfSAqL1xyXG5cdFx0dGhpcy5oYWlyID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJIYWlyfSAqL1xyXG5cdFx0dGhpcy5faGFpcjIgPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IDB+MS4wICovXHJcblx0XHR0aGlzLl9oYWlyTWl4MiA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckhhaXJ9ICovXHJcblx0XHR0aGlzLl9oYWlyMyA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gMH4xLjAgKi9cclxuXHRcdHRoaXMuX2hhaXJNaXgzID0gbnVsbDtcclxuXHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSAxICovXHJcblx0XHR0aGlzLmNhcCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJGYWNlQWNjfSAtIDIgKi9cclxuXHRcdHRoaXMuYWNjZXNzb3J5RmFjZSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSAzKi9cclxuXHRcdHRoaXMuYWNjZXNzb3J5RXllcyA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSA0ICovXHJcblx0XHR0aGlzLmFjY2Vzc29yeUVhcnMgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyRXF1aXB9IC0gNSAqL1xyXG5cdFx0dGhpcy5jb2F0ID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDUgKi9cclxuXHRcdHRoaXMubG9uZ2NvYXQgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyRXF1aXB9IC0gNiAqL1xyXG5cdFx0dGhpcy5wYW50cyA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSA3ICovXHJcblx0XHR0aGlzLnNob2VzID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDggKi9cclxuXHRcdHRoaXMuZ2xvdmUgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyRXF1aXB9IC0gOSAqL1xyXG5cdFx0dGhpcy5jYXBlID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDEwICovXHJcblx0XHR0aGlzLnNoaWVsZCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSAxMSAqL1xyXG5cdFx0dGhpcy53ZWFwb24gPSBudWxsO1xyXG5cdFx0XHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlclRhbWluZ01vYn0gKi9cclxuXHRcdHRoaXMudGFtaW5nTW9iID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0e1xyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfb3JkZXJlZF9zbG90XCIsIHtcclxuXHRcdFx0XHRjb25maWd1cmFibGU6IHRydWUsXHJcblx0XHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXHJcblx0XHRcdFx0dmFsdWU6IFtdXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2hhaXJcIiwge1xyXG5cdFx0XHRcdHdyaXRhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdHZhbHVlOiBudWxsLFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGFpclwiLCB7XHJcblx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcclxuXHRcdFx0XHRnZXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdHJldHVybiB0aGlzLl9oYWlyO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0c2V0OiBmdW5jdGlvbiAodmFsdWUpIHtcclxuXHRcdFx0XHRcdHRoaXMuX2hhaXIgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdGlmICh2YWx1ZSkge1xyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5faGFpcjIgJiYgdGhpcy5faGFpck1peDIpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmhhaXJDb2xvcjIgPSB0aGlzLmhhaXJDb2xvcjI7Ly9mb3JjZSByZWxvYWRcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmhhaXJNaXgyID0gdGhpcy5oYWlyTWl4MjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZiAodGhpcy5faGFpcjMgJiYgdGhpcy5faGFpck1peDMpIHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmhhaXJDb2xvcjMgPSB0aGlzLmhhaXJDb2xvcjM7Ly9mb3JjZSByZWxvYWRcclxuXHRcdFx0XHRcdFx0XHR0aGlzLmhhaXJNaXgzID0gdGhpcy5oYWlyTWl4MztcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2hhaXJcIiwge1xyXG5cdFx0XHRcdHdyaXRhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdHZhbHVlOiBudWxsLFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2hhaXIyXCIsIHtcclxuXHRcdFx0XHR3cml0YWJsZTogdHJ1ZSxcclxuXHRcdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcclxuXHRcdFx0XHR2YWx1ZTogbnVsbCxcclxuXHRcdFx0fSk7XHJcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9oYWlyTWl4MlwiLCB7XHQvLyAwfjEuMFxyXG5cdFx0XHRcdHdyaXRhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdHZhbHVlOiBudWxsLFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2hhaXIzXCIsIHtcclxuXHRcdFx0XHR3cml0YWJsZTogdHJ1ZSxcclxuXHRcdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcclxuXHRcdFx0XHR2YWx1ZTogbnVsbCxcclxuXHRcdFx0fSk7XHJcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9oYWlyTWl4M1wiLCB7XHQvLyAwfjEuMFxyXG5cdFx0XHRcdHdyaXRhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdHZhbHVlOiBudWxsLFxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIF9fbG9hZENvbG9yZWRIYWlyKGNvbG9yKSB7XHJcblx0XHRjb25zdCBpZCA9IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckhhaXJJRCh0aGlzLmhhaXIuaWQsIGNvbG9yKTtcclxuXHRcdGNvbnN0IGNhdGVJbmZvID0gSXRlbUNhdGVnb3J5SW5mby5nZXQoaWQpO1xyXG5cclxuXHRcdGlmIChjYXRlSW5mbykge1xyXG5cdFx0XHRjb25zdCB1cmwgPSBgL0NoYXJhY3Rlci8ke2NhdGVJbmZvLnBhdGggKyAoY2F0ZUluZm8ucGF0aCA/IFwiL1wiIDogXCJcIikgKyBpZH1gO1xyXG5cdFx0XHRjb25zdCB1c2VfY2F0ZWdvcnkgPSB1bmRlZmluZWQ7XHJcblxyXG5cdFx0XHRsZXQgaGFpciA9IG5ldyBDaGFyYWN0ZXJIYWlyKCk7XHJcblxyXG5cdFx0XHRhd2FpdCBoYWlyLmxvYWQodXJsLCBpZCwgY2F0ZUluZm8sIHVzZV9jYXRlZ29yeSk7XHJcblxyXG5cdFx0XHRyZXR1cm4gaGFpcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKiBAcmV0dXJucyB7bnVtYmVyfSAqL1xyXG5cdGdldCBoYWlyQ29sb3IyKCkge1xyXG5cdFx0aWYgKHRoaXMuX2hhaXIyKSB7XHJcblx0XHRcdHJldHVybiBOdW1iZXIoQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldEhhaXJDb2xvcih0aGlzLl9oYWlyMi5pZCkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRzZXQgaGFpckNvbG9yMihjb2xvcikge1xyXG5cdFx0aWYgKCFjb2xvcikge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKG5ldyBUeXBlRXJyb3IoKSk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBoYzJJZCA9IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckhhaXJJRCh0aGlzLmhhaXIuaWQsIGNvbG9yKTtcclxuXHJcblx0XHRpZiAoIXRoaXMuX2hhaXIyIHx8IGhjMklkICE9IHRoaXMuX2hhaXIyLmlkKSB7XHJcblx0XHRcdGlmIChoYzJJZCA9PSB0aGlzLl9oYWlyLmlkKSB7XHJcblx0XHRcdFx0dGhpcy5faGFpcjIgPSBudWxsO1xyXG5cdFx0XHRcdHRoaXMuaGFpck1peDIgPSAwO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuaGFpci4kcHJvbWlzZV9oYWlyMiA9IHRoaXMuX19sb2FkQ29sb3JlZEhhaXIoY29sb3IpO1xyXG5cclxuXHRcdFx0XHR0aGlzLmhhaXIuJHByb21pc2VfaGFpcjIudGhlbihoYWlyMiA9PiB7XHJcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5oYWlyLiRwcm9taXNlX2hhaXIyO1xyXG5cclxuXHRcdFx0XHRcdHRoaXMuX2hhaXIyID0gaGFpcjI7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5faGFpcjIgJiYgdGhpcy5oYWlyTWl4MiAhPSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuaGFpck1peDIgPSB0aGlzLmhhaXJNaXgyOy8vZm9yY2UgdXBkYXRlXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvL2Vsc2Uge1xyXG5cdFx0XHRcdFx0Ly9cdHRoaXMuaGFpck1peDIgPSAwOy8vZGlzYWJsZVxyXG5cdFx0XHRcdFx0Ly99XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0LyoqIEByZXR1cm5zIHtudW1iZXJ9IDB+MS4wICovXHJcblx0Z2V0IGhhaXJNaXgyKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2hhaXJNaXgyO1xyXG5cdH1cclxuXHRzZXQgaGFpck1peDIodmFsdWUpIHtcclxuXHRcdHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcclxuXHJcblx0XHRQcm9taXNlLnJlc29sdmUodGhpcy5oYWlyLiRwcm9taXNlX2hhaXIyKS50aGVuKCgpID0+IHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGl0ZW0gPSB0aGlzLl9oYWlyMjtcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGJhc2UgPSB0aGlzLmhhaXI7XHJcblxyXG5cdFx0XHRpZiAoIWl0ZW0gfHwgIWJhc2UpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGZvciAobGV0IGogaW4gaXRlbS5mcmFnbWVudHMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrIGluIGl0ZW0uZnJhZ21lbnRzW2pdLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW0uZnJhZ21lbnRzW2pdLnRleHR1cmVzW2tdLmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0XHRsZXQgZnQgPSBpdGVtLmZyYWdtZW50c1tqXS50ZXh0dXJlc1trXVtpXTtcclxuXHRcdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRcdGxldCBvcmkgPSBiYXNlLmZyYWdtZW50c1tqXS50ZXh0dXJlc1trXVtpXTtcclxuXHRcdFx0XHRcdFx0aWYgKG9yaSkge1xyXG5cdFx0XHRcdFx0XHRcdG9yaS5ncmFwaDIgPSBmdDtcclxuXHRcdFx0XHRcdFx0XHRvcmkuZ3JhcGgyLm9wYWNpdHkgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLl9oYWlyTWl4MiA9IHZhbHVlO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKiogQHJldHVybnMge251bWJlcn0gMH4xLjAgKi9cclxuXHRnZXQgaGFpckNvbG9yMygpIHtcclxuXHRcdGlmICh0aGlzLl9oYWlyMykge1xyXG5cdFx0XHRyZXR1cm4gTnVtYmVyKENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRIYWlyQ29sb3IodGhpcy5faGFpcjMuaWQpKTtcclxuXHRcdH1cclxuXHR9XHJcblx0c2V0IGhhaXJDb2xvcjMoY29sb3IpIHtcclxuXHRcdGlmICghY29sb3IpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihuZXcgVHlwZUVycm9yKCkpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRsZXQgaGMzSWQgPSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0Q29sb3JIYWlySUQodGhpcy5oYWlyLmlkLCBjb2xvcik7XHJcblxyXG5cdFx0aWYgKCF0aGlzLl9oYWlyMyB8fCB0aGlzLl9oYWlyMy5pZCAhPSBoYzNJZCkge1xyXG5cdFx0XHRpZiAodGhpcy5faGFpci5pZCA9PSBoYzNJZCB8fCB0aGlzLl9oYWlyMi5pZCA9PSBoYzNJZCkge1xyXG5cdFx0XHRcdHRoaXMuX2hhaXIzID0gbnVsbDtcclxuXHRcdFx0XHR0aGlzLmhhaXJNaXgzID0gMDtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0aGlzLmhhaXIuJHByb21pc2VfaGFpcjMgPSB0aGlzLl9fbG9hZENvbG9yZWRIYWlyKGNvbG9yKTtcclxuXHJcblx0XHRcdFx0dGhpcy5oYWlyLiRwcm9taXNlX2hhaXIzLnRoZW4oaGFpcjMgPT4ge1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuaGFpci4kcHJvbWlzZV9oYWlyMztcclxuXHJcblx0XHRcdFx0XHR0aGlzLl9oYWlyMyA9IGhhaXIzO1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMuX2hhaXIzICYmIHRoaXMuaGFpck1peDMgIT0gbnVsbCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmhhaXJNaXgzID0gdGhpcy5oYWlyTWl4MzsvL2ZvcmNlIHVwZGF0ZVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly9lbHNlIHtcclxuXHRcdFx0XHRcdC8vXHR0aGlzLmhhaXJNaXgzID0gMDsvL2Rpc2FibGVcclxuXHRcdFx0XHRcdC8vfVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKiBAcmV0dXJucyB7bnVtYmVyfSAqL1xyXG5cdGdldCBoYWlyTWl4MygpIHtcclxuXHRcdHJldHVybiB0aGlzLl9oYWlyTWl4MztcclxuXHR9XHJcblx0c2V0IGhhaXJNaXgzKHZhbHVlKSB7XHJcblx0XHR2YWx1ZSA9IE51bWJlcih2YWx1ZSk7XHJcblxyXG5cdFx0UHJvbWlzZS5yZXNvbHZlKHRoaXMuaGFpci4kcHJvbWlzZV9oYWlyMykudGhlbigoKSA9PiB7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9ICovXHJcblx0XHRcdGxldCBpdGVtID0gdGhpcy5faGFpcjM7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9ICovXHJcblx0XHRcdGxldCBiYXNlID0gdGhpcy5oYWlyO1xyXG5cclxuXHRcdFx0aWYgKCFpdGVtIHx8ICFiYXNlKSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRmb3IgKGxldCBqIGluIGl0ZW0uZnJhZ21lbnRzKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgayBpbiBpdGVtLmZyYWdtZW50c1tqXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtLmZyYWdtZW50c1tqXS50ZXh0dXJlc1trXS5sZW5ndGg7ICsraSkge1xyXG5cdFx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdFx0bGV0IGZ0ID0gaXRlbS5mcmFnbWVudHNbal0udGV4dHVyZXNba11baV07XHJcblx0XHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0XHRsZXQgb3JpID0gYmFzZS5mcmFnbWVudHNbal0udGV4dHVyZXNba11baV07XHJcblx0XHRcdFx0XHRcdGlmIChvcmkpIHtcclxuXHRcdFx0XHRcdFx0XHRvcmkuZ3JhcGgzID0gZnQ7XHJcblx0XHRcdFx0XHRcdFx0b3JpLmdyYXBoMy5vcGFjaXR5ID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0dGhpcy5faGFpck1peDMgPSB2YWx1ZTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0Ly9fX29yZGVyX3Nsb3QoKSB7XHJcblx0Ly9cdGxldCBzbG90X21hcCA9IG5ldyBNYXAoKTtcclxuXHQvL1xyXG5cdC8vXHRmb3IgKGxldCBpIGluIHRoaXMpIHtcclxuXHQvL1x0XHRsZXQgZXF1aXAgPSB0aGlzW2ldO1xyXG5cdC8vXHJcblx0Ly9cdFx0ZXF1aXAuY3NcclxuXHQvL1x0fVxyXG5cdC8vfVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWRcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFwcGVhcmFuY2VCYXNlfSBsb2FkZWRFcXVpcFxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB1c2VfY2F0ZWdvcnkgLSBjYXRlZ29yeSB3aGljaCB1c2VkIG9mIGNhc2gtd2VhcG9uXHJcblx0ICovXHJcblx0YXN5bmMgX3VzZShpZCwgbG9hZGVkRXF1aXAsIHVzZV9jYXRlZ29yeSkge1xyXG5cdFx0aWYgKCFpZCkge1xyXG5cdFx0XHRkZWJ1Z2dlclxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRjb25zdCBjYXRlSW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KGlkKTtcclxuXHJcblx0XHRpZiAoY2F0ZUluZm8pIHtcclxuXHRcdFx0bGV0IHVybCA9IGAvQ2hhcmFjdGVyLyR7Y2F0ZUluZm8ucGF0aCArIChjYXRlSW5mby5wYXRoID8gXCIvXCI6XCJcIikgKyBpZH1gO1xyXG5cdFx0XHQvKiogQHR5cGUge0NoYXJhY3RlckFwcGVhcmFuY2VCYXNlfSAqL1xyXG5cdFx0XHRsZXQgaXRlbTtcclxuXHJcblx0XHRcdGlmIChsb2FkZWRFcXVpcCBpbnN0YW5jZW9mIENoYXJhY3RlckFwcGVhcmFuY2VCYXNlKSB7XHJcblx0XHRcdFx0YWxlcnQoXCJDaGFyYWN0ZXJTbG90cyAjIF91c2U6IHBhcmFtIGxvYWRlZEVxdWlwID8/XCIpO1xyXG5cdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdGl0ZW0gPSBsb2FkZWRFcXVpcDtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRpZiAobG9hZGVkRXF1aXApIHtcclxuXHRcdFx0XHRcdGFsZXJ0KFwiQ2hhcmFjdGVyU2xvdHMgIyBfdXNlOiBwYXJhbSBsb2FkZWRFcXVpcCA/P1wiKTtcclxuXHRcdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjb25zdCBmcmFnbWVudFR5cGUgPSBjYXRlSW5mby5GcmFnbWVudFR5cGUgfHwgQ2hhcmFjdGVyRXF1aXA7XHJcblxyXG5cdFx0XHRcdGl0ZW0gPSBuZXcgZnJhZ21lbnRUeXBlKCk7XHJcblx0XHRcdH1cclxuXHRcdFx0LyoqIF91c2VfbG9hZGVkX2VxdWlwICovXHJcblx0XHRcdGlmICgwKSB7XHJcblx0XHRcdFx0aWYgKHRoaXNbY2F0ZUluZm8uc2xvdF0pIHtcclxuXHRcdFx0XHRcdHRoaXNbY2F0ZUluZm8uc2xvdF0uX3VubG9hZCgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzW2NhdGVJbmZvLnNsb3RdID0gaXRlbTtcclxuXHJcblx0XHRcdFx0dGhpcy5fb3JkZXJlZF9zbG90W2l0ZW0uc2xvdF9vcmRlcl0gPSBpdGVtO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgaXNfZXhpc3QgPSBsb2FkZWRFcXVpcCB8fCBhd2FpdCBpdGVtLmxvYWQodXJsLCBpZCwgY2F0ZUluZm8sIHVzZV9jYXRlZ29yeSk7XHJcblx0XHRcdGlmIChpc19leGlzdCkge1xyXG5cdFx0XHRcdC8qKiBfdXNlX2xvYWRlZF9lcXVpcCAqL1xyXG5cdFx0XHRcdGlmICgxKSB7XHJcblx0XHRcdFx0XHRpZiAodGhpc1tjYXRlSW5mby5zbG90XSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzW2NhdGVJbmZvLnNsb3RdLl91bmxvYWQoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXNbY2F0ZUluZm8uc2xvdF0gPSBpdGVtO1xyXG5cclxuXHRcdFx0XHRcdHRoaXMuX29yZGVyZWRfc2xvdFtpdGVtLnNsb3Rfb3JkZXJdID0gaXRlbTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKFwiaXRlbShcIiArIGlkICsgXCIpIGlzIG5vdCBleGlzdFwiKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0cmV0dXJuIGl0ZW07XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdF91bnVzZShpZCkge1xyXG5cdFx0aWYgKCFpZCkge1xyXG5cdFx0XHRkZWJ1Z2dlclxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRsZXQgY2F0ZUluZm8sIGVxdWlwO1xyXG5cclxuXHRcdGlmIChpZCBpbnN0YW5jZW9mIENoYXJhY3RlckFwcGVhcmFuY2VCYXNlKSB7XHJcblx0XHRcdGVxdWlwID0gaWQ7XHJcblx0XHRcdGlkID0gZXF1aXAuaWQ7XHJcblx0XHRcdGNhdGVJbmZvID0gZXF1aXAuY2F0ZWdvcnlJbmZvO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGNhdGVJbmZvID0gSXRlbUNhdGVnb3J5SW5mby5nZXQoaWQpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRjb25zdCBzbG90TmFtZSA9IGNhdGVJbmZvLnNsb3Q7XHJcblxyXG5cdFx0aWYgKHNsb3ROYW1lICE9IFwiaGVhZFwiICYmIHNsb3ROYW1lICE9IFwiYm9keVwiKSB7XHJcblx0XHRcdGlmICh0aGlzW3Nsb3ROYW1lXSAmJiB0aGlzW3Nsb3ROYW1lXS5pZCA9PSBpZCkge1xyXG5cdFx0XHRcdGVxdWlwID0gdGhpc1tzbG90TmFtZV07XHJcblx0XHRcdFx0Zm9yIChsZXQgc2xvdCBpbiBlcXVpcC5pc2xvdCkge1xyXG5cdFx0XHRcdFx0bGV0IG9yZGVyID0gZXF1aXAuaXNsb3Rbc2xvdF07XHJcblx0XHRcdFx0XHRpZiAodGhpcy5fb3JkZXJlZF9zbG90W29yZGVyXSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLl9vcmRlcmVkX3Nsb3Rbb3JkZXJdLl91bmxvYWQoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLl9vcmRlcmVkX3Nsb3Rbb3JkZXJdO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzW3Nsb3ROYW1lXSA9IG51bGw7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxzZTtcclxuXHR9XHJcblx0X2NsZWFyKCkge1xyXG5cdFx0Ly90aGlzLmJvZHkgPSBudWxsO1xyXG5cdFx0Ly90aGlzLmhlYWQgPSBudWxsO1xyXG5cdFx0dGhpcy5mYWNlID0gbnVsbDtcclxuXHRcdHRoaXMuaGFpciA9IG51bGw7XHJcblx0XHR0aGlzLmNhcCA9IG51bGw7XHJcblx0XHR0aGlzLmFjY2Vzc29yeUZhY2UgPSBudWxsO1xyXG5cdFx0dGhpcy5hY2Nlc3NvcnlFeWVzID0gbnVsbDtcclxuXHRcdHRoaXMuYWNjZXNzb3J5RWFycyA9IG51bGw7XHJcblx0XHR0aGlzLmNvYXQgPSBudWxsO1xyXG5cdFx0dGhpcy5sb25nY29hdCA9IG51bGw7XHJcblx0XHR0aGlzLnBhbnRzID0gbnVsbDtcclxuXHRcdHRoaXMuc2hvZXMgPSBudWxsO1xyXG5cdFx0dGhpcy5nbG92ZSA9IG51bGw7XHJcblx0XHR0aGlzLmNhcGUgPSBudWxsO1xyXG5cdFx0dGhpcy5zaGllbGQgPSBudWxsO1xyXG5cclxuXHRcdC8vdGVtcFxyXG5cdFx0bGV0IGhlYWQgPSB0aGlzLmhlYWQ7XHJcblx0XHRsZXQgYm9keSA9IHRoaXMuYm9keTtcclxuXHJcblx0XHQvL2NsZWFyXHJcblx0XHR0aGlzLl9vcmRlcmVkX3Nsb3QgPSBbXTtcclxuXHJcblx0XHQvL3Jlc3RvcmVcclxuXHRcdGlmIChoZWFkKSB7XHJcblx0XHRcdHRoaXMuX29yZGVyZWRfc2xvdFtoZWFkLnNsb3Rfb3JkZXJdID0gaGVhZDtcclxuXHRcdH1cclxuXHRcdGlmIChib2R5KSB7XHJcblx0XHRcdHRoaXMuX29yZGVyZWRfc2xvdFtib2R5LnNsb3Rfb3JkZXJdID0gYm9keTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdF9zdHJpbmdpZnkoKSB7XHJcblx0XHRsZXQgc2xvdHMgPSBbXCJjXCJdO1xyXG5cdFx0XHRcclxuXHRcdGlmICh0aGlzLmJvZHkpIHNsb3RzLnB1c2godGhpcy5ib2R5LmlkKTtcclxuXHRcdGlmICh0aGlzLmhlYWQpIHNsb3RzLnB1c2godGhpcy5oZWFkLmlkKTtcclxuXHRcdGlmICh0aGlzLmZhY2UpIHNsb3RzLnB1c2godGhpcy5mYWNlLmlkICsgXCJ8XCIgKyB0aGlzLmZhY2UuaWQpO1xyXG5cdFx0aWYgKHRoaXMuaGFpcikge1xyXG5cdFx0XHRsZXQgaGEgPSBbXTtcclxuXHRcdFx0aGEucHVzaCh0aGlzLmhhaXIuaWQpO1xyXG5cdFx0XHRpZiAodGhpcy5oYWlyQ29sb3IyICYmIHRoaXMuaGFpck1peDIgPiAwKSBoYS5wdXNoKHRoaXMuaGFpckNvbG9yMiArIFwiJVwiICsgTWF0aC50cnVuYyh0aGlzLmhhaXJNaXgyICogMTAwKSk7XHJcblx0XHRcdGlmICh0aGlzLmhhaXJDb2xvcjMgJiYgdGhpcy5oYWlyTWl4MyA+IDApIGhhLnB1c2godGhpcy5oYWlyQ29sb3IzICsgXCIlXCIgKyBNYXRoLnRydW5jKHRoaXMuaGFpck1peDMgKiAxMDApKTtcclxuXHRcdFx0c2xvdHMucHVzaChoYS5qb2luKFwifFwiKSk7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5jYXApIHNsb3RzLnB1c2godGhpcy5jYXAuaWQpO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RmFjZSkgc2xvdHMucHVzaCh0aGlzLmFjY2Vzc29yeUZhY2UuaWQpO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RXllcykgc2xvdHMucHVzaCh0aGlzLmFjY2Vzc29yeUV5ZXMuaWQpO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RWFycykgc2xvdHMucHVzaCh0aGlzLmFjY2Vzc29yeUVhcnMuaWQpO1xyXG5cdFx0aWYgKHRoaXMuY29hdCkgc2xvdHMucHVzaCh0aGlzLmNvYXQuaWQpO1xyXG5cdFx0aWYgKHRoaXMubG9uZ2NvYXQpIHNsb3RzLnB1c2godGhpcy5sb25nY29hdC5pZCk7XHJcblx0XHRpZiAodGhpcy5wYW50cykgc2xvdHMucHVzaCh0aGlzLnBhbnRzLmlkKTtcclxuXHRcdGlmICh0aGlzLnNob2VzKSBzbG90cy5wdXNoKHRoaXMuc2hvZXMuaWQpO1xyXG5cdFx0aWYgKHRoaXMuZ2xvdmUpIHNsb3RzLnB1c2godGhpcy5nbG92ZS5pZCk7XHJcblx0XHRpZiAodGhpcy5zaGllbGQpIHNsb3RzLnB1c2godGhpcy5zaGllbGQuaWQpO1xyXG5cdFx0aWYgKHRoaXMuY2FwZSkgc2xvdHMucHVzaCh0aGlzLmNhcGUuaWQpO1xyXG5cdFx0aWYgKHRoaXMud2VhcG9uKSBzbG90cy5wdXNoKHRoaXMud2VhcG9uLmlkKTtcclxuXHJcblx0XHRyZXR1cm4gc2xvdHMuam9pbihcIixcIik7XHJcblx0fVxyXG5cclxuXHR0b0pTT04oKSB7XHJcblx0XHRsZXQgc2xvdHMgPSBbXTtcclxuXHJcblx0XHRpZiAodGhpcy5ib2R5KSBzbG90cy5wdXNoKHRoaXMuYm9keSk7XHJcblx0XHRpZiAodGhpcy5oZWFkKSBzbG90cy5wdXNoKHRoaXMuaGVhZCk7XHJcblx0XHRpZiAodGhpcy5mYWNlKSBzbG90cy5wdXNoKHRoaXMuZmFjZSk7XHJcblx0XHRpZiAodGhpcy5oYWlyKSBzbG90cy5wdXNoKHRoaXMuaGFpcik7XHJcblx0XHQvL2lmICh0aGlzLl9oYWlyMikgc2xvdHMucHVzaCh0aGlzLl9oYWlyMik7XHJcblx0XHQvL2lmICh0aGlzLl9oYWlyMykgc2xvdHMucHVzaCh0aGlzLl9oYWlyMyk7XHJcblx0XHRpZiAodGhpcy5jYXApIHNsb3RzLnB1c2godGhpcy5jYXApO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RmFjZSkgc2xvdHMucHVzaCh0aGlzLmFjY2Vzc29yeUZhY2UpO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RXllcykgc2xvdHMucHVzaCh0aGlzLmFjY2Vzc29yeUV5ZXMpO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RWFycykgc2xvdHMucHVzaCh0aGlzLmFjY2Vzc29yeUVhcnMpO1xyXG5cdFx0aWYgKHRoaXMuY29hdCkgc2xvdHMucHVzaCh0aGlzLmNvYXQpO1xyXG5cdFx0aWYgKHRoaXMubG9uZ2NvYXQpIHNsb3RzLnB1c2godGhpcy5sb25nY29hdCk7XHJcblx0XHRpZiAodGhpcy5wYW50cykgc2xvdHMucHVzaCh0aGlzLnBhbnRzKTtcclxuXHRcdGlmICh0aGlzLnNob2VzKSBzbG90cy5wdXNoKHRoaXMuc2hvZXMpO1xyXG5cdFx0aWYgKHRoaXMuZ2xvdmUpIHNsb3RzLnB1c2godGhpcy5nbG92ZSk7XHJcblx0XHRpZiAodGhpcy5zaGllbGQpIHNsb3RzLnB1c2godGhpcy5zaGllbGQpO1xyXG5cdFx0aWYgKHRoaXMuY2FwZSkgc2xvdHMucHVzaCh0aGlzLmNhcGUpO1xyXG5cdFx0aWYgKHRoaXMud2VhcG9uKSBzbG90cy5wdXNoKHRoaXMud2VhcG9uKTtcclxuXHJcblx0XHRyZXR1cm4gc2xvdHM7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiByZXR1cm5zOiBbZmFjZSwgaGFpciwgY2FwLCAuLi4sIHdlYXBvbl1cclxuXHQgKi9cclxuXHQqZW51bWVyYXRlKCkge1xyXG5cdFx0aWYgKHRoaXMuZmFjZSkgeWllbGQgdGhpcy5mYWNlO1xyXG5cdFx0aWYgKHRoaXMuaGFpcikgeWllbGQgdGhpcy5oYWlyO1xyXG5cclxuXHRcdHlpZWxkKiB0aGlzLmVudW1lcmF0ZV9lcXVpcCgpO1xyXG5cdH1cclxuXHQqZW51bWVyYXRlX2VxdWlwKCkge1xyXG5cdFx0aWYgKHRoaXMuY2FwKSB5aWVsZCB0aGlzLmNhcDtcclxuXHRcdGlmICh0aGlzLmFjY2Vzc29yeUZhY2UpIHlpZWxkIHRoaXMuYWNjZXNzb3J5RmFjZTtcclxuXHRcdGlmICh0aGlzLmFjY2Vzc29yeUV5ZXMpIHlpZWxkIHRoaXMuYWNjZXNzb3J5RXllcztcclxuXHRcdGlmICh0aGlzLmFjY2Vzc29yeUVhcnMpIHlpZWxkIHRoaXMuYWNjZXNzb3J5RWFycztcclxuXHRcdGlmICh0aGlzLmNvYXQpIHlpZWxkIHRoaXMuY29hdDtcclxuXHRcdGlmICh0aGlzLmxvbmdjb2F0KSB5aWVsZCB0aGlzLmxvbmdjb2F0O1xyXG5cdFx0aWYgKHRoaXMucGFudHMpIHlpZWxkIHRoaXMucGFudHM7XHJcblx0XHRpZiAodGhpcy5zaG9lcykgeWllbGQgdGhpcy5zaG9lcztcclxuXHRcdGlmICh0aGlzLmdsb3ZlKSB5aWVsZCB0aGlzLmdsb3ZlO1xyXG5cdFx0aWYgKHRoaXMuc2hpZWxkKSB5aWVsZCB0aGlzLnNoaWVsZDtcclxuXHRcdGlmICh0aGlzLmNhcGUpIHlpZWxkIHRoaXMuY2FwZTtcclxuXHRcdGlmICh0aGlzLndlYXBvbikgeWllbGQgdGhpcy53ZWFwb247XHJcblx0fVxyXG5cdCplbnVtZXJhdGVfZmFjZSgpIHtcclxuXHRcdGlmICh0aGlzLmZhY2UpIHlpZWxkIHRoaXMuZmFjZTtcclxuXHRcdGlmICh0aGlzLmFjY2Vzc29yeUZhY2UpIHlpZWxkIHRoaXMuYWNjZXNzb3J5RmFjZTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENoYXJhY3RlckNoYW5nZUxvZyB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvKiogQHR5cGUge1wiaHVtYW5cInxcImVsZlwifFwibGVmXCJ8XCJoaWdobGVmXCJ9ICovXHJcblx0XHR0aGlzLmVhciA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ1tdfSAqL1xyXG5cdFx0dGhpcy51c2VFcXVpcCA9IFtdO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nW119ICovXHJcblx0XHR0aGlzLnVudXNlRXF1aXAgPSBbXTtcclxuXHRcdFxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9IC0gaGFpcjIgaWQgKi9cclxuXHRcdHRoaXMuaGFpcjIgPSB1bmRlZmluZWQ7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmhhaXJNaXgyID0gdW5kZWZpbmVkO1xyXG5cclxuXHRcdC8vLyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHQvL3RoaXMuaGFpcjMgPSB1bmRlZmluZWQ7XHJcblxyXG5cdFx0Ly8vKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdC8vdGhpcy5oYWlyTWl4MyA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gd2VhcG9uID0+IGVxdWlwIGlkICovXHJcblx0XHR0aGlzLndlYXBvbiA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMud2VhcG9uVHlwZSA9IHVuZGVmaW5lZDtcclxuXHR9XHJcblxyXG5cdGNsZWFyKCkge1xyXG5cdFx0dGhpcy5lYXIgPSB1bmRlZmluZWQ7XHJcblx0XHR0aGlzLnVzZUVxdWlwID0gW107XHJcblx0XHR0aGlzLnVudXNlRXF1aXAgPSBbXTtcclxuXHRcdHRoaXMuaGFpcjIgPSB1bmRlZmluZWQ7XHJcblx0XHR0aGlzLmhhaXJNaXgyID0gdW5kZWZpbmVkO1xyXG5cdFx0Ly90aGlzLmhhaXIzID0gdW5kZWZpbmVkO1xyXG5cdFx0Ly90aGlzLmhhaXJNaXgzID0gdW5kZWZpbmVkO1xyXG5cdFx0dGhpcy53ZWFwb25UeXBlID0gdW5kZWZpbmVkO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENoYXJhY3RlckFuaW1hdGlvbkJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0dGhpcy5fJGRpcnR5ID0gMDsvL2ZvcmNlIHVwZGF0ZSB2dWVcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gLSDmnKrlrozmiJAgKi9cclxuXHRcdHRoaXMuam9iID0gbnVsbDtcclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAtIOacquWujOaIkCAqL1xyXG5cdFx0dGhpcy5zdWJKb2IgPSBudWxsO1xyXG5cclxuXHJcblx0XHQvKiogQHR5cGUge0FjdGlvbkFuaW1hdGlvbn0gKi9cclxuXHRcdHRoaXMuYWN0YW5pID0gbmV3IEFjdGlvbkFuaW1hdGlvbigpO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAtIGFuaW1hdGlvbiBzcGVlZCByYXRlICovXHJcblx0XHR0aGlzLnNwZWVkID0gMTtcclxuXHJcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXHJcblx0XHR0aGlzLmZpeGVkX3NwZWVkID0gZmFsc2U7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtib29sZWFufSAtIHBhdXNlIGFuaW1hdGlvbiAqL1xyXG5cdFx0dGhpcy5wYXVzZSA9IGZhbHNlO1xyXG5cclxuXHJcblx0XHR0aGlzLmhpZGVCb2R5ID0gZmFsc2U7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLl9yaWRlX2FjdGlvbiA9IFwic3RhbmQxXCI7XHJcblxyXG5cdFx0Ly9cdGFjdGlvblxyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy5fYWN0aW9uID0gXCJzdGFuZDFcIjtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMuX2FjdGlvbl9mcmFtZSA9IDA7XHJcblxyXG5cdFx0Ly9cdGVtb3Rpb25cclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuX2Vtb3Rpb24gPSBcImJsaW5rXCI7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLl9lbW90aW9uX2ZyYW1lID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMuX2Vtb3Rpb25fdGltZSA9IDA7XHJcblxyXG5cdFx0Ly9cclxuXHJcblx0XHR0aGlzLl9nZW5lcmF0b3JfZW1vdGlvbl9mcmFtZSA9IHRoaXMuZW1vdGlvbl9mcmFtZV9zZXF1ZW5jZV9nZW5lcmF0b3IoMywgMCk7Ly9bMCwxLDJdLmxlbmd0aFxyXG5cdFx0XHJcblx0XHR0aGlzLmJsaW5rUmF0ZSA9IDAuMDE1O1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyU2xvdHN9ICovXHJcblx0XHR0aGlzLnNsb3RzID0gbmV3IENoYXJhY3RlclNsb3RzKCk7XHJcblxyXG5cdFx0LyoqXHJcblx0XHQgKiBpcyByZXF1aXJlIHVwZGF0ZSByZW5kZXIgZGF0YVxyXG5cdFx0ICogQHR5cGUge2Jvb2xlYW59XHJcblx0XHQgKi9cclxuXHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSA9IHRydWU7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmVbXX0gKi9cclxuXHRcdHRoaXMuX19mcmFnX2xpc3QgPSBbXTtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckNoYW5nZUxvZ30gKiovXHJcblx0XHR0aGlzLiQkY2hhbmdlTG9nID0gbmV3IENoYXJhY3RlckNoYW5nZUxvZygpO1xyXG5cdH1cclxuXHJcblx0X2Nsb25lKCkge1xyXG5cdFx0YWxlcnQodGhpcy5jb25zdHJ1Y3Rvci5uYW1lICsgXCI6Ol9jbG9uZVwiKTtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9ICovXHJcblx0XHRsZXQgbmMgPSBuZXcgdGhpcy5jb25zdHJ1Y3RvcigpOy8vbm90IG11c3QgQ2hhcmFjdGVyUmVuZGVyXHJcblx0XHRpZiAoIW5jKSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0bmMuc3BlZWQgPSAwO1xyXG5cclxuXHRcdG5jLnggPSB0aGlzLng7XHJcblx0XHRuYy55ID0gdGhpcy55O1xyXG5cdFx0bmMuYW5nbGUgPSB0aGlzLmFuZ2xlO1xyXG5cclxuXHRcdG5jLmFjdGlvbiA9IHRoaXMuYWN0aW9uO1xyXG5cdFx0bmMuYWN0aW9uX2ZyYW1lID0gdGhpcy5hY3Rpb25fZnJhbWU7XHJcblxyXG5cdFx0bmMuZW1vdGlvbiA9IHRoaXMuX2Vtb3Rpb247XHJcblx0XHRuYy5lbW90aW9uX2ZyYW1lID0gdGhpcy5lbW90aW9uX2ZyYW1lO1xyXG5cclxuXHRcdGZvciAobGV0IGkgaW4gdGhpcy5zbG90cykge1xyXG5cdFx0XHRsZXQgaXRlbSA9IHRoaXMuc2xvdHNbaV07XHJcblx0XHRcdGlmIChpdGVtKSB7XHJcblx0XHRcdFx0bmMuc2xvdHNbaV0gPSB0aGlzLnNsb3RzW2ldOy8vbm90IG5lZWQgY29sbmUgP1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gbmM7XHJcblx0fVxyXG5cdFx0XHJcblx0X3dhaXRGcmFtZVRleHR1cmVzTG9hZGVkKCkge1xyXG5cdFx0bGV0IHRhc2tzID0gW107XHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuc2xvdHMpIHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGl0ZW0gPSB0aGlzLnNsb3RzW2ldO1xyXG5cdFx0XHRpZiAoaXRlbSkge1xyXG5cdFx0XHRcdGZvciAobGV0IGogaW4gaXRlbS5mcmFnbWVudHMpIHtcclxuXHRcdFx0XHRcdGxldCBmcmFnID0gaXRlbS5mcmFnbWVudHNbal07XHJcblx0XHRcdFx0XHRsZXQgY291bnQgPSBmcmFnLmdldEZyYW1lQ291bnQodGhpcyk7XHJcblx0XHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGNvdW50OyArK2spIHtcclxuXHRcdFx0XHRcdFx0bGV0IGZ0ID0gZnJhZy5nZXRGcmFtZVRleHR1cmUodGhpcywgayk7XHJcblx0XHRcdFx0XHRcdGlmIChmdCAmJiAhZnQuX2lzTG9hZGVkX29yX2RvbG9hZCgpKSB7XHJcblx0XHRcdFx0XHRcdFx0dGFza3MucHVzaChmdC4kcHJvbWlzZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBQcm9taXNlLmFsbCh0YXNrcyk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBpbml0IGFuaW1hdGlvbiBzdGF0dXNcclxuXHQgKi9cclxuXHRpbml0QW5pbWF0aW9uKCkge1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmFjdGlvbiA9IFwic3RhbmQxXCI7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLl9hY3Rpb25fZnJhbWUgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy5lbW90aW9uID0gXCJibGlua1wiO1xyXG5cdFx0XHRcclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdFx0dGhpcy5fZW1vdGlvbl90aW1lID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMuX2Vtb3Rpb25fZnJhbWUgPSAwO1xyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtudW1iZXJ9IC0gMH4xICovXHJcblx0Z2V0U3BlZWQoKSB7XHJcblx0XHRpZiAodGhpcy5wYXVzZSkge1xyXG5cdFx0XHRyZXR1cm4gMDtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzLmZpeGVkX3NwZWVkID8gMSA6IHRoaXMuc3BlZWQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdHlwZSB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRnZXQgZWxmRWFyKCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5zbG90cy5oZWFkLmVsZkVhcjtcclxuXHRcdH1cclxuXHR9XHJcblx0c2V0IGVsZkVhcih2YWx1ZSkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHR0aGlzLnNsb3RzLmhlYWQuZWxmRWFyID0gdmFsdWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdHlwZSB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRnZXQgbGVmRWFyKCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5zbG90cy5oZWFkLmxlZkVhcjtcclxuXHRcdH1cclxuXHR9XHJcblx0c2V0IGxlZkVhcih2YWx1ZSkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHR0aGlzLnNsb3RzLmhlYWQubGVmRWFyID0gdmFsdWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdHlwZSB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRnZXQgaGlnaGxlZkVhcigpIHtcclxuXHRcdGlmICh0aGlzLnNsb3RzLmhlYWQpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuc2xvdHMuaGVhZC5oaWdobGVmRWFyO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRzZXQgaGlnaGxlZkVhcih2YWx1ZSkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHR0aGlzLnNsb3RzLmhlYWQuaGlnaGxlZkVhciA9IHZhbHVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtcImh1bWFuXCJ8XCJlbGZcInxcImxlZlwifFwiaGlnaGxlZlwifSAqL1xyXG5cdGdldCBlYXIoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnNsb3RzLmhlYWQubGVmRWFyID8gXCJsZWZcIiA6ICh0aGlzLnNsb3RzLmhlYWQuZWxmRWFyID8gXCJlbGZcIiA6ICh0aGlzLnNsb3RzLmhlYWQuaGlnaGxlZkVhciA/IFwiaGlnaGxlZlwiIDogXCJodW1hblwiKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdHNldCBlYXIodmFsdWUpIHtcclxuXHRcdGlmICh0aGlzLnNsb3RzLmhlYWQpIHtcclxuXHRcdFx0aWYgKHZhbHVlID09IFwiZWxmXCIpIHtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuZWxmRWFyID0gdHJ1ZTtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQubGVmRWFyID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5zbG90cy5oZWFkLmhpZ2hsZWZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmVhciA9IHZhbHVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKHZhbHVlID09IFwibGVmXCIpIHtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQubGVmRWFyID0gdHJ1ZTtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuZWxmRWFyID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5zbG90cy5oZWFkLmhpZ2hsZWZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmVhciA9IHZhbHVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKHZhbHVlID09IFwiaGlnaGxlZlwiKSB7XHJcblx0XHRcdFx0dGhpcy5zbG90cy5oZWFkLmVsZkVhciA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5sZWZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuaGlnaGxlZkVhciA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy5lYXIgPSB2YWx1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuZWxmRWFyID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5zbG90cy5oZWFkLmxlZkVhciA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5oaWdobGVmRWFyID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy5lYXIgPSBcImh1bWFuXCI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmVhciA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdGdldCBhY3Rpb24oKSB7XHJcblx0XHQvL2lmICh0aGlzLnNsb3RzLnRhbWluZ01vYikge1xyXG5cdFx0Ly9cdGNvbnN0IGFjdG1hcCA9IHRoaXMuc2xvdHMudGFtaW5nTW9iLmFjdGlvbk1hcDtcclxuXHRcdC8vXHRpZiAoYWN0bWFwKSB7XHJcblx0XHQvL1x0XHRyZXR1cm4gYWN0bWFwW3RoaXMuX2FjdGlvbl07XHJcblx0XHQvL1x0fVxyXG5cdFx0Ly9cdHJldHVybiBcInNpdFwiOy8vZGVmYXVsdFxyXG5cdFx0Ly99XHJcblx0XHRyZXR1cm4gdGhpcy5fYWN0aW9uO1xyXG5cdH1cclxuXHRzZXQgYWN0aW9uKGFjdCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMudGFtaW5nTW9iKSB7XHJcblx0XHRcdGxldCBfYWN0O1xyXG5cclxuXHRcdFx0dGhpcy5fcmlkZV9hY3Rpb24gPSBhY3Q7XHJcblxyXG5cdFx0XHRpZiAodGhpcy5zbG90cy50YW1pbmdNb2IuYWN0aW9uTWFwKSB7XHJcblx0XHRcdFx0X2FjdCA9IHRoaXMuc2xvdHMudGFtaW5nTW9iLmFjdGlvbk1hcFthY3RdO1xyXG5cclxuXHRcdFx0XHRpZiAoX2FjdCA9PSBcImhpZGVCb2R5XCIpIHtcclxuXHRcdFx0XHRcdHRoaXMuaGlkZUJvZHkgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRcdC8vVE9ETzogaGlkZUJvZHkgYWN0PT9cclxuXHJcblx0XHRcdFx0XHR0aGlzLl9hY3Rpb24gPSBhY3Q7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5hY3RhbmkuX2FjdGlvbiAhPSBhY3QpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5hY3RhbmkucmVsb2FkKGFjdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLmhpZGVCb2R5ID0gZmFsc2U7XHJcblxyXG5cdFx0XHRcdFx0dGhpcy5fYWN0aW9uID0gX2FjdDtcclxuXHRcdFx0XHRcdGlmICh0aGlzLmFjdGFuaS5fYWN0aW9uICE9IF9hY3QpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5hY3RhbmkucmVsb2FkKF9hY3QpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlIHw9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGlmIChhY3QgPT0gXCJyb3BlXCIpIHtcclxuXHRcdFx0XHRcdHRoaXMuX2FjdGlvbiA9IFwicm9wZVwiOy8vZGVmYXVsdFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmIChhY3QgPT0gXCJsYWRkZXJcIikge1xyXG5cdFx0XHRcdFx0dGhpcy5fYWN0aW9uID0gXCJsYWRkZXJcIjsvL2RlZmF1bHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHR0aGlzLl9hY3Rpb24gPSBcInNpdFwiOy8vZGVmYXVsdFxyXG5cdFx0XHRcdFx0dGhpcy5fYWN0aW9uX2ZyYW1lID0gMDsvL2RlZmF1bHRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRoaXMuYWN0YW5pLl9hY3Rpb24gIT0gYWN0KSB7XHJcblx0XHRcdFx0XHR0aGlzLmFjdGFuaS5yZWxvYWQoYWN0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlIHw9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHR0aGlzLmhpZGVCb2R5ID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuX3JpZGVfYWN0aW9uID0gbnVsbDtcclxuXHJcblx0XHRcdGlmICh0aGlzLmFjdGFuaS5fYWN0aW9uICE9IGFjdCAmJiB0aGlzLnNsb3RzLmJvZHkpIHtcclxuXHRcdFx0XHR0aGlzLl9hY3Rpb24gPSBhY3Q7XHJcblx0XHRcdFx0dGhpcy5hY3RhbmkucmVsb2FkKGFjdCk7XHJcblxyXG5cdFx0XHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSB8PSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRnZXQgYWN0aW9uX2ZyYW1lKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2FjdGlvbl9mcmFtZTtcclxuXHR9XHJcblx0c2V0IGFjdGlvbl9mcmFtZSh2YWx1ZSkge1xyXG5cdFx0aWYgKHZhbHVlID09PSBcIlwiKSB7Ly9mcm9tICQoXCJpbnB1dFwiKVxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykge1xyXG5cdFx0XHRpZiAoISh0eXBlb2YgdmFsdWUgPT0gJ251bWJlcicpKSB7XHJcblx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0dGhpcy5fYWN0aW9uX2ZyYW1lID0gTnVtYmVyKHZhbHVlKSB8IDA7XHJcblx0XHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlIHw9IHRydWU7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fYWN0aW9uX2ZyYW1lID0gdmFsdWU7XHJcblx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdGdldCBhY3Rpb25fZnJhbWVfY291bnQoKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRpZiAodGhpcy5zbG90cy5ib2R5KSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuc2xvdHMuYm9keS5nZXRGcmFtZUNvdW50KHRoaXMpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcblxyXG5cdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdGdldCBlbW90aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2Vtb3Rpb247XHJcblx0fVxyXG5cdHNldCBlbW90aW9uKGVtbykge1xyXG5cdFx0aWYgKHRoaXMuX2Vtb3Rpb24gIT0gZW1vICYmIHRoaXMuc2xvdHMuZmFjZSAmJiB0aGlzLnNsb3RzLmZhY2UuZnJhZ21lbnRzLmZhY2UudGV4dHVyZXNbZW1vXSkge1xyXG5cdFx0XHR0aGlzLl9lbW90aW9uID0gZW1vO1xyXG5cdFx0XHR0aGlzLl9lbW90aW9uX2ZyYW1lID0gMDtcclxuXHRcdFx0dGhpcy5fZW1vdGlvbl90aW1lID0gMDtcclxuXHJcblx0XHRcdGlmIChlbW8gPT0gXCJibGlua1wiKSB7XHJcblx0XHRcdFx0dGhpcy5ibGlua1JhdGUgPSAwLjAxNTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0aGlzLmJsaW5rUmF0ZSA9IDE7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdHRoaXMuX2dlbmVyYXRvcl9lbW90aW9uX2ZyYW1lID0gdGhpcy5lbW90aW9uX2ZyYW1lX3NlcXVlbmNlX2dlbmVyYXRvcih0aGlzLmVtb3Rpb25fZnJhbWVfY291bnQsIDApO1xyXG5cclxuXHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlIHw9IHRydWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gY291bnQgb2YgZnJhbWVcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhcnQgZnJhbWVcclxuXHQgKi9cclxuXHQqZW1vdGlvbl9mcmFtZV9zZXF1ZW5jZV9nZW5lcmF0b3IobGVuZ3RoLCBzdGFydCkge1xyXG5cdFx0d2hpbGUgKHRydWUpIHtcclxuXHRcdFx0aWYgKE1hdGgucmFuZG9tKCkgPCB0aGlzLmJsaW5rUmF0ZSkge1xyXG5cdFx0XHRcdHlpZWxkKiBsaW5lYXJTZXF1ZW5jZShsZW5ndGgsIHN0YXJ0KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR5aWVsZCAwO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdGdldCBlbW90aW9uX2ZyYW1lKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2Vtb3Rpb25fZnJhbWU7XHJcblx0fVxyXG5cdHNldCBlbW90aW9uX2ZyYW1lKHZhbHVlKSB7XHJcblx0XHRpZiAodmFsdWUgPT09IFwiXCIpIHsvL2Zyb20gJChcImlucHV0XCIpXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcblx0XHRcdGlmICghKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykpIHtcclxuXHRcdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0XHR0aGlzLl9lbW90aW9uX2ZyYW1lID0gTnVtYmVyKHZhbHVlKSB8IDA7XHJcblx0XHRcdFx0dGhpcy5fZW1vdGlvbl90aW1lID0gMDtcclxuXHRcdFx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX2Vtb3Rpb25fZnJhbWUgPSB2YWx1ZTtcclxuXHRcdHRoaXMuX2Vtb3Rpb25fdGltZSA9IDA7XHJcblx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBuZXh0XHJcblx0ICovXHJcblx0X2dldF9lbW90aW9uX25leHRfZnJhbWUobmV4dCkge1xyXG5cdFx0bGV0IHIgPSB0aGlzLl9nZW5lcmF0b3JfZW1vdGlvbl9mcmFtZS5uZXh0KCkudmFsdWU7XHJcblx0XHRcclxuXHRcdHRoaXMuX2dlbmVyYXRvcl9lbW90aW9uX2ZyYW1lID0gdGhpcy5lbW90aW9uX2ZyYW1lX3NlcXVlbmNlX2dlbmVyYXRvcih0aGlzLmVtb3Rpb25fZnJhbWVfY291bnQsIHRoaXMuX2Vtb3Rpb25fZnJhbWUpO1xyXG5cdFx0XHJcblx0XHRyZXR1cm4gcjtcclxuXHR9XHJcblxyXG5cdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdGdldCBlbW90aW9uX3RpbWUoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fZW1vdGlvbl90aW1lO1xyXG5cdH1cclxuXHRzZXQgZW1vdGlvbl90aW1lKHRpbWUpIHtcclxuXHRcdGlmICh0aGlzLmVtb3Rpb25fZnJhbWVfY291bnQpIHtcclxuXHRcdFx0aWYgKHRpbWUgPCB0aGlzLmVtb3Rpb25fZGVsYXkpIHtcclxuXHRcdFx0XHR0aGlzLl9lbW90aW9uX3RpbWUgPSB0aW1lO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuX2Vtb3Rpb25fdGltZSA9IDA7XHJcblxyXG5cdFx0XHRcdHRoaXMuX2Vtb3Rpb25fZnJhbWUgPSB0aGlzLl9nZW5lcmF0b3JfZW1vdGlvbl9mcmFtZS5uZXh0KCkudmFsdWU7XHJcblxyXG5cdFx0XHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSB8PSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldCBlbW90aW9uX2RlbGF5KCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuZmFjZSkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5zbG90cy5mYWNlLmdldERlbGF5KHRoaXMpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDYwO1xyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0Z2V0IGVtb3Rpb25fZnJhbWVfY291bnQoKSB7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRpZiAodGhpcy5zbG90cy5mYWNlKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuc2xvdHMuZmFjZS5nZXRGcmFtZUNvdW50KHRoaXMpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBzdGFtcCAtIDAgPD0gc3RhbXAgPCBJbmZpbml0eVxyXG5cdCAqL1xyXG5cdF91cGRhdGUoX3N0YW1wKSB7XHJcblx0XHRpZiAodGhpcy5wYXVzZSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHN0YW1wID0gX3N0YW1wICogdGhpcy5nZXRTcGVlZCgpO1xyXG5cdFx0XHJcblx0XHRpZiAodGhpcy5hY3RhbmkpIHtcclxuXHRcdFx0aWYgKHRoaXMuYWN0YW5pLmlzRW5kKCkgJiYgdGhpcy5hY3RhbmkubG9vcCkge1xyXG5cdFx0XHRcdHRoaXMuYWN0YW5pLnJlc2V0KCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMuYWN0YW5pLnVwZGF0ZShzdGFtcCwgdGhpcyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5lbW90aW9uX3RpbWUgKz0gX3N0YW1wO1xyXG5cclxuXHRcdGZvciAobGV0IGkgaW4gdGhpcy5zbG90cykge1xyXG5cdFx0XHRsZXQgZXF1aXAgPSB0aGlzLnNsb3RzW2ldO1xyXG5cdFx0XHRpZiAoZXF1aXAgJiYgZXF1aXAuZWZmZWN0ICYmIGVxdWlwLmVmZmVjdC5lbmFibGUpIHtcclxuXHRcdFx0XHRlcXVpcC5lZmZlY3QudXBkYXRlKHN0YW1wKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge2FueX0gbnVtYmVyICAwIDwgc3RhbXAgKiBzcGVlZCA8IEluZmluaXR5XHJcblx0ICovXHJcblx0dXBkYXRlKHN0YW1wKSB7XHJcblx0XHR0aGlzLl91cGRhdGUoc3RhbXApO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogdXNlIGF3YWl0IHRoaXMuX19zeW5jaHJvbml6ZShzdGFtcCkgdXBkYXRlIGFuZCBmb3JjZSB3YWl0IGFsbCByZXNvdXJjZSBsb2FkXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9XHJcblx0ICovXHJcblx0X19mb3JjZVVwZGF0ZShzdGFtcCkge1xyXG5cdFx0dGhpcy5fJGRpcnR5ID0gTWF0aC5yYW5kb20oKTtcclxuXHRcdHRoaXMuX3VwZGF0ZShzdGFtcCB8IDApO1xyXG5cdFx0dGhpcy5fX3VwZGF0ZV9mcmFnX2xpc3QoKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtJUmVuZGVyZXJ9IHJlbmRlcmVyXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geSwgXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGFuZ2xlXHJcblx0ICogQHBhcmFtIHtib29sZWFufSBmbGlwXHJcblx0ICovXHJcblx0X2RyYXcocmVuZGVyZXIsIHgsIHksIGFuZ2xlLCBmbGlwKSB7XHJcblx0XHRyZW5kZXJlci5wdXNoR2xvYmFsQWxwaGEoKTtcclxuXHJcblx0XHQvL2xpc3QuZmlsdGVyKGE9PmEmJmEuX3Jhdy5tYXApLmZvckVhY2goYT0+eyBmb3IgKGxldCBpIGluIGEuX3Jhdy5tYXApIHsgaWYgKHFbaV0pIHsgcVtpXS5wdXNoKGEpOyB9IGVsc2UgeyBxW2ldID0gW2FdOyB9IH0gfSlcclxuXHRcdHRoaXMuX19kcmF3X2xpc3QocmVuZGVyZXIsIHRoaXMuX19mcmFnX2xpc3QsIHgsIHksIGFuZ2xlLCBmbGlwKTtcclxuXHJcblx0XHRyZW5kZXJlci5wb3BHbG9iYWxBbHBoYSgpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZVtdfSBsaXN0XHJcblx0ICovXHJcblx0X19kcmF3X2xpc3QocmVuZGVyZXIsIGxpc3QsIHgsIHksIGFuZ2xlLCBmbGlwKSB7XHJcblx0XHRyZW5kZXJlci5wdXNoTWF0cml4KCk7XHJcblxyXG5cdFx0cmVuZGVyZXIudHJhbnNsYXRlKHgsIHkpO1xyXG5cdFx0XHJcblx0XHRpZiAoMCkge1xyXG5cdFx0XHRsZXQgY3R4ID0gcmVuZGVyZXIuY3R4O1xyXG5cdFx0XHRjdHguYmVnaW5QYXRoKCk7XHJcblx0XHRcdGN0eC5tb3ZlVG8oMCwgMCk7XHJcblx0XHRcdGN0eC5saW5lVG8oMTAwLCAwKTtcclxuXHRcdFx0Y3R4LnN0cm9rZVN0eWxlID0gXCIjRjAwXCI7XHJcblx0XHRcdGN0eC5zdHJva2UoKTtcclxuXHRcdFx0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdFx0XHRjdHgubW92ZVRvKDAsIDApO1xyXG5cdFx0XHRjdHgubGluZVRvKDAsIDEwMCk7XHJcblx0XHRcdGN0eC5zdHJva2VTdHlsZSA9IFwiIzBGMFwiO1xyXG5cdFx0XHRjdHguc3Ryb2tlKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmVuZGVyZXIucm90YXRlKHdpbmRvdy5tX2EgfHwgYW5nbGUpO1xyXG5cclxuXHRcdGlmIChmbGlwKSB7XHJcblx0XHRcdHJlbmRlcmVyLnNjYWxlKC0xLCAxKTtcclxuXHRcdH1cclxuXHRcdC8ve1xyXG5cdFx0Ly9cdGxldCBjdHggPSByZW5kZXJlci5jdHg7XHJcblx0XHQvL1x0Y3R4LmJlZ2luUGF0aCgpO1xyXG5cdFx0Ly9cdGN0eC5tb3ZlVG8oMCwgMCk7XHJcblx0XHQvL1x0Y3R4LmxpbmVUbygxMDAsIDApO1xyXG5cdFx0Ly9cdGN0eC5zdHJva2VTdHlsZSA9IFwiI0YwMFwiO1xyXG5cdFx0Ly9cdGN0eC5zdHJva2UoKTtcclxuXHRcdC8vXHRjdHguYmVnaW5QYXRoKCk7XHJcblx0XHQvL1x0Y3R4Lm1vdmVUbygwLCAwKTtcclxuXHRcdC8vXHRjdHgubGluZVRvKDAsIDEwMCk7XHJcblx0XHQvL1x0Y3R4LnN0cm9rZVN0eWxlID0gXCIjMEYwXCI7XHJcblx0XHQvL1x0Y3R4LnN0cm9rZSgpO1xyXG5cdFx0Ly99XHJcblxyXG5cdFx0e1xyXG5cdFx0XHRmb3IgKGxldCBpIGluIHRoaXMuc2xvdHMpIHtcclxuXHRcdFx0XHRsZXQgZXF1aXAgPSB0aGlzLnNsb3RzW2ldO1xyXG5cdFx0XHRcdGlmIChlcXVpcCAmJiBlcXVpcC5lZmZlY3QpIHtcclxuXHRcdFx0XHRcdGVxdWlwLmVmZmVjdC5yZW5kZXIocmVuZGVyZXIsIHRoaXMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRmb3IgKGxldCBpIGluIGxpc3QpIHtcclxuXHRcdFx0XHRsZXQgZnQgPSBsaXN0W2ldO1xyXG5cdFx0XHRcdGZ0LnJlbmRlcihyZW5kZXJlciwgdGhpcyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJlbmRlcmVyLnBvcE1hdHJpeCgpO1xyXG5cdH1cclxuXHRfX3VwZGF0ZV9mcmFnX2xpc3QoKSB7XHJcblx0XHR0aGlzLl9fZnJhZ19saXN0ID0gW107XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7QXJyYXk8Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2U+W119ICovXHJcblx0XHRsZXQgc2xvdHMgPSB7fTtcclxuXHRcdFxyXG5cdFx0Zm9yIChsZXQgaSA9IDI7IGkgPD0gMzsgKytpKSB7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9ICovXHJcblx0XHRcdGxldCBpdGVtID0gdGhpcy5zbG90c1tcIl9oYWlyXCIgKyBpXTtcclxuXHRcdFx0XHJcblx0XHRcdHRoaXMuX19hZGRfZXF1aXBfdG9fZnJhZ19saXN0KHNsb3RzLCBpdGVtKTtcclxuXHRcdH1cclxuXHRcdGZvciAobGV0IGkgaW4gdGhpcy5zbG90cy5fb3JkZXJlZF9zbG90KSB7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9ICovXHJcblx0XHRcdGxldCBpdGVtID0gdGhpcy5zbG90cy5fb3JkZXJlZF9zbG90W2ldO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5fX2FkZF9lcXVpcF90b19mcmFnX2xpc3Qoc2xvdHMsIGl0ZW0pO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR7Ly9iYWNrXHJcblx0XHRcdGxldCBpc19iYWNrID0gZmFsc2U7XHJcblx0XHRcdFxyXG5cdFx0XHRmb3IgKGxldCBpIGluIHNsb3RzKSB7XHJcblx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmVbXX0gKi9cclxuXHRcdFx0XHRsZXQgZnRzID0gc2xvdHNbaV07XHJcblx0XHRcdFx0Zm9yIChsZXQgaiBpbiBmdHMpIHtcclxuXHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0bGV0IGZ0ID0gZnRzW2pdO1xyXG5cdFx0XHRcdFx0aWYgKGlzX2JhY2spIHtcclxuXHRcdFx0XHRcdFx0aWYgKGZ0Ll9wbGFjZS5zdGFydHNXaXRoKFwiZmFjZVwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIGlmIChmdC5fcGxhY2Uuc3RhcnRzV2l0aChcImJhY2tIYWlyXCIpKSB7XHJcblx0XHRcdFx0XHRcdGlzX2JhY2sgPSB0cnVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dGhpcy5fX2FkZF9mcmFnX3RvX2xpc3QoZnQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR7XHJcblx0XHRcdGxldCBhZSA9IHRoaXMuX19mcmFnX2xpc3RbMTE0XTsvL0hBQ0s6IEFlXHJcblx0XHRcdGlmIChhZSkge1xyXG5cdFx0XHRcdHRoaXMuX19mcmFnX2xpc3QucHVzaChhZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9jYWxjQm91bmRCb3goKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtBcnJheTxDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZT5bXX0gc2xvdHNcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFwcGVhcmFuY2VCYXNlfSBpdGVtXHJcblx0ICovXHJcblx0X19hZGRfZXF1aXBfdG9fZnJhZ19saXN0KHNsb3RzLCBpdGVtKSB7XHJcblx0XHQvLyBpZiBlcXVpcCBub3QgdXNlIHRoZW4gdmFsdWUgaXMgbXVtYmVyKHNsb3Rfb3JkZXIpIHdoZXJlIHRoaXMuc2xvdHMuX29yZGVyZWRfc2xvdFxyXG5cdFx0aWYgKGl0ZW0gPT0gbnVsbCkge1xyXG5cdFx0XHRyZXR1cm47Ly9kZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKGl0ZW0gPiAwKSB7Ly8gdHlwZW9mIGl0ZW0gPT0gJ251bWJlcic7IGl0ZW0gIT0gbnVsbCAmJiAoaXRlbSBpbnN0YW5jZW9mIENoYXJhY3RlckFwcGVhcmFuY2VCYXNlIHx8IGl0ZW0gPj0gMClcclxuXHRcdFx0cmV0dXJuOy8vY29udGludWU7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaW5pdCBzbG90c1xyXG5cdFx0Zm9yIChsZXQgaiBpbiBpdGVtLnZzbG90KSB7XHJcblx0XHRcdGxldCBzbG90ID0gaXRlbS52c2xvdFtqXTtcclxuXHRcdFx0c2xvdHNbc2xvdF0gPSBbXTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGxldCBqIGluIGl0ZW0uZnJhZ21lbnRzKSB7Ly9mb3JlYWNoIGVxdWlwIHBsYWNlXHJcblx0XHRcdGxldCBzbG90ID0gc01hcFtqXTtcclxuXHRcdFx0aWYgKHNsb3QgIT0gbnVsbCkge1xyXG5cdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdGxldCBmdCA9IGl0ZW0uZnJhZ21lbnRzW2pdLmdldFRleHR1cmUodGhpcyk7XHJcblx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRpZiAoIXNsb3RzW3Nsb3RdKSB7XHJcblx0XHRcdFx0XHRcdHNsb3RzW3Nsb3RdID0gW2Z0XTsvL2NvdmVyID8/XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0c2xvdHNbc2xvdF0ucHVzaChmdCk7Ly9jb3ZlciA/P1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChqID09IFwiZGVmYXVsdFwiKSB7XHJcblx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0bGV0IGZ0ID0gaXRlbS5mcmFnbWVudHNbal0uZ2V0VGV4dHVyZSh0aGlzKTtcclxuXHRcdFx0XHRzbG90ID0gaXRlbS5fcmF3LmluZm8uaXNsb3Q7XHJcblx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRpZiAoIXNsb3RzW3Nsb3RdKSB7XHJcblx0XHRcdFx0XHRcdHNsb3RzW3Nsb3RdID0gW2Z0XTsvL2NvdmVyID8/XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0c2xvdHNbc2xvdF0ucHVzaChmdCk7Ly9jb3ZlciA/P1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRsZXQgZnQgPSBpdGVtLmZyYWdtZW50c1tqXS5nZXRUZXh0dXJlKHRoaXMpO1xyXG5cdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0dGhpcy5fX2FkZF9mcmFnX3RvX2xpc3QoZnQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHQvL2l0ZW0uZnJhZ21lbnRzW2pdLnZpc2libGUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvKiogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGZ0ICovXHJcblx0X19hZGRfZnJhZ190b19saXN0KGZ0KSB7XHJcblx0XHRmdC51cGRhdGUodGhpcyk7XHJcblx0XHR0aGlzLl9fZnJhZ19saXN0W2Z0LnpdID0gZnQ7XHJcblx0fVxyXG5cclxuXHJcblx0LyoqXHJcblx0ICogY2FsYyBjdXJyZW50IGZyYW1lIGJvdW5kIGJveCBhbmQgcmVzdG9yZSByZXN1bHRcclxuXHQgKiBAcmV0dXJucyB7UmVjdGFuZ2xlfVxyXG5cdCAqL1xyXG5cdGNhbGNCb3VuZEJveCgpIHtcclxuXHRcdGlmICh0aGlzLl9fcmVxdWlyZV91cGRhdGUpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2NhbGNCb3VuZEJveCgpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9ib3VuZEJveDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGNhbGMgY3VycmVudCBmcmFtZSBib3VuZCBib3ggYW5kIHJlc3RvcmUgcmVzdWx0XHJcblx0ICogQHJldHVybnMge1JlY3RhbmdsZX1cclxuXHQgKi9cclxuXHRfY2FsY0JvdW5kQm94KCkge1xyXG5cdFx0bGV0IGxlZnQgPSAwLCB0b3AgPSAwLCByaWdodCA9IDAsIGJvdHRvbSA9IDA7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLl9fZnJhZ19saXN0KSB7XHJcblx0XHRcdGxldCBmdCA9IHRoaXMuX19mcmFnX2xpc3RbaV07XHJcblx0XHRcdGlmIChmdC50ZXh0dXJlICYmIGZ0LnJlbGF0aXZlKSB7XHJcblx0XHRcdFx0bGV0IHgwID0gZnQucmVsYXRpdmUueDtcclxuXHRcdFx0XHRsZXQgeTAgPSBmdC5yZWxhdGl2ZS55O1xyXG5cdFx0XHRcdGxldCB4MSA9IHgwICsgZnQud2lkdGg7XHJcblx0XHRcdFx0bGV0IHkxID0geTAgKyBmdC5oZWlnaHQ7XHJcblxyXG5cdFx0XHRcdGxlZnQgPSBNYXRoLm1pbihsZWZ0LCB4MCk7XHJcblx0XHRcdFx0dG9wID0gTWF0aC5taW4odG9wLCB5MCk7XHJcblx0XHRcdFx0cmlnaHQgPSBNYXRoLm1heChyaWdodCwgeDEpO1xyXG5cdFx0XHRcdGJvdHRvbSA9IE1hdGgubWF4KGJvdHRvbSwgeTEpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHR0aGlzLl9ib3VuZEJveCA9IG5ldyBSZWN0YW5nbGUoXHJcblx0XHRcdE1hdGgudHJ1bmMobGVmdCksXHJcblx0XHRcdE1hdGgudHJ1bmModG9wKSxcclxuXHRcdFx0TWF0aC50cnVuYyhyaWdodCAtIGxlZnQpLFxyXG5cdFx0XHRNYXRoLnRydW5jKGJvdHRvbSAtIHRvcClcclxuXHRcdCk7XHJcblx0XHRyZXR1cm4gdGhpcy5fYm91bmRCb3g7XHJcblx0fVxyXG5cdFxyXG5cdHRvSlNPTigpIHtcclxuXHRcdGxldCBvYmogPSB7XHJcblx0XHRcdHNsb3RzOiB0aGlzLnNsb3RzLnRvSlNPTigpLFxyXG5cdFx0fTtcclxuXHRcdGlmICh0aGlzLnNsb3RzLl9oYWlyMikge1xyXG5cdFx0XHRvYmouaGFpcjIgPSB0aGlzLnNsb3RzLl9oYWlyMi5pZDtcclxuXHRcdFx0b2JqLmhhaXJNaXgyID0gdGhpcy5zbG90cy5oYWlyTWl4MjtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkLmVsZkVhcikge1xyXG5cdFx0XHRvYmouZWFyID0gXCJlbGZcIjtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKHRoaXMuc2xvdHMuaGVhZC5sZWZFYXIpIHtcclxuXHRcdFx0b2JqLmVhciA9IFwibGVmXCI7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmICh0aGlzLnNsb3RzLmhlYWQuaGlnaGxlZkVhcikge1xyXG5cdFx0XHRvYmouZWFyID0gXCJoaWdobGVmXCI7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIG9iajtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBDaGFyYWN0ZXJSZW5kZXJlciBleHRlbmRzIENoYXJhY3RlckFuaW1hdGlvbkJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gLSBwb3NpdGlvbiB4ICovXHJcblx0XHR0aGlzLnggPSAwO1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IC0gcG9zaXRpb24geSAqL1xyXG5cdFx0dGhpcy55ID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gLSB3aGVyZSBsYXllciAqL1xyXG5cdFx0dGhpcy56ID0gNTtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gLSB0cmFuc2xhdGUgeCBvbmNlIGZyYW1lICovXHJcblx0XHR0aGlzLnR4ID0gMDtcclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAtIHRyYW5zbGF0ZSB5IG9uY2UgZnJhbWUgKi9cclxuXHRcdHRoaXMudHkgPSAwO1xyXG5cdFx0XHJcblx0XHR0aGlzLmFuZ2xlID0gMDtcclxuXHRcdHRoaXMuZnJvbnQgPSAtMTtcclxuXHJcblx0XHQvKiogQHR5cGUge1Byb21pc2U8dm9pZD5bXX0gKi9cclxuXHRcdHRoaXMuX19sb2FkX3Rhc2sgPSBbXTtcclxuXHJcblx0XHQvKiogQHR5cGUge2Z1bmN0aW9uKElSZW5kZXJlcil9ICovXHJcblx0XHR0aGlzLnJlbmRlciA9IGZ1bmN0aW9uIChyZW5kZXJlcikge1xyXG5cdFx0XHQvL25vdCByZWFkeSB0byByZW5kZXJcclxuXHRcdFx0Ly9pZiBsb2FkIHRoZW4gc2V0IGxvYWQgcmVuZGVyID0gX3JlbmRlclxyXG5cdFx0fVxyXG5cclxuXHRcdC8qKiBAdHlwZSB7UmVjdGFuZ2xlfSAqL1xyXG5cdFx0dGhpcy5fYm91bmRCb3ggPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy5fJG9sZF9hY3Rpb24gPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLl8kb2xkX2Vtb3Rpb24gPSBudWxsO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGFzeW5jIEluaXQoKSB7XHJcblx0XHRsZXQgcmVzdWx0ID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG5cdFx0XHQkZ2V0LmRhdGEoXCIvem1hcFwiKSxcclxuXHRcdFx0JGdldC5kYXRhKFwiL3NtYXBcIiksXHJcblx0XHRcdEl0ZW1FZmZlY3QuSW5pdCgpLFxyXG5cdFx0XHRBY3Rpb25BbmltYXRpb24uSW5pdCgpLC8vYWN0aW9uIGRlZmluaXRpb25cclxuXHRcdF0pO1xyXG5cdFx0XHJcblx0XHR6TWFwID0ge307XHJcblx0XHRPYmplY3Qua2V5cyhyZXN1bHRbMF0pLnJldmVyc2UoKS5mb3JFYWNoKChrLCBpKSA9PiB6TWFwW2tdID0gaSArIDEpO1xyXG5cclxuXHRcdHNNYXAgPSByZXN1bHRbMV07XHJcblx0fVxyXG5cclxuXHRsb2FkKCkge1xyXG5cdFx0Ly9sb2FkIGJvZHkgYW5kIGhlYWQgZm9yIGNhbGMgcmVsYXRpdmUgcG9zaXRpb25cclxuXHRcdHRoaXMudXNlKFwiMDAwMDIwMTJcIik7XHJcblx0XHR0aGlzLnVzZShcIjAwMDEyMDEyXCIpO1xyXG5cclxuXHRcdGxldCAkcHJvbWlzZSA9IFByb21pc2UuYWxsKFsuLi50aGlzLl9fbG9hZF90YXNrXSk7XHJcblx0XHQoZnVuY3Rpb24gKHRoYXQsICRwcm9taXNlKSB7XHJcblx0XHRcdCRwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG5cdFx0XHRcdHRoYXQuaW5pdEFuaW1hdGlvbigpO1xyXG5cdFx0XHRcdHRoYXQucmVuZGVyID0gdGhhdC5fcmVuZGVyO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pKHRoaXMsICRwcm9taXNlKTtcclxuXHJcblx0XHRyZXR1cm4gJHByb21pc2U7XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7YW55fSBudW1iZXIgIDAgPCBzdGFtcCAqIHNwZWVkIDwgSW5maW5pdHlcclxuXHQgKi9cclxuXHR1cGRhdGUoc3RhbXApIHtcclxuXHRcdHRoaXMuXyRvbGRfYWN0aW9uID0gdGhpcy5fYWN0aW9uO1xyXG5cdFx0dGhpcy5fJG9sZF9lbW90aW9uID0gdGhpcy5lbW90aW9uO1xyXG5cclxuXHRcdHRoaXMud2FpdExvYWRlZCgpO1xyXG5cdFx0c3VwZXIudXBkYXRlKHN0YW1wKTtcclxuXHJcblx0XHRpZiAodGhpcy5fX3JlcXVpcmVfdXBkYXRlKSB7XHJcblx0XHRcdHRoaXMuX191cGRhdGVfZnJhZ19saXN0KCk7XHJcblx0XHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtJUmVuZGVyZXJ9IHJlbmRlcmVyXHJcblx0ICovXHJcblx0X3JlbmRlcihyZW5kZXJlcikge1xyXG5cdFx0Y29uc3QgeCA9IE1hdGgudHJ1bmModGhpcy54ICsgdGhpcy50eCk7XHJcblx0XHRjb25zdCB5ID0gTWF0aC50cnVuYyh0aGlzLnkgKyB0aGlzLnR5KTtcclxuXHRcdFxyXG5cdFx0dGhpcy5fZHJhdyhyZW5kZXJlciwgeCwgeSwgdGhpcy5hbmdsZSwgdGhpcy5mcm9udCA+IDApO1xyXG5cdFx0XHJcblx0XHQvL3RoaXMudHggPSAwOy8vYXV0byBjbGVhclxyXG5cdFx0Ly90aGlzLnR5ID0gMDsvL2F1dG8gY2xlYXJcclxuXHR9XHJcblx0XHJcblx0X3NldHVwX3Rlc3QoKSB7XHJcblx0XHRpZiAoMCkge1xyXG5cdFx0XHR0aGlzLnVzZShcIjAwMDI2NTA5XCIpO1xyXG5cclxuXHRcdFx0dGhpcy51c2UoXCIwMDA0NDA0MVwiKTtcclxuXHJcblx0XHRcdC8vdGhpcy51c2UoXCIwMTAyMjI3NFwiKTtcclxuXHJcblx0XHRcdHRoaXMudXNlKFwiMDEwNTMxNjlcIik7XHJcblxyXG5cdFx0XHR0aGlzLnVzZShcIjAxMDcxMDc3XCIpO1xyXG5cclxuXHRcdFx0Ly90aGlzLnVzZShcIjAxMTAyOTYwXCIpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMudXNlKFwiMDAwMjY1MDlcIik7XHJcblxyXG5cdFx0XHR0aGlzLnVzZShcIjAwMDQxNTI2XCIpO1xyXG5cclxuXHRcdFx0dGhpcy51c2UoXCIwMTA1MTQyOVwiKTtcclxuXHJcblx0XHRcdHRoaXMudXNlKFwiMDEwNzExMTBcIik7XHJcblxyXG5cdFx0XHR0aGlzLmVsZkVhciA9IHRydWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRcclxuXHQvKipcclxuXHQgKiB1cGRhdGUgYW5kIGZvcmNlIHdhaXQgYWxsIHJlc291cmNlIGxvYWRcclxuXHQgKiBAcGFyYW0ge251bWJlcn1cclxuXHQgKi9cclxuXHRhc3luYyBfX3N5bmNocm9uaXplKHN0YW1wKSB7XHJcblx0XHR0aGlzLl9fZm9yY2VVcGRhdGUoc3RhbXApO1xyXG5cdFxyXG5cdFx0YXdhaXQgdGhpcy53YWl0TG9hZGVkKCk7XHJcblx0XHRhd2FpdCB0aGlzLl93YWl0RnJhbWVUZXh0dXJlc0xvYWRlZCgpO1xyXG5cdH1cclxuXHRhc3luYyB3YWl0TG9hZGVkKCkge1xyXG5cdFx0bGV0IHRhc2tzID0gdGhpcy5fX2xvYWRfdGFzaztcclxuXHRcdGlmICh0YXNrcyAmJiB0YXNrcy5sZW5ndGgpIHtcclxuXHRcdFx0YXdhaXQgUHJvbWlzZS5hbGwodGFza3MpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdHRoaXMuX19sb2FkX3Rhc2sgPSBbXTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gKGVycikge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8vaXNMb2FkaW5nKCkge1xyXG5cdC8vfVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWRcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnkgLSBjYXRlZ29yeSBvZiBjYXNoLXdlYXBvblxyXG5cdCAqL1xyXG5cdGFzeW5jIHVzZShpZCwgY2F0ZWdvcnkpIHtcclxuXHRcdGlmICghY2F0ZWdvcnkpIHtcclxuXHRcdFx0Y2F0ZWdvcnkgPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldEpvYldlYXBvbkNhdGVnb3J5KHRoaXMuam9iKTtcclxuXHRcdH1cclxuXHRcdGlmICghKGlkICYmIHR5cGVvZiBpZCA9PSBcInN0cmluZ1wiKSkge1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKFwiaWQ6IHN0cmluZ1wiKTtcclxuXHRcdH1cclxuXHRcdGNvbnN0IGl0ZW1fdHlwZSA9IGlkWzBdO1xyXG5cdFx0c3dpdGNoIChpdGVtX3R5cGUpIHtcclxuXHRcdFx0Y2FzZSBcIjBcIjovL2VxdWlwXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0aWYgKEl0ZW1DYXRlZ29yeUluZm8uaXNDYXNoV2VhcG9uKGlkKSkge1xyXG5cdFx0XHRcdFx0XHQvL3RoaXMuJCRjaGFuZ2VMb2cud2VhcG9uVHlwZSA9IHNzWzFdOy8/P1xyXG5cdFx0XHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLndlYXBvbiA9IGlkO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cudXNlRXF1aXAucHVzaChpZCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0bGV0IHRhc2sgPSB0aGlzLnNsb3RzLl91c2UoaWQsIG51bGwsIGNhdGVnb3J5KTtcclxuXHRcdFx0XHRcdHRoaXMuX19sb2FkX3Rhc2sucHVzaCh0YXNrKTtcclxuXHRcdFx0XHRcdGxldCBpdGVtID0gYXdhaXQgdGFzaztcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0aWYgKGlkLnN0YXJ0c1dpdGgoXCIwMTlcIikpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5hY3Rpb24gPSB0aGlzLmFjdGlvbjsvL2ZvcmNlIHVwZGF0ZSBhY3Rpb25cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0dGhpcy5fX3VwZGF0ZV9mcmFnX2xpc3QoKTtcclxuXHRcdFx0XHRcdHRoaXMuX2NhbGNCb3VuZEJveCgpO1xyXG5cclxuXHRcdFx0XHRcdHJldHVybiBpdGVtO1xyXG5cdFx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqL1xyXG5cdHVudXNlKGlkKSB7XHJcblx0XHRkZWJ1Z2dlcjtcclxuXHRcdGlmIChpZFswXSA9PSBcIjBcIikgey8vZXF1aXBcclxuXHRcdFx0bGV0IHJlc3VsdCA9IHRoaXMuc2xvdHMuX3VudXNlKGlkKTtcclxuXHRcdFx0aWYgKHJlc3VsdCkge1xyXG5cdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cudW51c2VFcXVpcC5wdXNoKGlkKTtcclxuXHRcdFx0XHR0aGlzLl9jYWxjQm91bmRCb3goKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHt7c2hvd2VhcnM6Ym9vbGVhbixzaG93TGVmRWFyczpib29sZWFuLHNob3dIaWdoTGVmRWFyczpib29sZWFuLGl0ZW1zOltdfX0gb3B0aW9uXHJcblx0ICovXHJcblx0c2V0KG9wdGlvbikge1xyXG5cdFx0dGhpcy5lYXIgPSBCb29sZWFuKG9wdGlvbi5zaG93ZWFycyk7XHJcblx0XHR0aGlzLmxlZkVhciA9IEJvb2xlYW4ob3B0aW9uLnNob3dMZWZFYXJzKTtcclxuXHRcdHRoaXMuaGlnaGxlZkVhciA9IEJvb2xlYW4ob3B0aW9uLnNob3dIaWdoTGVmRWFycyk7XHJcblxyXG5cdFx0b3B0aW9uLml0ZW1zLmZvckVhY2goYXN5bmMgKGl0ZW1EYXRhKSA9PiB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGl0ZW1JZCA9IE51bWJlcihpdGVtRGF0YS5pdGVtSWQgfCAwKS50b1N0cmluZygpLnBhZFN0YXJ0KDgsIFwiMFwiKTtcclxuXHRcdFx0XHRsZXQgaXRlbSA9IGF3YWl0IHRoaXMudXNlKGl0ZW1JZCk7XHJcblx0XHRcdFx0aXRlbS5zZXQoaXRlbURhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJpdGVtSWQ6XCIsIGl0ZW1EYXRhLml0ZW1JZCwgZXgsIGl0ZW1EYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBhbm90aGVyIGZvcm1hdFxyXG5cdCAqIEBwYXJhbSB7e2FscGhhOiBudW1iZXIsIGh1ZTogbnVtYmVyLCBzYXR1cmF0aW9uOiBudW1iZXIsIGJyaWdodG5lc3M6IG51bWJlciwgY29udHJhc3Q6IG51bWJlcn1bXX0gZXF1aXBEYXRhQXJyYXlcclxuXHQgKi9cclxuXHRwYXJzZShlcXVpcERhdGFBcnJheSkge1xyXG5cdFx0ZXF1aXBEYXRhQXJyYXkuZm9yRWFjaChhc3luYyAoaXRlbURhdGEpID0+IHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRsZXQgaXRlbUlkID0gTnVtYmVyKGl0ZW1EYXRhLml0ZW1JZCB8IDApLnRvU3RyaW5nKCkucGFkU3RhcnQoOCwgXCIwXCIpO1xyXG5cdFx0XHRcdGxldCBlcXVpcCA9IGF3YWl0IHRoaXMudXNlKGl0ZW1JZCk7XHJcblx0XHRcdFx0ZXF1aXAucGFyc2UoaXRlbURhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoXCJpdGVtSWQ6XCIsIGl0ZW1EYXRhLml0ZW1JZCwgZXgsIGl0ZW1EYXRhKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRfcGFyc2UoY29kZSkge1xyXG5cdFx0aWYgKCFjb2RlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBlcyA9IGNvZGUuc3BsaXQoXCIsXCIpO1xyXG5cdFx0dGhpcy5zbG90cy5fY2xlYXIoKTtcclxuXHRcdGVzLmZvckVhY2goKHYsIGksIGEpID0+IHtcclxuXHRcdFx0aWYgKHYuaW5kZXhPZihcInxcIikgPj0gMCkge1xyXG5cdFx0XHRcdGNvbnN0IHNzID0gdi5zcGxpdChcInxcIik7XHJcblx0XHRcdFx0Y29uc3QgY2F0ZSA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KHNzWzBdKTtcclxuXHRcdFx0XHRsZXQgaWQ7XHJcblx0XHRcdFx0aWYgKGNhdGUuc2xvdCA9PSBcImZhY2VcIikge1xyXG5cdFx0XHRcdFx0aWQgPSBzc1sxXS50cmltKCkucGFkU3RhcnQoOCwgMCk7XHJcblx0XHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLnVzZUVxdWlwLnB1c2goaWQpO1xyXG5cdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdHRoaXMudXNlKGlkKTtcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYgKGNhdGUuc2xvdCA9PSBcImhhaXJcIikge1xyXG5cdFx0XHRcdFx0Y29uc3Qgc2xvdHMgPSB0aGlzLnNsb3RzO1xyXG5cdFx0XHRcdFx0bGV0IGgyID0gc3NbMV07XHJcblx0XHRcdFx0XHRsZXQgaDMgPSBzc1syXTtcclxuXHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHRpZCA9IHNzWzBdLnRyaW0oKS5wYWRTdGFydCg4LCAwKTtcclxuXHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cudXNlRXF1aXAucHVzaChpZCk7XHJcblx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0dGhpcy51c2UoaWQpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRpZiAoaDIgJiYgaDIuaW5kZXhPZihcIiVcIikgPj0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGxldCBoYyA9IGgyLnNwbGl0KFwiJVwiKTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjMiA9IGhjWzBdO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IG0yID0gaGNbMV0gLyAxMDA7XHJcblx0XHRcdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmhhaXIyID0gYzI7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy5oYWlyTWl4MiA9IG0yO1xyXG5cdFx0XHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHRcdFx0c2xvdHMuaGFpckNvbG9yMiA9IGMyO1xyXG5cdFx0XHRcdFx0XHRcdHNsb3RzLmhhaXJNaXgyID0gbTI7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0aWYgKGgzICYmIGgzLmluZGV4T2YoXCIlXCIpID49IDApIHtcclxuXHRcdFx0XHRcdFx0XHRsZXQgaGMgPSBoMy5zcGxpdChcIiVcIik7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYzMgPSBoY1swXTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBtMyA9IGhjWzFdIC8gMTAwO1xyXG5cdFx0XHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy5oYWlyMyA9IGMzO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cuaGFpck1peDMgPSBtMztcclxuXHRcdFx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0XHRcdHNsb3RzLmhhaXJDb2xvcjMgPSBoY1swXTtcclxuXHRcdFx0XHRcdFx0XHRzbG90cy5oYWlyTWl4NCA9IGhjWzFdIC8gMTAwO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAoY2F0ZS5zbG90ID09IFwid2VhcG9uXCIpIHtcclxuXHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cud2VhcG9uVHlwZSA9IHNzWzFdO1xyXG5cdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy53ZWFwb24gPSBpZDtcclxuXHRcdFx0XHRcdHRoaXMudXNlLmFwcGx5KHRoaXMsIHNzLCBzc1sxXSk7Ly90aGlzLnVzZShzc1swXSwgc3NbMV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRpZiAoTnVtYmVyLmlzRmluaXRlKHBhcnNlSW50KHYsIDEwKSkpIHtcclxuXHRcdFx0XHRcdGxldCBpZCA9IHYudHJpbSgpLnBhZFN0YXJ0KDgsIDApO1xyXG5cdFx0XHRcdFx0dGhpcy51c2UoaWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdHlwZSB7c3RyaW5nfSBjb2xcclxuXHQgKi9cclxuXHRnZXQgaGFpckNvbG9yKCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGFpcikge1xyXG5cdFx0XHRyZXR1cm4gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldEhhaXJDb2xvcih0aGlzLnNsb3RzLmhhaXIuaWQpO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFwiMFwiO1xyXG5cdH1cclxuXHRzZXQgaGFpckNvbG9yKGNvbCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGFpciAmJiBjb2wgIT0gdGhpcy5oYWlyQ29sb3IpIHtcclxuXHRcdFx0bGV0IGlkID0gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldENvbG9ySGFpcklEKHRoaXMuc2xvdHMuaGFpci5pZCwgY29sKTtcclxuXHRcdFx0dGhpcy51c2UoaWQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGNvbFxyXG5cdCAqL1xyXG5cdGdldCBmYWNlQ29sb3IoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5mYWNlKSB7XHJcblx0XHRcdHJldHVybiBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0RmFjZUNvbG9yKHRoaXMuc2xvdHMuZmFjZS5pZCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gXCIwXCI7XHJcblx0fVxyXG5cdHNldCBmYWNlQ29sb3IoY29sKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5mYWNlICYmIGNvbCAhPSB0aGlzLmZhY2VDb2xvcikge1xyXG5cdFx0XHRsZXQgaWQgPSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0Q29sb3JGYWNlSUQodGhpcy5zbG90cy5mYWNlLmlkLCBjb2wpO1xyXG5cdFx0XHR0aGlzLnVzZShpZCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckNoYW5nZUxvZ30gY2hhbmdlTG9nXHJcblx0ICovXHJcblx0Y29tbWl0Q2hhbmdlKGNoYW5nZUxvZykge1xyXG5cdFx0aWYgKGNoYW5nZUxvZy5lYXIpIHtcclxuXHRcdFx0dGhpcy5lYXIgPSBjaGFuZ2VMb2cuZWFyO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnVzZUVxdWlwKSB7XHJcblx0XHRcdGZvciAobGV0IGlkIG9mIHRoaXMudXNlRXF1aXApIHtcclxuXHRcdFx0XHR0aGlzLnVzZShpZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy51bnVzZUVxdWlwKSB7XHJcblx0XHRcdGZvciAobGV0IGlkIG9mIHRoaXMudW51c2VFcXVpcCkge1xyXG5cdFx0XHRcdHRoaXMudW51c2UoaWQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNoYW5nZUxvZy5oYWlyMiAmJiBjaGFuZ2VMb2cuaGFpck1peDIpIHtcclxuXHRcdFx0dGhpcy5zbG90cy5oYWlyQ29sb3IyID0gY2hhbmdlTG9nLmhhaXIyO1xyXG5cdFx0XHR0aGlzLnNsb3RzLmhhaXJNaXgyID0gY2hhbmdlTG9nLmhhaXJNaXgyO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChjaGFuZ2VMb2cuaGFpcjMgJiYgY2hhbmdlTG9nLmhhaXJNaXgzKSB7XHJcblx0XHRcdC8vdGhpcy5zbG90cy5oYWlyQ29sb3IzID0gY2hhbmdlTG9nLmhhaXIzO1xyXG5cdFx0XHQvL3RoaXMuc2xvdHMuaGFpck1peDMgPSBjaGFuZ2VMb2cuaGFpck1peDM7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmIChjaGFuZ2VMb2cud2VhcG9uICYmIGNoYW5nZUxvZy53ZWFwb25UeXBlKSB7XHJcblx0XHRcdHRoaXMudXNlKGNoYW5nZUxvZy53ZWFwb24sIGNoYW5nZUxvZy53ZWFwb25UeXBlKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdF9zdHJpbmdpZnkoZ2VuQ29kZSkge1xyXG5cdFx0bGV0IHJlc3VsdCA9IHRoaXMuc2xvdHMuX3N0cmluZ2lmeSgpO1xyXG5cdFx0aWYgKGdlbkNvZGUpIHtcclxuXHRcdFx0cmV0dXJuIGBjaGFyYS5fcGFyc2UoJyR7cmVzdWx0fScpYDtcclxuXHRcdH1cclxuXHRcdHJldHVybiByZXN1bHQ7XHJcblx0fVxyXG5cclxuXHRfb3V0bGlua19vbGQoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5ib2R5ICYmIHRoaXMuc2xvdHMuYm9keS5pZCAmJiB0aGlzLnNsb3RzLmZhY2UgJiYgdGhpcy5zbG90cy5mYWNlLmlkICYmIHRoaXMuYWN0aW9uICYmIHRoaXMuZW1vdGlvbikge1xyXG5cdFx0XHRsZXQgbGluayA9IFwiaHR0cHM6Ly9tYXBsZXN0b3J5LmlvL2FwaS9HTVMvbGF0ZXN0L2NoYXJhY3Rlci9jZW50ZXIvXCIgKyB0aGlzLnNsb3RzLmJvZHkuaWQgKyBcIi9cIjtcclxuXHRcdFx0bGV0IHNsb3RzID0gWy4uLnRoaXMuc2xvdHMuZW51bWVyYXRlKCldLm1hcChhID0+IHBhcnNlSW50KGEuaWQsIDEwKSk7XHJcblxyXG5cdFx0XHRzbG90c1swXSA9IHRoaXMuc2xvdHMuZmFjZS5pZCArIFwiOlwiICsgdGhpcy5lbW90aW9uO1xyXG5cclxuXHRcdFx0bGluayArPSBzbG90cy5qb2luKFwiLFwiKTtcclxuXHJcblx0XHRcdGxpbmsgKz0gXCIvXCIgKyB0aGlzLmFjdGlvbiArIFwiP3Nob3dlYXJzPVwiICsgKHRoaXMuZWxmRWFyID8gXCJ0cnVlXCIgOiBcImZhbHNlXCIpO1xyXG5cclxuXHRcdFx0bGluayArPSBcIiZzaG93TGVmRWFycz1cIiArICh0aGlzLmxlZkVhciA/IFwidHJ1ZVwiIDogXCJmYWxzZVwiKTtcclxuXHJcblx0XHRcdHJldHVybiBsaW5rO1xyXG5cdFx0fVxyXG5cdFx0Y29uc29sZS5sb2coXCJjaGFyYWN0ZXIgbmVlZCBib2R5LCBmYWNlLCBhY3Rpb24sIGVtb3Rpb25cIik7XHJcblx0fVxyXG5cdFxyXG5cdF9vdXRsaW5rKG5hbWUpIHtcclxuXHRcdGNvbnN0IGFuaW1hdGlvbk5hbWUgPSB0aGlzLmFjdGlvbjtcclxuXHRcdGNvbnN0IGZyYW1lID0gdGhpcy5hY3Rpb25fZnJhbWU7XHJcblx0XHRjb25zdCBzbG90cyA9IHRoaXMuc2xvdHM7XHJcblx0XHRjb25zdCBpdGVtTGlzdCA9IG1ha2VJdGVtTGlzdC5jYWxsKCk7XHJcblx0XHRyZXR1cm4gXCJodHRwczovL21hcGxlc3RvcnkuaW8vYXBpL2NoYXJhY3Rlci9cIiArXHJcblx0XHRcdFx0aXRlbUxpc3QgKyAgICAvLyBub3QgYXJyYXlcclxuXHRcdFx0XHRcIi9cIiArIGFuaW1hdGlvbk5hbWUgKyBcIi9cIiArIGZyYW1lICsgXCI/XCIgK1xyXG5cdFx0XHRcdFwic2hvd2VhcnM9XCIgKyB0aGlzLmVsZkVhciArXHJcblx0XHRcdFx0XCImc2hvd0xlZkVhcnM9XCIgKyB0aGlzLmxlZkVhciArXHJcblx0XHRcdFx0XCImcmVzaXplPTFcIiArXHJcblx0XHRcdFx0KG5hbWUgPyAoXCImbmFtZT1cIiArIG5hbWUpIDogXCJcIikgK1xyXG5cdFx0XHRcdFwiJmZsaXBYPVwiICsgQm9vbGVhbih0aGlzLmZyb250ID4gMCkgK1xyXG5cdFx0XHRcdFwiJmJnQ29sb3I9MCwwLDAsMFwiO1xyXG5cdFx0ZnVuY3Rpb24gbWFrZUl0ZW1MaXN0KCkge1xyXG5cdFx0XHRyZXR1cm4gT2JqZWN0LnZhbHVlcyhzbG90cykuZmlsdGVyKGEgPT4gYSkubWFwKGl0ZW0gPT4ge1xyXG5cdFx0XHRcdHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoSlNPTi5zdHJpbmdpZnkoaXRlbS50b0pTT04oYW5pbWF0aW9uTmFtZSkpKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdF9kb3dubG9hZCgpIHtcclxuXHRcdHdpbmRvdy5vcGVuKHRoaXMuX291dGxpbmsoKSk7XHJcblx0fVxyXG5cclxuXHRfc2F2ZV9hc19zdmcocmVuZGVyZXIsIGZpbGVuYW1lKSB7XHJcblx0XHR0aGlzLl9fdGV4dHVyZV90b19iYXNlNjQoKS50aGVuKGZyYWdfbGlzdCA9PiB7XHJcblx0XHRcdGxldCBmaWxlX25hbWUgPSBgJHtmaWxlbmFtZSA/IChmaWxlbmFtZStcIi5cIik6XCJcIn0ke3RoaXMuYWN0aW9ufVske3RoaXMuYWN0aW9uX2ZyYW1lfV0uJHt0aGlzLmVtb3Rpb259WyR7dGhpcy5lbW90aW9uX2ZyYW1lfV0uc3ZnYDtcclxuXHRcdFx0bGV0IGJvdW5kID0gdGhpcy5jYWxjQm91bmRCb3goKTtcclxuXHRcdFx0bGV0IHNpemUgPSBib3VuZC5zaXplO1xyXG5cdFx0XHRsZXQgW2N4LCBjeV0gPSBbLWJvdW5kLmxlZnQsIGJvdW5kLmhlaWdodF07XHJcblx0XHJcblx0XHRcdGxldCBzdmcgPSAnPCFET0NUWVBFIHN2ZyBQVUJMSUMgXCItLy9XM0MvL0RURCBTVkcgMS4xLy9FTlwiIFwiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkXCIgPic7XHJcblxyXG5cdFx0XHRzdmcgKz0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHhtbG5zOnhsaW5rPSBcImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmtcIiB3aWR0aD1cIiR7c2l6ZS54fVwiIGhlaWdodD1cIiR7c2l6ZS55fVwiPlxcbmA7XHJcblxyXG5cdFx0XHRzdmcgKz0gYDxnIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSgke2N4fSwgJHtjeX0pXCI+YDtcclxuXHRcdFx0ZnJhZ19saXN0LmZvckVhY2goZnVuY3Rpb24gKGZ0KSB7XHJcblx0XHRcdFx0aWYgKGZ0ICYmIGZ0LnJlbGF0aXZlKSB7XHJcblx0XHRcdFx0XHRsZXQgY2x6ID0gZnQuY2xhc3NMaXN0O1xyXG5cdFx0XHRcdFx0c3ZnICs9IGBcXHQ8aW1hZ2UgY2xhc3M9XCIke2Nsen1cIiBvcGFjaXR5PVwiJHtmdC52aXNpYmxlID8gZnQub3BhY2l0eSA6IDB9XCIgeD1cIiR7ZnQucmVsYXRpdmUueH1cIiB5PVwiJHtmdC5yZWxhdGl2ZS55fVwiIHdpZHRoPVwiJHtmdC53aWR0aH1cIiBoZWlnaHQ9XCIke2Z0LmhlaWdodH1cIiB4bGluazpocmVmPVwiJHtmdC5fdXJsfVwiPjwvaW1hZ2U+XFxuYDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRzdmcgKz0gJzwvZz4nO1xyXG5cclxuXHRcdFx0c3ZnICs9ICc8dGV4dCB4PVwiMFwiIHk9XCIxMjJcIiBmaWxsPVwidHJhbnNwYXJlbnRcIj4nICsgdGhpcy5fc3RyaW5naWZ5KGZhbHNlKSArICc8L3RleHQ+JztcclxuXHRcdFx0c3ZnICs9ICc8dGV4dCB4PVwiMFwiIHk9XCIxNDRcIiBmaWxsPVwidHJhbnNwYXJlbnRcIj4nICsgSlNPTi5zdHJpbmdpZnkodGhpcykgKyAnPC90ZXh0Pic7XHJcblxyXG5cdFx0XHRzdmcgKz0gJzwvc3ZnPic7XHJcblxyXG5cdFx0XHQvL2xldCB1cmwgPSBcImRhdGE6dGV4dC9wbGFpbjt1dGY4LFwiICsgc3ZnO1xyXG5cclxuXHRcdFx0ZGVidWdnZXI7XHJcblxyXG5cdFx0XHQvL3dpbmRvdy5vcGVuKHVybCk7XHJcblx0XHRcdERvd25sb2FkRGF0YShzdmcsIFwiaW1hZ2Uvc3ZnK3htbDt1dGY4XCIsIGZpbGVfbmFtZSk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LFsuLi5dXCJcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZmlsZW5hbWVcclxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG5cdCAqL1xyXG5cdF9zYXZlX2FzX3BuZyhyZW5kZXJlciwgZmlsZW5hbWUpIHtcclxuXHRcdGxldCBib3VuZCA9IHRoaXMuX2NhbGNCb3VuZEJveCgpO1xyXG5cdFx0bGV0IHNpemUgPSBib3VuZC5zaXplO1xyXG5cdFx0bGV0IFt4LCB5XSA9IFstYm91bmQubGVmdCwgYm91bmQuaGVpZ2h0XTtcclxuXHRcdGxldCBhbmdsZSA9IDA7XHJcblx0XHRsZXQgZnJvbnQgPSBmYWxzZTtcclxuXHJcblx0XHQvLyB1c2UgQ2FudmFzMiwgbXVzdCBub3QgZmFpbFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmVuZGVyZXIuJHN3YXBDYW52YXMoKTtcclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGV4KTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vc2F2ZSBDYW52YXMyIHNpemUsIGN1cnJlbnQgY3R4IGlzIF9jdHgyXHJcblx0XHRjb25zdCBjMncgPSByZW5kZXJlci5fY3R4Mi5jYW52YXMud2lkdGg7XHJcblx0XHRjb25zdCBjMmggPSByZW5kZXJlci5fY3R4Mi5jYW52YXMuaGVpZ2h0O1xyXG5cdFx0Ly9cclxuXHRcdHJlbmRlcmVyLmN0eC5jYW52YXMud2lkdGggPSBzaXplLng7XHJcblx0XHRyZW5kZXJlci5jdHguY2FudmFzLmhlaWdodCA9IHNpemUueTtcclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHR0aGlzLl9kcmF3KHJlbmRlcmVyLCB4LCB5LCBhbmdsZSwgZnJvbnQpO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXgpO1xyXG5cdFx0XHQvLyBub3RoaW5nXHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IGJhc2U2NCA9IHJlbmRlcmVyLmN0eC5jYW52YXMudG9EYXRhVVJMKFwiaW1hZ2UvcG5nXCIpO1xyXG5cdFx0e1xyXG5cdFx0XHRsZXQgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpO1xyXG5cclxuXHRcdFx0bGV0IG5hbWUgPSBgJHtmaWxlbmFtZSA/IChmaWxlbmFtZStcIi5cIik6XCJcIn0ke3RoaXMuYWN0aW9ufVske3RoaXMuYWN0aW9uX2ZyYW1lfV0uJHt0aGlzLmVtb3Rpb259WyR7dGhpcy5lbW90aW9uX2ZyYW1lfV0ucG5nYDtcclxuXHJcblx0XHRcdGVsZW0uaWQgPSBuYW1lO1xyXG5cdFx0XHRlbGVtLmRvd25sb2FkID0gbmFtZTtcclxuXHRcdFx0ZWxlbS5ocmVmID0gYmFzZTY0O1xyXG5cclxuXHRcdFx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtKTtcclxuXHRcdFx0ZWxlbS5jbGljaygpO1xyXG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGVsZW0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vcmVzdG9yZSBDYW52YXMyIHNpemUsIGN1cnJlbnQgY3R4IGlzIF9jdHgyXHJcblx0XHRyZW5kZXJlci5jdHguY2FudmFzLndpZHRoID0gYzJ3O1xyXG5cdFx0cmVuZGVyZXIuY3R4LmNhbnZhcy5oZWlnaHQgPSBjMmg7XHJcblxyXG5cdFx0Ly8gcmVzdG9yZSBDYW52YXMsIG11c3Qgbm90IGZhaWxcclxuXHRcdHRyeSB7XHJcblx0XHRcdHJlbmRlcmVyLiRzd2FwQ2FudmFzKCk7XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRcdC8vIG5vdGhpbmdcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gYmFzZTY0O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHJldHVybnMge1Byb21pc2U8RnJhZ21lbnRUZXh0dXJlW10+fVxyXG5cdCAqL1xyXG5cdGFzeW5jIF9fdGV4dHVyZV90b19iYXNlNjQoKSB7XHJcblx0XHRsZXQgZnJhZ19saXN0ID0gdGhpcy5fX2ZyYWdfbGlzdDtcclxuXHRcdGxldCB0YXNrcyA9IFtdO1xyXG5cclxuXHRcdGZyYWdfbGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChmdCkge1xyXG5cdFx0XHRpZiAoIWZ0KSB7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICghZnQuX3VybC5zdGFydHNXaXRoKFwiZGF0YTpcIikpIHtcclxuXHRcdFx0XHR0YXNrcy5wdXNoKChhc3luYyBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0XHQvL2Z0LnRleHR1cmUuJHNyYyA9IGZ0Ll91cmw7XHJcblx0XHRcdFx0XHRmdC5fdXJsID0gYXdhaXQgdG9EYXRhVVJMKGZ0LnRleHR1cmUuc3JjKTtcclxuXHRcdFx0XHRcdHJldHVybiBmdDtcclxuXHRcdFx0XHR9KSgpKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0YXNrcy5wdXNoKGZ0KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoZnQuZ3JhcGgyKSB7XHJcblx0XHRcdFx0bGV0IHNyYyA9IGZ0LmdyYXBoMi50ZXh0dXJlLnNyYztcclxuXHRcdFx0XHRpZiAoIXNyYy5zdGFydHNXaXRoKFwiZGF0YTpcIikpIHtcclxuXHRcdFx0XHRcdHRhc2tzLnB1c2goKGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdFx0Ly9mdC50ZXh0dXJlLiRzcmMgPSBmdC5fdXJsO1xyXG5cdFx0XHRcdFx0XHRmdC5ncmFwaDIuX3VybCA9IGF3YWl0IHRvRGF0YVVSTChzcmMpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZnQuZ3JhcGgyO1xyXG5cdFx0XHRcdFx0fSkoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0dGFza3MucHVzaChmdC5ncmFwaDIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoZnQuZ3JhcGgzKSB7XHJcblx0XHRcdFx0bGV0IHNyYyA9IGZ0LmdyYXBoMy50ZXh0dXJlLnNyYztcclxuXHRcdFx0XHRpZiAoIXNyYy5zdGFydHNXaXRoKFwiZGF0YTpcIikpIHtcclxuXHRcdFx0XHRcdHRhc2tzLnB1c2goKGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdFx0Ly9mdC50ZXh0dXJlLiRzcmMgPSBmdC5fdXJsO1xyXG5cdFx0XHRcdFx0XHRmdC5ncmFwaDMuX3VybCA9IGF3YWl0IHRvRGF0YVVSTChzcmMpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZnQuZ3JhcGgzO1xyXG5cdFx0XHRcdFx0fSkoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0dGFza3MucHVzaChmdC5ncmFwaDMpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cmV0dXJuIFByb21pc2UuYWxsKHRhc2tzKTtcclxuXHR9XHJcbn1cclxuQWRkSW5pdFRhc2soQ2hhcmFjdGVyUmVuZGVyZXIuSW5pdCk7XHJcblxyXG5mdW5jdGlvbiogY2lyY3VsYXJTZXF1ZW5jZShsZW5ndGgsIHN0YXJ0PTApIHtcclxuXHRsZXQgaSA9IHN0YXJ0O1xyXG5cdGZvciAoOyBpIDwgbGVuZ3RoOyArK2kpIHsvL2E6IDAsIDEsIDIsIDMsIC4uLmJcclxuXHRcdHlpZWxkIGk7XHJcblx0fVxyXG5cdGZvciAoaSAtPSAyOyBpID4gMDsgLS1pKSB7Ly9iOiAyLCAxLCAuLi5hXHJcblx0XHR5aWVsZCBpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24qIGxpbmVhclNlcXVlbmNlKGxlbmd0aCwgc3RhcnQ9MCkge1xyXG5cdGZvciAobGV0IGkgPSBzdGFydDsgaSA8IGxlbmd0aDsgKytpKSB7XHJcblx0XHR5aWVsZCBpO1xyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gZXh0cmFjdF9udW1iZXIoaW5wdXQpIHtcclxuXHRyZXR1cm4gU3RyaW5nKGlucHV0KS5tYXRjaCgvKC0/XFxkK1xcLj9cXGQqKXwoXFwuXFxkKikvZyk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBpbWFnZSBocmVmIHRvIGRhdGEgdXJsXHJcbiAqL1xyXG5mdW5jdGlvbiB0b0RhdGFVUkwodXJsKSB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuXHRcdGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHRcdHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdGxldCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xyXG5cdFx0XHRyZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdHJlc29sdmUocmVhZGVyLnJlc3VsdCk7XHJcblx0XHRcdH1cclxuXHRcdFx0cmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbiAoZXYpIHtcclxuXHRcdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0XHRyZWplY3QoZXYpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJlYWRlci5yZWFkQXNEYXRhVVJMKHhoci5yZXNwb25zZSk7XHJcblx0XHR9O1xyXG5cdFx0eGhyLm9wZW4oJ0dFVCcsIHVybCk7XHJcblx0XHR4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InO1xyXG5cdFx0eGhyLnNlbmQoKTtcclxuXHR9KTtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///336\n')},347:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return SpriteBase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Sprite; });\n/* unused harmony export _$PatternSprite_Loaded */\n/* unused harmony export $PatternSprite */\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(332);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(333);\n/* harmony import */ var _Engine_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(335);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @extends {IGraph}\r\n */\r\nclass SpriteBase extends _Engine_js__WEBPACK_IMPORTED_MODULE_2__["Graph"] {\r\n\t/**\r\n\t * @param {!any} raw\r\n\t * @param {string=} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tif (raw) {\r\n\t\t\tsuper(url, {\r\n\t\t\t\twidth: raw.__w,\r\n\t\t\t\theight: raw.__h,\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsuper();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._raw = raw;\r\n\t\t\r\n\t\t//this.src is broken;\r\n\r\n\t\tif (url) {\r\n\t\t\tdebugger\r\n\t\t\tthis._url = url;\r\n\t\t\t//this._loadTexture(url);//_loadTexture: undefined\r\n\t\t}\r\n\t\telse if (SpriteBase.isTexture(raw) !== false) {\r\n\t\t\tthis._url = raw[""];\r\n\t\t}\r\n\t}\r\n\r\n\tstatic isTexture(raw) {\r\n\t\tif (raw) {\r\n\t\t\tif (raw.hasOwnProperty("")) {\r\n\t\t\t\tif (typeof raw[""] == \'string\') {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!raw.__isEmpty) {\r\n\t\t\t\t\tconsole.group("no texture");\r\n\t\t\t\t\tconsole.warn(raw);\r\n\t\t\t\t\tconsole.groupEnd();\r\n\t\t\t\t\tthrow new Error("no texture");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tstatic isTextureHasData(raw) {\r\n\t\treturn raw && typeof raw[""] == \'string\' && raw[""].startsWith("data:image/");\r\n\t}\r\n\r\n\tset z(value) {\r\n\t\tthis._order = value;\r\n\t}\r\n\tget z() {\r\n\t\treturn this._order;\r\n\t}\r\n\t\r\n\t/**\r\n\t * try construct value from raw data\r\n\t * @param {T} defaultValue\r\n\t * @param {string} propertyName\r\n\t * @param {function(any):T} constructor\r\n\t * @returns {T}\r\n\t * @template T\r\n\t */\r\n\t_get(defaultValue, propertyName, converter) {\r\n\t\tif (!this._raw) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\telse if (propertyName in this._raw) {\r\n\t\t\treturn converter(this._raw[propertyName]);\r\n\t\t}\r\n\t\treturn defaultValue;\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tthis._engine.drawGraph(this);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tdraw2(x, y) {\r\n\t\tthis._engine.drawGraph2(this, x - this.x, y - this.y);\r\n\t}\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t */\r\n\tdraw2i(x, y) {\r\n\t\tthis._engine.drawGraph2(this, Math.trunc(x - this.x + 0.5), Math.trunc(y - this.y + 0.5));\r\n\t}\r\n}\r\n\r\n\r\nclass Sprite extends SpriteBase {\r\n\t/**\r\n\t * sprite = new Sprite(rawData);//不會載入image\r\n\t * sprite._url = img_url;//不會載入image\r\n\t *\r\n\t * 會觸發載入image的method\r\n\t * draw(), isLoaded(), get width(), get height()\r\n\t * \r\n\t * 手動載入image: __loadTexture()\r\n\t * \r\n\t * @param {!any} raw\r\n\t * @param {string=} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\r\n\t\tvar origin = this._get(new _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"](0, 0), "origin", _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"].get);\r\n\t\tthis.x = origin.x;\r\n\t\tthis.y = origin.y;\r\n\r\n\t\tthis.z = this._get(0, "z", Number);\r\n\r\n\t\tthis.delay = this._get(100, "delay", Number);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern(x, y, w, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.rect(x, y, w, h);\r\n\t\t\tctx.clip();\r\n\r\n\t\t\tlet left = x;\r\n\t\t\tlet top = y;\r\n\t\t\tlet right = x + w;\r\n\t\t\tlet bottom = y + h;\r\n\r\n\t\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\t\t\tthis.draw2(j, i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t */\r\n\tdrawHorizontalPattern(x, y, w) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tconst left = x;\r\n\t\t\tconst right = x + w;\r\n\r\n\t\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\t\tthis.draw2(j, y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} h\r\n\t */\r\n\tdrawVerticalPattern(x, y, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tconst top = y;\r\n\t\t\tconst bottom = y + h;\r\n\r\n\t\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\t\tthis.draw2(x, i);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\t_drawPattern(x, y, w, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t\r\n\t\tconst sw = Math.trunc(w / this.width) * this.width;\r\n\t\tconst sh = Math.trunc(h / this.height) * this.height;\r\n\t\t\r\n\t\tconst left = x;\r\n\t\tconst top = y;\r\n\t\tconst right = x + sw;\r\n\t\tconst bottom = y + h;\r\n\r\n\t\tlet i, j;\r\n\r\n\t\tif (h >= this.height) {\r\n\t\t\tfor (i = top; i < bottom; i += this.height) {\r\n\t\t\t\tif (w >= this.width) {\r\n\t\t\t\t\tfor (j = left; j < right; j += this.width) {\r\n\t\t\t\t\t\tthis.draw2(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet sx = w - sw;\r\n\t\t\t\t\tif (sx > 0) {\r\n\t\t\t\t\t\tthis._engine._drawImage(this, 0, 0, sx, this.height, j - this.x, i - this.y, sx, this.height);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._engine._drawImage(this, 0, 0, w, this.height, left - this.x, i - this.y, w, this.height);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet sy = h - sh;\r\n\t\t\tif (sy > 0) {\r\n\t\t\t\tconsole.error(new Error("未完成"));\r\n\t\t\t\tthis._engine._drawImage(this, 0, 0, this.width, sy, left - this.x, i - this.y, this.width, sy);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.error(new Error("未完成"));\r\n\t\t\tthis._engine._drawImage(this, 0, 0, this.width, h, left - this.x, top - this.y, this.width, h);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t */\r\n\t_drawHorizontalPattern(x, y, w) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tconst left = x;\r\n\t\tconst right = x + w;\r\n\r\n\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\tthis.draw2(j, y);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} h\r\n\t */\r\n\t_drawVerticalPattern(x, y, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tconst top = y;\r\n\t\tconst bottom = y + h;\r\n\r\n\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\tthis.draw2(x, i);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\tdrawPattern4i(x, y, w, h) {\r\n\t\tthis.drawPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t */\r\n\tdrawHorizontalPattern3i(x, y, w) {\r\n\t\tthis.drawHorizontalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5));\r\n\t}\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\tdrawVerticalPattern3i(x, y, h) {\r\n\t\tthis.drawVerticalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\t_drawPattern4i(x, y, w, h) {\r\n\t\tthis._drawPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t */\r\n\t_drawHorizontalPattern3i(x, y, w) {\r\n\t\tthis._drawHorizontalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5));\r\n\t}\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\t_drawVerticalPattern3i(x, y, h) {\r\n\t\tthis._drawVerticalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n}\r\n\r\nclass _$PatternSprite_Loaded extends Sprite {\r\n\t/**\r\n\t * @param {!any} raw\r\n\t * @param {string=} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._direction = null;\r\n\r\n\t\t/** @type {CanvasPattern} */\r\n\t\tthis._pattern = null;\r\n\t}\r\n\r\n\t/** @type {string} */\r\n\tget direction() {\r\n\t\treturn this._direction;\r\n\t}\r\n\tset direction(value) {\r\n\t\tif (value && this._direction != value) {\r\n\t\t\tthis._direction = value;\r\n\t\r\n\t\t\t//reload;\r\n\t\t\tthis._pattern = null;\r\n\t\t\tthis.__proto__ = $PatternSprite.prototype;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern(w, h) {\r\n\t\tif (this.direction && this._pattern) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tctx.rect(-this.x, -this.y, w, h);\r\n\t\t\tctx.fillStyle = this._pattern;\r\n\t\t\tctx.fill();\r\n\t\t\tctx.fillStyle = "no-repeat";\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern2(x, y, w, h) {\r\n\t\tif (this.direction && this._pattern) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tctx.rect(x - this.x, y - this.y, w, h);\r\n\t\t\tctx.fillStyle = this._pattern;\r\n\t\t\tctx.fill();\r\n\t\t\tctx.fillStyle = "no-repeat";\r\n\t\t}\r\n\t}\r\n\r\n\t/** @returns {"repeat"} */\r\n\tget e_repeat() {\r\n\t\treturn "repeat";\r\n\t}\r\n\t/** @returns {"repeat-x"} */\r\n\tget e_repeat_x() {\r\n\t\treturn "repeat-x";\r\n\t}\r\n\t/** @returns {"repeat-y"} */\r\n\tget e_repeat_y() {\r\n\t\treturn "repeat-y";\r\n\t}\r\n\t/** @returns {"no-repeat"} */\r\n\tget e_noRepeat() {\r\n\t\treturn "no-repeat";\r\n\t}\r\n}\r\n\r\nclass $PatternSprite extends _$PatternSprite_Loaded {\r\n\tdrawPattern(w, h) {\r\n\t\tthis.drawPattern2(0, 0, w, h);\r\n\t}\r\n\tdrawPattern2(x, y, w, h) {\r\n\t\tif (this.isLoaded()) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\t\tctx.save();\r\n\t\t\t{\r\n\t\t\t\tctx.rect(x, y, w, h);\r\n\t\t\t\tctx.clip();\r\n\t\t\t\t\r\n\t\t\t\tlet left = x;\r\n\t\t\t\tlet top = y;\r\n\t\t\t\tlet right = x + w;\r\n\t\t\t\tlet bottom = y + h;\r\n\r\n\t\t\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\t\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\t\t\t\tthis.draw2(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern(w, h) {\r\n\t\tif (this.direction) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tif (!this._pattern) {\r\n\t\t\t\tif (this.isLoaded()) {\r\n\t\t\t\t\tthis._pattern = ctx.createPattern(this.texture, this.direction);\r\n\t\t\t\t\tthis.__proto__ = _$PatternSprite_Loaded.prototype;\r\n\t\t\t\t\tthis.drawPattern(w, h);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern2(x, y, w, h) {\r\n\t\tif (this.direction) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tif (!this._pattern) {\r\n\t\t\t\tif (this.isLoaded()) {\r\n\t\t\t\t\tthis._pattern = ctx.createPattern(this.texture, this.direction);\r\n\t\t\t\t\tthis.__proto__ = _$PatternSprite_Loaded.prototype;\r\n\t\t\t\t\tthis.drawPattern2(x, y, w, h);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQ3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvU3ByaXRlLmpzPzA3NzQiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCB7IFZlYzIsIFJlY3RhbmdsZSB9IGZyb20gXCIuL21hdGguanNcIjtcclxuaW1wb3J0IHsgSUdycGFoLCBJUmVuZGVyZXIsIElHcmFwaCB9IGZyb20gXCIuL0lSZW5kZXJlci5qc1wiO1xyXG5cclxuaW1wb3J0IHsgZW5naW5lLCBHcmFwaCB9IGZyb20gXCIuL0VuZ2luZS5qc1wiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBAZXh0ZW5kcyB7SUdyYXBofVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNwcml0ZUJhc2UgZXh0ZW5kcyBHcmFwaCB7XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHshYW55fSByYXdcclxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHVybFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHRpZiAocmF3KSB7XHJcblx0XHRcdHN1cGVyKHVybCwge1xyXG5cdFx0XHRcdHdpZHRoOiByYXcuX193LFxyXG5cdFx0XHRcdGhlaWdodDogcmF3Ll9faCxcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0c3VwZXIoKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3JhdyA9IHJhdztcclxuXHRcdFxyXG5cdFx0Ly90aGlzLnNyYyBpcyBicm9rZW47XHJcblxyXG5cdFx0aWYgKHVybCkge1xyXG5cdFx0XHRkZWJ1Z2dlclxyXG5cdFx0XHR0aGlzLl91cmwgPSB1cmw7XHJcblx0XHRcdC8vdGhpcy5fbG9hZFRleHR1cmUodXJsKTsvL19sb2FkVGV4dHVyZTogdW5kZWZpbmVkXHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChTcHJpdGVCYXNlLmlzVGV4dHVyZShyYXcpICE9PSBmYWxzZSkge1xyXG5cdFx0XHR0aGlzLl91cmwgPSByYXdbXCJcIl07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgaXNUZXh0dXJlKHJhdykge1xyXG5cdFx0aWYgKHJhdykge1xyXG5cdFx0XHRpZiAocmF3Lmhhc093blByb3BlcnR5KFwiXCIpKSB7XHJcblx0XHRcdFx0aWYgKHR5cGVvZiByYXdbXCJcIl0gPT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRpZiAoIXJhdy5fX2lzRW1wdHkpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUuZ3JvdXAoXCJubyB0ZXh0dXJlXCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKHJhdyk7XHJcblx0XHRcdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJubyB0ZXh0dXJlXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRzdGF0aWMgaXNUZXh0dXJlSGFzRGF0YShyYXcpIHtcclxuXHRcdHJldHVybiByYXcgJiYgdHlwZW9mIHJhd1tcIlwiXSA9PSAnc3RyaW5nJyAmJiByYXdbXCJcIl0uc3RhcnRzV2l0aChcImRhdGE6aW1hZ2UvXCIpO1xyXG5cdH1cclxuXHJcblx0c2V0IHoodmFsdWUpIHtcclxuXHRcdHRoaXMuX29yZGVyID0gdmFsdWU7XHJcblx0fVxyXG5cdGdldCB6KCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX29yZGVyO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiB0cnkgY29uc3RydWN0IHZhbHVlIGZyb20gcmF3IGRhdGFcclxuXHQgKiBAcGFyYW0ge1R9IGRlZmF1bHRWYWx1ZVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eU5hbWVcclxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9uKGFueSk6VH0gY29uc3RydWN0b3JcclxuXHQgKiBAcmV0dXJucyB7VH1cclxuXHQgKiBAdGVtcGxhdGUgVFxyXG5cdCAqL1xyXG5cdF9nZXQoZGVmYXVsdFZhbHVlLCBwcm9wZXJ0eU5hbWUsIGNvbnZlcnRlcikge1xyXG5cdFx0aWYgKCF0aGlzLl9yYXcpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChwcm9wZXJ0eU5hbWUgaW4gdGhpcy5fcmF3KSB7XHJcblx0XHRcdHJldHVybiBjb252ZXJ0ZXIodGhpcy5fcmF3W3Byb3BlcnR5TmFtZV0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlZmF1bHRWYWx1ZTtcclxuXHR9XHJcblxyXG5cdGRyYXcoKSB7XHJcblx0XHR0aGlzLl9lbmdpbmUuZHJhd0dyYXBoKHRoaXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqL1xyXG5cdGRyYXcyKHgsIHkpIHtcclxuXHRcdHRoaXMuX2VuZ2luZS5kcmF3R3JhcGgyKHRoaXMsIHggLSB0aGlzLngsIHkgLSB0aGlzLnkpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geCAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gdHlwZTogaW50XHJcblx0ICovXHJcblx0ZHJhdzJpKHgsIHkpIHtcclxuXHRcdHRoaXMuX2VuZ2luZS5kcmF3R3JhcGgyKHRoaXMsIE1hdGgudHJ1bmMoeCAtIHRoaXMueCArIDAuNSksIE1hdGgudHJ1bmMoeSAtIHRoaXMueSArIDAuNSkpO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBTcHJpdGUgZXh0ZW5kcyBTcHJpdGVCYXNlIHtcclxuXHQvKipcclxuXHQgKiBzcHJpdGUgPSBuZXcgU3ByaXRlKHJhd0RhdGEpOy8v5LiN5pyD6LyJ5YWlaW1hZ2VcclxuXHQgKiBzcHJpdGUuX3VybCA9IGltZ191cmw7Ly/kuI3mnIPovInlhaVpbWFnZVxyXG5cdCAqXHJcblx0ICog5pyD6Ke455m86LyJ5YWlaW1hZ2XnmoRtZXRob2RcclxuXHQgKiBkcmF3KCksIGlzTG9hZGVkKCksIGdldCB3aWR0aCgpLCBnZXQgaGVpZ2h0KClcclxuXHQgKiBcclxuXHQgKiDmiYvli5XovInlhaVpbWFnZTogX19sb2FkVGV4dHVyZSgpXHJcblx0ICogXHJcblx0ICogQHBhcmFtIHshYW55fSByYXdcclxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHVybFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHRzdXBlcihyYXcsIHVybCk7XHJcblxyXG5cdFx0dmFyIG9yaWdpbiA9IHRoaXMuX2dldChuZXcgVmVjMigwLCAwKSwgXCJvcmlnaW5cIiwgVmVjMi5nZXQpO1xyXG5cdFx0dGhpcy54ID0gb3JpZ2luLng7XHJcblx0XHR0aGlzLnkgPSBvcmlnaW4ueTtcclxuXHJcblx0XHR0aGlzLnogPSB0aGlzLl9nZXQoMCwgXCJ6XCIsIE51bWJlcik7XHJcblxyXG5cdFx0dGhpcy5kZWxheSA9IHRoaXMuX2dldCgxMDAsIFwiZGVsYXlcIiwgTnVtYmVyKTtcclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGhcclxuXHQgKi9cclxuXHRkcmF3UGF0dGVybih4LCB5LCB3LCBoKSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRyZXR1cm47Ly9zcHJpdGUgcmVxdWlyZSBwcm9wZXJ0eTogd2lkdGgsIGhlaWdodFxyXG5cdFx0fVxyXG5cdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRjb25zdCBjdHggPSB0aGlzLl9lbmdpbmUuY3R4O1xyXG5cclxuXHRcdGN0eC5zYXZlKCk7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjdHgucmVjdCh4LCB5LCB3LCBoKTtcclxuXHRcdFx0Y3R4LmNsaXAoKTtcclxuXHJcblx0XHRcdGxldCBsZWZ0ID0geDtcclxuXHRcdFx0bGV0IHRvcCA9IHk7XHJcblx0XHRcdGxldCByaWdodCA9IHggKyB3O1xyXG5cdFx0XHRsZXQgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gdG9wOyBpIDwgYm90dG9tOyBpICs9IHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgaiA9IGxlZnQ7IGogPCByaWdodDsgaiArPSB0aGlzLndpZHRoKSB7XHJcblx0XHRcdFx0XHR0aGlzLmRyYXcyKGosIGkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXgpO1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdGN0eC5yZXN0b3JlKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHdcclxuXHQgKi9cclxuXHRkcmF3SG9yaXpvbnRhbFBhdHRlcm4oeCwgeSwgdykge1xyXG5cdFx0aWYgKCF0aGlzLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0cmV0dXJuOy8vc3ByaXRlIHJlcXVpcmUgcHJvcGVydHk6IHdpZHRoLCBoZWlnaHRcclxuXHRcdH1cclxuXHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHJcblx0XHRjdHguc2F2ZSgpO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgbGVmdCA9IHg7XHJcblx0XHRcdGNvbnN0IHJpZ2h0ID0geCArIHc7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBqID0gbGVmdDsgaiA8IHJpZ2h0OyBqICs9IHRoaXMud2lkdGgpIHtcclxuXHRcdFx0XHR0aGlzLmRyYXcyKGosIHkpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0fVxyXG5cdFx0Y3R4LnJlc3RvcmUoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHlcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaFxyXG5cdCAqL1xyXG5cdGRyYXdWZXJ0aWNhbFBhdHRlcm4oeCwgeSwgaCkge1xyXG5cdFx0aWYgKCF0aGlzLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0cmV0dXJuOy8vc3ByaXRlIHJlcXVpcmUgcHJvcGVydHk6IHdpZHRoLCBoZWlnaHRcclxuXHRcdH1cclxuXHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHJcblx0XHRjdHguc2F2ZSgpO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgdG9wID0geTtcclxuXHRcdFx0Y29uc3QgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gdG9wOyBpIDwgYm90dG9tOyBpICs9IHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdFx0dGhpcy5kcmF3Mih4LCBpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXgpO1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdGN0eC5yZXN0b3JlKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiB3aXRob3V0IGNsaXBcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHdcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaFxyXG5cdCAqL1xyXG5cdF9kcmF3UGF0dGVybih4LCB5LCB3LCBoKSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRyZXR1cm47Ly9zcHJpdGUgcmVxdWlyZSBwcm9wZXJ0eTogd2lkdGgsIGhlaWdodFxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRjb25zdCBzdyA9IE1hdGgudHJ1bmModyAvIHRoaXMud2lkdGgpICogdGhpcy53aWR0aDtcclxuXHRcdGNvbnN0IHNoID0gTWF0aC50cnVuYyhoIC8gdGhpcy5oZWlnaHQpICogdGhpcy5oZWlnaHQ7XHJcblx0XHRcclxuXHRcdGNvbnN0IGxlZnQgPSB4O1xyXG5cdFx0Y29uc3QgdG9wID0geTtcclxuXHRcdGNvbnN0IHJpZ2h0ID0geCArIHN3O1xyXG5cdFx0Y29uc3QgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0bGV0IGksIGo7XHJcblxyXG5cdFx0aWYgKGggPj0gdGhpcy5oZWlnaHQpIHtcclxuXHRcdFx0Zm9yIChpID0gdG9wOyBpIDwgYm90dG9tOyBpICs9IHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdFx0aWYgKHcgPj0gdGhpcy53aWR0aCkge1xyXG5cdFx0XHRcdFx0Zm9yIChqID0gbGVmdDsgaiA8IHJpZ2h0OyBqICs9IHRoaXMud2lkdGgpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5kcmF3MihqLCBpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxldCBzeCA9IHcgLSBzdztcclxuXHRcdFx0XHRcdGlmIChzeCA+IDApIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5fZW5naW5lLl9kcmF3SW1hZ2UodGhpcywgMCwgMCwgc3gsIHRoaXMuaGVpZ2h0LCBqIC0gdGhpcy54LCBpIC0gdGhpcy55LCBzeCwgdGhpcy5oZWlnaHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuX2VuZ2luZS5fZHJhd0ltYWdlKHRoaXMsIDAsIDAsIHcsIHRoaXMuaGVpZ2h0LCBsZWZ0IC0gdGhpcy54LCBpIC0gdGhpcy55LCB3LCB0aGlzLmhlaWdodCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGxldCBzeSA9IGggLSBzaDtcclxuXHRcdFx0aWYgKHN5ID4gMCkge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IobmV3IEVycm9yKFwi5pyq5a6M5oiQXCIpKTtcclxuXHRcdFx0XHR0aGlzLl9lbmdpbmUuX2RyYXdJbWFnZSh0aGlzLCAwLCAwLCB0aGlzLndpZHRoLCBzeSwgbGVmdCAtIHRoaXMueCwgaSAtIHRoaXMueSwgdGhpcy53aWR0aCwgc3kpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihuZXcgRXJyb3IoXCLmnKrlrozmiJBcIikpO1xyXG5cdFx0XHR0aGlzLl9lbmdpbmUuX2RyYXdJbWFnZSh0aGlzLCAwLCAwLCB0aGlzLndpZHRoLCBoLCBsZWZ0IC0gdGhpcy54LCB0b3AgLSB0aGlzLnksIHRoaXMud2lkdGgsIGgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogd2l0aG91dCBjbGlwXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICovXHJcblx0X2RyYXdIb3Jpem9udGFsUGF0dGVybih4LCB5LCB3KSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRyZXR1cm47Ly9zcHJpdGUgcmVxdWlyZSBwcm9wZXJ0eTogd2lkdGgsIGhlaWdodFxyXG5cdFx0fVxyXG5cdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRjb25zdCBjdHggPSB0aGlzLl9lbmdpbmUuY3R4O1xyXG5cclxuXHRcdGNvbnN0IGxlZnQgPSB4O1xyXG5cdFx0Y29uc3QgcmlnaHQgPSB4ICsgdztcclxuXHJcblx0XHRmb3IgKGxldCBqID0gbGVmdDsgaiA8IHJpZ2h0OyBqICs9IHRoaXMud2lkdGgpIHtcclxuXHRcdFx0dGhpcy5kcmF3MihqLCB5KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHlcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaFxyXG5cdCAqL1xyXG5cdF9kcmF3VmVydGljYWxQYXR0ZXJuKHgsIHksIGgpIHtcclxuXHRcdGlmICghdGhpcy5pc0xvYWRlZCgpKSB7XHJcblx0XHRcdHJldHVybjsvL3Nwcml0ZSByZXF1aXJlIHByb3BlcnR5OiB3aWR0aCwgaGVpZ2h0XHJcblx0XHR9XHJcblx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdGNvbnN0IGN0eCA9IHRoaXMuX2VuZ2luZS5jdHg7XHJcblxyXG5cdFx0Y29uc3QgdG9wID0geTtcclxuXHRcdGNvbnN0IGJvdHRvbSA9IHkgKyBoO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSB0b3A7IGkgPCBib3R0b207IGkgKz0gdGhpcy5oZWlnaHQpIHtcclxuXHRcdFx0dGhpcy5kcmF3Mih4LCBpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geCAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHcgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaCAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdGRyYXdQYXR0ZXJuNGkoeCwgeSwgdywgaCkge1xyXG5cdFx0dGhpcy5kcmF3UGF0dGVybihNYXRoLnRydW5jKHggKyAwLjUpLCBNYXRoLnRydW5jKHkgKyAwLjUpLCBNYXRoLnRydW5jKHcgKyAwLjUpLCBNYXRoLnRydW5jKGggKyAwLjUpKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHggLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geSAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3IC0gdHlwZTogaW50XHJcblx0ICovXHJcblx0ZHJhd0hvcml6b250YWxQYXR0ZXJuM2koeCwgeSwgdykge1xyXG5cdFx0dGhpcy5kcmF3SG9yaXpvbnRhbFBhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyh3ICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaCAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdGRyYXdWZXJ0aWNhbFBhdHRlcm4zaSh4LCB5LCBoKSB7XHJcblx0XHR0aGlzLmRyYXdWZXJ0aWNhbFBhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyhoICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gdyAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoIC0gdHlwZTogaW50XHJcblx0ICovXHJcblx0X2RyYXdQYXR0ZXJuNGkoeCwgeSwgdywgaCkge1xyXG5cdFx0dGhpcy5fZHJhd1BhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyh3ICsgMC41KSwgTWF0aC50cnVuYyhoICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gdyAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdF9kcmF3SG9yaXpvbnRhbFBhdHRlcm4zaSh4LCB5LCB3KSB7XHJcblx0XHR0aGlzLl9kcmF3SG9yaXpvbnRhbFBhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyh3ICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaCAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdF9kcmF3VmVydGljYWxQYXR0ZXJuM2koeCwgeSwgaCkge1xyXG5cdFx0dGhpcy5fZHJhd1ZlcnRpY2FsUGF0dGVybihNYXRoLnRydW5jKHggKyAwLjUpLCBNYXRoLnRydW5jKHkgKyAwLjUpLCBNYXRoLnRydW5jKGggKyAwLjUpKTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBfJFBhdHRlcm5TcHJpdGVfTG9hZGVkIGV4dGVuZHMgU3ByaXRlIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0geyFhbnl9IHJhd1xyXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gdXJsXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IocmF3LCB1cmwpIHtcclxuXHRcdHN1cGVyKHJhdywgdXJsKTtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuX2RpcmVjdGlvbiA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDYW52YXNQYXR0ZXJufSAqL1xyXG5cdFx0dGhpcy5fcGF0dGVybiA9IG51bGw7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRnZXQgZGlyZWN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcclxuXHR9XHJcblx0c2V0IGRpcmVjdGlvbih2YWx1ZSkge1xyXG5cdFx0aWYgKHZhbHVlICYmIHRoaXMuX2RpcmVjdGlvbiAhPSB2YWx1ZSkge1xyXG5cdFx0XHR0aGlzLl9kaXJlY3Rpb24gPSB2YWx1ZTtcclxuXHRcclxuXHRcdFx0Ly9yZWxvYWQ7XHJcblx0XHRcdHRoaXMuX3BhdHRlcm4gPSBudWxsO1xyXG5cdFx0XHR0aGlzLl9fcHJvdG9fXyA9ICRQYXR0ZXJuU3ByaXRlLnByb3RvdHlwZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGhcclxuXHQgKi9cclxuXHRkcmF3UGF0dGVybih3LCBoKSB7XHJcblx0XHRpZiAodGhpcy5kaXJlY3Rpb24gJiYgdGhpcy5fcGF0dGVybikge1xyXG5cdFx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHRcclxuXHRcdFx0Y3R4LnJlY3QoLXRoaXMueCwgLXRoaXMueSwgdywgaCk7XHJcblx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLl9wYXR0ZXJuO1xyXG5cdFx0XHRjdHguZmlsbCgpO1xyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gXCJuby1yZXBlYXRcIjtcclxuXHRcdH1cclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGhcclxuXHQgKi9cclxuXHRkcmF3UGF0dGVybjIoeCwgeSwgdywgaCkge1xyXG5cdFx0aWYgKHRoaXMuZGlyZWN0aW9uICYmIHRoaXMuX3BhdHRlcm4pIHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRcdGNvbnN0IGN0eCA9IHRoaXMuX2VuZ2luZS5jdHg7XHJcblx0XHJcblx0XHRcdGN0eC5yZWN0KHggLSB0aGlzLngsIHkgLSB0aGlzLnksIHcsIGgpO1xyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gdGhpcy5fcGF0dGVybjtcclxuXHRcdFx0Y3R4LmZpbGwoKTtcclxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IFwibm8tcmVwZWF0XCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiogQHJldHVybnMge1wicmVwZWF0XCJ9ICovXHJcblx0Z2V0IGVfcmVwZWF0KCkge1xyXG5cdFx0cmV0dXJuIFwicmVwZWF0XCI7XHJcblx0fVxyXG5cdC8qKiBAcmV0dXJucyB7XCJyZXBlYXQteFwifSAqL1xyXG5cdGdldCBlX3JlcGVhdF94KCkge1xyXG5cdFx0cmV0dXJuIFwicmVwZWF0LXhcIjtcclxuXHR9XHJcblx0LyoqIEByZXR1cm5zIHtcInJlcGVhdC15XCJ9ICovXHJcblx0Z2V0IGVfcmVwZWF0X3koKSB7XHJcblx0XHRyZXR1cm4gXCJyZXBlYXQteVwiO1xyXG5cdH1cclxuXHQvKiogQHJldHVybnMge1wibm8tcmVwZWF0XCJ9ICovXHJcblx0Z2V0IGVfbm9SZXBlYXQoKSB7XHJcblx0XHRyZXR1cm4gXCJuby1yZXBlYXRcIjtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyAkUGF0dGVyblNwcml0ZSBleHRlbmRzIF8kUGF0dGVyblNwcml0ZV9Mb2FkZWQge1xyXG5cdGRyYXdQYXR0ZXJuKHcsIGgpIHtcclxuXHRcdHRoaXMuZHJhd1BhdHRlcm4yKDAsIDAsIHcsIGgpO1xyXG5cdH1cclxuXHRkcmF3UGF0dGVybjIoeCwgeSwgdywgaCkge1xyXG5cdFx0aWYgKHRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHJcblx0XHRcdGN0eC5zYXZlKCk7XHJcblx0XHRcdHtcclxuXHRcdFx0XHRjdHgucmVjdCh4LCB5LCB3LCBoKTtcclxuXHRcdFx0XHRjdHguY2xpcCgpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGxldCBsZWZ0ID0geDtcclxuXHRcdFx0XHRsZXQgdG9wID0geTtcclxuXHRcdFx0XHRsZXQgcmlnaHQgPSB4ICsgdztcclxuXHRcdFx0XHRsZXQgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0XHRcdGZvciAobGV0IGkgPSB0b3A7IGkgPCBib3R0b207IGkgKz0gdGhpcy5oZWlnaHQpIHtcclxuXHRcdFx0XHRcdGZvciAobGV0IGogPSBsZWZ0OyBqIDwgcmlnaHQ7IGogKz0gdGhpcy53aWR0aCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmRyYXcyKGosIGkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRjdHgucmVzdG9yZSgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gd1xyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoXHJcblx0ICovXHJcblx0ZHJhd1BhdHRlcm4odywgaCkge1xyXG5cdFx0aWYgKHRoaXMuZGlyZWN0aW9uKSB7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0XHRjb25zdCBjdHggPSB0aGlzLl9lbmdpbmUuY3R4O1xyXG5cdFxyXG5cdFx0XHRpZiAoIXRoaXMuX3BhdHRlcm4pIHtcclxuXHRcdFx0XHRpZiAodGhpcy5pc0xvYWRlZCgpKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9wYXR0ZXJuID0gY3R4LmNyZWF0ZVBhdHRlcm4odGhpcy50ZXh0dXJlLCB0aGlzLmRpcmVjdGlvbik7XHJcblx0XHRcdFx0XHR0aGlzLl9fcHJvdG9fXyA9IF8kUGF0dGVyblNwcml0ZV9Mb2FkZWQucHJvdG90eXBlO1xyXG5cdFx0XHRcdFx0dGhpcy5kcmF3UGF0dGVybih3LCBoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHlcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gd1xyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoXHJcblx0ICovXHJcblx0ZHJhd1BhdHRlcm4yKHgsIHksIHcsIGgpIHtcclxuXHRcdGlmICh0aGlzLmRpcmVjdGlvbikge1xyXG5cdFx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHRcclxuXHRcdFx0aWYgKCF0aGlzLl9wYXR0ZXJuKSB7XHJcblx0XHRcdFx0aWYgKHRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fcGF0dGVybiA9IGN0eC5jcmVhdGVQYXR0ZXJuKHRoaXMudGV4dHVyZSwgdGhpcy5kaXJlY3Rpb24pO1xyXG5cdFx0XHRcdFx0dGhpcy5fX3Byb3RvX18gPSBfJFBhdHRlcm5TcHJpdGVfTG9hZGVkLnByb3RvdHlwZTtcclxuXHRcdFx0XHRcdHRoaXMuZHJhd1BhdHRlcm4yKHgsIHksIHcsIGgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///347\n')},349:function(module,exports){eval('\ufeff\r\nclass ItemCategoryInfo {\r\n\t/**\r\n\t * @param {string} id_prefix\r\n\t * @param {string} path\r\n\t * @param {boolean} isOnFace\r\n\t * @param {string} slot - property name\r\n\t * @param {string} categoryName\r\n\t * @param {string} type\r\n\t * @param {string} [stringPath]\r\n\t */\r\n\tconstructor(id_prefix, imgDir, listPath, slot, categoryName, type, stringPath) {\r\n\t\tthis.id_prefix = id_prefix;\r\n\r\n\t\t/** data path */\r\n\t\tthis.path = imgDir;\r\n\r\n\t\t/** equip window */\r\n\t\tthis.slot = slot;\r\n\r\n\t\t/** item list file name */\r\n\t\tthis.listPath = listPath;\r\n\r\n\t\t/** display category name */\r\n\t\tthis.categoryName = categoryName;\r\n\r\n\t\t/** renderer */\r\n\t\tthis.FragmentType = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.dataDir = null;\r\n\t\t/** @type {string} */\r\n\t\tthis.stringDir = null;\r\n\t\t/** @type {string} */\r\n\t\tthis.iconPath = null;\r\n\t\t/** @type {string} */\r\n\t\tthis.iconRawPath = null;\r\n\t\t{\r\n\t\t\tlet dataDir, stringDir, iconPath, iconRawPath;\r\n\r\n\t\t\tswitch (slot) {\r\n\t\t\t\tcase "head":\r\n\t\t\t\t\ticonPath = "stand1/0/head";\r\n\t\t\t\t\ticonRawPath = "stand1/0/head";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase "body":\r\n\t\t\t\t\ticonPath = "stand1/0/body";\r\n\t\t\t\t\ticonRawPath = "stand1/0/body";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase "hair":\r\n\t\t\t\t\ticonPath = "stand1/0/hair";\r\n\t\t\t\t\ticonRawPath = "stand1/0/hair";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase "face":\r\n\t\t\t\t\ticonPath = "blink/0/face";\r\n\t\t\t\t\ticonRawPath = "blink/0/face";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: // typeId: 0|1|2|3|4\r\n\t\t\t\t\ticonPath = "info/icon";\r\n\t\t\t\t\ticonRawPath = "info/iconRaw";\r\n\t\t\t}\r\n\r\n\t\t\tif (id_prefix == "5") {\r\n\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\tstringDir = "/String/Pet/";\r\n\t\t\t\talert("Pet");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tswitch (id_prefix[1]) {\r\n\t\t\t\t\tcase "0":\r\n\t\t\t\t\t\tif (Math.trunc(id_prefix) <= 1) {\r\n\t\t\t\t\t\t\tdataDir = "/Character/";\r\n\t\t\t\t\t\t\tstringDir = null;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase "1":\r\n\t\t\t\t\t\tlet s = imgDir + (imgDir ? "/" : "");\r\n\t\t\t\t\t\tdataDir = "/Character/" + s;\r\n\t\t\t\t\t\tstringDir = "/String/Eqp/Eqp/" + (stringPath || s);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "2":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Consume/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "3":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Ins/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "4":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Etc/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "5":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Cash/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow new Error("unknow item type, param: %o", [id_prefix, imgDir, listPath, slot, categoryName, type]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tObject.defineProperties(this, {\r\n\t\t\t\t"type": {\r\n\t\t\t\t\tvalue: type,\r\n\t\t\t\t},\r\n\t\t\t\t"dataDir": {\r\n\t\t\t\t\tvalue: dataDir,\r\n\t\t\t\t},\r\n\t\t\t\t"stringDir": {\r\n\t\t\t\t\tvalue: stringDir,\r\n\t\t\t\t},\r\n\t\t\t\t"iconPath": {\r\n\t\t\t\t\tvalue: iconPath,\r\n\t\t\t\t},\r\n\t\t\t\t"iconRawPath": {\r\n\t\t\t\t\tvalue: iconRawPath,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string|null}\r\n\t */\r\n\tstatic getIconRawUrl(id) {\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tlet info = ItemCategoryInfo.get(id);\r\n\t\tif (!info) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (id[0] == "0") {\r\n\t\t\t//TODO: return path, not url\r\n\t\t\treturn info.dataDir + id + "/" + info.iconRawPath;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string|null}\r\n\t */\r\n\tstatic getIconUrl(id) {\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tlet info = ItemCategoryInfo.get(id);\r\n\t\tif (!info) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (id[0] == "0") {\r\n\t\t\t//TODO: return path, not url\r\n\t\t\treturn info.dataDir + id + "/" + info.iconPath;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id - 4+ digit string\r\n\t * @returns {ItemCategoryInfo}\r\n\t */\r\n\tstatic get(id) {\r\n\t\tlet info;\r\n\r\n\t\tif (id == null || id == "") {\r\n\t\t\tdebugger;\r\n\t\t\tthrow new TypeError();\r\n\t\t}\r\n\r\n\t\tif (id[0] == "0") {\r\n\t\t\tif (id.length == 4) {\r\n\t\t\t\tinfo = ItemCategoryInfo._info[id];\r\n\t\t\t\tif (info) {\r\n\t\t\t\t\treturn info;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (id.length == 6) {\r\n\t\t\t\treturn ItemCategoryInfo._info[id];\r\n\t\t\t}\r\n\t\t\telse if (id.length == 3) {\r\n\t\t\t\treturn ItemCategoryInfo._info[id];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tinfo = ItemCategoryInfo._info[id.slice(0, 4)];\r\n\t\t\t\tif (info) {\r\n\t\t\t\t\treturn info;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tinfo = ItemCategoryInfo._info[id.slice(0, 6)];\r\n\t\t\t\t\tif (info) {\r\n\t\t\t\t\t\treturn info;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tinfo = ItemCategoryInfo._info[id.slice(0, 3)];//019\r\n\t\t\t\t\t\tif (info) {\r\n\t\t\t\t\t\t\treturn info;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconsole.warn("unknow item type, itemId: " + id);\r\n\t\treturn null;\r\n\t}\r\n\r\n\tstatic getTypeId() {\r\n\t\treturn Math.trunc(_id / 1000000);\r\n\t}\r\n\r\n\tstatic getCategory() {\r\n\t\treturn Math.trunc(_id / 10000);// % 100;// 0105 // 01 + 05 // type + category\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id - char[4]: type; char[4+]: itemId\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isItem(id) {\r\n\t\tlet type = Math.trunc(id / 1000000);//id.startsWith("00");\r\n\t\treturn type != 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id - char[4]: type; char[4+]: itemId\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isEquip(id) {\r\n\t\tif (!id) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\t\tlet _id = Number(id);\r\n\r\n\t\tif (!Number.isSafeInteger(_id)) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\r\n\t\t//let cate = Number(id.length == 4 ? id : id.slice(0, 4));\r\n\t\t//return (cate >= "0100" && cate < "0180");\r\n\r\n\t\t//let cate = Math.trunc(_id / 10000);\r\n\t\t//if (cate >= 180 && cate < 2000) {\r\n\t\t//\tconsole.warn("?? equip: " + id);\r\n\t\t//\tdebugger;\r\n\t\t//}\r\n\r\n\t\tlet type = Math.trunc(_id / 1000000);\r\n\r\n\t\treturn type == 1;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isSkin(id) {\r\n\t\treturn Math.trunc(id / 10000) == 0;\r\n\t\t//return id.startsWith("0000");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isBody(id) {\r\n\t\treturn Math.trunc(id / 10000) == 0;\r\n\t\t//return id.startsWith("0000");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isHead(id) {\r\n\t\treturn Math.trunc(id / 10000) == 1;\r\n\t\t//return id.startsWith("0000");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isFace(id) {\r\n\t\treturn Math.trunc(id / 10000) == 2;\r\n\t\t//return id.startsWith("0002");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isHair(id) {\r\n\t\tconst i = Math.trunc(id / 10000);\r\n\t\treturn i == 3 || i == 4;\r\n\t\t//return id.startsWith("0003") || id.startsWith("0004");\r\n\t}\r\n\r\n\tstatic isChair(id) {\r\n\t\tif (!id) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\t\tlet _id = Number(id);\r\n\r\n\t\tif (!Number.isSafeInteger(_id)) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\r\n\t\tlet cate = Math.trunc(_id / 10000);\r\n\r\n\t\treturn cate == 301;//0301xxxx\r\n\t}\r\n\r\n\t/**\r\n\t * 1~4 digit number\r\n\t * @param {string} itemId\r\n\t */\r\n\tstatic getSubCategory(itemId) {\r\n\t\treturn Math.trunc(itemId / 10000);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} itemId\r\n\t */\r\n\tstatic isCashWeapon(itemId) {\r\n\t\treturn Math.trunc(itemId / 10000) == 170;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} job\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getJobWeaponCategory(job) {\r\n\t\t//TODO: getJobWeaponCategory\r\n\t\tconsole.warn("getJobWeaponCategory: 未完成");\r\n\t}\r\n}\r\nItemCategoryInfo.type = {\r\n\tEquip: "Equip",\r\n\tConsume: "Consume",\r\n\tEtc: "Etc",\r\n\tInstall: "Install",\r\n\tCash: "Cash"\r\n};\r\nItemCategoryInfo.typeName = {\r\n\t0: "Equip",\r\n\t1: "Consume",\r\n\t2: "Etc",\r\n\t3: "Install",\r\n\t4: "Cash"\r\n};\r\nItemCategoryInfo.typeId = {\r\n\tEquip: 0,\r\n\tConsume: 1,\r\n\tEtc: 2,\r\n\tInstall: 3,\r\n\tCash: 4,\r\n};\r\nItemCategoryInfo._info = {\r\n\t"0000": new ItemCategoryInfo("0000", "", "body", "body", "<body>", "Equip"),\r\n\t"0001": new ItemCategoryInfo("0001", "", "head", "head", "<head>", "Equip"),\r\n\r\n\t"0002": new ItemCategoryInfo("0002", "Face", "Face", "face", "臉型", "Equip"),\r\n\t"0003": new ItemCategoryInfo("0003", "Hair", "Hair", "hair", "髮型", "Equip"),\r\n\t"0004": new ItemCategoryInfo("0004", "Hair", "Hair", "hair", "髮型", "Equip"),\r\n\r\n\t"0100": new ItemCategoryInfo("0100", "Cap", "Cap", "cap", "帽子", "Equip"),\r\n\t"0101": new ItemCategoryInfo("0101", "Accessory", "accessoryFace", "accessoryFace", "臉飾", "Equip"),\r\n\t"0102": new ItemCategoryInfo("0102", "Accessory", "accessoryEyes", "accessoryEyes", "眼飾", "Equip"),\r\n\t"0103": new ItemCategoryInfo("0103", "Accessory", "accessoryEars", "accessoryEars", "耳環", "Equip"),\r\n\t"0104": new ItemCategoryInfo("0104", "Coat", "Coat", "coat", "上衣", "Equip"),\r\n\t"0105": new ItemCategoryInfo("0105", "Longcoat", "Longcoat", "longcoat", "套服", "Equip"),\r\n\t"0106": new ItemCategoryInfo("0106", "Pants", "Pants", "pants", "褲子", "Equip"),\r\n\t"0107": new ItemCategoryInfo("0107", "Shoes", "Shoes", "shoes", "鞋子", "Equip"),\r\n\t"0108": new ItemCategoryInfo("0108", "Glove", "Glove", "glove", "手套", "Equip"),\r\n\t"0109": new ItemCategoryInfo("0109", "Shield", "Shield", "shield", "盾牌", "Equip"),\r\n\t"0110": new ItemCategoryInfo("0110", "Cape", "Cape", "cape", "披風", "Equip"),\r\n\r\n\t"0121": new ItemCategoryInfo("0121", "Weapon", "閃亮克魯", "weapon", "閃亮克魯", "Equip"),\r\n\t"0122": new ItemCategoryInfo("0122", "Weapon", "靈魂射手", "weapon", "靈魂射手", "Equip"),\r\n\t"0123": new ItemCategoryInfo("0123", "Weapon", "魔劍", "weapon", "魔劍", "Equip"),\r\n\t"0124": new ItemCategoryInfo("0124", "Weapon", "能量劍", "weapon", "能量劍", "Equip"),\r\n\t"0125": new ItemCategoryInfo("0125", "Weapon", "幻獸棒", "weapon", "幻獸棒", "Equip"),\r\n\t"0126": new ItemCategoryInfo("0126", "Weapon", "ESP限制器", "weapon", "ESP限制器", "Equip"),\r\n\t"0127": new ItemCategoryInfo("0127", "Weapon", "鎖鏈", "weapon", "鎖鏈", "Equip"),\r\n\t"0128": new ItemCategoryInfo("0128", "Weapon", "魔力護腕", "weapon", "魔力護腕", "Equip"),\r\n\r\n\t"0130": new ItemCategoryInfo("0130", "Weapon", "單手劍", "weapon", "單手劍", "Equip"),\r\n\t"0131": new ItemCategoryInfo("0131", "Weapon", "單手斧", "weapon", "單手斧", "Equip"),\r\n\t"0132": new ItemCategoryInfo("0132", "Weapon", "單手錘", "weapon", "單手錘", "Equip"),\r\n\t"0133": new ItemCategoryInfo("0133", "Weapon", "短劍", "weapon", "短劍", "Equip"),\r\n\t"0134": new ItemCategoryInfo("0134", "Weapon", "雙刀", "weapon", "雙刀", "Equip"),\r\n\t"013526": new ItemCategoryInfo("013526", "Weapon", "靈魂之環", "weapon", "靈魂之環", "Equip"),\r\n\t"013530": new ItemCategoryInfo("013530", "Weapon", "控制器", "weapon", "控制器", "Equip"),\r\n\t"0136": new ItemCategoryInfo("0136", "Weapon", "手杖", "weapon", "手杖", "Equip"),\r\n\t"0137": new ItemCategoryInfo("0137", "Weapon", "短杖", "weapon", "短杖", "Equip"),\r\n\t"0138": new ItemCategoryInfo("0138", "Weapon", "長杖", "weapon", "長杖", "Equip"),\r\n\r\n\t"0140": new ItemCategoryInfo("0140", "Weapon", "雙手劍", "weapon", "雙手劍", "Equip"),\r\n\t"0141": new ItemCategoryInfo("0141", "Weapon", "雙手斧", "weapon", "雙手斧", "Equip"),\r\n\t"0142": new ItemCategoryInfo("0142", "Weapon", "雙手棍", "weapon", "雙手棍", "Equip"),\r\n\t"0143": new ItemCategoryInfo("0143", "Weapon", "槍", "weapon", "槍", "Equip"),\r\n\t"0144": new ItemCategoryInfo("0144", "Weapon", "矛", "weapon", "矛", "Equip"),\r\n\t"0145": new ItemCategoryInfo("0145", "Weapon", "弓", "weapon", "弓", "Equip"),\r\n\t"0146": new ItemCategoryInfo("0146", "Weapon", "弩", "weapon", "弩", "Equip"),\r\n\t"0147": new ItemCategoryInfo("0147", "Weapon", "拳套", "weapon", "拳套", "Equip"),\r\n\t"0148": new ItemCategoryInfo("0148", "Weapon", "指虎", "weapon", "指虎", "Equip"),\r\n\t"0149": new ItemCategoryInfo("0149", "Weapon", "火槍", "weapon", "火槍", "Equip"),\r\n\t"0150": new ItemCategoryInfo("0150", "Weapon", "鏟", "weapon", "鏟", "Equip"),\r\n\t"0151": new ItemCategoryInfo("0151", "Weapon", "鎬", "weapon", "鎬", "Equip"),\r\n\t"0152": new ItemCategoryInfo("0152", "Weapon", "雙弩槍", "weapon", "雙弩槍", "Equip"),\r\n\t"0153": new ItemCategoryInfo("0153", "Weapon", "加農砲", "weapon", "加農砲", "Equip"),\r\n\t"0154": new ItemCategoryInfo("0154", "Weapon", "太刀", "weapon", "太刀", "Equip"),\r\n\t"0155": new ItemCategoryInfo("0155", "Weapon", "扇子", "weapon", "扇子", "Equip"),\r\n\t"0156": new ItemCategoryInfo("0156", "Weapon", "琉", "weapon", "琉", "Equip"),\r\n\t"0157": new ItemCategoryInfo("0157", "Weapon", "璃", "weapon", "璃", "Equip"),\r\n\t"0158": new ItemCategoryInfo("0158", "Weapon", "重拳槍", "weapon", "重拳槍", "Equip"),\r\n\t"0170": new ItemCategoryInfo("0170", "Weapon", "0170", "weapon", "點裝武器", "Equip"),\r\n\t"019": new ItemCategoryInfo("019", "TamingMob", "TamingMob", "tamingMob", "騎寵", "Equip", "Taming/"),\r\n\r\n\t"0301": new ItemCategoryInfo("0301", "Install", "Chair", "install", "椅子", "Item"),\r\n};\r\n\r\nItemCategoryInfo._categoryList = (function (info_map) {\r\n\tlet list = [];\r\n\tlet set = new Set();\r\n\tfor (let i in info_map) {\r\n\t\tlet cat = info_map[i];\r\n\t\tlet key = cat.categoryName || cat.listPath;\r\n\r\n\t\tif (!set.has(key)) {\r\n\t\t\tset.add(key);\r\n\r\n\t\t\tlist.push({\r\n\t\t\t\tkey: key,\r\n\t\t\t\tvalue: i,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\treturn list;\r\n})(ItemCategoryInfo._info);\r\n\r\n\r\n/** @type {Map<string,ItemCategoryInfo} */\r\nItemCategoryInfo.map_slot_to_info = (function () {\r\n\t/** @type {Map<string,ItemCategoryInfo} */\r\n\tconst map = new Map();\r\n\tObject.values(ItemCategoryInfo._info).forEach(info => {\r\n\t\tmap.set(info.slot, info);\r\n\t});\r\n\treturn map;\r\n})();\r\n\r\n\r\nclass EquipSlotsMap {\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {number} slotId\r\n\t * @returns {string} slotName\r\n\t */\r\n\tstatic toName(equipType, slotId) {\r\n\t\treturn EquipSlotsMap.slots_to_name_map[equipType][slotId];\r\n\t}\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {ItemCategoryInfo} info\r\n\t * @returns {number} slotId\r\n\t */\r\n\tstatic infoToSlot(equipType, info) {\r\n\t\treturn EquipSlotsMap.map_slots_to_typeInfo[equipType].get(info);\r\n\t}\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {string} itemId\r\n\t * @returns {number} slotId\r\n\t */\r\n\tstatic itemIdToSlot(equipType, itemId) {\r\n\t\tlet info = ItemCategoryInfo.get(itemId);\r\n\t\treturn EquipSlotsMap.map_slots_to_typeInfo[equipType].get(info);\r\n\t}\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {string} slotName\r\n\t * @returns {number} slotId\r\n\t */\r\n\tstatic toSlot(equipType, slotName) {\r\n\t\treturn EquipSlotsMap.name_to_slots_map[equipType][slotName];\r\n\t}\r\n}\r\n\r\nEquipSlotsMap.slots_to_name_map = {\r\n\tEquip: {\r\n\t\t1: "cap",\r\n\t\t2: "accessoryFace",\r\n\t\t3: "accessoryEyes",\r\n\t\t4: "accessoryEars",\r\n\t\t5: "coat",\r\n\t\t5: "longcoat",\r\n\t\t6: "pants",\r\n\t\t7: "shoes",\r\n\t\t8: "glove",\r\n\t\t9: "cape",\r\n\t\t10: "shield",\r\n\t\t11: "weapon",\r\n\t},\r\n\tCash: {\r\n\t},\r\n}\r\nObject.keys(EquipSlotsMap.slots_to_name_map.Equip).forEach(slot => {\r\n\tEquipSlotsMap.slots_to_name_map.Cash[Number(slot) + 100] = EquipSlotsMap.slots_to_name_map.Equip[slot];\r\n});\r\n\r\nEquipSlotsMap.map_slots_to_typeInfo = {\r\n};\r\nObject.entries(EquipSlotsMap.slots_to_name_map).forEach(([slotTypeName, slots]) => {\r\n\tconst sti = ItemCategoryInfo.map_slot_to_info;\r\n\tconst typedSlots = EquipSlotsMap.map_slots_to_typeInfo[slotTypeName] = new Map();\r\n\r\n\tObject.entries(slots).forEach(function ([slotId, slotName]) {\r\n\t\tconst info = sti.get(slotName);\r\n\t\ttypedSlots.set(info, slotId);\r\n\t})\r\n});\r\n\r\nEquipSlotsMap.name_to_slots_map = {\r\n};\r\nObject.entries(EquipSlotsMap.slots_to_name_map).forEach(([slotTypeName, slots]) => {\r\n\tconst sti = ItemCategoryInfo.map_slot_to_info;\r\n\tconst typedSlots = EquipSlotsMap.name_to_slots_map[slotTypeName] = {};\r\n\r\n\tObject.entries(slots).forEach(function ([slotId, slotName]) {\r\n\t\tconst info = sti.get(slotName);\r\n\t\ttypedSlots[info.slot] = slotId;\r\n\t})\r\n});\r\n\r\n\r\nmodule.exports = {\r\n\tItemCategoryInfo,\r\n\tEquipSlotsMap,\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQ5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL0NvbW1vbi9JdGVtQ2F0ZWdvcnlJbmZvLmpzPzVhNjMiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmNsYXNzIEl0ZW1DYXRlZ29yeUluZm8ge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZF9wcmVmaXhcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPbkZhY2VcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc2xvdCAtIHByb3BlcnR5IG5hbWVcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnlOYW1lXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZ1BhdGhdXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IoaWRfcHJlZml4LCBpbWdEaXIsIGxpc3RQYXRoLCBzbG90LCBjYXRlZ29yeU5hbWUsIHR5cGUsIHN0cmluZ1BhdGgpIHtcclxuXHRcdHRoaXMuaWRfcHJlZml4ID0gaWRfcHJlZml4O1xyXG5cclxuXHRcdC8qKiBkYXRhIHBhdGggKi9cclxuXHRcdHRoaXMucGF0aCA9IGltZ0RpcjtcclxuXHJcblx0XHQvKiogZXF1aXAgd2luZG93ICovXHJcblx0XHR0aGlzLnNsb3QgPSBzbG90O1xyXG5cclxuXHRcdC8qKiBpdGVtIGxpc3QgZmlsZSBuYW1lICovXHJcblx0XHR0aGlzLmxpc3RQYXRoID0gbGlzdFBhdGg7XHJcblxyXG5cdFx0LyoqIGRpc3BsYXkgY2F0ZWdvcnkgbmFtZSAqL1xyXG5cdFx0dGhpcy5jYXRlZ29yeU5hbWUgPSBjYXRlZ29yeU5hbWU7XHJcblxyXG5cdFx0LyoqIHJlbmRlcmVyICovXHJcblx0XHR0aGlzLkZyYWdtZW50VHlwZSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmRhdGFEaXIgPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLnN0cmluZ0RpciA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuaWNvblBhdGggPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmljb25SYXdQYXRoID0gbnVsbDtcclxuXHRcdHtcclxuXHRcdFx0bGV0IGRhdGFEaXIsIHN0cmluZ0RpciwgaWNvblBhdGgsIGljb25SYXdQYXRoO1xyXG5cclxuXHRcdFx0c3dpdGNoIChzbG90KSB7XHJcblx0XHRcdFx0Y2FzZSBcImhlYWRcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJzdGFuZDEvMC9oZWFkXCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwic3RhbmQxLzAvaGVhZFwiO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImJvZHlcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJzdGFuZDEvMC9ib2R5XCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwic3RhbmQxLzAvYm9keVwiO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImhhaXJcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJzdGFuZDEvMC9oYWlyXCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwic3RhbmQxLzAvaGFpclwiO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImZhY2VcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJibGluay8wL2ZhY2VcIjtcclxuXHRcdFx0XHRcdGljb25SYXdQYXRoID0gXCJibGluay8wL2ZhY2VcIjtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGRlZmF1bHQ6IC8vIHR5cGVJZDogMHwxfDJ8M3w0XHJcblx0XHRcdFx0XHRpY29uUGF0aCA9IFwiaW5mby9pY29uXCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwiaW5mby9pY29uUmF3XCI7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChpZF9wcmVmaXggPT0gXCI1XCIpIHtcclxuXHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRzdHJpbmdEaXIgPSBcIi9TdHJpbmcvUGV0L1wiO1xyXG5cdFx0XHRcdGFsZXJ0KFwiUGV0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHN3aXRjaCAoaWRfcHJlZml4WzFdKSB7XHJcblx0XHRcdFx0XHRjYXNlIFwiMFwiOlxyXG5cdFx0XHRcdFx0XHRpZiAoTWF0aC50cnVuYyhpZF9wcmVmaXgpIDw9IDEpIHtcclxuXHRcdFx0XHRcdFx0XHRkYXRhRGlyID0gXCIvQ2hhcmFjdGVyL1wiO1xyXG5cdFx0XHRcdFx0XHRcdHN0cmluZ0RpciA9IG51bGw7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGNhc2UgXCIxXCI6XHJcblx0XHRcdFx0XHRcdGxldCBzID0gaW1nRGlyICsgKGltZ0RpciA/IFwiL1wiIDogXCJcIik7XHJcblx0XHRcdFx0XHRcdGRhdGFEaXIgPSBcIi9DaGFyYWN0ZXIvXCIgKyBzO1xyXG5cdFx0XHRcdFx0XHRzdHJpbmdEaXIgPSBcIi9TdHJpbmcvRXFwL0VxcC9cIiArIChzdHJpbmdQYXRoIHx8IHMpO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgXCIyXCI6XHJcblx0XHRcdFx0XHRcdGRhdGFEaXIgPSBgL0l0ZW0vJHtpbWdEaXJ9LyR7aWRfcHJlZml4fS9gO1xyXG5cdFx0XHRcdFx0XHRzdHJpbmdEaXIgPSBcIi9TdHJpbmcvQ29uc3VtZS9cIjtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwiM1wiOlxyXG5cdFx0XHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRcdFx0c3RyaW5nRGlyID0gXCIvU3RyaW5nL0lucy9cIjtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwiNFwiOlxyXG5cdFx0XHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRcdFx0c3RyaW5nRGlyID0gXCIvU3RyaW5nL0V0Yy9cIjtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwiNVwiOlxyXG5cdFx0XHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRcdFx0c3RyaW5nRGlyID0gXCIvU3RyaW5nL0Nhc2gvXCI7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFwidW5rbm93IGl0ZW0gdHlwZSwgcGFyYW06ICVvXCIsIFtpZF9wcmVmaXgsIGltZ0RpciwgbGlzdFBhdGgsIHNsb3QsIGNhdGVnb3J5TmFtZSwgdHlwZV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xyXG5cdFx0XHRcdFwidHlwZVwiOiB7XHJcblx0XHRcdFx0XHR2YWx1ZTogdHlwZSxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiZGF0YURpclwiOiB7XHJcblx0XHRcdFx0XHR2YWx1ZTogZGF0YURpcixcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwic3RyaW5nRGlyXCI6IHtcclxuXHRcdFx0XHRcdHZhbHVlOiBzdHJpbmdEaXIsXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImljb25QYXRoXCI6IHtcclxuXHRcdFx0XHRcdHZhbHVlOiBpY29uUGF0aCxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiaWNvblJhd1BhdGhcIjoge1xyXG5cdFx0XHRcdFx0dmFsdWU6IGljb25SYXdQYXRoLFxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHJldHVybnMge3N0cmluZ3xudWxsfVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBnZXRJY29uUmF3VXJsKGlkKSB7XHJcblx0XHQvKiogQHR5cGUge0l0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0XHRsZXQgaW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KGlkKTtcclxuXHRcdGlmICghaW5mbykge1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHRcdGlmIChpZFswXSA9PSBcIjBcIikge1xyXG5cdFx0XHQvL1RPRE86IHJldHVybiBwYXRoLCBub3QgdXJsXHJcblx0XHRcdHJldHVybiBpbmZvLmRhdGFEaXIgKyBpZCArIFwiL1wiICsgaW5mby5pY29uUmF3UGF0aDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd8bnVsbH1cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0SWNvblVybChpZCkge1xyXG5cdFx0LyoqIEB0eXBlIHtJdGVtQ2F0ZWdvcnlJbmZvfSAqL1xyXG5cdFx0bGV0IGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldChpZCk7XHJcblx0XHRpZiAoIWluZm8pIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAoaWRbMF0gPT0gXCIwXCIpIHtcclxuXHRcdFx0Ly9UT0RPOiByZXR1cm4gcGF0aCwgbm90IHVybFxyXG5cdFx0XHRyZXR1cm4gaW5mby5kYXRhRGlyICsgaWQgKyBcIi9cIiArIGluZm8uaWNvblBhdGg7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSA0KyBkaWdpdCBzdHJpbmdcclxuXHQgKiBAcmV0dXJucyB7SXRlbUNhdGVnb3J5SW5mb31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0KGlkKSB7XHJcblx0XHRsZXQgaW5mbztcclxuXHJcblx0XHRpZiAoaWQgPT0gbnVsbCB8fCBpZCA9PSBcIlwiKSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGlkWzBdID09IFwiMFwiKSB7XHJcblx0XHRcdGlmIChpZC5sZW5ndGggPT0gNCkge1xyXG5cdFx0XHRcdGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvW2lkXTtcclxuXHRcdFx0XHRpZiAoaW5mbykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGlkLmxlbmd0aCA9PSA2KSB7XHJcblx0XHRcdFx0cmV0dXJuIEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWRdO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGlkLmxlbmd0aCA9PSAzKSB7XHJcblx0XHRcdFx0cmV0dXJuIEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWRdO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvW2lkLnNsaWNlKDAsIDQpXTtcclxuXHRcdFx0XHRpZiAoaW5mbykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0aW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWQuc2xpY2UoMCwgNildO1xyXG5cdFx0XHRcdFx0aWYgKGluZm8pIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0aW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWQuc2xpY2UoMCwgMyldOy8vMDE5XHJcblx0XHRcdFx0XHRcdGlmIChpbmZvKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNvbnNvbGUud2FybihcInVua25vdyBpdGVtIHR5cGUsIGl0ZW1JZDogXCIgKyBpZCk7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBnZXRUeXBlSWQoKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhfaWQgLyAxMDAwMDAwKTtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBnZXRDYXRlZ29yeSgpIHtcclxuXHRcdHJldHVybiBNYXRoLnRydW5jKF9pZCAvIDEwMDAwKTsvLyAlIDEwMDsvLyAwMTA1IC8vIDAxICsgMDUgLy8gdHlwZSArIGNhdGVnb3J5XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBjaGFyWzRdOiB0eXBlOyBjaGFyWzQrXTogaXRlbUlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzSXRlbShpZCkge1xyXG5cdFx0bGV0IHR5cGUgPSBNYXRoLnRydW5jKGlkIC8gMTAwMDAwMCk7Ly9pZC5zdGFydHNXaXRoKFwiMDBcIik7XHJcblx0XHRyZXR1cm4gdHlwZSAhPSAwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gY2hhcls0XTogdHlwZTsgY2hhcls0K106IGl0ZW1JZFxyXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBpc0VxdWlwKGlkKSB7XHJcblx0XHRpZiAoIWlkKSB7XHJcblx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xyXG5cdFx0fVxyXG5cdFx0bGV0IF9pZCA9IE51bWJlcihpZCk7XHJcblxyXG5cdFx0aWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihfaWQpKSB7XHJcblx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vbGV0IGNhdGUgPSBOdW1iZXIoaWQubGVuZ3RoID09IDQgPyBpZCA6IGlkLnNsaWNlKDAsIDQpKTtcclxuXHRcdC8vcmV0dXJuIChjYXRlID49IFwiMDEwMFwiICYmIGNhdGUgPCBcIjAxODBcIik7XHJcblxyXG5cdFx0Ly9sZXQgY2F0ZSA9IE1hdGgudHJ1bmMoX2lkIC8gMTAwMDApO1xyXG5cdFx0Ly9pZiAoY2F0ZSA+PSAxODAgJiYgY2F0ZSA8IDIwMDApIHtcclxuXHRcdC8vXHRjb25zb2xlLndhcm4oXCI/PyBlcXVpcDogXCIgKyBpZCk7XHJcblx0XHQvL1x0ZGVidWdnZXI7XHJcblx0XHQvL31cclxuXHJcblx0XHRsZXQgdHlwZSA9IE1hdGgudHJ1bmMoX2lkIC8gMTAwMDAwMCk7XHJcblxyXG5cdFx0cmV0dXJuIHR5cGUgPT0gMTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRcclxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRzdGF0aWMgaXNTa2luKGlkKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhpZCAvIDEwMDAwKSA9PSAwO1xyXG5cdFx0Ly9yZXR1cm4gaWQuc3RhcnRzV2l0aChcIjAwMDBcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzQm9keShpZCkge1xyXG5cdFx0cmV0dXJuIE1hdGgudHJ1bmMoaWQgLyAxMDAwMCkgPT0gMDtcclxuXHRcdC8vcmV0dXJuIGlkLnN0YXJ0c1dpdGgoXCIwMDAwXCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBpZFxyXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBpc0hlYWQoaWQpIHtcclxuXHRcdHJldHVybiBNYXRoLnRydW5jKGlkIC8gMTAwMDApID09IDE7XHJcblx0XHQvL3JldHVybiBpZC5zdGFydHNXaXRoKFwiMDAwMFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRcclxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRzdGF0aWMgaXNGYWNlKGlkKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhpZCAvIDEwMDAwKSA9PSAyO1xyXG5cdFx0Ly9yZXR1cm4gaWQuc3RhcnRzV2l0aChcIjAwMDJcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzSGFpcihpZCkge1xyXG5cdFx0Y29uc3QgaSA9IE1hdGgudHJ1bmMoaWQgLyAxMDAwMCk7XHJcblx0XHRyZXR1cm4gaSA9PSAzIHx8IGkgPT0gNDtcclxuXHRcdC8vcmV0dXJuIGlkLnN0YXJ0c1dpdGgoXCIwMDAzXCIpIHx8IGlkLnN0YXJ0c1dpdGgoXCIwMDA0XCIpO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGlzQ2hhaXIoaWQpIHtcclxuXHRcdGlmICghaWQpIHtcclxuXHRcdFx0dGhyb3cgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblx0XHRsZXQgX2lkID0gTnVtYmVyKGlkKTtcclxuXHJcblx0XHRpZiAoIU51bWJlci5pc1NhZmVJbnRlZ2VyKF9pZCkpIHtcclxuXHRcdFx0dGhyb3cgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IGNhdGUgPSBNYXRoLnRydW5jKF9pZCAvIDEwMDAwKTtcclxuXHJcblx0XHRyZXR1cm4gY2F0ZSA9PSAzMDE7Ly8wMzAxeHh4eFxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogMX40IGRpZ2l0IG51bWJlclxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWRcclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0U3ViQ2F0ZWdvcnkoaXRlbUlkKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhpdGVtSWQgLyAxMDAwMCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaXRlbUlkXHJcblx0ICovXHJcblx0c3RhdGljIGlzQ2FzaFdlYXBvbihpdGVtSWQpIHtcclxuXHRcdHJldHVybiBNYXRoLnRydW5jKGl0ZW1JZCAvIDEwMDAwKSA9PSAxNzA7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gam9iXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0Sm9iV2VhcG9uQ2F0ZWdvcnkoam9iKSB7XHJcblx0XHQvL1RPRE86IGdldEpvYldlYXBvbkNhdGVnb3J5XHJcblx0XHRjb25zb2xlLndhcm4oXCJnZXRKb2JXZWFwb25DYXRlZ29yeTog5pyq5a6M5oiQXCIpO1xyXG5cdH1cclxufVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLnR5cGUgPSB7XHJcblx0RXF1aXA6IFwiRXF1aXBcIixcclxuXHRDb25zdW1lOiBcIkNvbnN1bWVcIixcclxuXHRFdGM6IFwiRXRjXCIsXHJcblx0SW5zdGFsbDogXCJJbnN0YWxsXCIsXHJcblx0Q2FzaDogXCJDYXNoXCJcclxufTtcclxuSXRlbUNhdGVnb3J5SW5mby50eXBlTmFtZSA9IHtcclxuXHQwOiBcIkVxdWlwXCIsXHJcblx0MTogXCJDb25zdW1lXCIsXHJcblx0MjogXCJFdGNcIixcclxuXHQzOiBcIkluc3RhbGxcIixcclxuXHQ0OiBcIkNhc2hcIlxyXG59O1xyXG5JdGVtQ2F0ZWdvcnlJbmZvLnR5cGVJZCA9IHtcclxuXHRFcXVpcDogMCxcclxuXHRDb25zdW1lOiAxLFxyXG5cdEV0YzogMixcclxuXHRJbnN0YWxsOiAzLFxyXG5cdENhc2g6IDQsXHJcbn07XHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm8gPSB7XHJcblx0XCIwMDAwXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDAwMFwiLCBcIlwiLCBcImJvZHlcIiwgXCJib2R5XCIsIFwiPGJvZHk+XCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMDAxXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDAwMVwiLCBcIlwiLCBcImhlYWRcIiwgXCJoZWFkXCIsIFwiPGhlYWQ+XCIsIFwiRXF1aXBcIiksXHJcblxyXG5cdFwiMDAwMlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAwMDJcIiwgXCJGYWNlXCIsIFwiRmFjZVwiLCBcImZhY2VcIiwgXCLoh4nlnotcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAwMDNcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMDAzXCIsIFwiSGFpclwiLCBcIkhhaXJcIiwgXCJoYWlyXCIsIFwi6auu5Z6LXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMDA0XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDAwNFwiLCBcIkhhaXJcIiwgXCJIYWlyXCIsIFwiaGFpclwiLCBcIumrruWei1wiLCBcIkVxdWlwXCIpLFxyXG5cclxuXHRcIjAxMDBcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTAwXCIsIFwiQ2FwXCIsIFwiQ2FwXCIsIFwiY2FwXCIsIFwi5bi95a2QXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTAxXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwMVwiLCBcIkFjY2Vzc29yeVwiLCBcImFjY2Vzc29yeUZhY2VcIiwgXCJhY2Nlc3NvcnlGYWNlXCIsIFwi6IeJ6aO+XCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTAyXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwMlwiLCBcIkFjY2Vzc29yeVwiLCBcImFjY2Vzc29yeUV5ZXNcIiwgXCJhY2Nlc3NvcnlFeWVzXCIsIFwi55y86aO+XCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTAzXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwM1wiLCBcIkFjY2Vzc29yeVwiLCBcImFjY2Vzc29yeUVhcnNcIiwgXCJhY2Nlc3NvcnlFYXJzXCIsIFwi6ICz55KwXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTA0XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwNFwiLCBcIkNvYXRcIiwgXCJDb2F0XCIsIFwiY29hdFwiLCBcIuS4iuiho1wiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEwNVwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMDVcIiwgXCJMb25nY29hdFwiLCBcIkxvbmdjb2F0XCIsIFwibG9uZ2NvYXRcIiwgXCLlpZfmnI1cIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMDZcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTA2XCIsIFwiUGFudHNcIiwgXCJQYW50c1wiLCBcInBhbnRzXCIsIFwi6KSy5a2QXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTA3XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwN1wiLCBcIlNob2VzXCIsIFwiU2hvZXNcIiwgXCJzaG9lc1wiLCBcIumei+WtkFwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEwOFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMDhcIiwgXCJHbG92ZVwiLCBcIkdsb3ZlXCIsIFwiZ2xvdmVcIiwgXCLmiYvlpZdcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMDlcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTA5XCIsIFwiU2hpZWxkXCIsIFwiU2hpZWxkXCIsIFwic2hpZWxkXCIsIFwi55u+54mMXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTEwXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDExMFwiLCBcIkNhcGVcIiwgXCJDYXBlXCIsIFwiY2FwZVwiLCBcIuaKq+miqFwiLCBcIkVxdWlwXCIpLFxyXG5cclxuXHRcIjAxMjFcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTIxXCIsIFwiV2VhcG9uXCIsIFwi6ZaD5Lqu5YWL6a2vXCIsIFwid2VhcG9uXCIsIFwi6ZaD5Lqu5YWL6a2vXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTIyXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEyMlwiLCBcIldlYXBvblwiLCBcIumdiOmtguWwhOaJi1wiLCBcIndlYXBvblwiLCBcIumdiOmtguWwhOaJi1wiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEyM1wiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMjNcIiwgXCJXZWFwb25cIiwgXCLprZTlio1cIiwgXCJ3ZWFwb25cIiwgXCLprZTlio1cIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMjRcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTI0XCIsIFwiV2VhcG9uXCIsIFwi6IO96YeP5YqNXCIsIFwid2VhcG9uXCIsIFwi6IO96YeP5YqNXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTI1XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEyNVwiLCBcIldlYXBvblwiLCBcIuW5u+eNuOajklwiLCBcIndlYXBvblwiLCBcIuW5u+eNuOajklwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEyNlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMjZcIiwgXCJXZWFwb25cIiwgXCJFU1DpmZDliLblmahcIiwgXCJ3ZWFwb25cIiwgXCJFU1DpmZDliLblmahcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMjdcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTI3XCIsIFwiV2VhcG9uXCIsIFwi6Y6W6Y+IXCIsIFwid2VhcG9uXCIsIFwi6Y6W6Y+IXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTI4XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEyOFwiLCBcIldlYXBvblwiLCBcIumtlOWKm+itt+iFlVwiLCBcIndlYXBvblwiLCBcIumtlOWKm+itt+iFlVwiLCBcIkVxdWlwXCIpLFxyXG5cclxuXHRcIjAxMzBcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTMwXCIsIFwiV2VhcG9uXCIsIFwi5Zau5omL5YqNXCIsIFwid2VhcG9uXCIsIFwi5Zau5omL5YqNXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTMxXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzMVwiLCBcIldlYXBvblwiLCBcIuWWruaJi+aWp1wiLCBcIndlYXBvblwiLCBcIuWWruaJi+aWp1wiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEzMlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMzJcIiwgXCJXZWFwb25cIiwgXCLllq7miYvpjJhcIiwgXCJ3ZWFwb25cIiwgXCLllq7miYvpjJhcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMzNcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTMzXCIsIFwiV2VhcG9uXCIsIFwi55+t5YqNXCIsIFwid2VhcG9uXCIsIFwi55+t5YqNXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTM0XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzNFwiLCBcIldlYXBvblwiLCBcIumbmeWIgFwiLCBcIndlYXBvblwiLCBcIumbmeWIgFwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEzNTI2XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzNTI2XCIsIFwiV2VhcG9uXCIsIFwi6Z2I6a2C5LmL55KwXCIsIFwid2VhcG9uXCIsIFwi6Z2I6a2C5LmL55KwXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTM1MzBcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTM1MzBcIiwgXCJXZWFwb25cIiwgXCLmjqfliLblmahcIiwgXCJ3ZWFwb25cIiwgXCLmjqfliLblmahcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMzZcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTM2XCIsIFwiV2VhcG9uXCIsIFwi5omL5p2WXCIsIFwid2VhcG9uXCIsIFwi5omL5p2WXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTM3XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzN1wiLCBcIldlYXBvblwiLCBcIuefreadllwiLCBcIndlYXBvblwiLCBcIuefreadllwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEzOFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMzhcIiwgXCJXZWFwb25cIiwgXCLplbfmnZZcIiwgXCJ3ZWFwb25cIiwgXCLplbfmnZZcIiwgXCJFcXVpcFwiKSxcclxuXHJcblx0XCIwMTQwXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0MFwiLCBcIldlYXBvblwiLCBcIumbmeaJi+WKjVwiLCBcIndlYXBvblwiLCBcIumbmeaJi+WKjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE0MVwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNDFcIiwgXCJXZWFwb25cIiwgXCLpm5nmiYvmlqdcIiwgXCJ3ZWFwb25cIiwgXCLpm5nmiYvmlqdcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNDJcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTQyXCIsIFwiV2VhcG9uXCIsIFwi6ZuZ5omL5qONXCIsIFwid2VhcG9uXCIsIFwi6ZuZ5omL5qONXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTQzXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0M1wiLCBcIldlYXBvblwiLCBcIuanjVwiLCBcIndlYXBvblwiLCBcIuanjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE0NFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNDRcIiwgXCJXZWFwb25cIiwgXCLnn5tcIiwgXCJ3ZWFwb25cIiwgXCLnn5tcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNDVcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTQ1XCIsIFwiV2VhcG9uXCIsIFwi5byTXCIsIFwid2VhcG9uXCIsIFwi5byTXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTQ2XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0NlwiLCBcIldlYXBvblwiLCBcIuW8qVwiLCBcIndlYXBvblwiLCBcIuW8qVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE0N1wiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNDdcIiwgXCJXZWFwb25cIiwgXCLmi7PlpZdcIiwgXCJ3ZWFwb25cIiwgXCLmi7PlpZdcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNDhcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTQ4XCIsIFwiV2VhcG9uXCIsIFwi5oyH6JmOXCIsIFwid2VhcG9uXCIsIFwi5oyH6JmOXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTQ5XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0OVwiLCBcIldlYXBvblwiLCBcIueBq+anjVwiLCBcIndlYXBvblwiLCBcIueBq+anjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE1MFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNTBcIiwgXCJXZWFwb25cIiwgXCLpj59cIiwgXCJ3ZWFwb25cIiwgXCLpj59cIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNTFcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTUxXCIsIFwiV2VhcG9uXCIsIFwi6Y6sXCIsIFwid2VhcG9uXCIsIFwi6Y6sXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTUyXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE1MlwiLCBcIldlYXBvblwiLCBcIumbmeW8qeanjVwiLCBcIndlYXBvblwiLCBcIumbmeW8qeanjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE1M1wiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNTNcIiwgXCJXZWFwb25cIiwgXCLliqDovrLnoLJcIiwgXCJ3ZWFwb25cIiwgXCLliqDovrLnoLJcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNTRcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTU0XCIsIFwiV2VhcG9uXCIsIFwi5aSq5YiAXCIsIFwid2VhcG9uXCIsIFwi5aSq5YiAXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTU1XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE1NVwiLCBcIldlYXBvblwiLCBcIuaJh+WtkFwiLCBcIndlYXBvblwiLCBcIuaJh+WtkFwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE1NlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNTZcIiwgXCJXZWFwb25cIiwgXCLnkIlcIiwgXCJ3ZWFwb25cIiwgXCLnkIlcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNTdcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTU3XCIsIFwiV2VhcG9uXCIsIFwi55KDXCIsIFwid2VhcG9uXCIsIFwi55KDXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTU4XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE1OFwiLCBcIldlYXBvblwiLCBcIumHjeaLs+anjVwiLCBcIndlYXBvblwiLCBcIumHjeaLs+anjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE3MFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNzBcIiwgXCJXZWFwb25cIiwgXCIwMTcwXCIsIFwid2VhcG9uXCIsIFwi6bue6KOd5q2m5ZmoXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTlcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTlcIiwgXCJUYW1pbmdNb2JcIiwgXCJUYW1pbmdNb2JcIiwgXCJ0YW1pbmdNb2JcIiwgXCLpqI7lr7VcIiwgXCJFcXVpcFwiLCBcIlRhbWluZy9cIiksXHJcblxyXG5cdFwiMDMwMVwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAzMDFcIiwgXCJJbnN0YWxsXCIsIFwiQ2hhaXJcIiwgXCJpbnN0YWxsXCIsIFwi5qSF5a2QXCIsIFwiSXRlbVwiKSxcclxufTtcclxuXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2NhdGVnb3J5TGlzdCA9IChmdW5jdGlvbiAoaW5mb19tYXApIHtcclxuXHRsZXQgbGlzdCA9IFtdO1xyXG5cdGxldCBzZXQgPSBuZXcgU2V0KCk7XHJcblx0Zm9yIChsZXQgaSBpbiBpbmZvX21hcCkge1xyXG5cdFx0bGV0IGNhdCA9IGluZm9fbWFwW2ldO1xyXG5cdFx0bGV0IGtleSA9IGNhdC5jYXRlZ29yeU5hbWUgfHwgY2F0Lmxpc3RQYXRoO1xyXG5cclxuXHRcdGlmICghc2V0LmhhcyhrZXkpKSB7XHJcblx0XHRcdHNldC5hZGQoa2V5KTtcclxuXHJcblx0XHRcdGxpc3QucHVzaCh7XHJcblx0XHRcdFx0a2V5OiBrZXksXHJcblx0XHRcdFx0dmFsdWU6IGksXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbGlzdDtcclxufSkoSXRlbUNhdGVnb3J5SW5mby5faW5mbyk7XHJcblxyXG5cclxuLyoqIEB0eXBlIHtNYXA8c3RyaW5nLEl0ZW1DYXRlZ29yeUluZm99ICovXHJcbkl0ZW1DYXRlZ29yeUluZm8ubWFwX3Nsb3RfdG9faW5mbyA9IChmdW5jdGlvbiAoKSB7XHJcblx0LyoqIEB0eXBlIHtNYXA8c3RyaW5nLEl0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0Y29uc3QgbWFwID0gbmV3IE1hcCgpO1xyXG5cdE9iamVjdC52YWx1ZXMoSXRlbUNhdGVnb3J5SW5mby5faW5mbykuZm9yRWFjaChpbmZvID0+IHtcclxuXHRcdG1hcC5zZXQoaW5mby5zbG90LCBpbmZvKTtcclxuXHR9KTtcclxuXHRyZXR1cm4gbWFwO1xyXG59KSgpO1xyXG5cclxuXHJcbmNsYXNzIEVxdWlwU2xvdHNNYXAge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcFR5cGVcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc2xvdElkXHJcblx0ICogQHJldHVybnMge3N0cmluZ30gc2xvdE5hbWVcclxuXHQgKi9cclxuXHRzdGF0aWMgdG9OYW1lKGVxdWlwVHlwZSwgc2xvdElkKSB7XHJcblx0XHRyZXR1cm4gRXF1aXBTbG90c01hcC5zbG90c190b19uYW1lX21hcFtlcXVpcFR5cGVdW3Nsb3RJZF07XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcFR5cGVcclxuXHQgKiBAcGFyYW0ge0l0ZW1DYXRlZ29yeUluZm99IGluZm9cclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfSBzbG90SWRcclxuXHQgKi9cclxuXHRzdGF0aWMgaW5mb1RvU2xvdChlcXVpcFR5cGUsIGluZm8pIHtcclxuXHRcdHJldHVybiBFcXVpcFNsb3RzTWFwLm1hcF9zbG90c190b190eXBlSW5mb1tlcXVpcFR5cGVdLmdldChpbmZvKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGVxdWlwVHlwZVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWRcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfSBzbG90SWRcclxuXHQgKi9cclxuXHRzdGF0aWMgaXRlbUlkVG9TbG90KGVxdWlwVHlwZSwgaXRlbUlkKSB7XHJcblx0XHRsZXQgaW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KGl0ZW1JZCk7XHJcblx0XHRyZXR1cm4gRXF1aXBTbG90c01hcC5tYXBfc2xvdHNfdG9fdHlwZUluZm9bZXF1aXBUeXBlXS5nZXQoaW5mbyk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcFR5cGVcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc2xvdE5hbWVcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfSBzbG90SWRcclxuXHQgKi9cclxuXHRzdGF0aWMgdG9TbG90KGVxdWlwVHlwZSwgc2xvdE5hbWUpIHtcclxuXHRcdHJldHVybiBFcXVpcFNsb3RzTWFwLm5hbWVfdG9fc2xvdHNfbWFwW2VxdWlwVHlwZV1bc2xvdE5hbWVdO1xyXG5cdH1cclxufVxyXG5cclxuRXF1aXBTbG90c01hcC5zbG90c190b19uYW1lX21hcCA9IHtcclxuXHRFcXVpcDoge1xyXG5cdFx0MTogXCJjYXBcIixcclxuXHRcdDI6IFwiYWNjZXNzb3J5RmFjZVwiLFxyXG5cdFx0MzogXCJhY2Nlc3NvcnlFeWVzXCIsXHJcblx0XHQ0OiBcImFjY2Vzc29yeUVhcnNcIixcclxuXHRcdDU6IFwiY29hdFwiLFxyXG5cdFx0NTogXCJsb25nY29hdFwiLFxyXG5cdFx0NjogXCJwYW50c1wiLFxyXG5cdFx0NzogXCJzaG9lc1wiLFxyXG5cdFx0ODogXCJnbG92ZVwiLFxyXG5cdFx0OTogXCJjYXBlXCIsXHJcblx0XHQxMDogXCJzaGllbGRcIixcclxuXHRcdDExOiBcIndlYXBvblwiLFxyXG5cdH0sXHJcblx0Q2FzaDoge1xyXG5cdH0sXHJcbn1cclxuT2JqZWN0LmtleXMoRXF1aXBTbG90c01hcC5zbG90c190b19uYW1lX21hcC5FcXVpcCkuZm9yRWFjaChzbG90ID0+IHtcclxuXHRFcXVpcFNsb3RzTWFwLnNsb3RzX3RvX25hbWVfbWFwLkNhc2hbTnVtYmVyKHNsb3QpICsgMTAwXSA9IEVxdWlwU2xvdHNNYXAuc2xvdHNfdG9fbmFtZV9tYXAuRXF1aXBbc2xvdF07XHJcbn0pO1xyXG5cclxuRXF1aXBTbG90c01hcC5tYXBfc2xvdHNfdG9fdHlwZUluZm8gPSB7XHJcbn07XHJcbk9iamVjdC5lbnRyaWVzKEVxdWlwU2xvdHNNYXAuc2xvdHNfdG9fbmFtZV9tYXApLmZvckVhY2goKFtzbG90VHlwZU5hbWUsIHNsb3RzXSkgPT4ge1xyXG5cdGNvbnN0IHN0aSA9IEl0ZW1DYXRlZ29yeUluZm8ubWFwX3Nsb3RfdG9faW5mbztcclxuXHRjb25zdCB0eXBlZFNsb3RzID0gRXF1aXBTbG90c01hcC5tYXBfc2xvdHNfdG9fdHlwZUluZm9bc2xvdFR5cGVOYW1lXSA9IG5ldyBNYXAoKTtcclxuXHJcblx0T2JqZWN0LmVudHJpZXMoc2xvdHMpLmZvckVhY2goZnVuY3Rpb24gKFtzbG90SWQsIHNsb3ROYW1lXSkge1xyXG5cdFx0Y29uc3QgaW5mbyA9IHN0aS5nZXQoc2xvdE5hbWUpO1xyXG5cdFx0dHlwZWRTbG90cy5zZXQoaW5mbywgc2xvdElkKTtcclxuXHR9KVxyXG59KTtcclxuXHJcbkVxdWlwU2xvdHNNYXAubmFtZV90b19zbG90c19tYXAgPSB7XHJcbn07XHJcbk9iamVjdC5lbnRyaWVzKEVxdWlwU2xvdHNNYXAuc2xvdHNfdG9fbmFtZV9tYXApLmZvckVhY2goKFtzbG90VHlwZU5hbWUsIHNsb3RzXSkgPT4ge1xyXG5cdGNvbnN0IHN0aSA9IEl0ZW1DYXRlZ29yeUluZm8ubWFwX3Nsb3RfdG9faW5mbztcclxuXHRjb25zdCB0eXBlZFNsb3RzID0gRXF1aXBTbG90c01hcC5uYW1lX3RvX3Nsb3RzX21hcFtzbG90VHlwZU5hbWVdID0ge307XHJcblxyXG5cdE9iamVjdC5lbnRyaWVzKHNsb3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChbc2xvdElkLCBzbG90TmFtZV0pIHtcclxuXHRcdGNvbnN0IGluZm8gPSBzdGkuZ2V0KHNsb3ROYW1lKTtcclxuXHRcdHR5cGVkU2xvdHNbaW5mby5zbG90XSA9IHNsb3RJZDtcclxuXHR9KVxyXG59KTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHRJdGVtQ2F0ZWdvcnlJbmZvLFxyXG5cdEVxdWlwU2xvdHNNYXAsXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///349\n')},353:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return ResourceManager; });\n/* unused harmony export $get */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return ItemAttrNormalize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return CharacterRenderConfig; });\n\ufeff\r\n//import { ItemCategoryInfo } from "../../src/Common/ItemCategoryInfo.js";\r\n\r\nif (window.$ROOT_PATH == null) {\r\n\twindow.$ROOT_PATH = "";\r\n\tconsole.error("window.$ROOT_PATH");\r\n}\r\n\r\nwindow.$noimage = location.search.indexOf("noimage") >= 0;\r\n\r\nconst $failed_urls = [];\r\n\r\nconst $archive = {};\r\n\r\nconst $symbol_partial = Symbol("partial");\r\nconst $symbol_loading = Symbol("loading");\r\n\r\n\r\nwindow.character_emotion_list = ["blink", "hit", "smile", "troubled", "cry", "angry", "bewildered", "stunned",\r\n\t"vomit", "oops", "cheers", "chu", "wink", "pain", "glitter", "despair", "love", "shine", "blaze", "hum",\r\n\t"bowing", "hot", "dam", "qBlue"];\r\n\r\nwindow.character_action_list = ["walk1", "walk2", "stand1", "stand2", "alert", "swingO1", "swingO2", "swingO3", "swingOF", "swingT1",\r\n\t"swingT2", "swingT3", "swingTF", "swingP1", "swingP2", "swingPF", "stabO1", "stabO2", "stabOF", "stabT1",\r\n\t"stabT2", "stabTF", "shoot1", "shoot2", "shootF", "proneStab", "prone", "heal", "fly", "jump", "sit", "ladder",\r\n\t"rope"/*, "dead", "ghostwalk", "ghoststand", "ghostjump", "ghostproneStab", "ghostladder", "ghostrope", "ghostfly",\r\n\t\t"ghostsit"*/];\r\n\r\nclass ResourceManager {\r\n\tstatic get dataRegion() { return (localStorage.region || "TWMS").toUpperCase(); }\r\n\tstatic set dataRegion(value) { localStorage.region = (value || "TWMS").toUpperCase(); }\r\n\tstatic get dataVersion() { return (localStorage.version || "220").toUpperCase(); }\r\n\tstatic set dataVersion(value) { localStorage.version = (value || "220").toUpperCase(); }\r\n\r\n\tstatic isEquipExist(id, cateInfo) {\r\n\t\tconst dp = cateInfo.listPath;\r\n\t\tconst es = ResourceManager.equip_map[dp];\r\n\t\treturn !es || es.has(id);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} url\r\n\t */\r\n\tstatic async loadArchive(url) {\r\n\t\t$setValue($archive, "/", JSON.parse(await ResourceManager.get(url)));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {""|"arraybuffer"|"blob"|"document"|"json"|"text"} responseType\r\n\t */\r\n\tstatic get(url, responseType) {\r\n\t\treturn new Promise(function (resolve, reject) {\r\n\t\t\tlet xhr = new XMLHttpRequest();\r\n\t\t\txhr.open("GET", url, true);\r\n\r\n\t\t\tif (responseType) {\r\n\t\t\t\txhr.responseType = responseType;;\r\n\t\t\t}\r\n\r\n\t\t\txhr.timeout = 10 * 60 * 1000;//20000;\r\n\r\n\t\t\txhr.onload = function () {\r\n\t\t\t\tif (this.status == 404 || this.status == 500) {\r\n\t\t\t\t\t$failed_urls.push(url);\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\t//resolve(null);\r\n\t\t\t\t\treject(this.status + ": " + url);\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.status == 200) {\r\n\t\t\t\t\tresolve(this.response);\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.status == 304) {\r\n\t\t\t\t\tdebugger\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.ontimeout = function (e) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\t// XMLHttpRequest 超时。在此做某事。\r\n\t\t\t\t//resolve(null);\r\n\t\t\t\treject("timeout: " + url);\r\n\t\t\t};\r\n\r\n\t\t\txhr.onabort = function (e) {\r\n\t\t\t\treject("abort: " + url);\r\n\t\t\t};\r\n\r\n\t\t\txhr.send();\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * load equip or item, name and desc\r\n\t * @param {string} itemId\r\n\t * @returns {{info:{icon:{[""]:string},iconRaw:{[""]:string}},name:string,desc:string,[prop:string]:any}}\r\n\t */\r\n\tstatic async getItem(itemId) {\r\n\t\tconst { ItemCategoryInfo } = await __webpack_require__.e(/* import() */ 19).then(__webpack_require__.t.bind(null, 349, 7));\r\n\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tlet info = ItemCategoryInfo.get(itemId);\r\n\t\tif (!info) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet id = itemId.padStart(8, "0");\r\n\t\tif (id[0] != "0") {\r\n\t\t\tthrow new Error("itemId: " + itemId);\r\n\t\t}\r\n\r\n\t\tlet results;\r\n\t\ttry {\r\n\t\t\tresults = await Promise.all([\r\n\t\t\t\t$get.data(info.dataDir + itemId),\r\n\t\t\t\tinfo.stringDir ? $get.data(info.stringDir + Number(itemId)).then(\r\n\t\t\t\t\ta => a, // have name or desc\r\n\t\t\t\t\t() => { return { name: "<" + itemId + ">" }; } // no name and desc\r\n\t\t\t\t) : { name: "<" + itemId + ">" } // no name and desc\r\n\t\t\t]);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow new ex;\r\n\t\t}\r\n\r\n\t\tif (!results[0] || !results[1]) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet data = Object.assign(results[0], results[1]);\r\n\r\n\t\tdata.id = itemId;\r\n\r\n\t\tif (data.info) {\r\n\t\t\t{//editor mode data\r\n\t\t\t\tdata.info.id = itemId;\r\n\t\t\t\tdata.info.name = data.name;\r\n\t\t\t\tif (data.desc) {\r\n\t\t\t\t\tdata.info.desc = data.desc;\r\n\t\t\t\t}\r\n\t\t\t\tdata.info.__v = window.DATA_TAG + window.DATA_VERSION;\r\n\t\t\t}\r\n\r\n\t\t\tif (!data.info.icon) {\r\n\t\t\t\tdata.info.icon = {};\r\n\t\t\t}\r\n\t\t\tif (!data.info.iconRaw) {\r\n\t\t\t\tdata.info.iconRaw = {};\r\n\t\t\t}\r\n\t\t\tif (!data.info.icon[""]) {\r\n\t\t\t\tdata.info.icon[""] = ItemCategoryInfo.getIconUrl(itemId);\r\n\t\t\t}\r\n\t\t\tif (data.info.iconRaw[""]) {\r\n\t\t\t\tdata.info.iconRaw[""] = ItemCategoryInfo.getIconRawUrl(itemId);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tstatic get root_path() {\r\n\t\treturn window.$ROOT_PATH;\r\n\t}\r\n\r\n\tstatic get archive() {\r\n\t\treturn $archive;\r\n\t}\r\n\r\n\tstatic get failed_urls() {\r\n\t\treturn $failed_urls;\r\n\t}\r\n}\r\nwindow.$ResourceManager = ResourceManager;\r\n\r\n/**\r\n * @param {{}} obj\r\n * @param {string} path\r\n * @param {any} value\r\n */\r\nfunction $setValue(obj, path, value) {\r\n\tif (path.endsWith("/")) {\r\n\t\tpath = path.slice(0, path.length - 1);\r\n\t}\r\n\tlet ps = path.split("/");\r\n\tlet i, target = obj, lastIndex = ps.length - 1;\r\n\tfor (i = 0; i < lastIndex; ++i) {\r\n\t\tlet key = ps[i];\r\n\t\tif (target[key] == null) {\r\n\t\t\ttarget[key] = {\r\n\t\t\t\t[$symbol_partial]: true,\r\n\t\t\t};\r\n\t\t\tconsole.info("partial object: ", path);\r\n\t\t}\r\n\t\ttarget = target[key];\r\n\t}\r\n\tlet origin_value = target[ps[lastIndex]];\r\n\tif (origin_value instanceof Promise) {\r\n\t\tdelete target[ps[lastIndex]];\r\n\t\ttarget[ps[lastIndex]] = value;\r\n\t\tif (target[ps[lastIndex]][$symbol_partial]) {\r\n\t\t\tdelete target[key][$symbol_partial];\r\n\t\t\tconsole.info("completed object (promise): ", path);\r\n\t\t}\r\n\t}\r\n\telse if (origin_value && typeof origin_value == "object") {\r\n\t\tif (value instanceof Promise) {\r\n\t\t\tdebugger;\r\n\t\t\torigin_value[$symbol_loading] = value.then(function (data) {\r\n\t\t\t\t//for (let key in value) {\r\n\t\t\t\t//\torigin_value[key] = value[key] || origin_value[key];\r\n\t\t\t\t//}\r\n\t\t\t\tobjectAssignDeep(origin_value, data);\r\n\t\t\t\tif (origin_value[$symbol_partial]) {\r\n\t\t\t\t\tdelete origin_value[$symbol_partial];\r\n\t\t\t\t\tconsole.info("completed object (await promise): ", path);\r\n\t\t\t\t}\r\n\t\t\t\tdelete origin_value[$symbol_loading];\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//for (let key in value) {\r\n\t\t\t//\torigin_value[key] = value[key] || origin_value[key];\r\n\t\t\t//}\r\n\t\t\tobjectAssignDeep(origin_value, value);\r\n\t\t\tif (origin_value[$symbol_partial]) {\r\n\t\t\t\tdelete origin_value[$symbol_partial];\r\n\t\t\t\tconsole.info("completed object (value): ", path);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse if (typeof value != "undefined") {\r\n\t\ttarget[ps[lastIndex]] = value;\r\n\t\tif (target[ps[lastIndex]][$symbol_partial]) {\r\n\t\t\tdelete target[ps[lastIndex]][$symbol_partial];\r\n\t\t\tconsole.info("C: completed object: ", path);\r\n\t\t}\r\n\t}\r\n}\r\nfunction $getValue(obj, path) {\r\n\tif (path.endsWith("/")) {\r\n\t\tpath = path.slice(0, path.length - 1);\r\n\t}\r\n\tlet ps = path.split("/");\r\n\tlet i, target = obj, lastIndex = ps.length - 1;\r\n\tfor (i = 0; i < lastIndex; ++i) {\r\n\t\tlet key = ps[i];\r\n\t\tif (target[key]) {\r\n\t\t\t\ttarget = target[key];\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\treturn target[ps[lastIndex]];\r\n}\r\n\r\nconst symbol_isPack = Symbol("$pack");\r\n\r\nconst url_startsWith_protocol = RegExp.prototype.test.bind(/^(([a-zA-Z^\\:]+)(\\:.*)$|\\/\\/)/);\r\nfunction _setValueByPath(path, value, is_pack) {\r\n\tif (is_pack) {\r\n\t\tvalue[symbol_isPack] = true;\r\n\t}\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn;\r\n\t}\r\n\telse if (window.$ROOT_PATH != "" && path.startsWith(window.$ROOT_PATH)) {\r\n\t\tif (is_pack) {\r\n\t\t\tvalue[symbol_isPack] = true;\r\n\t\t}\r\n\t\tpath = path.slice(window.$ROOT_PATH.length);\r\n\t\treturn $setValue($archive, path, value);\r\n\t}\r\n\telse {\r\n\t\treturn $setValue($archive, path, value);\r\n\t}\r\n}\r\nfunction _getValueFromArchiveByPath(path, value) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tif (_path) {\r\n\t\treturn $getValue($archive, _path);\r\n\t}\r\n\treturn undefined;\r\n}\r\nfunction _getDataPathByUrl(path) {\r\n\tif (!url_startsWith_protocol(path)) {\r\n\t\tif (window.$ROOT_PATH != "" && path.startsWith(window.$ROOT_PATH)) {\r\n\t\t\treturn path.slice(window.$ROOT_PATH.length);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn path;\r\n\t\t}\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\n/**\r\n * @returns {Promise<any>|any}\r\n */\r\nfunction $getValueAsync(obj, path) {\r\n\tif (path.endsWith("/")) {\r\n\t\tpath = path.slice(0, path.length - 1);\r\n\t}\r\n\t\r\n\t// try get value sync\r\n\tlet value = $getValue(obj, path);\r\n\t\r\n\t// if value exist\r\n\tif (value) {\r\n\t\tif (value instanceof Promise) {\r\n\t\t\t// ??\r\n\t\t\treturn new Promise(async function (resolve, reject) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet t = await value;\r\n\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t//resolve(await $getValueAsync(obj, path));\r\n\t\t\t\t}\r\n\t\t\t\tcatch (ex) {\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\treject(ex);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t}\r\n\telse {// if value not exist, try await parent node\r\n\t\tlet ps = path.split("/");\r\n\t\tlet i, target = obj, lastIndex = ps.length - 1;\r\n\t\tfor (i = 0; i < lastIndex; ++i) {\r\n\t\t\tlet key = ps[i];\r\n\t\t\tif (target[key] instanceof Promise) {\r\n\t\t\t\treturn new Promise(async function (resolve, reject) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet t = await target[key];\r\n\t\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t\t//resolve(await $getValueAsync(obj, path));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (ex) {\r\n\t\t\t\t\t\tdebugger;\r\n\t\t\t\t\t\treject(ex);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (target[key]) {\r\n\t\t\t\t\ttarget = target[key];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet result = target[ps[lastIndex]];\r\n\t\tif (result instanceof Promise) {\r\n\t\t\treturn new Promise(async function (resolve, reject) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet t = await result;\r\n\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t//resolve(await $getValueAsync(obj, path));\r\n\t\t\t\t}\r\n\t\t\t\tcatch (ex) {\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\treject(ex);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @returns {Promise<any>}\r\n */\r\nlet $get = function $get(url) {\r\n\treturn ResourceManager.get(url);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.pack = async function $get_pack(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && obj[symbol_isPack]) {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\t//if (process.env.NODE_ENV !== "production") {\r\n\t\t//\tif (obj && !obj[symbol_isPack]) {\r\n\t\t//\t\tthrow new TypeError("data: " + path);\r\n\t\t//\t}\r\n\t\t//}\r\n\t\tconst url = $get.packUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet jsonText = await ResourceManager.get(url);\r\n\r\n\t\t\t\tobj = JSON.parse(jsonText);\r\n\r\n\t\t\t\t_setValueByPath(path, obj, true);\r\n\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, true);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.packSync = function get_packSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn obj;\r\n\t}\r\n\treturn undefined;\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.data = async function $get_data(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && !obj[$symbol_partial]) {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tif (obj && obj[$symbol_partial]) {\r\n\t\t\tconsole.info("complet object: ", path);\r\n\t\t}\r\n\t\tconst url = $get.dataUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet jsonText = await ResourceManager.get(url);\r\n\r\n\t\t\t\tobj = JSON.parse(jsonText);\r\n\r\n\t\t\t\t_setValueByPath(path, obj, false);\r\n\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, false);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {any}\r\n */\r\n$get.dataSync = function get_dataSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn obj;\r\n\t}\r\n\treturn undefined;\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.list = async function $get_list(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\tconsole.warn("$get.list 未完成");\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && !obj[$symbol_partial]) {\r\n\t\tconsole.warn("$get.list 未完成");\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tif (obj && obj[$symbol_partial]) {\r\n\t\t\tconsole.info("complet object: ", path);\r\n\t\t}\r\n\t\tconsole.warn("$get.list 未完成");\r\n\r\n\t\tconst url = $get.listUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet jsonText = await ResourceManager.get(url);\r\n\r\n\t\t\t\tobj = JSON.parse(jsonText);\r\n\r\n\t\t\t\t_setValueByPath(path, obj, false);\r\n\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, false);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.listSync = function $get_listSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn Object.keys(obj);\r\n\t}\r\n\treturn undefined;\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.binary = async function $get_data(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && !obj[$symbol_partial]) {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tif (obj && obj[$symbol_partial]) {\r\n\t\t\tconsole.info("complet object: ", path);\r\n\t\t}\r\n\t\tconst url = $get.binaryUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet buf = await ResourceManager.get(url, "arrayBuffer");\r\n\r\n\t\t\t\t_setValueByPath(path, buf, false);\r\n\r\n\t\t\t\treturn buf;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, false);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {any}\r\n */\r\n$get.binarySync = function get_dataSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn obj;\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.dataUrl = function $get_dataUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("data")) {\r\n\t\treturn `${window.$ROOT_PATH}data${path}.json`;\r\n\t}\r\n\tthrow new Error("Not game data: " + path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.packUrl = function $get_packUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("pack")) {\r\n\t\treturn `${window.$ROOT_PATH}pack${path}.json`;\r\n\t}\r\n\tthrow new Error("Not game pack: " + path);\r\n}\r\n$get.listUrl = function $get_listUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("ls")) {\r\n\t\treturn `${window.$ROOT_PATH}ls${path}.json`;\r\n\t}\r\n\tthrow new Error(path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.binaryUrl = function $get_dataUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("binary")) {\r\n\t\treturn `${window.$ROOT_PATH}binary${path}`;\r\n\t}\r\n\tthrow new Error("Not game binary data: " + path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.imageUrl = function $get_imagesUrl(path) {\r\n\tif (window.$noimage) {\r\n\t\treturn `${window.$ROOT_PATH}images/1x1.png`;\r\n\t}\r\n\t{\r\n\t\tif (url_startsWith_protocol(path)) {\r\n\t\t\treturn path;\r\n\t\t}\r\n\t\telse if (!path.startsWith("images")) {\r\n\t\t\treturn `${window.$ROOT_PATH}images${path}.png`;\r\n\t\t}\r\n\t\tthrow new Error("Not game images: " + path);\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.soundMp3Url = function $get_soundMp3Url(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("sound")) {\r\n\t\treturn `${window.$ROOT_PATH}sound${path}.mp3`;\r\n\t}\r\n\tthrow new Error("Not game sound: " + path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.soundWavUrl = function $get_soundWavUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("sound")) {\r\n\t\treturn `${window.$ROOT_PATH}sound${path}.wav`;\r\n\t}\r\n\tthrow new Error("Not game sound: " + path);\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.assetUrl = function $get_assetUrl(path) {\r\n\treturn `${window.$ROOT_PATH}${path}`;\r\n}\r\n$get.asset = function $get_asset(path) {\r\n\treturn $get($get.assetUrl(path));\r\n}\r\n\r\nwindow.$get = $get;\r\n\r\n\r\nclass ItemAttrNormalize {\r\n\tstatic head(item) {\r\n\t\titem.gender = 2;\r\n\t}\r\n\tstatic body(item) {\r\n\t\titem.gender = 2;\r\n\t}\r\n\tstatic Face(item) {\r\n\t\tconst g = Math.trunc((item.id % 10000) / 1000);\r\n\t\titem.gender = g == 1 || g == 4 ? 1 : 0;\r\n\t}\r\n\tstatic Hair(item) {\r\n\t\tconst g = Math.trunc((item.id % 10000) / 1000);\r\n\t\titem.gender = g == 1 || g == 2 || g == 4 || g == 7 ? 1 : 0;\r\n\t}\r\n\tstatic Cap(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic accessoryFace(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic accessoryEyes(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic accessoryEars(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Coat(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Longcoat(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Pants(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Shoes(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Glove(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Shield(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Cape(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic _equip(item) {\r\n\t\tconst g = Math.trunc((item.id % 10000) / 1000);\r\n\t\titem.gender = g == 0 ? 0 : (g == 1 ? 1 : 2);\r\n\t}\r\n}\r\n\r\nconst regexp_getHairStyleID = /(\\d{4,7})\\d$/;\r\nconst regexp_getFaceStyleID = /(\\d{2,5})\\d(\\d{2})$/;\r\n\r\nconst regexp_getHairColor = /\\d{4,7}(\\d)$/;\r\nconst regexp_getFaceColor = /\\d{2,5}(\\d)\\d{2}$/;\r\n\r\nclass CharacterRenderConfig {\r\n\t/**\r\n\t * @param {string} style id\r\n\t * @returns {string[]}\r\n\t */\r\n\tstatic * enumHairColor(style) {\r\n\t\tlet m = style.match(regexp_getHairStyleID);\r\n\t\tfor (let i = 0; i < 10; ++i) {\r\n\t\t\tlet id = m[1] + i;\r\n\t\t\tyield id;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} style id\r\n\t * @returns {string[]}\r\n\t */\r\n\tstatic * enumFaceColor(style) {\r\n\t\tlet m = style.match(regexp_getFaceStyleID);\r\n\t\tfor (let i = 0; i < 10; ++i) {\r\n\t\t\tlet id = m[1] + i + m[2];\r\n\t\t\tyield id;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} style\r\n\t * @param {number} color\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getColorHairID(style, color) {\r\n\t\tlet m = style.match(regexp_getHairStyleID);\r\n\t\tlet id = m[1] + (color % 10);\r\n\t\treturn id;\r\n\t}\r\n\t/**\r\n\t * @param {string} style\r\n\t * @param {number} color\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getColorFaceID(style, color) {\r\n\t\tlet m = style.match(regexp_getFaceStyleID);\r\n\t\tlet id = m[1] + (color % 10) + m[2];\r\n\t\treturn id;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id_1\r\n\t * @param {string} id_2\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isHairStyleEqual(id_1, id_2) {\r\n\t\treturn CharacterRenderConfig.getColorHairID(id_1, 0) == CharacterRenderConfig.getColorHairID(id_2, 0);\r\n\t}\r\n\t/**\r\n\t * @param {string} id_1\r\n\t * @param {string} id_2\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isFaceStyleEqual(id_1, id_2) {\r\n\t\treturn CharacterRenderConfig.getColorFaceID(id_1, 0) == CharacterRenderConfig.getColorFaceID(id_2, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getHairColor(id) {\r\n\t\tif (id) {\r\n\t\t\tid = String(id);\r\n\t\t\tlet m = id.match(regexp_getHairColor);\r\n\t\t\tif (m) {\r\n\t\t\t\treturn m[1];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getFaceColor(id) {\r\n\t\tif (id) {\r\n\t\t\tid = String(id);\r\n\t\t\tlet m = id.match(regexp_getFaceColor);\r\n\t\t\tif (m) {\r\n\t\t\t\treturn m[1];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar _external_data = {\r\n\t"requiredJobs": [\r\n\t\t"Beginner"\r\n\t],\r\n\t"requiredLevel": 0,\r\n\t"isCash": true,\r\n\t"name": "Blue Beanie",\r\n\t"desc": null,\r\n\t"id": 1000000,\r\n\t"requiredGender": 0,\r\n\t"typeInfo": {\r\n\t\t"overallCategory": "Equip",\r\n\t\t"category": "Armor",\r\n\t\t"subCategory": "Hat"\r\n\t}\r\n};\r\n\r\nvar ItemTypeInfo = {\r\n\t"Equip": {\r\n\t\t"Hat": "Cap",\r\n\t\t"Cape": "Cape",\r\n\t\t"Top": "Coat",\r\n\t\t"Overall": "Longcoat",\r\n\t\t"Glove": "Glove",\r\n\t\t"Bottom": "Pants",\r\n\r\n\t\t"Shield": "Shield",\r\n\t\t"Shoes": "Shoes",\r\n\t\t"Eye Decoration": "accessoryEyes",\r\n\t\t"Earrings": "accessoryEars",\r\n\t\t//"Ring": "",\r\n\r\n\t\t//"Pendant": "",\r\n\t\t"Face Accessory": "accessoryFace",\r\n\t\t//"Belt": "",\r\n\t\t//"Medal": "",\r\n\t\t//"Shoulder Accessory": "",\r\n\t\t//"Badge": "",\r\n\r\n\t\t//"Dragon Equipment": "",\r\n\t\t//"Mechanic Equipment": "",\r\n\t\t//"Pet Equipment": "",\r\n\t\t//"Android": "",\r\n\t\t//"Mechanical Heart": "",\r\n\t\t//"Bits": "",\r\n\r\n\t\t"Face": "Face",\r\n\t\t"Hair": "Hair",\r\n\t},\r\n};\r\n\r\nResourceManager.external = {\r\n\tequip: {\r\n\t},\r\n};\r\n\r\nResourceManager.equip_map = {\r\n};\r\n\r\nfor (let i in ItemTypeInfo.Equip) {\r\n\tlet cate = ItemTypeInfo.Equip[i];\r\n\r\n\tResourceManager.external.equip[cate] = [];\r\n\tResourceManager.equip_map[cate] = null;\r\n}\r\nfor (let i = 0; i < 9; ++i) {\r\n\tlet cate = "Face" + i;\r\n\tResourceManager.external.equip[cate] = [];\r\n\tResourceManager.equip_map[cate] = null;\r\n}\r\nfor (let i = 0; i < 8; ++i) {\r\n\tlet cate = "Hair" + i;\r\n\tResourceManager.external.equip[cate] = [];\r\n\tResourceManager.equip_map[cate] = null;\r\n}\r\n\r\nasync function load_external_resource(url) {\r\n\turl = url || "/items.json";\r\n\tlet raw;\r\n\r\n\t// try {\r\n\t// \traw = ResourceManager._external_raw = JSON.parse(await $get.asset("equip.json"));\r\n\t// \tif (!raw) {\r\n\t// \t\tdebugger;\r\n\t// \t\tthrow Error("\'/equip.json\' is empty");\r\n\t// \t}\r\n\t// }\r\n\t// catch (ex) {\r\n\t\ttry {\r\n\t\t\traw = ResourceManager._external_raw = JSON.parse(await $get(`https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/category/equip`));\r\n\t\t\tif (!raw) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t// }\r\n\t\r\n\tfor (let i = 0; i < raw.length; ++i) {\r\n\t\tconst item = raw[i];\r\n\t\tconst id = String(item.id).padStart(8, "0");\r\n\t\t\r\n\t\ttry {\r\n\t\t\tif (!(item.typeInfo && ItemTypeInfo[item.typeInfo.overallCategory])) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet clz = item.typeInfo.overallCategory.toLowerCase();\r\n\t\t\tlet cate = ItemTypeInfo[item.typeInfo.overallCategory][item.typeInfo.subCategory];\r\n\t\t\tif (!cate) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (cate == "Face") {\r\n\t\t\t\tcate += CharacterRenderConfig.getFaceColor(id);\r\n\t\t\t}\r\n\t\t\telse if (cate == "Hair") {\r\n\t\t\t\tcate += CharacterRenderConfig.getHairColor(id);\r\n\t\t\t}\r\n\r\n\t\t\tlet it = {\r\n\t\t\t\tid: id,\r\n\t\t\t\tname: item.name,\r\n\t\t\t\tdesc: item.desc,\r\n\t\t\t\tcash: item.isCash ? 1 : 0,\r\n\t\t\t\ticon: {\r\n\t\t\t\t\t"": `https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/${item.id}/icon`,\r\n\t\t\t\t},\r\n\t\t\t\t__v: `${ResourceManager.dataRegion}${ResourceManager.dataVersion}`,\r\n\t\t\t};\r\n\r\n\t\t\tResourceManager.external[clz][cate].push(it);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error("external resource: id(" + id + ")");\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction update_external_equip_list() {\r\n\tdebugger;//??\r\n\tconst url = `https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/category/equip`;\r\n\tload_external_resource(url).then(() => {\r\n\t\t_concat_external_resource(category, origin_data);\r\n\t\tconcat_external_resource = _concat_external_resource;\r\n\t\tconsole.log("done: update_external_equip_list");\r\n\t});\r\n}\r\n\r\nlet external_resource_promise = load_external_resource();\r\n\r\nwindow.concat_external_resource = _concat_external_resource_p;\r\n\r\nwindow.trigger_update_external_equip_list = function () {\r\n\texternal_resource_promise = load_external_resource();\r\n\twindow.concat_external_resource = _concat_external_resource_p;\r\n}\r\n\r\nasync function _concat_external_resource_p(category, origin_data) {\r\n\tawait external_resource_promise;\r\n\t_concat_external_resource(category, origin_data);\r\n\tconcat_external_resource = _concat_external_resource;\r\n}\r\n\r\nfunction _concat_external_resource(category, origin_data) {\r\n\ttry {\r\n\t\tconst list = ResourceManager.external.equip[category];\r\n\t\tif (!list) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet id_map = ResourceManager.equip_map[category];\r\n\r\n\t\tif (!id_map) {\r\n\t\t\tid_map = new Map();\r\n\t\t\t\r\n\t\t\torigin_data.forEach(item => {\r\n\t\t\t\tid_map.set(item.id, item);\r\n\t\t\t});\r\n\r\n\t\t\tResourceManager.equip_map[category] = id_map;\r\n\t\t}\r\n\r\n\t\tlist.forEach((item) => {\r\n\t\t\tlet id = item.id;\r\n\t\t\tif (!id_map.has(id)) {\r\n\t\t\t\titem.$foreign = true;\r\n\t\t\t\torigin_data.push(item);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet ori_item = id_map.get(id);\r\n\t\t\t\tori_item._name = item.name || "";\r\n\t\t\t\tori_item._desc = item.desc || "";\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tcatch (ex) {\r\n\t\tconsole.error(ex);\r\n\t\tdebugger;\r\n\t}\r\n}\r\n\r\nwindow.load_extern_item_data = async function (id) {\r\n\tlet _raw = JSON.parse(await $get(`https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/${id}`));\r\n\tlet raw = {};\r\n\r\n\tlet default_ = _raw.frameBooks.default ? _raw.frameBooks.default.frames[0]:null;\r\n\r\n\tfor (let i in _raw.frameBooks) {\r\n\t\tlet _act = _raw.frameBooks[i];\r\n\t\tlet act = [];\r\n\r\n\t\tfor (let j = 0; j < _act.frames.length; ++j) {\r\n\t\t\tlet frame = _act.frames[j] || default_;\r\n\t\t\tif (!frame || !frame.effects) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tlet _frags = frame.effects;\r\n\t\t\tlet frags = {};\r\n\t\t\tfor (let k in _frags) {\r\n\t\t\t\tlet _frag = _frags[k];\r\n\t\t\t\tif (_frag.image) {\r\n\t\t\t\t\tfrags[k] = {\r\n\t\t\t\t\t\t"": "data:image/png;base64," + _frag.image,\r\n\t\t\t\t\t\t"origin": _frag.originOrZero || _frag.origin || _frag.center,\r\n\t\t\t\t\t\t"map": _frag.mapOffset,\r\n\t\t\t\t\t\t"z": _frag.position\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tact[j] = frags;\r\n\t\t}\r\n\r\n\t\traw[i] = act;\r\n\t}\r\n\r\n\traw.info = {\r\n\t\tislot: _raw.metaInfo.islot,\r\n\t\tvslot: _raw.metaInfo.vslot,\r\n\t\ticon: {\r\n\t\t\t"": `https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/${_raw.id}/icon`,\r\n\t\t},\r\n\t\tcash: _raw.metaInfo.cash ? 1 : 0,\r\n\t\t__v: `${ResourceManager.dataRegion}${ResourceManager.dataVersion}`,\r\n\t};\r\n\r\n\treturn raw;\r\n}\r\n\r\nfunction _objectAssignDeep(target, object) {\r\n\tif (target != null && object != null) {\r\n\t\tif (Object.prototype.valueOf.call(object) instanceof String) {\r\n\t\t\ttarget = object;\r\n\t\t}\r\n\t\telse if (Object.prototype.valueOf.call(object) instanceof Number) {\r\n\t\t\ttarget = object;\r\n\t\t}\r\n\t\telse if (Object.prototype.valueOf.call(object) instanceof Boolean) {\r\n\t\t\ttarget = object;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfor (let key in object) {\r\n\t\t\t\tlet value = object[key];\r\n\t\t\t\tif (value != null) {\r\n\t\t\t\t\ttarget[key] = _objectAssignDeep(target[key], value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn target;\r\n}\r\n\r\nfunction objectAssignDeep(target, ...objects) {\r\n\tfor (let object of objects) {\r\n\t\t_objectAssignDeep(target, object);\r\n\t}\r\n\treturn target;\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vcHVibGljL2phdmFzY3JpcHRzL3Jlc291cmNlLmpzPzIzZmUiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbi8vaW1wb3J0IHsgSXRlbUNhdGVnb3J5SW5mbyB9IGZyb20gXCIuLi8uLi9zcmMvQ29tbW9uL0l0ZW1DYXRlZ29yeUluZm8uanNcIjtcclxuXHJcbmlmICh3aW5kb3cuJFJPT1RfUEFUSCA9PSBudWxsKSB7XHJcblx0d2luZG93LiRST09UX1BBVEggPSBcIlwiO1xyXG5cdGNvbnNvbGUuZXJyb3IoXCJ3aW5kb3cuJFJPT1RfUEFUSFwiKTtcclxufVxyXG5cclxud2luZG93LiRub2ltYWdlID0gbG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJub2ltYWdlXCIpID49IDA7XHJcblxyXG5jb25zdCAkZmFpbGVkX3VybHMgPSBbXTtcclxuXHJcbmNvbnN0ICRhcmNoaXZlID0ge307XHJcblxyXG5jb25zdCAkc3ltYm9sX3BhcnRpYWwgPSBTeW1ib2woXCJwYXJ0aWFsXCIpO1xyXG5jb25zdCAkc3ltYm9sX2xvYWRpbmcgPSBTeW1ib2woXCJsb2FkaW5nXCIpO1xyXG5cclxuXHJcbndpbmRvdy5jaGFyYWN0ZXJfZW1vdGlvbl9saXN0ID0gW1wiYmxpbmtcIiwgXCJoaXRcIiwgXCJzbWlsZVwiLCBcInRyb3VibGVkXCIsIFwiY3J5XCIsIFwiYW5ncnlcIiwgXCJiZXdpbGRlcmVkXCIsIFwic3R1bm5lZFwiLFxyXG5cdFwidm9taXRcIiwgXCJvb3BzXCIsIFwiY2hlZXJzXCIsIFwiY2h1XCIsIFwid2lua1wiLCBcInBhaW5cIiwgXCJnbGl0dGVyXCIsIFwiZGVzcGFpclwiLCBcImxvdmVcIiwgXCJzaGluZVwiLCBcImJsYXplXCIsIFwiaHVtXCIsXHJcblx0XCJib3dpbmdcIiwgXCJob3RcIiwgXCJkYW1cIiwgXCJxQmx1ZVwiXTtcclxuXHJcbndpbmRvdy5jaGFyYWN0ZXJfYWN0aW9uX2xpc3QgPSBbXCJ3YWxrMVwiLCBcIndhbGsyXCIsIFwic3RhbmQxXCIsIFwic3RhbmQyXCIsIFwiYWxlcnRcIiwgXCJzd2luZ08xXCIsIFwic3dpbmdPMlwiLCBcInN3aW5nTzNcIiwgXCJzd2luZ09GXCIsIFwic3dpbmdUMVwiLFxyXG5cdFwic3dpbmdUMlwiLCBcInN3aW5nVDNcIiwgXCJzd2luZ1RGXCIsIFwic3dpbmdQMVwiLCBcInN3aW5nUDJcIiwgXCJzd2luZ1BGXCIsIFwic3RhYk8xXCIsIFwic3RhYk8yXCIsIFwic3RhYk9GXCIsIFwic3RhYlQxXCIsXHJcblx0XCJzdGFiVDJcIiwgXCJzdGFiVEZcIiwgXCJzaG9vdDFcIiwgXCJzaG9vdDJcIiwgXCJzaG9vdEZcIiwgXCJwcm9uZVN0YWJcIiwgXCJwcm9uZVwiLCBcImhlYWxcIiwgXCJmbHlcIiwgXCJqdW1wXCIsIFwic2l0XCIsIFwibGFkZGVyXCIsXHJcblx0XCJyb3BlXCIvKiwgXCJkZWFkXCIsIFwiZ2hvc3R3YWxrXCIsIFwiZ2hvc3RzdGFuZFwiLCBcImdob3N0anVtcFwiLCBcImdob3N0cHJvbmVTdGFiXCIsIFwiZ2hvc3RsYWRkZXJcIiwgXCJnaG9zdHJvcGVcIiwgXCJnaG9zdGZseVwiLFxyXG5cdFx0XCJnaG9zdHNpdFwiKi9dO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlc291cmNlTWFuYWdlciB7XHJcblx0c3RhdGljIGdldCBkYXRhUmVnaW9uKCkgeyByZXR1cm4gKGxvY2FsU3RvcmFnZS5yZWdpb24gfHwgXCJUV01TXCIpLnRvVXBwZXJDYXNlKCk7IH1cclxuXHRzdGF0aWMgc2V0IGRhdGFSZWdpb24odmFsdWUpIHsgbG9jYWxTdG9yYWdlLnJlZ2lvbiA9ICh2YWx1ZSB8fCBcIlRXTVNcIikudG9VcHBlckNhc2UoKTsgfVxyXG5cdHN0YXRpYyBnZXQgZGF0YVZlcnNpb24oKSB7IHJldHVybiAobG9jYWxTdG9yYWdlLnZlcnNpb24gfHwgXCIyMjBcIikudG9VcHBlckNhc2UoKTsgfVxyXG5cdHN0YXRpYyBzZXQgZGF0YVZlcnNpb24odmFsdWUpIHsgbG9jYWxTdG9yYWdlLnZlcnNpb24gPSAodmFsdWUgfHwgXCIyMjBcIikudG9VcHBlckNhc2UoKTsgfVxyXG5cclxuXHRzdGF0aWMgaXNFcXVpcEV4aXN0KGlkLCBjYXRlSW5mbykge1xyXG5cdFx0Y29uc3QgZHAgPSBjYXRlSW5mby5saXN0UGF0aDtcclxuXHRcdGNvbnN0IGVzID0gUmVzb3VyY2VNYW5hZ2VyLmVxdWlwX21hcFtkcF07XHJcblx0XHRyZXR1cm4gIWVzIHx8IGVzLmhhcyhpZCk7XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcclxuXHQgKi9cclxuXHRzdGF0aWMgYXN5bmMgbG9hZEFyY2hpdmUodXJsKSB7XHJcblx0XHQkc2V0VmFsdWUoJGFyY2hpdmUsIFwiL1wiLCBKU09OLnBhcnNlKGF3YWl0IFJlc291cmNlTWFuYWdlci5nZXQodXJsKSkpO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHBhcmFtIHtcIlwifFwiYXJyYXlidWZmZXJcInxcImJsb2JcInxcImRvY3VtZW50XCJ8XCJqc29uXCJ8XCJ0ZXh0XCJ9IHJlc3BvbnNlVHlwZVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBnZXQodXJsLCByZXNwb25zZVR5cGUpIHtcclxuXHRcdHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblx0XHRcdGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHRcdFx0eGhyLm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcclxuXHJcblx0XHRcdGlmIChyZXNwb25zZVR5cGUpIHtcclxuXHRcdFx0XHR4aHIucmVzcG9uc2VUeXBlID0gcmVzcG9uc2VUeXBlOztcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0eGhyLnRpbWVvdXQgPSAxMCAqIDYwICogMTAwMDsvLzIwMDAwO1xyXG5cclxuXHRcdFx0eGhyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRpZiAodGhpcy5zdGF0dXMgPT0gNDA0IHx8IHRoaXMuc3RhdHVzID09IDUwMCkge1xyXG5cdFx0XHRcdFx0JGZhaWxlZF91cmxzLnB1c2godXJsKTtcclxuXHRcdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdFx0Ly9yZXNvbHZlKG51bGwpO1xyXG5cdFx0XHRcdFx0cmVqZWN0KHRoaXMuc3RhdHVzICsgXCI6IFwiICsgdXJsKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAodGhpcy5zdGF0dXMgPT0gMjAwKSB7XHJcblx0XHRcdFx0XHRyZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmICh0aGlzLnN0YXR1cyA9PSAzMDQpIHtcclxuXHRcdFx0XHRcdGRlYnVnZ2VyXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0eGhyLm9udGltZW91dCA9IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0Ly8gWE1MSHR0cFJlcXVlc3Qg6LaF5pe244CC5Zyo5q2k5YGa5p+Q5LqL44CCXHJcblx0XHRcdFx0Ly9yZXNvbHZlKG51bGwpO1xyXG5cdFx0XHRcdHJlamVjdChcInRpbWVvdXQ6IFwiICsgdXJsKTtcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdHhoci5vbmFib3J0ID0gZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRyZWplY3QoXCJhYm9ydDogXCIgKyB1cmwpO1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0eGhyLnNlbmQoKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBsb2FkIGVxdWlwIG9yIGl0ZW0sIG5hbWUgYW5kIGRlc2NcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaXRlbUlkXHJcblx0ICogQHJldHVybnMge3tpbmZvOntpY29uOntbXCJcIl06c3RyaW5nfSxpY29uUmF3OntbXCJcIl06c3RyaW5nfX0sbmFtZTpzdHJpbmcsZGVzYzpzdHJpbmcsW3Byb3A6c3RyaW5nXTphbnl9fVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBhc3luYyBnZXRJdGVtKGl0ZW1JZCkge1xyXG5cdFx0Y29uc3QgeyBJdGVtQ2F0ZWdvcnlJbmZvIH0gPSBhd2FpdCBpbXBvcnQoXCIuLi8uLi9zcmMvQ29tbW9uL0l0ZW1DYXRlZ29yeUluZm8uanNcIik7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtJdGVtQ2F0ZWdvcnlJbmZvfSAqL1xyXG5cdFx0bGV0IGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldChpdGVtSWQpO1xyXG5cdFx0aWYgKCFpbmZvKSB7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBpZCA9IGl0ZW1JZC5wYWRTdGFydCg4LCBcIjBcIik7XHJcblx0XHRpZiAoaWRbMF0gIT0gXCIwXCIpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKFwiaXRlbUlkOiBcIiArIGl0ZW1JZCk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHJlc3VsdHM7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRyZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG5cdFx0XHRcdCRnZXQuZGF0YShpbmZvLmRhdGFEaXIgKyBpdGVtSWQpLFxyXG5cdFx0XHRcdGluZm8uc3RyaW5nRGlyID8gJGdldC5kYXRhKGluZm8uc3RyaW5nRGlyICsgTnVtYmVyKGl0ZW1JZCkpLnRoZW4oXHJcblx0XHRcdFx0XHRhID0+IGEsIC8vIGhhdmUgbmFtZSBvciBkZXNjXHJcblx0XHRcdFx0XHQoKSA9PiB7IHJldHVybiB7IG5hbWU6IFwiPFwiICsgaXRlbUlkICsgXCI+XCIgfTsgfSAvLyBubyBuYW1lIGFuZCBkZXNjXHJcblx0XHRcdFx0KSA6IHsgbmFtZTogXCI8XCIgKyBpdGVtSWQgKyBcIj5cIiB9IC8vIG5vIG5hbWUgYW5kIGRlc2NcclxuXHRcdFx0XSk7XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0dGhyb3cgbmV3IGV4O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghcmVzdWx0c1swXSB8fCAhcmVzdWx0c1sxXSkge1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHRcdGxldCBkYXRhID0gT2JqZWN0LmFzc2lnbihyZXN1bHRzWzBdLCByZXN1bHRzWzFdKTtcclxuXHJcblx0XHRkYXRhLmlkID0gaXRlbUlkO1xyXG5cclxuXHRcdGlmIChkYXRhLmluZm8pIHtcclxuXHRcdFx0ey8vZWRpdG9yIG1vZGUgZGF0YVxyXG5cdFx0XHRcdGRhdGEuaW5mby5pZCA9IGl0ZW1JZDtcclxuXHRcdFx0XHRkYXRhLmluZm8ubmFtZSA9IGRhdGEubmFtZTtcclxuXHRcdFx0XHRpZiAoZGF0YS5kZXNjKSB7XHJcblx0XHRcdFx0XHRkYXRhLmluZm8uZGVzYyA9IGRhdGEuZGVzYztcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZGF0YS5pbmZvLl9fdiA9IHdpbmRvdy5EQVRBX1RBRyArIHdpbmRvdy5EQVRBX1ZFUlNJT047XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICghZGF0YS5pbmZvLmljb24pIHtcclxuXHRcdFx0XHRkYXRhLmluZm8uaWNvbiA9IHt9O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICghZGF0YS5pbmZvLmljb25SYXcpIHtcclxuXHRcdFx0XHRkYXRhLmluZm8uaWNvblJhdyA9IHt9O1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICghZGF0YS5pbmZvLmljb25bXCJcIl0pIHtcclxuXHRcdFx0XHRkYXRhLmluZm8uaWNvbltcIlwiXSA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0SWNvblVybChpdGVtSWQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChkYXRhLmluZm8uaWNvblJhd1tcIlwiXSkge1xyXG5cdFx0XHRcdGRhdGEuaW5mby5pY29uUmF3W1wiXCJdID0gSXRlbUNhdGVnb3J5SW5mby5nZXRJY29uUmF3VXJsKGl0ZW1JZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gZGF0YTtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBnZXQgcm9vdF9wYXRoKCkge1xyXG5cdFx0cmV0dXJuIHdpbmRvdy4kUk9PVF9QQVRIO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldCBhcmNoaXZlKCkge1xyXG5cdFx0cmV0dXJuICRhcmNoaXZlO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldCBmYWlsZWRfdXJscygpIHtcclxuXHRcdHJldHVybiAkZmFpbGVkX3VybHM7XHJcblx0fVxyXG59XHJcbndpbmRvdy4kUmVzb3VyY2VNYW5hZ2VyID0gUmVzb3VyY2VNYW5hZ2VyO1xyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7e319IG9ialxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcGFyYW0ge2FueX0gdmFsdWVcclxuICovXHJcbmZ1bmN0aW9uICRzZXRWYWx1ZShvYmosIHBhdGgsIHZhbHVlKSB7XHJcblx0aWYgKHBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XHJcblx0XHRwYXRoID0gcGF0aC5zbGljZSgwLCBwYXRoLmxlbmd0aCAtIDEpO1xyXG5cdH1cclxuXHRsZXQgcHMgPSBwYXRoLnNwbGl0KFwiL1wiKTtcclxuXHRsZXQgaSwgdGFyZ2V0ID0gb2JqLCBsYXN0SW5kZXggPSBwcy5sZW5ndGggLSAxO1xyXG5cdGZvciAoaSA9IDA7IGkgPCBsYXN0SW5kZXg7ICsraSkge1xyXG5cdFx0bGV0IGtleSA9IHBzW2ldO1xyXG5cdFx0aWYgKHRhcmdldFtrZXldID09IG51bGwpIHtcclxuXHRcdFx0dGFyZ2V0W2tleV0gPSB7XHJcblx0XHRcdFx0WyRzeW1ib2xfcGFydGlhbF06IHRydWUsXHJcblx0XHRcdH07XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcInBhcnRpYWwgb2JqZWN0OiBcIiwgcGF0aCk7XHJcblx0XHR9XHJcblx0XHR0YXJnZXQgPSB0YXJnZXRba2V5XTtcclxuXHR9XHJcblx0bGV0IG9yaWdpbl92YWx1ZSA9IHRhcmdldFtwc1tsYXN0SW5kZXhdXTtcclxuXHRpZiAob3JpZ2luX3ZhbHVlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG5cdFx0ZGVsZXRlIHRhcmdldFtwc1tsYXN0SW5kZXhdXTtcclxuXHRcdHRhcmdldFtwc1tsYXN0SW5kZXhdXSA9IHZhbHVlO1xyXG5cdFx0aWYgKHRhcmdldFtwc1tsYXN0SW5kZXhdXVskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRcdGRlbGV0ZSB0YXJnZXRba2V5XVskc3ltYm9sX3BhcnRpYWxdO1xyXG5cdFx0XHRjb25zb2xlLmluZm8oXCJjb21wbGV0ZWQgb2JqZWN0IChwcm9taXNlKTogXCIsIHBhdGgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIGlmIChvcmlnaW5fdmFsdWUgJiYgdHlwZW9mIG9yaWdpbl92YWx1ZSA9PSBcIm9iamVjdFwiKSB7XHJcblx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRvcmlnaW5fdmFsdWVbJHN5bWJvbF9sb2FkaW5nXSA9IHZhbHVlLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcclxuXHRcdFx0XHQvL2ZvciAobGV0IGtleSBpbiB2YWx1ZSkge1xyXG5cdFx0XHRcdC8vXHRvcmlnaW5fdmFsdWVba2V5XSA9IHZhbHVlW2tleV0gfHwgb3JpZ2luX3ZhbHVlW2tleV07XHJcblx0XHRcdFx0Ly99XHJcblx0XHRcdFx0b2JqZWN0QXNzaWduRGVlcChvcmlnaW5fdmFsdWUsIGRhdGEpO1xyXG5cdFx0XHRcdGlmIChvcmlnaW5fdmFsdWVbJHN5bWJvbF9wYXJ0aWFsXSkge1xyXG5cdFx0XHRcdFx0ZGVsZXRlIG9yaWdpbl92YWx1ZVskc3ltYm9sX3BhcnRpYWxdO1xyXG5cdFx0XHRcdFx0Y29uc29sZS5pbmZvKFwiY29tcGxldGVkIG9iamVjdCAoYXdhaXQgcHJvbWlzZSk6IFwiLCBwYXRoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZGVsZXRlIG9yaWdpbl92YWx1ZVskc3ltYm9sX2xvYWRpbmddO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHQvL2ZvciAobGV0IGtleSBpbiB2YWx1ZSkge1xyXG5cdFx0XHQvL1x0b3JpZ2luX3ZhbHVlW2tleV0gPSB2YWx1ZVtrZXldIHx8IG9yaWdpbl92YWx1ZVtrZXldO1xyXG5cdFx0XHQvL31cclxuXHRcdFx0b2JqZWN0QXNzaWduRGVlcChvcmlnaW5fdmFsdWUsIHZhbHVlKTtcclxuXHRcdFx0aWYgKG9yaWdpbl92YWx1ZVskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRcdFx0ZGVsZXRlIG9yaWdpbl92YWx1ZVskc3ltYm9sX3BhcnRpYWxdO1xyXG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcImNvbXBsZXRlZCBvYmplY3QgKHZhbHVlKTogXCIsIHBhdGgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSAhPSBcInVuZGVmaW5lZFwiKSB7XHJcblx0XHR0YXJnZXRbcHNbbGFzdEluZGV4XV0gPSB2YWx1ZTtcclxuXHRcdGlmICh0YXJnZXRbcHNbbGFzdEluZGV4XV1bJHN5bWJvbF9wYXJ0aWFsXSkge1xyXG5cdFx0XHRkZWxldGUgdGFyZ2V0W3BzW2xhc3RJbmRleF1dWyRzeW1ib2xfcGFydGlhbF07XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcIkM6IGNvbXBsZXRlZCBvYmplY3Q6IFwiLCBwYXRoKTtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuZnVuY3Rpb24gJGdldFZhbHVlKG9iaiwgcGF0aCkge1xyXG5cdGlmIChwYXRoLmVuZHNXaXRoKFwiL1wiKSkge1xyXG5cdFx0cGF0aCA9IHBhdGguc2xpY2UoMCwgcGF0aC5sZW5ndGggLSAxKTtcclxuXHR9XHJcblx0bGV0IHBzID0gcGF0aC5zcGxpdChcIi9cIik7XHJcblx0bGV0IGksIHRhcmdldCA9IG9iaiwgbGFzdEluZGV4ID0gcHMubGVuZ3RoIC0gMTtcclxuXHRmb3IgKGkgPSAwOyBpIDwgbGFzdEluZGV4OyArK2kpIHtcclxuXHRcdGxldCBrZXkgPSBwc1tpXTtcclxuXHRcdGlmICh0YXJnZXRba2V5XSkge1xyXG5cdFx0XHRcdHRhcmdldCA9IHRhcmdldFtrZXldO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJldHVybiB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB0YXJnZXRbcHNbbGFzdEluZGV4XV07XHJcbn1cclxuXHJcbmNvbnN0IHN5bWJvbF9pc1BhY2sgPSBTeW1ib2woXCIkcGFja1wiKTtcclxuXHJcbmNvbnN0IHVybF9zdGFydHNXaXRoX3Byb3RvY29sID0gUmVnRXhwLnByb3RvdHlwZS50ZXN0LmJpbmQoL14oKFthLXpBLVpeXFw6XSspKFxcOi4qKSR8XFwvXFwvKS8pO1xyXG5mdW5jdGlvbiBfc2V0VmFsdWVCeVBhdGgocGF0aCwgdmFsdWUsIGlzX3BhY2spIHtcclxuXHRpZiAoaXNfcGFjaykge1xyXG5cdFx0dmFsdWVbc3ltYm9sX2lzUGFja10gPSB0cnVlO1xyXG5cdH1cclxuXHRpZiAodXJsX3N0YXJ0c1dpdGhfcHJvdG9jb2wocGF0aCkpIHtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0ZWxzZSBpZiAod2luZG93LiRST09UX1BBVEggIT0gXCJcIiAmJiBwYXRoLnN0YXJ0c1dpdGgod2luZG93LiRST09UX1BBVEgpKSB7XHJcblx0XHRpZiAoaXNfcGFjaykge1xyXG5cdFx0XHR2YWx1ZVtzeW1ib2xfaXNQYWNrXSA9IHRydWU7XHJcblx0XHR9XHJcblx0XHRwYXRoID0gcGF0aC5zbGljZSh3aW5kb3cuJFJPT1RfUEFUSC5sZW5ndGgpO1xyXG5cdFx0cmV0dXJuICRzZXRWYWx1ZSgkYXJjaGl2ZSwgcGF0aCwgdmFsdWUpO1xyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdHJldHVybiAkc2V0VmFsdWUoJGFyY2hpdmUsIHBhdGgsIHZhbHVlKTtcclxuXHR9XHJcbn1cclxuZnVuY3Rpb24gX2dldFZhbHVlRnJvbUFyY2hpdmVCeVBhdGgocGF0aCwgdmFsdWUpIHtcclxuXHRsZXQgX3BhdGggPSBfZ2V0RGF0YVBhdGhCeVVybChwYXRoKTtcclxuXHRpZiAoX3BhdGgpIHtcclxuXHRcdHJldHVybiAkZ2V0VmFsdWUoJGFyY2hpdmUsIF9wYXRoKTtcclxuXHR9XHJcblx0cmV0dXJuIHVuZGVmaW5lZDtcclxufVxyXG5mdW5jdGlvbiBfZ2V0RGF0YVBhdGhCeVVybChwYXRoKSB7XHJcblx0aWYgKCF1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0aWYgKHdpbmRvdy4kUk9PVF9QQVRIICE9IFwiXCIgJiYgcGF0aC5zdGFydHNXaXRoKHdpbmRvdy4kUk9PVF9QQVRIKSkge1xyXG5cdFx0XHRyZXR1cm4gcGF0aC5zbGljZSh3aW5kb3cuJFJPT1RfUEFUSC5sZW5ndGgpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJldHVybiBwYXRoO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gdW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogQHJldHVybnMge1Byb21pc2U8YW55Pnxhbnl9XHJcbiAqL1xyXG5mdW5jdGlvbiAkZ2V0VmFsdWVBc3luYyhvYmosIHBhdGgpIHtcclxuXHRpZiAocGF0aC5lbmRzV2l0aChcIi9cIikpIHtcclxuXHRcdHBhdGggPSBwYXRoLnNsaWNlKDAsIHBhdGgubGVuZ3RoIC0gMSk7XHJcblx0fVxyXG5cdFxyXG5cdC8vIHRyeSBnZXQgdmFsdWUgc3luY1xyXG5cdGxldCB2YWx1ZSA9ICRnZXRWYWx1ZShvYmosIHBhdGgpO1xyXG5cdFxyXG5cdC8vIGlmIHZhbHVlIGV4aXN0XHJcblx0aWYgKHZhbHVlKSB7XHJcblx0XHRpZiAodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRcdC8vID8/XHJcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShhc3luYyBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGxldCB0ID0gYXdhaXQgdmFsdWU7XHJcblx0XHRcdFx0XHRyZXNvbHZlKHQpO1xyXG5cdFx0XHRcdFx0Ly9yZXNvbHZlKGF3YWl0ICRnZXRWYWx1ZUFzeW5jKG9iaiwgcGF0aCkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdFx0cmVqZWN0KGV4KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJldHVybiB2YWx1ZTtcclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSB7Ly8gaWYgdmFsdWUgbm90IGV4aXN0LCB0cnkgYXdhaXQgcGFyZW50IG5vZGVcclxuXHRcdGxldCBwcyA9IHBhdGguc3BsaXQoXCIvXCIpO1xyXG5cdFx0bGV0IGksIHRhcmdldCA9IG9iaiwgbGFzdEluZGV4ID0gcHMubGVuZ3RoIC0gMTtcclxuXHRcdGZvciAoaSA9IDA7IGkgPCBsYXN0SW5kZXg7ICsraSkge1xyXG5cdFx0XHRsZXQga2V5ID0gcHNbaV07XHJcblx0XHRcdGlmICh0YXJnZXRba2V5XSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuXHRcdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoYXN5bmMgZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG5cdFx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdFx0bGV0IHQgPSBhd2FpdCB0YXJnZXRba2V5XTtcclxuXHRcdFx0XHRcdFx0cmVzb2x2ZSh0KTtcclxuXHRcdFx0XHRcdFx0Ly9yZXNvbHZlKGF3YWl0ICRnZXRWYWx1ZUFzeW5jKG9iaiwgcGF0aCkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdFx0XHRyZWplY3QoZXgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICh0YXJnZXRba2V5XSkge1xyXG5cdFx0XHRcdFx0dGFyZ2V0ID0gdGFyZ2V0W2tleV07XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0bGV0IHJlc3VsdCA9IHRhcmdldFtwc1tsYXN0SW5kZXhdXTtcclxuXHRcdGlmIChyZXN1bHQgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShhc3luYyBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGxldCB0ID0gYXdhaXQgcmVzdWx0O1xyXG5cdFx0XHRcdFx0cmVzb2x2ZSh0KTtcclxuXHRcdFx0XHRcdC8vcmVzb2x2ZShhd2FpdCAkZ2V0VmFsdWVBc3luYyhvYmosIHBhdGgpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0XHRcdHJlamVjdChleCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcclxuICogQHJldHVybnMge1Byb21pc2U8YW55Pn1cclxuICovXHJcbmV4cG9ydCBsZXQgJGdldCA9IGZ1bmN0aW9uICRnZXQodXJsKSB7XHJcblx0cmV0dXJuIFJlc291cmNlTWFuYWdlci5nZXQodXJsKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge1Byb21pc2U8YW55Pn1cclxuICovXHJcbiRnZXQucGFjayA9IGFzeW5jIGZ1bmN0aW9uICRnZXRfcGFjayhwYXRoKSB7XHJcblx0bGV0IF9wYXRoID0gX2dldERhdGFQYXRoQnlVcmwocGF0aCk7XHJcblx0bGV0IG9iajtcclxuXHJcblx0aWYgKF9wYXRoKSB7XHJcblx0XHRvYmogPSAkZ2V0VmFsdWVBc3luYygkYXJjaGl2ZSwgX3BhdGgpO1xyXG5cdH1cclxuXHJcblx0aWYgKG9iaiBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuXHRcdHJldHVybiBhd2FpdCBvYmo7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG9iaiAmJiBvYmpbc3ltYm9sX2lzUGFja10pIHtcclxuXHRcdHJldHVybiBvYmo7XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0Ly9pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XHJcblx0XHQvL1x0aWYgKG9iaiAmJiAhb2JqW3N5bWJvbF9pc1BhY2tdKSB7XHJcblx0XHQvL1x0XHR0aHJvdyBuZXcgVHlwZUVycm9yKFwiZGF0YTogXCIgKyBwYXRoKTtcclxuXHRcdC8vXHR9XHJcblx0XHQvL31cclxuXHRcdGNvbnN0IHVybCA9ICRnZXQucGFja1VybChwYXRoKTtcclxuXHJcblx0XHRsZXQgdGFzayA9IChhc3luYyBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGpzb25UZXh0ID0gYXdhaXQgUmVzb3VyY2VNYW5hZ2VyLmdldCh1cmwpO1xyXG5cclxuXHRcdFx0XHRvYmogPSBKU09OLnBhcnNlKGpzb25UZXh0KTtcclxuXHJcblx0XHRcdFx0X3NldFZhbHVlQnlQYXRoKHBhdGgsIG9iaiwgdHJ1ZSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBvYmo7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fSkoKTtcclxuXHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCB0YXNrLCB0cnVlKTtcclxuXHJcblx0XHRyZXR1cm4gYXdhaXQgdGFzaztcclxuXHR9XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XHJcbiAqL1xyXG4kZ2V0LnBhY2tTeW5jID0gZnVuY3Rpb24gZ2V0X3BhY2tTeW5jKHBhdGgpIHtcclxuXHRsZXQgb2JqID0gX2dldFZhbHVlRnJvbUFyY2hpdmVCeVBhdGgocGF0aCk7XHJcblx0aWYgKG9iaikge1xyXG5cdFx0cmV0dXJuIG9iajtcclxuXHR9XHJcblx0cmV0dXJuIHVuZGVmaW5lZDtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge1Byb21pc2U8YW55Pn1cclxuICovXHJcbiRnZXQuZGF0YSA9IGFzeW5jIGZ1bmN0aW9uICRnZXRfZGF0YShwYXRoKSB7XHJcblx0bGV0IF9wYXRoID0gX2dldERhdGFQYXRoQnlVcmwocGF0aCk7XHJcblx0bGV0IG9iajtcclxuXHJcblx0aWYgKF9wYXRoKSB7XHJcblx0XHRvYmogPSAkZ2V0VmFsdWVBc3luYygkYXJjaGl2ZSwgX3BhdGgpO1xyXG5cdH1cclxuXHJcblx0aWYgKG9iaiBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuXHRcdHJldHVybiBhd2FpdCBvYmo7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG9iaiAmJiAhb2JqWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdHJldHVybiBvYmo7XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0aWYgKG9iaiAmJiBvYmpbJHN5bWJvbF9wYXJ0aWFsXSkge1xyXG5cdFx0XHRjb25zb2xlLmluZm8oXCJjb21wbGV0IG9iamVjdDogXCIsIHBhdGgpO1xyXG5cdFx0fVxyXG5cdFx0Y29uc3QgdXJsID0gJGdldC5kYXRhVXJsKHBhdGgpO1xyXG5cclxuXHRcdGxldCB0YXNrID0gKGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRsZXQganNvblRleHQgPSBhd2FpdCBSZXNvdXJjZU1hbmFnZXIuZ2V0KHVybCk7XHJcblxyXG5cdFx0XHRcdG9iaiA9IEpTT04ucGFyc2UoanNvblRleHQpO1xyXG5cclxuXHRcdFx0XHRfc2V0VmFsdWVCeVBhdGgocGF0aCwgb2JqLCBmYWxzZSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBvYmo7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fSkoKTtcclxuXHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCB0YXNrLCBmYWxzZSk7XHJcblxyXG5cdFx0cmV0dXJuIGF3YWl0IHRhc2s7XHJcblx0fVxyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7YW55fVxyXG4gKi9cclxuJGdldC5kYXRhU3luYyA9IGZ1bmN0aW9uIGdldF9kYXRhU3luYyhwYXRoKSB7XHJcblx0bGV0IG9iaiA9IF9nZXRWYWx1ZUZyb21BcmNoaXZlQnlQYXRoKHBhdGgpO1xyXG5cdGlmIChvYmopIHtcclxuXHRcdHJldHVybiBvYmo7XHJcblx0fVxyXG5cdHJldHVybiB1bmRlZmluZWQ7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XHJcbiAqL1xyXG4kZ2V0Lmxpc3QgPSBhc3luYyBmdW5jdGlvbiAkZ2V0X2xpc3QocGF0aCkge1xyXG5cdGxldCBfcGF0aCA9IF9nZXREYXRhUGF0aEJ5VXJsKHBhdGgpO1xyXG5cdGxldCBvYmo7XHJcblxyXG5cdGlmIChfcGF0aCkge1xyXG5cdFx0b2JqID0gJGdldFZhbHVlQXN5bmMoJGFyY2hpdmUsIF9wYXRoKTtcclxuXHR9XHJcblxyXG5cdGlmIChvYmogaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRjb25zb2xlLndhcm4oXCIkZ2V0Lmxpc3Qg5pyq5a6M5oiQXCIpO1xyXG5cdFx0cmV0dXJuIGF3YWl0IG9iajtcclxuXHR9XHJcblx0ZWxzZSBpZiAob2JqICYmICFvYmpbJHN5bWJvbF9wYXJ0aWFsXSkge1xyXG5cdFx0Y29uc29sZS53YXJuKFwiJGdldC5saXN0IOacquWujOaIkFwiKTtcclxuXHRcdHJldHVybiBvYmo7XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0aWYgKG9iaiAmJiBvYmpbJHN5bWJvbF9wYXJ0aWFsXSkge1xyXG5cdFx0XHRjb25zb2xlLmluZm8oXCJjb21wbGV0IG9iamVjdDogXCIsIHBhdGgpO1xyXG5cdFx0fVxyXG5cdFx0Y29uc29sZS53YXJuKFwiJGdldC5saXN0IOacquWujOaIkFwiKTtcclxuXHJcblx0XHRjb25zdCB1cmwgPSAkZ2V0Lmxpc3RVcmwocGF0aCk7XHJcblxyXG5cdFx0bGV0IHRhc2sgPSAoYXN5bmMgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGxldCBqc29uVGV4dCA9IGF3YWl0IFJlc291cmNlTWFuYWdlci5nZXQodXJsKTtcclxuXHJcblx0XHRcdFx0b2JqID0gSlNPTi5wYXJzZShqc29uVGV4dCk7XHJcblxyXG5cdFx0XHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCBvYmosIGZhbHNlKTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIG9iajtcclxuXHRcdFx0fVxyXG5cdFx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xyXG5cdFx0XHR9XHJcblx0XHR9KSgpO1xyXG5cdFx0X3NldFZhbHVlQnlQYXRoKHBhdGgsIHRhc2ssIGZhbHNlKTtcclxuXHJcblx0XHRyZXR1cm4gYXdhaXQgdGFzaztcclxuXHR9XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XHJcbiAqL1xyXG4kZ2V0Lmxpc3RTeW5jID0gZnVuY3Rpb24gJGdldF9saXN0U3luYyhwYXRoKSB7XHJcblx0bGV0IG9iaiA9IF9nZXRWYWx1ZUZyb21BcmNoaXZlQnlQYXRoKHBhdGgpO1xyXG5cdGlmIChvYmopIHtcclxuXHRcdHJldHVybiBPYmplY3Qua2V5cyhvYmopO1xyXG5cdH1cclxuXHRyZXR1cm4gdW5kZWZpbmVkO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxyXG4gKi9cclxuJGdldC5iaW5hcnkgPSBhc3luYyBmdW5jdGlvbiAkZ2V0X2RhdGEocGF0aCkge1xyXG5cdGxldCBfcGF0aCA9IF9nZXREYXRhUGF0aEJ5VXJsKHBhdGgpO1xyXG5cdGxldCBvYmo7XHJcblxyXG5cdGlmIChfcGF0aCkge1xyXG5cdFx0b2JqID0gJGdldFZhbHVlQXN5bmMoJGFyY2hpdmUsIF9wYXRoKTtcclxuXHR9XHJcblxyXG5cdGlmIChvYmogaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRyZXR1cm4gYXdhaXQgb2JqO1xyXG5cdH1cclxuXHRlbHNlIGlmIChvYmogJiYgIW9ialskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdGlmIChvYmogJiYgb2JqWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdFx0Y29uc29sZS5pbmZvKFwiY29tcGxldCBvYmplY3Q6IFwiLCBwYXRoKTtcclxuXHRcdH1cclxuXHRcdGNvbnN0IHVybCA9ICRnZXQuYmluYXJ5VXJsKHBhdGgpO1xyXG5cclxuXHRcdGxldCB0YXNrID0gKGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRsZXQgYnVmID0gYXdhaXQgUmVzb3VyY2VNYW5hZ2VyLmdldCh1cmwsIFwiYXJyYXlCdWZmZXJcIik7XHJcblxyXG5cdFx0XHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCBidWYsIGZhbHNlKTtcclxuXHJcblx0XHRcdFx0cmV0dXJuIGJ1ZjtcclxuXHRcdFx0fVxyXG5cdFx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xyXG5cdFx0XHR9XHJcblx0XHR9KSgpO1xyXG5cdFx0X3NldFZhbHVlQnlQYXRoKHBhdGgsIHRhc2ssIGZhbHNlKTtcclxuXHJcblx0XHRyZXR1cm4gYXdhaXQgdGFzaztcclxuXHR9XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHthbnl9XHJcbiAqL1xyXG4kZ2V0LmJpbmFyeVN5bmMgPSBmdW5jdGlvbiBnZXRfZGF0YVN5bmMocGF0aCkge1xyXG5cdGxldCBvYmogPSBfZ2V0VmFsdWVGcm9tQXJjaGl2ZUJ5UGF0aChwYXRoKTtcclxuXHRpZiAob2JqKSB7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRyZXR1cm4gdW5kZWZpbmVkO1xyXG59XHJcblxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbiRnZXQuZGF0YVVybCA9IGZ1bmN0aW9uICRnZXRfZGF0YVVybChwYXRoKSB7XHJcblx0aWYgKHVybF9zdGFydHNXaXRoX3Byb3RvY29sKHBhdGgpKSB7XHJcblx0XHRyZXR1cm4gcGF0aDtcclxuXHR9XHJcblx0ZWxzZSBpZiAoIXBhdGguc3RhcnRzV2l0aChcImRhdGFcIikpIHtcclxuXHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1kYXRhJHtwYXRofS5qc29uYDtcclxuXHR9XHJcblx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGdhbWUgZGF0YTogXCIgKyBwYXRoKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbiRnZXQucGFja1VybCA9IGZ1bmN0aW9uICRnZXRfcGFja1VybChwYXRoKSB7XHJcblx0aWYgKHVybF9zdGFydHNXaXRoX3Byb3RvY29sKHBhdGgpKSB7XHJcblx0XHRyZXR1cm4gcGF0aDtcclxuXHR9XHJcblx0ZWxzZSBpZiAoIXBhdGguc3RhcnRzV2l0aChcInBhY2tcIikpIHtcclxuXHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1wYWNrJHtwYXRofS5qc29uYDtcclxuXHR9XHJcblx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGdhbWUgcGFjazogXCIgKyBwYXRoKTtcclxufVxyXG4kZ2V0Lmxpc3RVcmwgPSBmdW5jdGlvbiAkZ2V0X2xpc3RVcmwocGF0aCkge1xyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJsc1wiKSkge1xyXG5cdFx0cmV0dXJuIGAke3dpbmRvdy4kUk9PVF9QQVRIfWxzJHtwYXRofS5qc29uYDtcclxuXHR9XHJcblx0dGhyb3cgbmV3IEVycm9yKHBhdGgpO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuJGdldC5iaW5hcnlVcmwgPSBmdW5jdGlvbiAkZ2V0X2RhdGFVcmwocGF0aCkge1xyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJiaW5hcnlcIikpIHtcclxuXHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1iaW5hcnkke3BhdGh9YDtcclxuXHR9XHJcblx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGdhbWUgYmluYXJ5IGRhdGE6IFwiICsgcGF0aCk7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG4kZ2V0LmltYWdlVXJsID0gZnVuY3Rpb24gJGdldF9pbWFnZXNVcmwocGF0aCkge1xyXG5cdGlmICh3aW5kb3cuJG5vaW1hZ2UpIHtcclxuXHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1pbWFnZXMvMXgxLnBuZ2A7XHJcblx0fVxyXG5cdHtcclxuXHRcdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0XHRyZXR1cm4gcGF0aDtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJpbWFnZXNcIikpIHtcclxuXHRcdFx0cmV0dXJuIGAke3dpbmRvdy4kUk9PVF9QQVRIfWltYWdlcyR7cGF0aH0ucG5nYDtcclxuXHRcdH1cclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBnYW1lIGltYWdlczogXCIgKyBwYXRoKTtcclxuXHR9XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG4kZ2V0LnNvdW5kTXAzVXJsID0gZnVuY3Rpb24gJGdldF9zb3VuZE1wM1VybChwYXRoKSB7XHJcblx0aWYgKHVybF9zdGFydHNXaXRoX3Byb3RvY29sKHBhdGgpKSB7XHJcblx0XHRyZXR1cm4gcGF0aDtcclxuXHR9XHJcblx0ZWxzZSBpZiAoIXBhdGguc3RhcnRzV2l0aChcInNvdW5kXCIpKSB7XHJcblx0XHRyZXR1cm4gYCR7d2luZG93LiRST09UX1BBVEh9c291bmQke3BhdGh9Lm1wM2A7XHJcblx0fVxyXG5cdHRocm93IG5ldyBFcnJvcihcIk5vdCBnYW1lIHNvdW5kOiBcIiArIHBhdGgpO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuJGdldC5zb3VuZFdhdlVybCA9IGZ1bmN0aW9uICRnZXRfc291bmRXYXZVcmwocGF0aCkge1xyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJzb3VuZFwiKSkge1xyXG5cdFx0cmV0dXJuIGAke3dpbmRvdy4kUk9PVF9QQVRIfXNvdW5kJHtwYXRofS53YXZgO1xyXG5cdH1cclxuXHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgZ2FtZSBzb3VuZDogXCIgKyBwYXRoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG4kZ2V0LmFzc2V0VXJsID0gZnVuY3Rpb24gJGdldF9hc3NldFVybChwYXRoKSB7XHJcblx0cmV0dXJuIGAke3dpbmRvdy4kUk9PVF9QQVRIfSR7cGF0aH1gO1xyXG59XHJcbiRnZXQuYXNzZXQgPSBmdW5jdGlvbiAkZ2V0X2Fzc2V0KHBhdGgpIHtcclxuXHRyZXR1cm4gJGdldCgkZ2V0LmFzc2V0VXJsKHBhdGgpKTtcclxufVxyXG5cclxud2luZG93LiRnZXQgPSAkZ2V0O1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBJdGVtQXR0ck5vcm1hbGl6ZSB7XHJcblx0c3RhdGljIGhlYWQoaXRlbSkge1xyXG5cdFx0aXRlbS5nZW5kZXIgPSAyO1xyXG5cdH1cclxuXHRzdGF0aWMgYm9keShpdGVtKSB7XHJcblx0XHRpdGVtLmdlbmRlciA9IDI7XHJcblx0fVxyXG5cdHN0YXRpYyBGYWNlKGl0ZW0pIHtcclxuXHRcdGNvbnN0IGcgPSBNYXRoLnRydW5jKChpdGVtLmlkICUgMTAwMDApIC8gMTAwMCk7XHJcblx0XHRpdGVtLmdlbmRlciA9IGcgPT0gMSB8fCBnID09IDQgPyAxIDogMDtcclxuXHR9XHJcblx0c3RhdGljIEhhaXIoaXRlbSkge1xyXG5cdFx0Y29uc3QgZyA9IE1hdGgudHJ1bmMoKGl0ZW0uaWQgJSAxMDAwMCkgLyAxMDAwKTtcclxuXHRcdGl0ZW0uZ2VuZGVyID0gZyA9PSAxIHx8IGcgPT0gMiB8fCBnID09IDQgfHwgZyA9PSA3ID8gMSA6IDA7XHJcblx0fVxyXG5cdHN0YXRpYyBDYXAoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgYWNjZXNzb3J5RmFjZShpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBhY2Nlc3NvcnlFeWVzKGl0ZW0pIHtcclxuXHRcdEl0ZW1BdHRyTm9ybWFsaXplLl9lcXVpcChpdGVtKTtcclxuXHR9XHJcblx0c3RhdGljIGFjY2Vzc29yeUVhcnMoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgQ29hdChpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBMb25nY29hdChpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBQYW50cyhpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBTaG9lcyhpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBHbG92ZShpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBTaGllbGQoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgQ2FwZShpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBfZXF1aXAoaXRlbSkge1xyXG5cdFx0Y29uc3QgZyA9IE1hdGgudHJ1bmMoKGl0ZW0uaWQgJSAxMDAwMCkgLyAxMDAwKTtcclxuXHRcdGl0ZW0uZ2VuZGVyID0gZyA9PSAwID8gMCA6IChnID09IDEgPyAxIDogMik7XHJcblx0fVxyXG59XHJcblxyXG5jb25zdCByZWdleHBfZ2V0SGFpclN0eWxlSUQgPSAvKFxcZHs0LDd9KVxcZCQvO1xyXG5jb25zdCByZWdleHBfZ2V0RmFjZVN0eWxlSUQgPSAvKFxcZHsyLDV9KVxcZChcXGR7Mn0pJC87XHJcblxyXG5jb25zdCByZWdleHBfZ2V0SGFpckNvbG9yID0gL1xcZHs0LDd9KFxcZCkkLztcclxuY29uc3QgcmVnZXhwX2dldEZhY2VDb2xvciA9IC9cXGR7Miw1fShcXGQpXFxkezJ9JC87XHJcblxyXG5leHBvcnQgY2xhc3MgQ2hhcmFjdGVyUmVuZGVyQ29uZmlnIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc3R5bGUgaWRcclxuXHQgKiBAcmV0dXJucyB7c3RyaW5nW119XHJcblx0ICovXHJcblx0c3RhdGljICogZW51bUhhaXJDb2xvcihzdHlsZSkge1xyXG5cdFx0bGV0IG0gPSBzdHlsZS5tYXRjaChyZWdleHBfZ2V0SGFpclN0eWxlSUQpO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgKytpKSB7XHJcblx0XHRcdGxldCBpZCA9IG1bMV0gKyBpO1xyXG5cdFx0XHR5aWVsZCBpZDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBzdHlsZSBpZFxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmdbXX1cclxuXHQgKi9cclxuXHRzdGF0aWMgKiBlbnVtRmFjZUNvbG9yKHN0eWxlKSB7XHJcblx0XHRsZXQgbSA9IHN0eWxlLm1hdGNoKHJlZ2V4cF9nZXRGYWNlU3R5bGVJRCk7XHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IDEwOyArK2kpIHtcclxuXHRcdFx0bGV0IGlkID0gbVsxXSArIGkgKyBtWzJdO1xyXG5cdFx0XHR5aWVsZCBpZDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBzdHlsZVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBjb2xvclxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9XHJcblx0ICovXHJcblx0c3RhdGljIGdldENvbG9ySGFpcklEKHN0eWxlLCBjb2xvcikge1xyXG5cdFx0bGV0IG0gPSBzdHlsZS5tYXRjaChyZWdleHBfZ2V0SGFpclN0eWxlSUQpO1xyXG5cdFx0bGV0IGlkID0gbVsxXSArIChjb2xvciAlIDEwKTtcclxuXHRcdHJldHVybiBpZDtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHN0eWxlXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGNvbG9yXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0Q29sb3JGYWNlSUQoc3R5bGUsIGNvbG9yKSB7XHJcblx0XHRsZXQgbSA9IHN0eWxlLm1hdGNoKHJlZ2V4cF9nZXRGYWNlU3R5bGVJRCk7XHJcblx0XHRsZXQgaWQgPSBtWzFdICsgKGNvbG9yICUgMTApICsgbVsyXTtcclxuXHRcdHJldHVybiBpZDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZF8xXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXzJcclxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRzdGF0aWMgaXNIYWlyU3R5bGVFcXVhbChpZF8xLCBpZF8yKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldENvbG9ySGFpcklEKGlkXzEsIDApID09IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckhhaXJJRChpZF8yLCAwKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXzFcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWRfMlxyXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBpc0ZhY2VTdHlsZUVxdWFsKGlkXzEsIGlkXzIpIHtcclxuXHRcdHJldHVybiBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0Q29sb3JGYWNlSUQoaWRfMSwgMCkgPT0gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldENvbG9yRmFjZUlEKGlkXzIsIDApO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0SGFpckNvbG9yKGlkKSB7XHJcblx0XHRpZiAoaWQpIHtcclxuXHRcdFx0aWQgPSBTdHJpbmcoaWQpO1xyXG5cdFx0XHRsZXQgbSA9IGlkLm1hdGNoKHJlZ2V4cF9nZXRIYWlyQ29sb3IpO1xyXG5cdFx0XHRpZiAobSkge1xyXG5cdFx0XHRcdHJldHVybiBtWzFdO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWRcclxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBnZXRGYWNlQ29sb3IoaWQpIHtcclxuXHRcdGlmIChpZCkge1xyXG5cdFx0XHRpZCA9IFN0cmluZyhpZCk7XHJcblx0XHRcdGxldCBtID0gaWQubWF0Y2gocmVnZXhwX2dldEZhY2VDb2xvcik7XHJcblx0XHRcdGlmIChtKSB7XHJcblx0XHRcdFx0cmV0dXJuIG1bMV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcbn1cclxuXHJcbnZhciBfZXh0ZXJuYWxfZGF0YSA9IHtcclxuXHRcInJlcXVpcmVkSm9ic1wiOiBbXHJcblx0XHRcIkJlZ2lubmVyXCJcclxuXHRdLFxyXG5cdFwicmVxdWlyZWRMZXZlbFwiOiAwLFxyXG5cdFwiaXNDYXNoXCI6IHRydWUsXHJcblx0XCJuYW1lXCI6IFwiQmx1ZSBCZWFuaWVcIixcclxuXHRcImRlc2NcIjogbnVsbCxcclxuXHRcImlkXCI6IDEwMDAwMDAsXHJcblx0XCJyZXF1aXJlZEdlbmRlclwiOiAwLFxyXG5cdFwidHlwZUluZm9cIjoge1xyXG5cdFx0XCJvdmVyYWxsQ2F0ZWdvcnlcIjogXCJFcXVpcFwiLFxyXG5cdFx0XCJjYXRlZ29yeVwiOiBcIkFybW9yXCIsXHJcblx0XHRcInN1YkNhdGVnb3J5XCI6IFwiSGF0XCJcclxuXHR9XHJcbn07XHJcblxyXG52YXIgSXRlbVR5cGVJbmZvID0ge1xyXG5cdFwiRXF1aXBcIjoge1xyXG5cdFx0XCJIYXRcIjogXCJDYXBcIixcclxuXHRcdFwiQ2FwZVwiOiBcIkNhcGVcIixcclxuXHRcdFwiVG9wXCI6IFwiQ29hdFwiLFxyXG5cdFx0XCJPdmVyYWxsXCI6IFwiTG9uZ2NvYXRcIixcclxuXHRcdFwiR2xvdmVcIjogXCJHbG92ZVwiLFxyXG5cdFx0XCJCb3R0b21cIjogXCJQYW50c1wiLFxyXG5cclxuXHRcdFwiU2hpZWxkXCI6IFwiU2hpZWxkXCIsXHJcblx0XHRcIlNob2VzXCI6IFwiU2hvZXNcIixcclxuXHRcdFwiRXllIERlY29yYXRpb25cIjogXCJhY2Nlc3NvcnlFeWVzXCIsXHJcblx0XHRcIkVhcnJpbmdzXCI6IFwiYWNjZXNzb3J5RWFyc1wiLFxyXG5cdFx0Ly9cIlJpbmdcIjogXCJcIixcclxuXHJcblx0XHQvL1wiUGVuZGFudFwiOiBcIlwiLFxyXG5cdFx0XCJGYWNlIEFjY2Vzc29yeVwiOiBcImFjY2Vzc29yeUZhY2VcIixcclxuXHRcdC8vXCJCZWx0XCI6IFwiXCIsXHJcblx0XHQvL1wiTWVkYWxcIjogXCJcIixcclxuXHRcdC8vXCJTaG91bGRlciBBY2Nlc3NvcnlcIjogXCJcIixcclxuXHRcdC8vXCJCYWRnZVwiOiBcIlwiLFxyXG5cclxuXHRcdC8vXCJEcmFnb24gRXF1aXBtZW50XCI6IFwiXCIsXHJcblx0XHQvL1wiTWVjaGFuaWMgRXF1aXBtZW50XCI6IFwiXCIsXHJcblx0XHQvL1wiUGV0IEVxdWlwbWVudFwiOiBcIlwiLFxyXG5cdFx0Ly9cIkFuZHJvaWRcIjogXCJcIixcclxuXHRcdC8vXCJNZWNoYW5pY2FsIEhlYXJ0XCI6IFwiXCIsXHJcblx0XHQvL1wiQml0c1wiOiBcIlwiLFxyXG5cclxuXHRcdFwiRmFjZVwiOiBcIkZhY2VcIixcclxuXHRcdFwiSGFpclwiOiBcIkhhaXJcIixcclxuXHR9LFxyXG59O1xyXG5cclxuUmVzb3VyY2VNYW5hZ2VyLmV4dGVybmFsID0ge1xyXG5cdGVxdWlwOiB7XHJcblx0fSxcclxufTtcclxuXHJcblJlc291cmNlTWFuYWdlci5lcXVpcF9tYXAgPSB7XHJcbn07XHJcblxyXG5mb3IgKGxldCBpIGluIEl0ZW1UeXBlSW5mby5FcXVpcCkge1xyXG5cdGxldCBjYXRlID0gSXRlbVR5cGVJbmZvLkVxdWlwW2ldO1xyXG5cclxuXHRSZXNvdXJjZU1hbmFnZXIuZXh0ZXJuYWwuZXF1aXBbY2F0ZV0gPSBbXTtcclxuXHRSZXNvdXJjZU1hbmFnZXIuZXF1aXBfbWFwW2NhdGVdID0gbnVsbDtcclxufVxyXG5mb3IgKGxldCBpID0gMDsgaSA8IDk7ICsraSkge1xyXG5cdGxldCBjYXRlID0gXCJGYWNlXCIgKyBpO1xyXG5cdFJlc291cmNlTWFuYWdlci5leHRlcm5hbC5lcXVpcFtjYXRlXSA9IFtdO1xyXG5cdFJlc291cmNlTWFuYWdlci5lcXVpcF9tYXBbY2F0ZV0gPSBudWxsO1xyXG59XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgODsgKytpKSB7XHJcblx0bGV0IGNhdGUgPSBcIkhhaXJcIiArIGk7XHJcblx0UmVzb3VyY2VNYW5hZ2VyLmV4dGVybmFsLmVxdWlwW2NhdGVdID0gW107XHJcblx0UmVzb3VyY2VNYW5hZ2VyLmVxdWlwX21hcFtjYXRlXSA9IG51bGw7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGxvYWRfZXh0ZXJuYWxfcmVzb3VyY2UodXJsKSB7XHJcblx0dXJsID0gdXJsIHx8IFwiL2l0ZW1zLmpzb25cIjtcclxuXHRsZXQgcmF3O1xyXG5cclxuXHQvLyB0cnkge1xyXG5cdC8vIFx0cmF3ID0gUmVzb3VyY2VNYW5hZ2VyLl9leHRlcm5hbF9yYXcgPSBKU09OLnBhcnNlKGF3YWl0ICRnZXQuYXNzZXQoXCJlcXVpcC5qc29uXCIpKTtcclxuXHQvLyBcdGlmICghcmF3KSB7XHJcblx0Ly8gXHRcdGRlYnVnZ2VyO1xyXG5cdC8vIFx0XHR0aHJvdyBFcnJvcihcIicvZXF1aXAuanNvbicgaXMgZW1wdHlcIik7XHJcblx0Ly8gXHR9XHJcblx0Ly8gfVxyXG5cdC8vIGNhdGNoIChleCkge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmF3ID0gUmVzb3VyY2VNYW5hZ2VyLl9leHRlcm5hbF9yYXcgPSBKU09OLnBhcnNlKGF3YWl0ICRnZXQoYGh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbn0vJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259L2l0ZW0vY2F0ZWdvcnkvZXF1aXBgKSk7XHJcblx0XHRcdGlmICghcmF3KSB7XHJcblx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdC8vIH1cclxuXHRcclxuXHRmb3IgKGxldCBpID0gMDsgaSA8IHJhdy5sZW5ndGg7ICsraSkge1xyXG5cdFx0Y29uc3QgaXRlbSA9IHJhd1tpXTtcclxuXHRcdGNvbnN0IGlkID0gU3RyaW5nKGl0ZW0uaWQpLnBhZFN0YXJ0KDgsIFwiMFwiKTtcclxuXHRcdFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aWYgKCEoaXRlbS50eXBlSW5mbyAmJiBJdGVtVHlwZUluZm9baXRlbS50eXBlSW5mby5vdmVyYWxsQ2F0ZWdvcnldKSkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgY2x6ID0gaXRlbS50eXBlSW5mby5vdmVyYWxsQ2F0ZWdvcnkudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0bGV0IGNhdGUgPSBJdGVtVHlwZUluZm9baXRlbS50eXBlSW5mby5vdmVyYWxsQ2F0ZWdvcnldW2l0ZW0udHlwZUluZm8uc3ViQ2F0ZWdvcnldO1xyXG5cdFx0XHRpZiAoIWNhdGUpIHtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChjYXRlID09IFwiRmFjZVwiKSB7XHJcblx0XHRcdFx0Y2F0ZSArPSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0RmFjZUNvbG9yKGlkKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIGlmIChjYXRlID09IFwiSGFpclwiKSB7XHJcblx0XHRcdFx0Y2F0ZSArPSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0SGFpckNvbG9yKGlkKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IGl0ID0ge1xyXG5cdFx0XHRcdGlkOiBpZCxcclxuXHRcdFx0XHRuYW1lOiBpdGVtLm5hbWUsXHJcblx0XHRcdFx0ZGVzYzogaXRlbS5kZXNjLFxyXG5cdFx0XHRcdGNhc2g6IGl0ZW0uaXNDYXNoID8gMSA6IDAsXHJcblx0XHRcdFx0aWNvbjoge1xyXG5cdFx0XHRcdFx0XCJcIjogYGh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbn0vJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259L2l0ZW0vJHtpdGVtLmlkfS9pY29uYCxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdF9fdjogYCR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFSZWdpb259JHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259YCxcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdFJlc291cmNlTWFuYWdlci5leHRlcm5hbFtjbHpdW2NhdGVdLnB1c2goaXQpO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJleHRlcm5hbCByZXNvdXJjZTogaWQoXCIgKyBpZCArIFwiKVwiKTtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZnVuY3Rpb24gdXBkYXRlX2V4dGVybmFsX2VxdWlwX2xpc3QoKSB7XHJcblx0ZGVidWdnZXI7Ly8/P1xyXG5cdGNvbnN0IHVybCA9IGBodHRwczovL21hcGxlc3RvcnkuaW8vYXBpLyR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFSZWdpb259LyR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFWZXJzaW9ufS9pdGVtL2NhdGVnb3J5L2VxdWlwYDtcclxuXHRsb2FkX2V4dGVybmFsX3Jlc291cmNlKHVybCkudGhlbigoKSA9PiB7XHJcblx0XHRfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlKGNhdGVnb3J5LCBvcmlnaW5fZGF0YSk7XHJcblx0XHRjb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2UgPSBfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlO1xyXG5cdFx0Y29uc29sZS5sb2coXCJkb25lOiB1cGRhdGVfZXh0ZXJuYWxfZXF1aXBfbGlzdFwiKTtcclxuXHR9KTtcclxufVxyXG5cclxubGV0IGV4dGVybmFsX3Jlc291cmNlX3Byb21pc2UgPSBsb2FkX2V4dGVybmFsX3Jlc291cmNlKCk7XHJcblxyXG53aW5kb3cuY29uY2F0X2V4dGVybmFsX3Jlc291cmNlID0gX2NvbmNhdF9leHRlcm5hbF9yZXNvdXJjZV9wO1xyXG5cclxud2luZG93LnRyaWdnZXJfdXBkYXRlX2V4dGVybmFsX2VxdWlwX2xpc3QgPSBmdW5jdGlvbiAoKSB7XHJcblx0ZXh0ZXJuYWxfcmVzb3VyY2VfcHJvbWlzZSA9IGxvYWRfZXh0ZXJuYWxfcmVzb3VyY2UoKTtcclxuXHR3aW5kb3cuY29uY2F0X2V4dGVybmFsX3Jlc291cmNlID0gX2NvbmNhdF9leHRlcm5hbF9yZXNvdXJjZV9wO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlX3AoY2F0ZWdvcnksIG9yaWdpbl9kYXRhKSB7XHJcblx0YXdhaXQgZXh0ZXJuYWxfcmVzb3VyY2VfcHJvbWlzZTtcclxuXHRfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlKGNhdGVnb3J5LCBvcmlnaW5fZGF0YSk7XHJcblx0Y29uY2F0X2V4dGVybmFsX3Jlc291cmNlID0gX2NvbmNhdF9leHRlcm5hbF9yZXNvdXJjZTtcclxufVxyXG5cclxuZnVuY3Rpb24gX2NvbmNhdF9leHRlcm5hbF9yZXNvdXJjZShjYXRlZ29yeSwgb3JpZ2luX2RhdGEpIHtcclxuXHR0cnkge1xyXG5cdFx0Y29uc3QgbGlzdCA9IFJlc291cmNlTWFuYWdlci5leHRlcm5hbC5lcXVpcFtjYXRlZ29yeV07XHJcblx0XHRpZiAoIWxpc3QpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0bGV0IGlkX21hcCA9IFJlc291cmNlTWFuYWdlci5lcXVpcF9tYXBbY2F0ZWdvcnldO1xyXG5cclxuXHRcdGlmICghaWRfbWFwKSB7XHJcblx0XHRcdGlkX21hcCA9IG5ldyBNYXAoKTtcclxuXHRcdFx0XHJcblx0XHRcdG9yaWdpbl9kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0aWRfbWFwLnNldChpdGVtLmlkLCBpdGVtKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRSZXNvdXJjZU1hbmFnZXIuZXF1aXBfbWFwW2NhdGVnb3J5XSA9IGlkX21hcDtcclxuXHRcdH1cclxuXHJcblx0XHRsaXN0LmZvckVhY2goKGl0ZW0pID0+IHtcclxuXHRcdFx0bGV0IGlkID0gaXRlbS5pZDtcclxuXHRcdFx0aWYgKCFpZF9tYXAuaGFzKGlkKSkge1xyXG5cdFx0XHRcdGl0ZW0uJGZvcmVpZ24gPSB0cnVlO1xyXG5cdFx0XHRcdG9yaWdpbl9kYXRhLnB1c2goaXRlbSk7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0bGV0IG9yaV9pdGVtID0gaWRfbWFwLmdldChpZCk7XHJcblx0XHRcdFx0b3JpX2l0ZW0uX25hbWUgPSBpdGVtLm5hbWUgfHwgXCJcIjtcclxuXHRcdFx0XHRvcmlfaXRlbS5fZGVzYyA9IGl0ZW0uZGVzYyB8fCBcIlwiO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRjb25zb2xlLmVycm9yKGV4KTtcclxuXHRcdGRlYnVnZ2VyO1xyXG5cdH1cclxufVxyXG5cclxud2luZG93LmxvYWRfZXh0ZXJuX2l0ZW1fZGF0YSA9IGFzeW5jIGZ1bmN0aW9uIChpZCkge1xyXG5cdGxldCBfcmF3ID0gSlNPTi5wYXJzZShhd2FpdCAkZ2V0KGBodHRwczovL21hcGxlc3RvcnkuaW8vYXBpLyR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFSZWdpb259LyR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFWZXJzaW9ufS9pdGVtLyR7aWR9YCkpO1xyXG5cdGxldCByYXcgPSB7fTtcclxuXHJcblx0bGV0IGRlZmF1bHRfID0gX3Jhdy5mcmFtZUJvb2tzLmRlZmF1bHQgPyBfcmF3LmZyYW1lQm9va3MuZGVmYXVsdC5mcmFtZXNbMF06bnVsbDtcclxuXHJcblx0Zm9yIChsZXQgaSBpbiBfcmF3LmZyYW1lQm9va3MpIHtcclxuXHRcdGxldCBfYWN0ID0gX3Jhdy5mcmFtZUJvb2tzW2ldO1xyXG5cdFx0bGV0IGFjdCA9IFtdO1xyXG5cclxuXHRcdGZvciAobGV0IGogPSAwOyBqIDwgX2FjdC5mcmFtZXMubGVuZ3RoOyArK2opIHtcclxuXHRcdFx0bGV0IGZyYW1lID0gX2FjdC5mcmFtZXNbal0gfHwgZGVmYXVsdF87XHJcblx0XHRcdGlmICghZnJhbWUgfHwgIWZyYW1lLmVmZmVjdHMpIHtcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRsZXQgX2ZyYWdzID0gZnJhbWUuZWZmZWN0cztcclxuXHRcdFx0bGV0IGZyYWdzID0ge307XHJcblx0XHRcdGZvciAobGV0IGsgaW4gX2ZyYWdzKSB7XHJcblx0XHRcdFx0bGV0IF9mcmFnID0gX2ZyYWdzW2tdO1xyXG5cdFx0XHRcdGlmIChfZnJhZy5pbWFnZSkge1xyXG5cdFx0XHRcdFx0ZnJhZ3Nba10gPSB7XHJcblx0XHRcdFx0XHRcdFwiXCI6IFwiZGF0YTppbWFnZS9wbmc7YmFzZTY0LFwiICsgX2ZyYWcuaW1hZ2UsXHJcblx0XHRcdFx0XHRcdFwib3JpZ2luXCI6IF9mcmFnLm9yaWdpbk9yWmVybyB8fCBfZnJhZy5vcmlnaW4gfHwgX2ZyYWcuY2VudGVyLFxyXG5cdFx0XHRcdFx0XHRcIm1hcFwiOiBfZnJhZy5tYXBPZmZzZXQsXHJcblx0XHRcdFx0XHRcdFwielwiOiBfZnJhZy5wb3NpdGlvblxyXG5cdFx0XHRcdFx0fTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGFjdFtqXSA9IGZyYWdzO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJhd1tpXSA9IGFjdDtcclxuXHR9XHJcblxyXG5cdHJhdy5pbmZvID0ge1xyXG5cdFx0aXNsb3Q6IF9yYXcubWV0YUluZm8uaXNsb3QsXHJcblx0XHR2c2xvdDogX3Jhdy5tZXRhSW5mby52c2xvdCxcclxuXHRcdGljb246IHtcclxuXHRcdFx0XCJcIjogYGh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbn0vJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259L2l0ZW0vJHtfcmF3LmlkfS9pY29uYCxcclxuXHRcdH0sXHJcblx0XHRjYXNoOiBfcmF3Lm1ldGFJbmZvLmNhc2ggPyAxIDogMCxcclxuXHRcdF9fdjogYCR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFSZWdpb259JHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259YCxcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gcmF3O1xyXG59XHJcblxyXG5mdW5jdGlvbiBfb2JqZWN0QXNzaWduRGVlcCh0YXJnZXQsIG9iamVjdCkge1xyXG5cdGlmICh0YXJnZXQgIT0gbnVsbCAmJiBvYmplY3QgIT0gbnVsbCkge1xyXG5cdFx0aWYgKE9iamVjdC5wcm90b3R5cGUudmFsdWVPZi5jYWxsKG9iamVjdCkgaW5zdGFuY2VvZiBTdHJpbmcpIHtcclxuXHRcdFx0dGFyZ2V0ID0gb2JqZWN0O1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoT2JqZWN0LnByb3RvdHlwZS52YWx1ZU9mLmNhbGwob2JqZWN0KSBpbnN0YW5jZW9mIE51bWJlcikge1xyXG5cdFx0XHR0YXJnZXQgPSBvYmplY3Q7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChPYmplY3QucHJvdG90eXBlLnZhbHVlT2YuY2FsbChvYmplY3QpIGluc3RhbmNlb2YgQm9vbGVhbikge1xyXG5cdFx0XHR0YXJnZXQgPSBvYmplY3Q7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Zm9yIChsZXQga2V5IGluIG9iamVjdCkge1xyXG5cdFx0XHRcdGxldCB2YWx1ZSA9IG9iamVjdFtrZXldO1xyXG5cdFx0XHRcdGlmICh2YWx1ZSAhPSBudWxsKSB7XHJcblx0XHRcdFx0XHR0YXJnZXRba2V5XSA9IF9vYmplY3RBc3NpZ25EZWVwKHRhcmdldFtrZXldLCB2YWx1ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB0YXJnZXQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9iamVjdEFzc2lnbkRlZXAodGFyZ2V0LCAuLi5vYmplY3RzKSB7XHJcblx0Zm9yIChsZXQgb2JqZWN0IG9mIG9iamVjdHMpIHtcclxuXHRcdF9vYmplY3RBc3NpZ25EZWVwKHRhcmdldCwgb2JqZWN0KTtcclxuXHR9XHJcblx0cmV0dXJuIHRhcmdldDtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///353\n')},368:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AddInitTask; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return InitAll; });\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(358);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(414);\n/* harmony import */ var jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(415);\n/* harmony import */ var jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var jquery_ui_themes_base_selectable_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(416);\n/* harmony import */ var jquery_ui_themes_base_selectable_css__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_selectable_css__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var jquery_ui_themes_base_sortable_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(417);\n/* harmony import */ var jquery_ui_themes_base_sortable_css__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_sortable_css__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var jquery_ui_themes_base_draggable_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(418);\n/* harmony import */ var jquery_ui_themes_base_draggable_css__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_draggable_css__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var jquery_ui_ui_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(419);\n/* harmony import */ var jquery_ui_ui_core__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_core__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var jquery_ui_ui_widgets_selectable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(420);\n/* harmony import */ var jquery_ui_ui_widgets_selectable__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_selectable__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var jquery_ui_ui_widgets_sortable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(421);\n/* harmony import */ var jquery_ui_ui_widgets_sortable__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_sortable__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var jquery_ui_ui_widgets_draggable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(422);\n/* harmony import */ var jquery_ui_ui_widgets_draggable__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_draggable__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var jquery_ui_ui_disable_selection__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(423);\n/* harmony import */ var jquery_ui_ui_disable_selection__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_disable_selection__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var jquery_ui_ui_position__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(424);\n/* harmony import */ var jquery_ui_ui_position__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_position__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var jquery_ui_ui_effect__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(425);\n/* harmony import */ var jquery_ui_ui_effect__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_effect__WEBPACK_IMPORTED_MODULE_12__);\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(383);\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(_util_js__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(337);\n/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(vue__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var vuex__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(363);\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvue__WEBPACK_IMPORTED_MODULE_14___default.a.config.productionTip = false;\r\nvue__WEBPACK_IMPORTED_MODULE_14___default.a.use(vuex__WEBPACK_IMPORTED_MODULE_15__[/* default */ "a"]);\r\n\r\nwindow.jQuery = jquery__WEBPACK_IMPORTED_MODULE_0___default.a;\r\nwindow.$ = jquery__WEBPACK_IMPORTED_MODULE_0___default.a;\r\n\r\nif (!window.onwheel) {\r\n\twindow.onwheel = function () {\r\n\t}\r\n}\r\n\r\nlet init_tasks = [];\r\n\r\nfunction AddInitTask(task) {\r\n\tinit_tasks.push(task);\r\n}\r\n\r\nfunction InitAll() {\r\n\tlet promise_list = init_tasks.map(f => f());\r\n\tinit_tasks = [];\r\n\tlet a = Promise.all(promise_list);\r\n\treturn a;\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2luaXQuanM/ZDk5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IGpRdWVyeSBmcm9tIFwianF1ZXJ5XCI7XHJcblxyXG5pbXBvcnQgXCJqcXVlcnktdWkvdGhlbWVzL2Jhc2UvY29yZS5jc3NcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3RoZW1lcy9iYXNlL3RoZW1lLmNzc1wiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdGhlbWVzL2Jhc2Uvc2VsZWN0YWJsZS5jc3NcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3RoZW1lcy9iYXNlL3NvcnRhYmxlLmNzc1wiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdGhlbWVzL2Jhc2UvZHJhZ2dhYmxlLmNzc1wiO1xyXG5cclxuaW1wb3J0IFwianF1ZXJ5LXVpL3VpL2NvcmVcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3VpL3dpZGdldHMvc2VsZWN0YWJsZVwiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdWkvd2lkZ2V0cy9zb3J0YWJsZVwiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdWkvd2lkZ2V0cy9kcmFnZ2FibGVcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3VpL2Rpc2FibGUtc2VsZWN0aW9uXCI7XHJcbmltcG9ydCBcImpxdWVyeS11aS91aS9wb3NpdGlvblwiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdWkvZWZmZWN0XCI7XHJcblxyXG5pbXBvcnQgeyB9IGZyb20gXCIuL3V0aWwuanNcIjtcclxuXHJcbmltcG9ydCBWdWUgZnJvbSBcInZ1ZVwiO1xyXG5pbXBvcnQgVnVleCBmcm9tIFwidnVleFwiO1xyXG5cclxuVnVlLmNvbmZpZy5wcm9kdWN0aW9uVGlwID0gZmFsc2U7XHJcblZ1ZS51c2UoVnVleCk7XHJcblxyXG53aW5kb3cualF1ZXJ5ID0galF1ZXJ5O1xyXG53aW5kb3cuJCA9IGpRdWVyeTtcclxuXHJcbmlmICghd2luZG93Lm9ud2hlZWwpIHtcclxuXHR3aW5kb3cub253aGVlbCA9IGZ1bmN0aW9uICgpIHtcclxuXHR9XHJcbn1cclxuXHJcbmxldCBpbml0X3Rhc2tzID0gW107XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gQWRkSW5pdFRhc2sodGFzaykge1xyXG5cdGluaXRfdGFza3MucHVzaCh0YXNrKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIEluaXRBbGwoKSB7XHJcblx0bGV0IHByb21pc2VfbGlzdCA9IGluaXRfdGFza3MubWFwKGYgPT4gZigpKTtcclxuXHRpbml0X3Rhc2tzID0gW107XHJcblx0bGV0IGEgPSBQcm9taXNlLmFsbChwcm9taXNlX2xpc3QpO1xyXG5cdHJldHVybiBhO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///368\n')},371:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* unused harmony export ActionAnimationFrameData */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ActionAnimation; });\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(332);\n\ufeff\r\n\r\n\r\n\r\nclass ActionAnimationFrameData {\r\n\tconstructor() {\r\n\t\t/** @type {number} */\r\n\t\tthis.delay = 0;\r\n\r\n\t\t/** @type {Vec2} */\r\n\t\tthis.move = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.action = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.frame = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * from loaded raw data\r\n\t * @param {ActionAnimationFrameData} raw\r\n\t * @param {string} action\r\n\t * @param {number} frame\r\n\t */\r\n\t_load(raw, action, frame) {\r\n\t\tthis._raw = raw;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.delay = raw.delay;\r\n\r\n\t\t/** @type {Vec2} */\r\n\t\tif (raw.move) {\r\n\t\t\tthis.move = new _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"](raw.move.x, raw.move.y);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.move = new _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"](0, 0);\r\n\t\t}\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.action = raw.action || action;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.frame = raw.frame || frame;\r\n\t}\r\n}\r\n\r\nclass ActionAnimation {\r\n\tconstructor(raw) {\r\n\t\t/** @returns {ActionAnimationFrameData[]} */\r\n\t\tthis.frames = null;\r\n\r\n\t\t/**\r\n\t\t * input action\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tthis._action = null;\r\n\r\n\t\t/**\r\n\t\t * input action\r\n\t\t * @type {number}\r\n\t\t */\r\n\t\tthis.frame = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.time = 0;\r\n\r\n\t\t/** @type {number} this.delay = delay < 0 ? -delay:0; if (this.delay == 0) launch attack */\r\n\t\tthis.delay = 0;//not frame delay\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis.loop = false;\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis._is_end = false;\r\n\r\n\t\t/** @type {(oldInputAction:string,oldOutputAction:string) => void} */\r\n\t\tthis.onEnd = null;\r\n\t}\r\n\r\n\t/**\r\n\t * from loaded data\r\n\t * @param {string} action\r\n\t */\r\n\t_load(action) {\r\n\t\tthis._action = action;\r\n\t\tthis.frames = ActionAnimation.Adef[action];\r\n\t}\r\n\r\n\t/**\r\n\t * from loaded data\r\n\t * @param {string} action\r\n\t * @param {(oldInputAction:string,oldOutputAction:string) => void} onEnd\r\n\t */\r\n\treload(action, onEnd) {\r\n\t\tif (this.onEnd) {\r\n\t\t\tthis.onEnd(this._action, this.action);\r\n\t\t}\r\n\r\n\t\tthis.reset();\r\n\t\tthis._load(action);\r\n\t\tthis.onEnd = onEnd;\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.time = 0;\r\n\t\tthis.frame = 0;\r\n\t\tthis._is_end = false;\r\n\t}\r\n\r\n\t/**\r\n\t * update action delay, target.action, target.action_frame, target.tx, target.ty\r\n\t * @param {number} stamp\r\n\t * @param {CharacterRenderer} target\r\n\t */\r\n\tupdate(stamp, target) {\r\n\t\tif (!this.frames || !stamp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst fdat = this.fdat;\r\n\t\tlet delay = 0;\r\n\r\n\t\tif (!fdat) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.time = this.time + stamp;\r\n\r\n\t\tif (fdat.delay < 0) {\r\n\t\t\tfdat.delay = -fdat.delay;\r\n\t\t}\r\n\r\n\t\tif (fdat.delay > 0) {\r\n\t\t\tdelay = fdat.delay;\r\n\t\t\tthis.delay = 0;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelay = -fdat.delay;\r\n\t\t\tthis.delay = delay;\r\n\t\t}\r\n\r\n\t\tif (this.time > delay) {\r\n\t\t\tthis.frame = ++this.frame;\r\n\t\t\tthis.time = 0;\r\n\t\t}\r\n\r\n\t\t//translate target position\r\n\t\tif (fdat.move) {\r\n\t\t\ttarget.tx = -fdat.move.x * target.front;\r\n\t\t\ttarget.ty = fdat.move.y;//Y 軸相反\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttarget.tx = 0;\r\n\t\t\ttarget.ty = 0;\r\n\t\t}\r\n\t\tif (this.isEnd()) {\r\n\t\t\ttarget.tx = 0;\r\n\t\t\ttarget.ty = 0;\r\n\t\t}\r\n\t\t\r\n\t\t// 改變 action & action_frame 會造成迴圈: this.reload(this._action)\r\n\t\tif (!target._ride_action) {\r\n\t\t\ttarget._action = fdat.action;\r\n\t\t\ttarget._action_frame = fdat.frame;\r\n\t\t}\r\n\r\n\t\tif (!this.frames || this.fdat == null) {\r\n\t\t\tthis._is_end = true;\r\n\t\t}\r\n\t\telse if (!this.loop) {\r\n\t\t\tthis._is_end = false;\r\n\t\t}\r\n\t\tif (this.frames.length <= 1) {\r\n\t\t\tthis._is_end = true;\r\n\t\t}\r\n\t}\r\n\r\n\tisEnd() {\r\n\t\treturn this._is_end;\r\n\t}\r\n\r\n\tgetTotalTime() {\r\n\t\treturn this.frames.reduce((total, frame) => total + frame.delay, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * frame data\r\n\t * @returns {ActionAnimationFrameData}\r\n\t */\r\n\tget fdat() {\r\n\t\tconst fdat = this.frames[this.frame];\r\n\t\treturn fdat;\r\n\t}\r\n\t/**\r\n\t * output action\r\n\t * @returns {string}\r\n\t */\r\n\tget action() {\r\n\t\tconst fdat = this.frames[this.frame];\r\n\t\treturn fdat ? fdat.action : this.frames[0].action;//need default\r\n\t}\r\n\t/**\r\n\t * output action frame\r\n\t * @returns {number}\r\n\t */\r\n\tget actionFrame() {\r\n\t\tconst fdat = this.frames[this.frame];\r\n\t\treturn fdat ? fdat.frame : 0;\r\n\t}\r\n\r\n\tstatic async Init() {\r\n\t\t/** @type {{[action:string]:ActionAnimationFrameData[]}} */\r\n\t\tlet raw = await $get.data(ActionAnimation._base_path);\r\n\r\n\t\tlet aadef = Object.assign({}, raw);\r\n\t\t\r\n\t\tdelete aadef[\'info\'];\r\n\r\n\t\tfor (let actName in aadef) {\r\n\t\t\tlet aa = aadef[actName];\r\n\t\t\taadef[actName] = Object.values(aa).map((_fdef, frame) => {\r\n\t\t\t\tlet fdef = new ActionAnimationFrameData();\r\n\t\t\t\tfdef._load(_fdef, actName, frame);\r\n\t\t\t\treturn fdef;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t//action definition\r\n\t\tActionAnimation.Adef = aadef;\r\n\r\n\t\twindow.CharacterActionAnimationDefinition = aadef;\r\n\t}\r\n\r\n\tstatic get _base_path() {\r\n\t\treturn "/Character/00002000";\r\n\t}\r\n}\r\n/**\r\n * action definition\r\n * @type {{[action:string]:ActionAnimationFrameData[]}}\r\n */\r\nActionAnimation.Adef = null;\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvUmVuZGVyZXIvQ2hhcmFjdGVyQWN0aW9uQW5pbWF0aW9uLmpzP2I2NjUiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCB7IFZlYzIgfSBmcm9tIFwiLi4vbWF0aC5qc1wiO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBBY3Rpb25BbmltYXRpb25GcmFtZURhdGEge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLmRlbGF5ID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge1ZlYzJ9ICovXHJcblx0XHR0aGlzLm1vdmUgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy5hY3Rpb24gPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdFx0dGhpcy5mcmFtZSA9IDA7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBmcm9tIGxvYWRlZCByYXcgZGF0YVxyXG5cdCAqIEBwYXJhbSB7QWN0aW9uQW5pbWF0aW9uRnJhbWVEYXRhfSByYXdcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGZyYW1lXHJcblx0ICovXHJcblx0X2xvYWQocmF3LCBhY3Rpb24sIGZyYW1lKSB7XHJcblx0XHR0aGlzLl9yYXcgPSByYXc7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLmRlbGF5ID0gcmF3LmRlbGF5O1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7VmVjMn0gKi9cclxuXHRcdGlmIChyYXcubW92ZSkge1xyXG5cdFx0XHR0aGlzLm1vdmUgPSBuZXcgVmVjMihyYXcubW92ZS54LCByYXcubW92ZS55KTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHR0aGlzLm1vdmUgPSBuZXcgVmVjMigwLCAwKTtcclxuXHRcdH1cclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuYWN0aW9uID0gcmF3LmFjdGlvbiB8fCBhY3Rpb247XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLmZyYW1lID0gcmF3LmZyYW1lIHx8IGZyYW1lO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFjdGlvbkFuaW1hdGlvbiB7XHJcblx0Y29uc3RydWN0b3IocmF3KSB7XHJcblx0XHQvKiogQHJldHVybnMge0FjdGlvbkFuaW1hdGlvbkZyYW1lRGF0YVtdfSAqL1xyXG5cdFx0dGhpcy5mcmFtZXMgPSBudWxsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogaW5wdXQgYWN0aW9uXHJcblx0XHQgKiBAdHlwZSB7c3RyaW5nfVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLl9hY3Rpb24gPSBudWxsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogaW5wdXQgYWN0aW9uXHJcblx0XHQgKiBAdHlwZSB7bnVtYmVyfVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmZyYW1lID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IHRoaXMuZGVsYXkgPSBkZWxheSA8IDAgPyAtZGVsYXk6MDsgaWYgKHRoaXMuZGVsYXkgPT0gMCkgbGF1bmNoIGF0dGFjayAqL1xyXG5cdFx0dGhpcy5kZWxheSA9IDA7Ly9ub3QgZnJhbWUgZGVsYXlcclxuXHJcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXHJcblx0XHR0aGlzLmxvb3AgPSBmYWxzZTtcclxuXHJcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXHJcblx0XHR0aGlzLl9pc19lbmQgPSBmYWxzZTtcclxuXHJcblx0XHQvKiogQHR5cGUgeyhvbGRJbnB1dEFjdGlvbjpzdHJpbmcsb2xkT3V0cHV0QWN0aW9uOnN0cmluZykgPT4gdm9pZH0gKi9cclxuXHRcdHRoaXMub25FbmQgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogZnJvbSBsb2FkZWQgZGF0YVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cclxuXHQgKi9cclxuXHRfbG9hZChhY3Rpb24pIHtcclxuXHRcdHRoaXMuX2FjdGlvbiA9IGFjdGlvbjtcclxuXHRcdHRoaXMuZnJhbWVzID0gQWN0aW9uQW5pbWF0aW9uLkFkZWZbYWN0aW9uXTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGZyb20gbG9hZGVkIGRhdGFcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXHJcblx0ICogQHBhcmFtIHsob2xkSW5wdXRBY3Rpb246c3RyaW5nLG9sZE91dHB1dEFjdGlvbjpzdHJpbmcpID0+IHZvaWR9IG9uRW5kXHJcblx0ICovXHJcblx0cmVsb2FkKGFjdGlvbiwgb25FbmQpIHtcclxuXHRcdGlmICh0aGlzLm9uRW5kKSB7XHJcblx0XHRcdHRoaXMub25FbmQodGhpcy5fYWN0aW9uLCB0aGlzLmFjdGlvbik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5yZXNldCgpO1xyXG5cdFx0dGhpcy5fbG9hZChhY3Rpb24pO1xyXG5cdFx0dGhpcy5vbkVuZCA9IG9uRW5kO1xyXG5cdH1cclxuXHJcblx0cmVzZXQoKSB7XHJcblx0XHR0aGlzLnRpbWUgPSAwO1xyXG5cdFx0dGhpcy5mcmFtZSA9IDA7XHJcblx0XHR0aGlzLl9pc19lbmQgPSBmYWxzZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIHVwZGF0ZSBhY3Rpb24gZGVsYXksIHRhcmdldC5hY3Rpb24sIHRhcmdldC5hY3Rpb25fZnJhbWUsIHRhcmdldC50eCwgdGFyZ2V0LnR5XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YW1wXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJSZW5kZXJlcn0gdGFyZ2V0XHJcblx0ICovXHJcblx0dXBkYXRlKHN0YW1wLCB0YXJnZXQpIHtcclxuXHRcdGlmICghdGhpcy5mcmFtZXMgfHwgIXN0YW1wKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGNvbnN0IGZkYXQgPSB0aGlzLmZkYXQ7XHJcblx0XHRsZXQgZGVsYXkgPSAwO1xyXG5cclxuXHRcdGlmICghZmRhdCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy50aW1lID0gdGhpcy50aW1lICsgc3RhbXA7XHJcblxyXG5cdFx0aWYgKGZkYXQuZGVsYXkgPCAwKSB7XHJcblx0XHRcdGZkYXQuZGVsYXkgPSAtZmRhdC5kZWxheTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoZmRhdC5kZWxheSA+IDApIHtcclxuXHRcdFx0ZGVsYXkgPSBmZGF0LmRlbGF5O1xyXG5cdFx0XHR0aGlzLmRlbGF5ID0gMDtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWxheSA9IC1mZGF0LmRlbGF5O1xyXG5cdFx0XHR0aGlzLmRlbGF5ID0gZGVsYXk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMudGltZSA+IGRlbGF5KSB7XHJcblx0XHRcdHRoaXMuZnJhbWUgPSArK3RoaXMuZnJhbWU7XHJcblx0XHRcdHRoaXMudGltZSA9IDA7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly90cmFuc2xhdGUgdGFyZ2V0IHBvc2l0aW9uXHJcblx0XHRpZiAoZmRhdC5tb3ZlKSB7XHJcblx0XHRcdHRhcmdldC50eCA9IC1mZGF0Lm1vdmUueCAqIHRhcmdldC5mcm9udDtcclxuXHRcdFx0dGFyZ2V0LnR5ID0gZmRhdC5tb3ZlLnk7Ly9ZIOi7uOebuOWPjVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRhcmdldC50eCA9IDA7XHJcblx0XHRcdHRhcmdldC50eSA9IDA7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5pc0VuZCgpKSB7XHJcblx0XHRcdHRhcmdldC50eCA9IDA7XHJcblx0XHRcdHRhcmdldC50eSA9IDA7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdC8vIOaUueiuiiBhY3Rpb24gJiBhY3Rpb25fZnJhbWUg5pyD6YCg5oiQ6L+05ZyIOiB0aGlzLnJlbG9hZCh0aGlzLl9hY3Rpb24pXHJcblx0XHRpZiAoIXRhcmdldC5fcmlkZV9hY3Rpb24pIHtcclxuXHRcdFx0dGFyZ2V0Ll9hY3Rpb24gPSBmZGF0LmFjdGlvbjtcclxuXHRcdFx0dGFyZ2V0Ll9hY3Rpb25fZnJhbWUgPSBmZGF0LmZyYW1lO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghdGhpcy5mcmFtZXMgfHwgdGhpcy5mZGF0ID09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5faXNfZW5kID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKCF0aGlzLmxvb3ApIHtcclxuXHRcdFx0dGhpcy5faXNfZW5kID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5mcmFtZXMubGVuZ3RoIDw9IDEpIHtcclxuXHRcdFx0dGhpcy5faXNfZW5kID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlzRW5kKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2lzX2VuZDtcclxuXHR9XHJcblxyXG5cdGdldFRvdGFsVGltZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLmZyYW1lcy5yZWR1Y2UoKHRvdGFsLCBmcmFtZSkgPT4gdG90YWwgKyBmcmFtZS5kZWxheSwgMCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBmcmFtZSBkYXRhXHJcblx0ICogQHJldHVybnMge0FjdGlvbkFuaW1hdGlvbkZyYW1lRGF0YX1cclxuXHQgKi9cclxuXHRnZXQgZmRhdCgpIHtcclxuXHRcdGNvbnN0IGZkYXQgPSB0aGlzLmZyYW1lc1t0aGlzLmZyYW1lXTtcclxuXHRcdHJldHVybiBmZGF0O1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBvdXRwdXQgYWN0aW9uXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRnZXQgYWN0aW9uKCkge1xyXG5cdFx0Y29uc3QgZmRhdCA9IHRoaXMuZnJhbWVzW3RoaXMuZnJhbWVdO1xyXG5cdFx0cmV0dXJuIGZkYXQgPyBmZGF0LmFjdGlvbiA6IHRoaXMuZnJhbWVzWzBdLmFjdGlvbjsvL25lZWQgZGVmYXVsdFxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBvdXRwdXQgYWN0aW9uIGZyYW1lXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgYWN0aW9uRnJhbWUoKSB7XHJcblx0XHRjb25zdCBmZGF0ID0gdGhpcy5mcmFtZXNbdGhpcy5mcmFtZV07XHJcblx0XHRyZXR1cm4gZmRhdCA/IGZkYXQuZnJhbWUgOiAwO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGFzeW5jIEluaXQoKSB7XHJcblx0XHQvKiogQHR5cGUge3tbYWN0aW9uOnN0cmluZ106QWN0aW9uQW5pbWF0aW9uRnJhbWVEYXRhW119fSAqL1xyXG5cdFx0bGV0IHJhdyA9IGF3YWl0ICRnZXQuZGF0YShBY3Rpb25BbmltYXRpb24uX2Jhc2VfcGF0aCk7XHJcblxyXG5cdFx0bGV0IGFhZGVmID0gT2JqZWN0LmFzc2lnbih7fSwgcmF3KTtcclxuXHRcdFxyXG5cdFx0ZGVsZXRlIGFhZGVmWydpbmZvJ107XHJcblxyXG5cdFx0Zm9yIChsZXQgYWN0TmFtZSBpbiBhYWRlZikge1xyXG5cdFx0XHRsZXQgYWEgPSBhYWRlZlthY3ROYW1lXTtcclxuXHRcdFx0YWFkZWZbYWN0TmFtZV0gPSBPYmplY3QudmFsdWVzKGFhKS5tYXAoKF9mZGVmLCBmcmFtZSkgPT4ge1xyXG5cdFx0XHRcdGxldCBmZGVmID0gbmV3IEFjdGlvbkFuaW1hdGlvbkZyYW1lRGF0YSgpO1xyXG5cdFx0XHRcdGZkZWYuX2xvYWQoX2ZkZWYsIGFjdE5hbWUsIGZyYW1lKTtcclxuXHRcdFx0XHRyZXR1cm4gZmRlZjtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9hY3Rpb24gZGVmaW5pdGlvblxyXG5cdFx0QWN0aW9uQW5pbWF0aW9uLkFkZWYgPSBhYWRlZjtcclxuXHJcblx0XHR3aW5kb3cuQ2hhcmFjdGVyQWN0aW9uQW5pbWF0aW9uRGVmaW5pdGlvbiA9IGFhZGVmO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldCBfYmFzZV9wYXRoKCkge1xyXG5cdFx0cmV0dXJuIFwiL0NoYXJhY3Rlci8wMDAwMjAwMFwiO1xyXG5cdH1cclxufVxyXG4vKipcclxuICogYWN0aW9uIGRlZmluaXRpb25cclxuICogQHR5cGUge3tbYWN0aW9uOnN0cmluZ106QWN0aW9uQW5pbWF0aW9uRnJhbWVEYXRhW119fVxyXG4gKi9cclxuQWN0aW9uQW5pbWF0aW9uLkFkZWYgPSBudWxsO1xyXG5cclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///371\n')},383:function(module,exports){eval('\r\nwindow.GetSearchParams = function GetSearchParams() {\r\n\tconst url = new URL(window.location, window.location.origin);\r\n\tlet params = {};\r\n\r\n\tfor ([key, value] of url.searchParams.entries()) {\r\n\t\tparams[key] = value;\r\n\t}\r\n\r\n\treturn params;\r\n}\r\n\r\nwindow.DownloadData = (function () {\r\n\tlet a = document.createElement("a");\r\n\tdocument.body.appendChild(a);\r\n\ta.style = "display: none";\r\n\ta.target = "_blank";\r\n\treturn function DownloadData(text, type, fileName) {\r\n\t\tlet blob = new Blob([text], { type: type || "octet/stream" });\r\n\t\tlet url = window.URL.createObjectURL(blob);\r\n\t\tif (fileName && fileName != "") {\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = fileName;\r\n\t\t\ta.click();\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//a.href = url;\r\n\t\t\t//a.click();\r\n\t\t\twindow.open(url, \'_blank\');\r\n\t\t}\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t};\r\n}());\r\n\r\nwindow.SelectText = function SelectText(elem) {\r\n\tvar range, selection;\r\n\r\n\tif (document.body.createTextRange) {\r\n\t\trange = document.body.createTextRange();\r\n\t\trange.moveToElementText(elem);\r\n\t\trange.select();\r\n\t}\r\n\telse if (window.getSelection) {\r\n\t\tselection = window.getSelection();\r\n\t\trange = document.createRange();\r\n\t\trange.selectNodeContents(elem);\r\n\t\tselection.removeAllRanges();\r\n\t\tselection.addRange(range);\r\n\t}\r\n}\r\nwindow.copyToClipboard = function copyToClipboard(text) {\r\n\tvar $temp = $("<input>");\r\n\t$("body").append($temp);\r\n\t$temp.val(text).select();\r\n\tdocument.execCommand("copy");\r\n\t$temp.remove();\r\n}\r\n\r\n/**\r\n * disable textNode "#text"\r\n * @param {string} xml - xml\r\n * @param {string[]=} arrayTags - optional\r\n * @returns {object}\r\n */\r\nfunction parseXml(xml, arrayTags) {\r\n\tvar dom = null;\r\n\tif (window.DOMParser) {\r\n\t\tdom = (new DOMParser()).parseFromString(xml, "text/xml");\r\n\t}\r\n\telse if (window.ActiveXObject) {\r\n\t\tdom = new ActiveXObject(\'Microsoft.XMLDOM\');\r\n\t\tdom.async = false;\r\n\t\tif (!dom.loadXML(xml)) {\r\n\t\t\tthrow dom.parseError.reason + " " + dom.parseError.srcText;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthrow "cannot parse xml string!";\r\n\t}\r\n\r\n\tfunction isArray(o) {\r\n\t\treturn Object.prototype.toString.apply(o) === \'[object Array]\';\r\n\t}\r\n\r\n\tfunction parseNode(xmlNode, result) {\r\n\t\tif (xmlNode.nodeName == "#text" && xmlNode.nodeValue.trim() == "") {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar jsonNode = {};\r\n\t\tvar existing = result[xmlNode.nodeName];\r\n\t\tif (existing) {\r\n\t\t\tif (!isArray(existing)) {\r\n\t\t\t\tresult[xmlNode.nodeName] = [existing, jsonNode];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tresult[xmlNode.nodeName].push(jsonNode);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (arrayTags && arrayTags.indexOf(xmlNode.nodeName) != -1) {\r\n\t\t\t\tresult[xmlNode.nodeName] = [jsonNode];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tresult[xmlNode.nodeName] = jsonNode;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (xmlNode.attributes) {\r\n\t\t\tvar length = xmlNode.attributes.length;\r\n\t\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\t\tvar attribute = xmlNode.attributes[i];\r\n\t\t\t\tjsonNode[attribute.nodeName] = attribute.nodeValue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar length = xmlNode.childNodes.length;\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tparseNode(xmlNode.childNodes[i], jsonNode);\r\n\t\t}\r\n\t}\r\n\r\n\tvar result = {};\r\n\tif (dom.childNodes.length) {\r\n\t\tparseNode(dom.childNodes[0], result);\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwuanM/ZTBlYiJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxud2luZG93LkdldFNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uIEdldFNlYXJjaFBhcmFtcygpIHtcclxuXHRjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbiwgd2luZG93LmxvY2F0aW9uLm9yaWdpbik7XHJcblx0bGV0IHBhcmFtcyA9IHt9O1xyXG5cclxuXHRmb3IgKFtrZXksIHZhbHVlXSBvZiB1cmwuc2VhcmNoUGFyYW1zLmVudHJpZXMoKSkge1xyXG5cdFx0cGFyYW1zW2tleV0gPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdHJldHVybiBwYXJhbXM7XHJcbn1cclxuXHJcbndpbmRvdy5Eb3dubG9hZERhdGEgPSAoZnVuY3Rpb24gKCkge1xyXG5cdGxldCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XHJcblx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcclxuXHRhLnN0eWxlID0gXCJkaXNwbGF5OiBub25lXCI7XHJcblx0YS50YXJnZXQgPSBcIl9ibGFua1wiO1xyXG5cdHJldHVybiBmdW5jdGlvbiBEb3dubG9hZERhdGEodGV4dCwgdHlwZSwgZmlsZU5hbWUpIHtcclxuXHRcdGxldCBibG9iID0gbmV3IEJsb2IoW3RleHRdLCB7IHR5cGU6IHR5cGUgfHwgXCJvY3RldC9zdHJlYW1cIiB9KTtcclxuXHRcdGxldCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuXHRcdGlmIChmaWxlTmFtZSAmJiBmaWxlTmFtZSAhPSBcIlwiKSB7XHJcblx0XHRcdGEuaHJlZiA9IHVybDtcclxuXHRcdFx0YS5kb3dubG9hZCA9IGZpbGVOYW1lO1xyXG5cdFx0XHRhLmNsaWNrKCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Ly9hLmhyZWYgPSB1cmw7XHJcblx0XHRcdC8vYS5jbGljaygpO1xyXG5cdFx0XHR3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTtcclxuXHRcdH1cclxuXHRcdHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcblx0fTtcclxufSgpKTtcclxuXHJcbndpbmRvdy5TZWxlY3RUZXh0ID0gZnVuY3Rpb24gU2VsZWN0VGV4dChlbGVtKSB7XHJcblx0dmFyIHJhbmdlLCBzZWxlY3Rpb247XHJcblxyXG5cdGlmIChkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSkge1xyXG5cdFx0cmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO1xyXG5cdFx0cmFuZ2UubW92ZVRvRWxlbWVudFRleHQoZWxlbSk7XHJcblx0XHRyYW5nZS5zZWxlY3QoKTtcclxuXHR9XHJcblx0ZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbikge1xyXG5cdFx0c2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xyXG5cdFx0cmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xyXG5cdFx0cmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGVsZW0pO1xyXG5cdFx0c2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xyXG5cdFx0c2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTtcclxuXHR9XHJcbn1cclxud2luZG93LmNvcHlUb0NsaXBib2FyZCA9IGZ1bmN0aW9uIGNvcHlUb0NsaXBib2FyZCh0ZXh0KSB7XHJcblx0dmFyICR0ZW1wID0gJChcIjxpbnB1dD5cIik7XHJcblx0JChcImJvZHlcIikuYXBwZW5kKCR0ZW1wKTtcclxuXHQkdGVtcC52YWwodGV4dCkuc2VsZWN0KCk7XHJcblx0ZG9jdW1lbnQuZXhlY0NvbW1hbmQoXCJjb3B5XCIpO1xyXG5cdCR0ZW1wLnJlbW92ZSgpO1xyXG59XHJcblxyXG4vKipcclxuICogZGlzYWJsZSB0ZXh0Tm9kZSBcIiN0ZXh0XCJcclxuICogQHBhcmFtIHtzdHJpbmd9IHhtbCAtIHhtbFxyXG4gKiBAcGFyYW0ge3N0cmluZ1tdPX0gYXJyYXlUYWdzIC0gb3B0aW9uYWxcclxuICogQHJldHVybnMge29iamVjdH1cclxuICovXHJcbmZ1bmN0aW9uIHBhcnNlWG1sKHhtbCwgYXJyYXlUYWdzKSB7XHJcblx0dmFyIGRvbSA9IG51bGw7XHJcblx0aWYgKHdpbmRvdy5ET01QYXJzZXIpIHtcclxuXHRcdGRvbSA9IChuZXcgRE9NUGFyc2VyKCkpLnBhcnNlRnJvbVN0cmluZyh4bWwsIFwidGV4dC94bWxcIik7XHJcblx0fVxyXG5cdGVsc2UgaWYgKHdpbmRvdy5BY3RpdmVYT2JqZWN0KSB7XHJcblx0XHRkb20gPSBuZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTERPTScpO1xyXG5cdFx0ZG9tLmFzeW5jID0gZmFsc2U7XHJcblx0XHRpZiAoIWRvbS5sb2FkWE1MKHhtbCkpIHtcclxuXHRcdFx0dGhyb3cgZG9tLnBhcnNlRXJyb3IucmVhc29uICsgXCIgXCIgKyBkb20ucGFyc2VFcnJvci5zcmNUZXh0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdHRocm93IFwiY2Fubm90IHBhcnNlIHhtbCBzdHJpbmchXCI7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBpc0FycmF5KG8pIHtcclxuXHRcdHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KG8pID09PSAnW29iamVjdCBBcnJheV0nO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcGFyc2VOb2RlKHhtbE5vZGUsIHJlc3VsdCkge1xyXG5cdFx0aWYgKHhtbE5vZGUubm9kZU5hbWUgPT0gXCIjdGV4dFwiICYmIHhtbE5vZGUubm9kZVZhbHVlLnRyaW0oKSA9PSBcIlwiKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIganNvbk5vZGUgPSB7fTtcclxuXHRcdHZhciBleGlzdGluZyA9IHJlc3VsdFt4bWxOb2RlLm5vZGVOYW1lXTtcclxuXHRcdGlmIChleGlzdGluZykge1xyXG5cdFx0XHRpZiAoIWlzQXJyYXkoZXhpc3RpbmcpKSB7XHJcblx0XHRcdFx0cmVzdWx0W3htbE5vZGUubm9kZU5hbWVdID0gW2V4aXN0aW5nLCBqc29uTm9kZV07XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0W3htbE5vZGUubm9kZU5hbWVdLnB1c2goanNvbk5vZGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0aWYgKGFycmF5VGFncyAmJiBhcnJheVRhZ3MuaW5kZXhPZih4bWxOb2RlLm5vZGVOYW1lKSAhPSAtMSkge1xyXG5cdFx0XHRcdHJlc3VsdFt4bWxOb2RlLm5vZGVOYW1lXSA9IFtqc29uTm9kZV07XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0W3htbE5vZGUubm9kZU5hbWVdID0ganNvbk5vZGU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoeG1sTm9kZS5hdHRyaWJ1dGVzKSB7XHJcblx0XHRcdHZhciBsZW5ndGggPSB4bWxOb2RlLmF0dHJpYnV0ZXMubGVuZ3RoO1xyXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGF0dHJpYnV0ZSA9IHhtbE5vZGUuYXR0cmlidXRlc1tpXTtcclxuXHRcdFx0XHRqc29uTm9kZVthdHRyaWJ1dGUubm9kZU5hbWVdID0gYXR0cmlidXRlLm5vZGVWYWx1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBsZW5ndGggPSB4bWxOb2RlLmNoaWxkTm9kZXMubGVuZ3RoO1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG5cdFx0XHRwYXJzZU5vZGUoeG1sTm9kZS5jaGlsZE5vZGVzW2ldLCBqc29uTm9kZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR2YXIgcmVzdWx0ID0ge307XHJcblx0aWYgKGRvbS5jaGlsZE5vZGVzLmxlbmd0aCkge1xyXG5cdFx0cGFyc2VOb2RlKGRvbS5jaGlsZE5vZGVzWzBdLCByZXN1bHQpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHJlc3VsdDtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///383\n')}}]);