(window.webpackJsonp=window.webpackJsonp||[]).push([[15,18,19],{334:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AnimationBase", function() { return AnimationBase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Animation", function() { return Animation; });\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(332);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(333);\n/* harmony import */ var _Sprite_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(347);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\nwindow.m_draw_animation_texture_info = false;\r\n\r\nclass IAnimation {\r\n\tconstructor(raw, url) {\r\n\t\tthis._raw = null;\r\n\t\tthis._url = null;\r\n\t\t\r\n\t\tObject.defineProperties(this, {\r\n\t\t\t_raw: {\r\n\t\t\t\tvalue: raw\r\n\t\t\t},\r\n\t\t\t_url: {\r\n\t\t\t\tvalue: url\r\n\t\t\t},\r\n\t\t});\r\n\r\n\t\tthis.frame = 0;\r\n\t\tthis.time = 0;\r\n\r\n\t\t/** elapsed time */\r\n\t\tthis.delta = 0;\r\n\r\n\t\t/** @type {Sprite[]} */\r\n\t\tthis.textures = [];\r\n\t\t\r\n\t\t/** @type {boolean} */\r\n\t\tthis.is_loop = true;\r\n\t\t\r\n\t\t/** @type {boolean} */\r\n\t\tthis.is_end = false;\r\n\r\n\t\tif (!raw && !this._url) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t}\r\n\r\n\tgetTotalTime() {\r\n\t\treturn this.textures.reduce((pv, cv) => pv + cv.delay, 0);\r\n\t}\r\n\t\r\n\tclone() {\r\n\t\tlet newAnim = new this.constructor(this._raw, this._url);\r\n\t\tnewAnim.textures = this.textures;\r\n\t\treturn newAnim;\r\n\t}\r\n\t\r\n\tload() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} stamp\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/** reset frame */\r\n\t_resetFrame() {\r\n\t\tthis.frame = 0;\r\n\t\tthis.time = 0;\r\n\t}\r\n\r\n\t/** restart */\r\n\treset() {\r\n\t\tthis.frame = 0;\r\n\t\tthis.time = 0;\r\n\t\tthis.is_end = false;\r\n\t}\r\n\t\r\n\tget texture() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * remove at nextStep\r\n\t */\r\n\tdestroy() {\r\n\t\tthis.is_loop = false;//防止重複\r\n\t\tthis.is_end = true;\r\n\t}\r\n}\r\n\r\n/**\r\n * process animation\r\n */\r\nclass AnimationBase extends IAnimation {\r\n\t/**\r\n\t * @param {!any} raw\r\n\t * @param {!string} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\t}\r\n\r\n\tload() {\r\n\t\tif (!this._raw) {\r\n\t\t\t//this._raw = await $get.data(this._url);\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i in this._raw; ++i) {\r\n\t\t\t//let url = this._url + "/" + i;\r\n\r\n\t\t\tlet texture = new _Sprite_js__WEBPACK_IMPORTED_MODULE_2__[/* Sprite */ "a"](this._raw[i]);\r\n\r\n\t\t\t//texture._url = url;\r\n\r\n\t\t\tthis.textures[i] = texture;\r\n\t\t}\r\n\t\t\r\n\t\tif (this.textures[0]) {\r\n\t\t\tif (!this.textures[0].isLoaded()) {\r\n\t\t\t\tthis.textures[0].__loadTexture();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tisEnd() {\r\n\t\treturn this.is_end;\r\n\t}\r\n\r\n\t/**\r\n\t * aways loop\r\n\t * @param {number} stamp\r\n\t */\r\n\t_update(stamp) {\r\n\t\tconst fc = this.textures.length;\r\n\r\n\t\tif (fc > 0) {//??\r\n\t\t\tthis.time = this.time + stamp;\r\n\r\n\t\t\tif (this.time > this.texture.delay) {\r\n\t\t\t\tthis.frame = ++this.frame % fc;\r\n\t\t\t\tthis.time = 0;\r\n\t\t\t}\r\n\t\t\t//this.frame = Math.trunc(this.time / 1000) % fc;\r\n\t\t}\r\n\r\n\t\tthis.delta += stamp;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} stamp\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tconst fc = this.textures.length;\r\n\r\n\t\tif (fc > 0) {//??\r\n\t\t\tthis.time = this.time + stamp;\r\n\r\n\t\t\tif (this.time > this.texture.delay) {\r\n\t\t\t\tthis.frame = this.frame + 1;\r\n\t\t\t\tif (this.frame >= fc) {\r\n\t\t\t\t\tif (this.is_loop) {\r\n\t\t\t\t\t\tthis.reset();//make loop\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t//防止錯誤\r\n\t\t\t\t\t\tthis.frame = fc - 1;//this._resetFrame();\r\n\r\n\t\t\t\t\t\tthis.is_end = true;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthis.time = 0;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis.delta += stamp;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer - GraphLayerRenderer\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tdraw(renderer, x, y, angle, flip) {\r\n\t\tlet texture = this.texture;\r\n\t\trenderer.drawRotaGraph(texture, x, y, angle, flip);\r\n\t}\r\n\t\r\n\tget texture() {\r\n\t\treturn this.textures[this.frame];\r\n\t}\r\n}\r\n\r\n/**\r\n * animation rendering\r\n */\r\nclass Animation extends AnimationBase {\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\r\n\t\tthis.draw = this._draw_and_preload;\r\n\t}\r\n\r\n\t/**\r\n\t * draw and load next frame\r\n\t * @param {IRenderer} renderer - GraphLayerRenderer\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\t_draw_and_preload(renderer, x, y, angle, flip) {\r\n\t\tlet frame;\r\n\r\n\t\t// if current frame is not loaded then render prev frame\r\n\t\tfor (frame = this.frame; frame >= 0; --frame) {\r\n\t\t\tlet texture = this.textures[frame];\r\n\r\n\t\t\tif (texture.isLoaded()) {\r\n\t\t\t\trenderer.drawRotaGraph(texture, x, y, angle, flip);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//preload next frame\r\n\t\tlet texture = this.textures[++frame];\r\n\t\tif (texture) {//if frame < this.textures.length\r\n\t\t\tif (!texture.isLoaded()) {\r\n\t\t\t\ttexture.__loadTexture();\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {//if all testure are loaded\r\n\t\t\tdelete this.draw;\r\n\t\t}\r\n\t}\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM0LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvQW5pbWF0aW9uLmpzP2E0ZDUiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCB7IFZlYzIgfSBmcm9tIFwiLi9tYXRoLmpzXCI7XHJcbmltcG9ydCB7IElHcmFwaCwgSVJlbmRlcmVyIH0gZnJvbSBcIi4vSVJlbmRlcmVyLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBTcHJpdGUgfSBmcm9tIFwiLi9TcHJpdGUuanNcIjtcclxuXHJcblxyXG53aW5kb3cubV9kcmF3X2FuaW1hdGlvbl90ZXh0dXJlX2luZm8gPSBmYWxzZTtcclxuXHJcbmNsYXNzIElBbmltYXRpb24ge1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHR0aGlzLl9yYXcgPSBudWxsO1xyXG5cdFx0dGhpcy5fdXJsID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xyXG5cdFx0XHRfcmF3OiB7XHJcblx0XHRcdFx0dmFsdWU6IHJhd1xyXG5cdFx0XHR9LFxyXG5cdFx0XHRfdXJsOiB7XHJcblx0XHRcdFx0dmFsdWU6IHVybFxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5mcmFtZSA9IDA7XHJcblx0XHR0aGlzLnRpbWUgPSAwO1xyXG5cclxuXHRcdC8qKiBlbGFwc2VkIHRpbWUgKi9cclxuXHRcdHRoaXMuZGVsdGEgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7U3ByaXRlW119ICovXHJcblx0XHR0aGlzLnRleHR1cmVzID0gW107XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cclxuXHRcdHRoaXMuaXNfbG9vcCA9IHRydWU7XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cclxuXHRcdHRoaXMuaXNfZW5kID0gZmFsc2U7XHJcblxyXG5cdFx0aWYgKCFyYXcgJiYgIXRoaXMuX3VybCkge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGdldFRvdGFsVGltZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLnRleHR1cmVzLnJlZHVjZSgocHYsIGN2KSA9PiBwdiArIGN2LmRlbGF5LCAwKTtcclxuXHR9XHJcblx0XHJcblx0Y2xvbmUoKSB7XHJcblx0XHRsZXQgbmV3QW5pbSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHRoaXMuX3JhdywgdGhpcy5fdXJsKTtcclxuXHRcdG5ld0FuaW0udGV4dHVyZXMgPSB0aGlzLnRleHR1cmVzO1xyXG5cdFx0cmV0dXJuIG5ld0FuaW07XHJcblx0fVxyXG5cdFxyXG5cdGxvYWQoKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhbXBcclxuXHQgKi9cclxuXHR1cGRhdGUoc3RhbXApIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRcIik7XHJcblx0fVxyXG5cclxuXHQvKiogcmVzZXQgZnJhbWUgKi9cclxuXHRfcmVzZXRGcmFtZSgpIHtcclxuXHRcdHRoaXMuZnJhbWUgPSAwO1xyXG5cdFx0dGhpcy50aW1lID0gMDtcclxuXHR9XHJcblxyXG5cdC8qKiByZXN0YXJ0ICovXHJcblx0cmVzZXQoKSB7XHJcblx0XHR0aGlzLmZyYW1lID0gMDtcclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblx0XHR0aGlzLmlzX2VuZCA9IGZhbHNlO1xyXG5cdH1cclxuXHRcclxuXHRnZXQgdGV4dHVyZSgpIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiByZW1vdmUgYXQgbmV4dFN0ZXBcclxuXHQgKi9cclxuXHRkZXN0cm95KCkge1xyXG5cdFx0dGhpcy5pc19sb29wID0gZmFsc2U7Ly/pmLLmraLph43opIdcclxuXHRcdHRoaXMuaXNfZW5kID0gdHJ1ZTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBwcm9jZXNzIGFuaW1hdGlvblxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIEFuaW1hdGlvbkJhc2UgZXh0ZW5kcyBJQW5pbWF0aW9uIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0geyFhbnl9IHJhd1xyXG5cdCAqIEBwYXJhbSB7IXN0cmluZ30gdXJsXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IocmF3LCB1cmwpIHtcclxuXHRcdHN1cGVyKHJhdywgdXJsKTtcclxuXHR9XHJcblxyXG5cdGxvYWQoKSB7XHJcblx0XHRpZiAoIXRoaXMuX3Jhdykge1xyXG5cdFx0XHQvL3RoaXMuX3JhdyA9IGF3YWl0ICRnZXQuZGF0YSh0aGlzLl91cmwpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIGluIHRoaXMuX3JhdzsgKytpKSB7XHJcblx0XHRcdC8vbGV0IHVybCA9IHRoaXMuX3VybCArIFwiL1wiICsgaTtcclxuXHJcblx0XHRcdGxldCB0ZXh0dXJlID0gbmV3IFNwcml0ZSh0aGlzLl9yYXdbaV0pO1xyXG5cclxuXHRcdFx0Ly90ZXh0dXJlLl91cmwgPSB1cmw7XHJcblxyXG5cdFx0XHR0aGlzLnRleHR1cmVzW2ldID0gdGV4dHVyZTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYgKHRoaXMudGV4dHVyZXNbMF0pIHtcclxuXHRcdFx0aWYgKCF0aGlzLnRleHR1cmVzWzBdLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0XHR0aGlzLnRleHR1cmVzWzBdLl9fbG9hZFRleHR1cmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHRpc0VuZCgpIHtcclxuXHRcdHJldHVybiB0aGlzLmlzX2VuZDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGF3YXlzIGxvb3BcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhbXBcclxuXHQgKi9cclxuXHRfdXBkYXRlKHN0YW1wKSB7XHJcblx0XHRjb25zdCBmYyA9IHRoaXMudGV4dHVyZXMubGVuZ3RoO1xyXG5cclxuXHRcdGlmIChmYyA+IDApIHsvLz8/XHJcblx0XHRcdHRoaXMudGltZSA9IHRoaXMudGltZSArIHN0YW1wO1xyXG5cclxuXHRcdFx0aWYgKHRoaXMudGltZSA+IHRoaXMudGV4dHVyZS5kZWxheSkge1xyXG5cdFx0XHRcdHRoaXMuZnJhbWUgPSArK3RoaXMuZnJhbWUgJSBmYztcclxuXHRcdFx0XHR0aGlzLnRpbWUgPSAwO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vdGhpcy5mcmFtZSA9IE1hdGgudHJ1bmModGhpcy50aW1lIC8gMTAwMCkgJSBmYztcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmRlbHRhICs9IHN0YW1wO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc3RhbXBcclxuXHQgKi9cclxuXHR1cGRhdGUoc3RhbXApIHtcclxuXHRcdGNvbnN0IGZjID0gdGhpcy50ZXh0dXJlcy5sZW5ndGg7XHJcblxyXG5cdFx0aWYgKGZjID4gMCkgey8vPz9cclxuXHRcdFx0dGhpcy50aW1lID0gdGhpcy50aW1lICsgc3RhbXA7XHJcblxyXG5cdFx0XHRpZiAodGhpcy50aW1lID4gdGhpcy50ZXh0dXJlLmRlbGF5KSB7XHJcblx0XHRcdFx0dGhpcy5mcmFtZSA9IHRoaXMuZnJhbWUgKyAxO1xyXG5cdFx0XHRcdGlmICh0aGlzLmZyYW1lID49IGZjKSB7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5pc19sb29wKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMucmVzZXQoKTsvL21ha2UgbG9vcFxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8v6Ziy5q2i6Yyv6KqkXHJcblx0XHRcdFx0XHRcdHRoaXMuZnJhbWUgPSBmYyAtIDE7Ly90aGlzLl9yZXNldEZyYW1lKCk7XHJcblxyXG5cdFx0XHRcdFx0XHR0aGlzLmlzX2VuZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0dGhpcy50aW1lID0gMDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR0aGlzLmRlbHRhICs9IHN0YW1wO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtJUmVuZGVyZXJ9IHJlbmRlcmVyIC0gR3JhcGhMYXllclJlbmRlcmVyXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqL1xyXG5cdGRyYXcocmVuZGVyZXIsIHgsIHksIGFuZ2xlLCBmbGlwKSB7XHJcblx0XHRsZXQgdGV4dHVyZSA9IHRoaXMudGV4dHVyZTtcclxuXHRcdHJlbmRlcmVyLmRyYXdSb3RhR3JhcGgodGV4dHVyZSwgeCwgeSwgYW5nbGUsIGZsaXApO1xyXG5cdH1cclxuXHRcclxuXHRnZXQgdGV4dHVyZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLnRleHR1cmVzW3RoaXMuZnJhbWVdO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIGFuaW1hdGlvbiByZW5kZXJpbmdcclxuICovXHJcbmV4cG9ydCBjbGFzcyBBbmltYXRpb24gZXh0ZW5kcyBBbmltYXRpb25CYXNlIHtcclxuXHRjb25zdHJ1Y3RvcihyYXcsIHVybCkge1xyXG5cdFx0c3VwZXIocmF3LCB1cmwpO1xyXG5cclxuXHRcdHRoaXMuZHJhdyA9IHRoaXMuX2RyYXdfYW5kX3ByZWxvYWQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBkcmF3IGFuZCBsb2FkIG5leHQgZnJhbWVcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXIgLSBHcmFwaExheWVyUmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcblx0ICovXHJcblx0X2RyYXdfYW5kX3ByZWxvYWQocmVuZGVyZXIsIHgsIHksIGFuZ2xlLCBmbGlwKSB7XHJcblx0XHRsZXQgZnJhbWU7XHJcblxyXG5cdFx0Ly8gaWYgY3VycmVudCBmcmFtZSBpcyBub3QgbG9hZGVkIHRoZW4gcmVuZGVyIHByZXYgZnJhbWVcclxuXHRcdGZvciAoZnJhbWUgPSB0aGlzLmZyYW1lOyBmcmFtZSA+PSAwOyAtLWZyYW1lKSB7XHJcblx0XHRcdGxldCB0ZXh0dXJlID0gdGhpcy50ZXh0dXJlc1tmcmFtZV07XHJcblxyXG5cdFx0XHRpZiAodGV4dHVyZS5pc0xvYWRlZCgpKSB7XHJcblx0XHRcdFx0cmVuZGVyZXIuZHJhd1JvdGFHcmFwaCh0ZXh0dXJlLCB4LCB5LCBhbmdsZSwgZmxpcCk7XHJcblx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvL3ByZWxvYWQgbmV4dCBmcmFtZVxyXG5cdFx0bGV0IHRleHR1cmUgPSB0aGlzLnRleHR1cmVzWysrZnJhbWVdO1xyXG5cdFx0aWYgKHRleHR1cmUpIHsvL2lmIGZyYW1lIDwgdGhpcy50ZXh0dXJlcy5sZW5ndGhcclxuXHRcdFx0aWYgKCF0ZXh0dXJlLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0XHR0ZXh0dXJlLl9fbG9hZFRleHR1cmUoKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7Ly9pZiBhbGwgdGVzdHVyZSBhcmUgbG9hZGVkXHJcblx0XHRcdGRlbGV0ZSB0aGlzLmRyYXc7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///334\n')},336:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterAnimationBase", function() { return CharacterAnimationBase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharacterRenderer", function() { return CharacterRenderer; });\n/* harmony import */ var _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(353);\n/* harmony import */ var _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(349);\n/* harmony import */ var _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _init_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(368);\n/* harmony import */ var _Animation__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(334);\n/* harmony import */ var _Engine_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(335);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(333);\n/* harmony import */ var _Sprite_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(347);\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(332);\n/* harmony import */ var _CharacterActionAnimation_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(371);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nlet zMap = {};\r\nlet sMap = {};\r\n\r\n\r\n/**\r\n * 00026623.blink[1].brow has bug\r\n * \'Weapon/01702694\' is Longcoat(islot)\r\n * how to use cash-weapon (ex: 01702504|0152)\r\n */\r\n\r\n/**\r\n * multi-image-sprite\r\n */\r\nclass FragmentTexture extends _Sprite_js__WEBPACK_IMPORTED_MODULE_6__[/* SpriteBase */ "b"] {\r\n\t/**\r\n\t * @param {wzproperty} raw\r\n\t * @param {string} full_path\r\n\t */\r\n\tconstructor(raw, full_path) {\r\n\t\tsuper(raw, full_path);\r\n\r\n\t\tif (this._raw.origin) {\r\n\t\t\tthis._raw.origin.__proto__ = _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].prototype;\r\n\t\t}\r\n\r\n\t\tfor (let i in this._raw.map) {\r\n\t\t\tthis._raw.map[i].__proto__ = _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].prototype;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * if this.relative == null then remove this\r\n\t\t * @type {Vec2}\r\n\t\t */\r\n\t\tthis.relative = new _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"](0, 0);\r\n\t\t\r\n\t\tthis.calcRelative = this._calcRelative;//this._getRelativeFunction();//this.__old_calcRelative;//\r\n\r\n\t\tthis.filter = new _IRenderer_js__WEBPACK_IMPORTED_MODULE_5__["ImageFilter"]();\r\n\t\tthis.opacity = 1;\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis.visible = true;\r\n\r\n\r\n\t\t/** @type {string} - extra property. */\r\n\t\tthis._slot = null;\r\n\r\n\t\t/** @type {string} - extra property. 在哪個部位 */\r\n\t\tthis._place = null;\r\n\r\n\t\t/** @type {string} - extra property: _slot itemId, _place, _raw.z z */\r\n\t\tthis.classList = null;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {number}\r\n\t */\r\n\tget z() {\r\n\t\treturn zMap[this._raw.z] || 1;\r\n\t}\r\n\tset z(not_value) {\r\n\t\tconsole.error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {number}\r\n\t */\r\n\tget order() {\r\n\t\tdebugger;\r\n\t\treturn this.z;\r\n\t}\r\n\tset order(not_value) {\r\n\t\tdebugger;\r\n\t\tconsole.error(new TypeError("Not implement"));\r\n\t}\r\n\r\n\t/** @returns {Vec2} */\r\n\tget origin() { return this._raw.origin || _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty; }\r\n\r\n\tisHasAnchor() { return !!this._raw.map; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget brow() { return this._raw.map.brow; }\r\n\tisAnchorBrow() { return !!this._raw.map.brow; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget neck() { return this._raw.map.neck; }\r\n\tisAnchorNeck() { return !!this._raw.map.neck; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget navel() { return this._raw.map.navel; }\r\n\tisAnchorNavel() { return !!this._raw.map.navel; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget hand() { return this._raw.map.hand; }\r\n\tisAnchorHand() { return !!this._raw.map.hand; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget handMove() { return this._raw.map.handMove; }\r\n\tisAnchorHandMove() { return !!this._raw.map.handMove; }\r\n\r\n\r\n\t/** @returns {Vec2} */\r\n\tget _earBelowHead() { return this._raw.map.earBelowHead; }\r\n\tisAnchor_EarBelowHead() { return !!this._raw.map.earBelowHead; }\r\n\r\n\t/** @returns {Vec2} */\r\n\tget _earOverHead() { return this._raw.map.earOverHead; }\r\n\tisAnchor_EarOverHead() { return !!this._raw.map.earOverHead; }\r\n\r\n\t/**\r\n\t * @param {FragmentTexture} that - this\r\n\t * @param {FragmentTexture} base - parent\r\n\t * @param {string} anchor - anchor name\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_anchor(that, base, anchor) {\r\n\t\treturn base[anchor].minus(that[anchor]).plus(base.origin.minus(that.origin));\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative(chara, body, head) {\r\n\t\tthis.calcRelative = this._getRelativeFunction(chara);\r\n\t\treturn this.calcRelative(chara, body, head);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {function(CharacterAnimationBase,FragmentTexture,FragmentTexture):Vec2}\r\n\t */\r\n\t_getRelativeFunction(chara) {\r\n\t\tif (!this.isHasAnchor()) {\r\n\t\t\treturn this._calcRelativeEmpty;\r\n\t\t}\r\n\t\tif (this.isAnchorNeck()) {\r\n\t\t\treturn this._calcRelative_neck;\r\n\t\t}\r\n\t\tif (this.isAnchorBrow()) {\r\n\t\t\treturn this._calcRelative_brow;\r\n\t\t}\r\n\t\tif (this.isAnchorNavel()) {\r\n\t\t\tif (this == chara.slots.body) {\r\n\t\t\t\treturn this._getOrigin;\r\n\t\t\t}\r\n\t\t\treturn this._calcRelative_navel;\r\n\t\t}\r\n\t\tif (this.isAnchorHand()) {\r\n\t\t\treturn this._calcRelative_hand;\r\n\t\t}\r\n\t\tif (this.isAnchorHandMove()) {\r\n\t\t\tif (this._url.lastIndexOf("lHand") > 0) {\r\n\t\t\t\treturn this._calcRelative_handMove_lHand;\r\n\t\t\t}\r\n\t\t\treturn this._calcRelative_handMove;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelativeEmpty(chara, body, head) {\r\n\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty;\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_getOrigin(chara, body, head) {\r\n\t\treturn this.origin;\r\n\t}\r\n\t/**\r\n\t * neck on the navel\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_neck(chara, body, head) {\r\n\t\treturn this._anchor(this, body, "neck").minus(body.origin);\r\n\t}\r\n\t/**\r\n\t * brow on the head & head on the neck & neck on the navel\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_brow(chara, body, head) {\r\n\t\treturn this._anchor(this, head, "brow").plus(this._anchor(head, body, "neck")).minus(body.origin);//anchor_brow+(-7,-33)\r\n\t}\r\n\t/**\r\n\t * this is origin point, no anchor\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_navel(chara, body, head) {\r\n\t\treturn body.navel.minus(this.navel).minus(this.origin);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_hand(chara, body, head) {\r\n\t\tconst hand = chara.slots.body.fragments.arm.getTexture(chara);\r\n\t\tif (hand == null) {\r\n\t\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty.minus(this.hand).minus(this.origin).minus(body.origin);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn this._anchor(this, hand, "hand").minus(this._anchor(body, hand, "navel")).minus(body.origin);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_handMove(chara, body, head) {\r\n\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty.minus(this.origin).minus(this.handMove);\r\n\t}\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {FragmentTexture} body\r\n\t * @param {FragmentTexture} [head]\r\n\t * @returns {Vec2}\r\n\t */\r\n\t_calcRelative_handMove_lHand(chara, body, head) {\r\n\t\treturn _math_js__WEBPACK_IMPORTED_MODULE_7__["Vec2"].empty.minus(this.origin);\r\n\t}\r\n\t\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\tupdate(chara) {\r\n\t\tif (chara.slots.body && chara.slots.head) {\r\n\t\t\tconst body = chara.slots.body.fragments.body.getTexture(chara);\r\n\t\t\tconst head = chara.slots.head.fragments.head.getTexture(chara);\r\n\t\t\tif (body && head) {\r\n\t\t\t\tthis.relative = this.calcRelative(chara, body, head);\r\n\r\n\t\t\t\tconst tamingMob = chara.slots.tamingMob;\r\n\t\t\t\tif (tamingMob) {\r\n\t\t\t\t\tthis.relative = tamingMob.adj_pos(this.relative, body, chara);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\trender(renderer, chara) {\r\n\t\tif (!(this.relative && this.visible)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst x = this.relative.x;\r\n\t\tconst y = this.relative.y;\r\n\r\n\t\trenderer.globalAlpha = this.opacity;\r\n\t\tif (this.filter.isEmpty) {\r\n\t\t\trenderer.drawGraph2(this, x, y);\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.ctx.filter = this.filter.toString();\r\n\t\t\trenderer.drawGraph2(this, x, y);\r\n\t\t\trenderer.ctx.filter = "none";\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass BodyFragmentTexture extends FragmentTexture {\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\tupdate(chara) {\r\n\t\tsuper.update(chara);\r\n\t\tthis.visible = !chara.hideBody;\r\n\t}\r\n}\r\n\r\nclass HairFragmentTexture extends FragmentTexture {\r\n\tconstructor(...args) {\r\n\t\tsuper(...args);\r\n\r\n\t\t/** @type {HairFragmentTexture} */\r\n\t\tthis.graph2 = null;\r\n\r\n\t\t/** @type {HairFragmentTexture} */\r\n\t\tthis.graph3 = null;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\tupdate(chara) {\r\n\t\tif (chara.slots.body && chara.slots.head) {\r\n\t\t\tconst body = chara.slots.body.fragments.body.getTexture(chara);\r\n\t\t\tconst head = chara.slots.head.fragments.head.getTexture(chara);\r\n\t\t\tif (body && head) {\r\n\t\t\t\tthis.relative = this.calcRelative(chara, body, head);\r\n\r\n\t\t\t\tconst tamingMob = chara.slots.tamingMob;\r\n\t\t\t\tif (tamingMob) {\r\n\t\t\t\t\tthis.relative = tamingMob.adj_pos(this.relative, body, chara);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this.graph2) {\r\n\t\t\t\t\tthis.graph2.relative = this.relative;\r\n\t\t\t\t}\r\n\t\t\t\tif (this.graph3) {\r\n\t\t\t\t\tthis.graph3.relative = this.relative;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {CharacterAnimationBase} chara\r\n\t */\r\n\trender(renderer, chara) {\r\n\t\tif (!this.relative) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\trenderer.globalAlpha = this.opacity || 1;\r\n\t\tif (this.filter.isEmpty) {\r\n\t\t\tthis._render(renderer);\r\n\t\t}\r\n\t\telse {\r\n\t\t\trenderer.ctx.filter = this.filter.toString();\r\n\t\t\tthis._render(renderer);\r\n\t\t\trenderer.ctx.filter = "none";\r\n\t\t}\r\n\t}\r\n\t_render(renderer) {\r\n\t\tconst x = this.relative.x;\r\n\t\tconst y = this.relative.y;\r\n\r\n\t\trenderer.drawGraph2(this, x, y);\r\n\r\n\t\tif (this.graph2 && this.graph2.opacity) {//color2\r\n\t\t\trenderer.globalAlpha = this.graph2.opacity;\r\n\r\n\t\t\trenderer.drawGraph2(this.graph2, x, y);\r\n\t\t}\r\n\t\tif (this.graph3 && this.graph3.opacity) {//color3\r\n\t\t\trenderer.globalAlpha = this.graph3.opacity;\r\n\r\n\t\t\trenderer.drawGraph2(this.graph3, x, y);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nclass ItemEffectAnimation extends _Animation__WEBPACK_IMPORTED_MODULE_3__["Animation"] {\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\t\t\r\n\t\tObject.defineProperty(this, "_raw", {\r\n\t\t\tvalue: raw,\r\n\t\t});\r\n\r\n\t\t//this._url = this._url;\r\n\r\n\t\tthis.__getAttr("z", -1);\r\n\t\tthis.__getAttr("pos", 1);\r\n\r\n\t\tsuper.load();\r\n\t}\r\n\t__getAttr(attr, defVal) {\r\n\t\tif (attr in this._raw) {\r\n\t\t\tthis[attr] = this._raw[attr];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis[attr] = defVal;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {boolean} actionExceptRotation\r\n\t * @param {number} angle\r\n\t * @param {boolean} flip\r\n\t */\r\n\trender(renderer, actionExceptRotation, angle, flip) {\r\n\t\tif (actionExceptRotation) {\r\n\t\t\tthis.draw(renderer, 0, 0, -angle, flip);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconst oy = -this.texture.height * 0.25;\r\n\t\t\tthis.draw(renderer, 0, oy, 0, flip);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//\t/data/Effect/ItemEff/1102918\r\nclass ItemEffect {\r\n\tconstructor() {\r\n\t\tthis._url = null;\r\n\t\tthis._raw = null;\r\n\r\n\t\t/** @type {{[animationName:string]:ItemEffectAnimation}} */\r\n\t\tthis.animation = {};\r\n\r\n\t\tthis.action = null;\r\n\t\tthis.time = 0;\r\n\t\tthis.frame = 0;\r\n\r\n\t\tthis.fixed = 0;\r\n\t\tthis.z = -2;\r\n\t\tthis.action = 1;\r\n\t\tthis.actionExceptRotation = 0;\r\n\t\t\r\n\t\tthis.enable = true;\r\n\t}\r\n\r\n\tstatic async Init() {\r\n\t\ttry {\r\n\t\t\t/** @type {Set<string>} */\r\n\t\t\tlet itemEffectList = ItemEffect._list;\r\n\r\n\t\t\t/** @type {string[]} */\r\n\t\t\tlet raw = await $get.list("/Effect/ItemEff");\r\n\r\n\t\t\titemEffectList.clear();\r\n\r\n\t\t\traw.forEach(id => {\r\n\t\t\t\titemEffectList.add(parseInt(id, 10));\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * if (!exist) return null\r\n\t * @param {string} equipID\r\n\t * @returns {Promise<ItemEffect>}\r\n\t */\r\n\tstatic async load(equipID) {\r\n\t\tconst id = Number(equipID);\r\n\r\n\t\tif (ItemEffect._list.has(id)) {\r\n\t\t\tlet eff = new ItemEffect();\r\n\t\t\tawait eff.load(equipID);\r\n\t\t\treturn eff;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * if (!exist) return null\r\n\t * @param {string} equipID\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tasync load(equipID) {\r\n\t\tconst id = Number(equipID);\r\n\t\tconst url = `/Effect/ItemEff/${id}/effect`;\r\n\t\tlet raw;\r\n\r\n\t\ttry {\r\n\t\t\traw = await $get.data(url);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow ex;\r\n\t\t}\r\n\r\n\t\tif (raw) {\r\n\t\t\treturn this._load(equipID, url, raw);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} stamp\r\n\t * @param {string} action\r\n\t */\r\n\tupdate(stamp, action) {\r\n\t\tif (action in this.animation) {\r\n\t\t\tthis.action = action;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.action = "default";\r\n\t\t}\r\n\r\n\t\tif (this.animation[this.action]) {\r\n\t\t\tthis.animation[this.action].update(stamp);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {CharacterRenderer} chara\r\n\t */\r\n\trender(renderer, chara) {\r\n\t\tif (this.animation && this.animation[this.action]) {\r\n\t\t\tthis.animation[this.action].render(renderer, this.actionExceptRotation, chara.angle, chara.front > 0);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} equipID\r\n\t * @param {object} raw_data\r\n\t */\r\n\t_load(equipID, url, raw) {\r\n\t\tthis.id = equipID;\r\n\r\n\t\tif (!raw) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\t//this._url = url;\r\n\t\tObject.defineProperty(this, "_raw", {\r\n\t\t\tvalue: raw,\r\n\t\t});\r\n\r\n\t\tthis.__construct();\r\n\t}\r\n\t__construct() {\r\n\t\tthis.__getAttr("fixed", 0);\r\n\t\tthis.__getAttr("z", -1);\r\n\t\tthis.__getAttr("action", 1);\r\n\t\tthis.__getAttr("actionExceptRotation", 0);\r\n\r\n\t\tfor (let i in this._raw) {\r\n\t\t\tif (this._raw[i] && typeof this._raw[i] == "object" && \'0\' in this._raw[i]) {//animation has frames\r\n\t\t\t\tthis.animation[i] = new ItemEffectAnimation(this._raw[i], [this._url, i].join("/"));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t__getAttr(attr, defVal) {\r\n\t\tif (attr in this._raw) {\r\n\t\t\tthis[attr] = this._raw[attr];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis[attr] = defVal;\r\n\t\t}\r\n\t}\r\n}\r\n/** @type {Set<string>} */\r\nItemEffect._list = new Set();\r\n\r\nclass CharacterFragmentBase {\r\n\t/**\r\n\t * @param {{[action:string]: FragmentTexture[]}} textures\r\n\t */\r\n\tconstructor(textures) {\r\n\t\t/** @type {{[action:string]: FragmentTexture[]}} - textures[action:string][frame:number] */\r\n\t\tthis.textures = textures;\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n}\r\n\r\n/**\r\n * @final \r\n */\r\nclass CharacterBodyFragment extends CharacterFragmentBase {\r\n\tconstructor(textures) {\r\n\t\tsuper(textures);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\treturn this.getFrameTexture(chara, chara.action_frame);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tif (!(chara.action in this.textures)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet ft = this.textures[chara.action][frame];//if frame not exist then return undefined\r\n\t\treturn ft;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tif (this.textures[chara.action]) {\r\n\t\t\treturn this.textures[chara.action].length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\n/**\r\n * @final \r\n */\r\nclass CharacterFaceFragment extends CharacterFragmentBase {\r\n\tconstructor(textures) {\r\n\t\tsuper(textures);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\treturn this.getFrameTexture(chara, chara.emotion_frame);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tif (!(chara.emotion in this.textures)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet ft = this.textures[chara.emotion][frame];\r\n\t\treturn ft;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tif (this.textures[chara.emotion]) {\r\n\t\t\treturn this.textures[chara.emotion].length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\n/**\r\n * @final \r\n */\r\nclass CharacterTamingMobFragment extends CharacterFragmentBase {\r\n\tconstructor(textures) {\r\n\t\tsuper(textures);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetTexture(chara) {\r\n\t\treturn this.getFrameTexture(chara, chara.actani.actionFrame);\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @param {number} frame - not sync chara._frame\r\n\t * @returns {FragmentTexture}\r\n\t */\r\n\tgetFrameTexture(chara, frame) {\r\n\t\tif (!(chara._ride_action in this.textures)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet ft = this.textures[chara._ride_action][frame];//if frame not exist then return undefined\r\n\t\treturn ft;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tif (this.textures[chara._ride_action]) {\r\n\t\t\treturn this.textures[chara._ride_action].length;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\nclass EquipImageFilter {\r\n\t/**\r\n\t * @param {CharacterAppearanceBase} equip\r\n\t */\r\n\tconstructor(equip) {\r\n\t\tthis.equip = equip;\r\n\t}\r\n\r\n\tget hue() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.hue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\tset hue(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.hue = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget sat() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.sat;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 100;\r\n\t}\r\n\tset sat(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.sat = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget bri() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.bri;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 100;\r\n\t}\r\n\tset bri(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.bri = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget contrast() {\r\n\t\tconst equip = this.equip;\r\n\t\tif (!equip) {\r\n\t\t\treturn 100;\r\n\t\t}\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.filter.contrast;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 100;\r\n\t}\r\n\tset contrast(value) {\r\n\t\tconst equip = this.equip;\r\n\t\tfor (let i in equip.fragments) {\r\n\t\t\tfor (let j in equip.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < equip.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = equip.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.contrast = value;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn {\r\n\t\t\thue: this.hue,\r\n\t\t\tsaturation: fixedNum(this.sat),\r\n\t\t\tbrightness: fixedNum(this.bri),\r\n\t\t\tcontrast: fixedNum(this.contrast),\r\n\t\t};\r\n\t\tfunction fixedNum(val) {\r\n\t\t\treturn Number((val / 100).toFixed(1));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {{hue: number, saturation: number, brightness: number, contrast: number}} data\r\n\t */\r\n\tparse(data) {\r\n\t\tlet { hue = 0, saturation = 1, brightness = 1, contrast = 1 } = data;\r\n\t\tthis.hue = Number(hue);\r\n\t\tthis.sat = Number(saturation) * 100;\r\n\t\tthis.bri = Number(brightness) * 100;\r\n\t\tthis.contrast = Number(contrast) * 100;\r\n\t}\r\n}\r\n\r\n/**\r\n * @interface\r\n */\r\nclass ICharacterAppearanceBase {\r\n\tconstructor() {\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t */\r\n\tisLoaded() {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t */\r\n\t_unload() {\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t */\r\n\ttoJSON() {\r\n\t\tthrow new Error("Not implement");\r\n\t\treturn {\r\n\t\t\tid: -1,//invalid ID\r\n\t\t};\r\n\t}\r\n}\r\n\r\n/**\r\n * ??\r\n */\r\nclass _CharacterAppearanceBaseSlotLink extends ICharacterAppearanceBase {\r\n\tconstructor(slot_link) {\r\n\t\tsuper();\r\n\t\tthis.slot_link = slot_link;//??\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\treturn {\r\n\t\t\tid: slot_link,//??\r\n\t\t};\r\n\t}\r\n}\r\n\r\n/**\r\n * character loader\r\n */\r\nclass CharacterAppearanceBase extends ICharacterAppearanceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t\t\r\n\t\tthis._raw = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\t//this._url = null;\r\n\t\t\t\r\n\t\t/** @type {ItemEffect} */\r\n\t\tthis.effect = null;\r\n\r\n\t\t/**\r\n\t\t * @type {{[place:string]:CharacterFragmentBase}}\r\n\t\t */\r\n\t\tthis.fragments = null;\r\n\r\n\t\tthis._onload = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.id = null;\r\n\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tthis.categoryInfo = null;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.slot_order = 0;\r\n\r\n\t\t/** @type {object<string, number>} */\r\n\t\tthis.islot = {};\r\n\r\n\t\t/** @type {object<string, number>} */\r\n\t\tthis.vslot = {};\r\n\r\n\t\tthis.filter = new EquipImageFilter(this);\r\n\t}\r\n\r\n\tisLoaded() {\r\n\t\treturn this.fragments != null;\r\n\t}\r\n\r\n\t/** @type {function(CharacterAppearanceBase):void} */\r\n\tget _onload() {\r\n\t\treturn this.__onload;\r\n\t}\r\n\tset _onload(func) {\r\n\t\tthis.__onload = func;\r\n\t\tif (this.isLoaded()) {\r\n\t\t\tthis.__onload.call(this, this);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {string} id\r\n\t * @param {ItemCategoryInfo} cateInfo\r\n\t * @param {void} use_category - no use\r\n\t * @returns {Promise<boolean>} - true if item exist\r\n\t */\r\n\tasync load(url, id, cateInfo, use_category) {\r\n\t\tlet raw;\r\n\r\n\t\tthis.id = id;\r\n\t\tthis.categoryInfo = cateInfo;\r\n\t\t\r\n\t\ttry {\r\n\t\t\tif (_public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "d"].isEquipExist(id, cateInfo)) {\r\n\t\t\t\traw = await _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "d"].getItem(id);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow ex;\r\n\t\t}\r\n\t\t\r\n\t\ttry {\r\n\t\t\tif (!raw && load_extern_item_data) {\r\n\t\t\t\traw = await load_extern_item_data(id, cateInfo.listPath || cateInfo.path || cateInfo.slot);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow ex;\r\n\t\t}\r\n\r\n\t\t//this._url = url;\r\n\t\tObject.defineProperty(this, "_raw", {\r\n\t\t\tvalue: raw,\r\n\t\t});\r\n\r\n\t\tthis.__load_slot();\r\n\r\n\t\tthis.__load_fragments();\r\n\r\n\t\tif (this._onload) {\r\n\t\t\tthis._onload.call(this, this);\r\n\t\t}\r\n\r\n\t\t//// if not body, head, face, hair then try load effect\r\n\t\t//if (id >= "00050000") {\r\n\t\t\t// load if exist\r\n\t\t\tItemEffect.load(this.id).then(a => this.effect = a);//01102918\t//01102915\r\n\t\t//}\r\n\r\n\t\treturn true;\r\n\t}\r\n\t__load_fragments() {\r\n\t\tconst FragmentConstructor = this.FragmentConstructor;\r\n\r\n\t\t//Object.keys(this._raw_textures).map(k => { return \'0\' in this._raw_textures[k]; })\r\n\r\n\t\tlet action_list = Object.keys(this._raw_textures);\r\n\r\n\t\tlet textures = {};\r\n\t\tfor (let action of action_list) {\r\n\t\t\tif (typeof this._raw_textures[action] == "object" && "0" in this._raw_textures[action]) {\r\n\t\t\t\tlet _url = this._base_path + action;\r\n\r\n\t\t\t\ttextures[action] = this.__load_frame_textures(this._raw_textures[action], _url);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet fragment_textures = {};\r\n\t\tfor (let action in textures) {\r\n\t\t\tfor (let frame in textures[action]) {\r\n\t\t\t\tfor (let place in textures[action][frame]) {\r\n\t\t\t\t\tif (!(place in fragment_textures)) {\r\n\t\t\t\t\t\tfragment_textures[place] = {};\r\n\t\t\t\t\t\t//fragment_textures[place].visible = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!(action in fragment_textures[place])) {\r\n\t\t\t\t\t\tfragment_textures[place][action] = [];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfragment_textures[place][action][frame] = textures[action][frame][place];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet fragments = {};\r\n\t\tfor (let frag in fragment_textures) {\r\n\t\t\tfragments[frag] = new FragmentConstructor(fragment_textures[frag]);\r\n\t\t}\r\n\t\tthis.fragments = fragments;\r\n\t}\r\n\t/**\r\n\t * @param {string} _url\r\n\t * @returns {{[place:string]:FragmentTexture}[]} - array - textures[frame][place]\r\n\t */\r\n\t__load_frame_textures(_raw, _url) {\r\n\t\tlet textures = [];\r\n\t\tfor (let frame = 0; frame in _raw; ++frame) {\r\n\t\t\tlet url = `${_url}/${frame}`;\r\n\t\t\ttextures[frame] = this.__load_place_textures(_raw[frame], url);\r\n\t\t}\r\n\t\treturn textures;\r\n\t}\r\n\t/**\r\n\t * @param {string} _url\r\n\t * @returns {{[place:string]:FragmentTexture}} - object - textures[place]\r\n\t */\r\n\t__load_place_textures(_raw, _url) {\r\n\t\tlet textures = {};\r\n\t\tfor (let place in _raw) {\r\n\t\t\tlet path = `${_url}/${place}`;\r\n\t\t\tlet raw = _raw[place];\r\n\r\n\t\t\tif (raw) {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tconst FragmentTextureConstructor = this.FragmentTextureConstructor;\r\n\t\t\t\tlet ft;\r\n\t\t\t\tif (raw[""] == "") {\r\n\t\t\t\t\tft._url = path;\r\n\t\t\t\t\t//ft._url = path;\r\n\t\t\t\t\ttextures[place] = ft\r\n\t\t\t\t}\r\n\t\t\t\telse if (typeof raw[""] == \'string\') {\r\n\t\t\t\t\tft = new FragmentTextureConstructor(raw);\r\n\t\t\t\t\t//ft._url = raw[""];\r\n\t\t\t\t\ttextures[place] = ft;\r\n\t\t\t\t}\r\n\t\t\t\telse if (place == "hairShade") {\r\n\t\t\t\t\tft = new FragmentTextureConstructor(raw[0]);\r\n\t\t\t\t\t//ft._url = path + "/0";\r\n\t\t\t\t\ttextures[place] = ft;\r\n\t\t\t\t}\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tft._slot = this.categoryInfo.slot;\r\n\t\t\t\t\tft._place = place;\r\n\r\n\t\t\t\t\tft.classList = [\r\n\t\t\t\t\t\tft._slot,\r\n\t\t\t\t\t\t"item" + this.id,\r\n\t\t\t\t\t\tft._place,\r\n\t\t\t\t\t\tft._raw.z,\r\n\t\t\t\t\t\t\'z\' + ft.z\r\n\t\t\t\t\t].join(\' \');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn textures;\r\n\t}\r\n\t__load_slot() {\r\n\t\tif (!this._raw.info.islot) {\r\n\t\t\tdebugger;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet islots = this._raw.info.islot.match(/([A-Z][a-z0-9])/g);\r\n\t\tfor (let i in islots) {\r\n\t\t\tconst slot = islots[i];\r\n\t\t\tconst slot_order = zMap[slot];\r\n\t\t\tthis.islot[slot] = slot_order;\r\n\t\t\t\t\r\n\t\t\tif (slot_order > this.slot_order) {//this.slot_order = Math.max(this.slot_order, slot_order);\r\n\t\t\t\tthis.slot_order = slot_order;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet vslots = this._raw.info.vslot.match(/([A-Z][a-z0-9])/g);\r\n\t\tfor (let i in vslots) {\r\n\t\t\tconst slot = vslots[i];\r\n\t\t\tthis.vslot[slot] = slot;\r\n\t\t}\r\n\t}\r\n\r\n\t_unload() {\r\n\t\tthis.fragments = null;\r\n\t\tthis.effect == null;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @param {string} [animationName] - action animation\r\n\t */\r\n\ttoJSON(animationName = "stand1") {\r\n\t\tlet region, version;\r\n\t\tif (this._raw.info.__v) {\r\n\t\t\tconst m = this._raw.info.__v.toUpperCase().match(/([A-Z]*)([0-9\\.]*)/);\r\n\t\t\tregion = (function (r) {\r\n\t\t\t\tconst mm = {\r\n\t\t\t\t\t"GMS": "GMS",\r\n\t\t\t\t\t"CMS": "CMS",\r\n\t\t\t\t\t"KMS": "KMS",\r\n\t\t\t\t\t"JMS": "JMS",\r\n\t\t\t\t\t"SEA": "SEA",\r\n\t\t\t\t\t"TMS": "TMS",\r\n\t\t\t\t\t"THMS": "THMS",\r\n\t\t\t\t\t"TWMS": "TWMS",\r\n\t\t\t\t};\r\n\t\t\t\tlet result = mm[r];\r\n\t\t\t\tif (!result) {\r\n\t\t\t\t\tresult = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "d"].dataRegion;\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t})([m[1]]);\r\n\t\t\tversion = m[2] || _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "d"].dataVersion;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tregion = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "d"].dataRegion;\r\n\t\t\tversion = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* ResourceManager */ "d"].dataVersion;\r\n\t\t}\r\n\t\tconst filter = this.filter;\r\n\r\n\t\tlet obj = {\r\n\t\t\titemId: Number(this.id),\r\n\t\t\tregion: region,\r\n\t\t\tversion: version,\r\n\t\t\thue: filter.hue,\r\n\t\t\tsaturation: fixedNum(filter.sat),\r\n\t\t\tbrightness: fixedNum(filter.bri),\r\n\t\t\tcontrast: fixedNum(filter.contrast),\r\n\t\t\talpha: Number((this.opacity).toFixed(1)),\r\n\t\t};\r\n\t\tif (animationName) {\r\n\t\t\tobj.animationName = animationName;\r\n\t\t}\r\n\t\treturn obj;\r\n\r\n\t\tfunction fixedNum(val) {\r\n\t\t\treturn Number((val / 100).toFixed(1));\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * another format\r\n\t * @param {{alpha: number, hue: number, saturation: number, brightness: number, contrast: number}} data\r\n\t */\r\n\tparse(data) {\r\n\t\tlet { alpha = 1 } = data;\r\n\t\tthis.filter.parse(data);\r\n\t\tthis.opacity = Math.max(0, Math.min(alpha, 1));\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Partial<{opacity:number,hue:number,sat:number,bri:number,contrast:number}>} option\r\n\t */\r\n\tset(option) {\r\n\t\tconst { opacity = 1, hue = 0, sat = 100, bri = 100, contrast = 100 } = option;\r\n\t\tthis.opacity = opacity;\r\n\t\tthis.filter.hue = hue;\r\n\t\tthis.filter.sat = sat;\r\n\t\tthis.filter.bri = bri;\r\n\t\tthis.filter.contrast = contrast;\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * @returns {number}\r\n\t */\r\n\tget opacity() {\r\n\t\tfor (let i in this.fragments) {\r\n\t\t\tfor (let j in this.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < this.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = this.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\treturn ft.opacity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 1;\r\n\t}\r\n\t/**\r\n\t * @param {number} opacity\r\n\t */\r\n\tset opacity(opacity) {\r\n\t\tfor (let i in this.fragments) {\r\n\t\t\tfor (let j in this.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < this.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = this.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.opacity = opacity;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} hue 0 ~ 360\r\n\t * @param {number} sat 0 ~ 100\r\n\t * @param {number} bri 0 ~ 100\r\n\t */\r\n\tsetFilter(hue, sat, bri) {\r\n\t\tfor (let i in this.fragments) {\r\n\t\t\tfor (let j in this.fragments[i].textures) {\r\n\t\t\t\tfor (let k = 0; k < this.fragments[i].textures[j].length; ++k) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = this.fragments[i].textures[j][k];\r\n\t\t\t\t\tif (ft) {\r\n\t\t\t\t\t\tft.filter.hue = hue;\r\n\t\t\t\t\t\tft.filter.sat = sat;\r\n\t\t\t\t\t\tft.filter.bri = bri;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * get icon url\r\n\t * @see {@link ItemCategoryInfo.getIconUrl}\r\n\t * @returns {string}\r\n\t */\r\n\tgetIconUrl() {\r\n\t\tconst icon = this._raw.info.icon;\r\n\t\tif (icon) {\r\n\t\t\treturn icon[""];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdebugger;\r\n\t\t\treturn _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].getIconUrl(this.id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * get iconRaw url\r\n\t * @see {@link ItemCategoryInfo.getIconRawUrl}\r\n\t * @returns {string}\r\n\t */\r\n\tgetIconRawUrl() {\r\n\t\tconst iconRaw = this._raw.info.iconRaw;\r\n\t\tif (iconRaw) {\r\n\t\t\treturn iconRaw[""];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdebugger;\r\n\t\t\treturn _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].getIconRawUrl(this.id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @type {string}\r\n\t */\r\n\tget _animation_type() {\r\n\t\tthrow new Error("Not Implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @returns {typeof CharacterFragmentBase}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @virtual\r\n\t * @returns {typeof FragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\tthrow new Error("Not implement");\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {{[actions:string]:{["0"]:Sprite,[frames:string]:Sprite}}} raw_textures[...actions][...frames][...fragments]\r\n\t */\r\n\tget _raw_textures() {\r\n\t\treturn this._raw;\r\n\t}\r\n\r\n\tget _base_path() {\r\n\t\treturn this._url;\r\n\t}\r\n}\r\n\r\n/**\r\n * @abstract\r\n */\r\nclass CharacterAppearance extends CharacterAppearanceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\t//__is_texture(k) {\r\n\t//\treturn (!(k == "face" || k == "delay" || k == "default"));\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\treturn chara.slots.body.fragments.body.textures[chara.action].length;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tconst d = this._raw[chara.action][chara.action_frame].delay;\r\n\t\tif (Number.isSafeInteger(d)) {\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn 120;\r\n\t}\r\n}\r\n\r\nclass CharacterBody extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof BodyFragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn BodyFragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterEquip extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof BodyFragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn BodyFragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterEquipCashWeapon extends CharacterEquip {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.use_category = null;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {string} id\r\n\t * @param {ItemCategoryInfo} cateInfo\r\n\t * @param {string} use_category - cash-weapon as [category]\r\n\t * @returns {Promise<boolean>} - true if item exist\r\n\t */\r\n\tasync load(url, id, cateInfo, use_category) {\r\n\t\tif (!use_category && use_category != "") {\r\n\t\t\tthrow new TypeError("use_category");\r\n\t\t}\r\n\r\n\t\tthis.use_category = use_category.slice(2, 4);\r\n\r\n\t\treturn super.load(url, id, cateInfo);\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {object} raw_textures[...actions][...frames][...fragments]\r\n\t */\r\n\tget _raw_textures() {\r\n\t\treturn this._raw[this.use_category];\r\n\t}\r\n\r\n\tget _base_path() {\r\n\t\treturn this._url + this.use_category;\r\n\t}\r\n}\r\n\r\n\r\nclass CharacterHeadBase extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof FragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn FragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterHead extends CharacterHeadBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tthis.elfEarFragment = null;\r\n\t\tthis.lefEarFragment = null;\r\n\t\tthis.highlefEarFragment = null;\r\n\t}\r\n\t__load_fragments() {\r\n\t\tsuper.__load_fragments()\r\n\t\t\r\n\t\tif (this.fragments) {\r\n\t\t\tif (this.fragments.ear) {\r\n\t\t\t\tthis.elfEarFragment = this.fragments.ear;\r\n\t\t\t\tdelete this.fragments.ear;\r\n\t\t\t}\r\n\t\t\tif (this.fragments.lefEar) {\r\n\t\t\t\tthis.lefEarFragment = this.fragments.lefEar;\r\n\t\t\t\tdelete this.fragments.lefEar;\r\n\t\t\t}\r\n\t\t\tif (this.fragments.highlefEar) {\r\n\t\t\t\tthis.highlefEarFragment = this.fragments.highlefEar;\r\n\t\t\t\tdelete this.fragments.highlefEar;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tget elfEar() {\r\n\t\treturn this.fragments.ear != null;\r\n\t}\r\n\tset elfEar(value) {\r\n\t\tif (!this.elfEarFragment) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (value) {\r\n\t\t\tthis.fragments.ear = this.elfEarFragment;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete this.fragments.ear;\r\n\t\t}\r\n\t}\r\n\r\n\tget lefEar() {\r\n\t\treturn this.fragments.lefEar != null;\r\n\t}\r\n\tset lefEar(value) {\r\n\t\tif (!this.lefEarFragment) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (value) {\r\n\t\t\tthis.fragments.lefEar = this.lefEarFragment;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete this.fragments.lefEar;\r\n\t\t}\r\n\t}\r\n\r\n\tget highlefEar() {\r\n\t\treturn this.fragments.highlefEar != null;\r\n\t}\r\n\tset highlefEar(value) {\r\n\t\tif (!this.highlefEarFragment) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (value) {\r\n\t\t\tthis.fragments.highlefEar = this.highlefEarFragment;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelete this.fragments.highlefEar;\r\n\t\t}\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n}\r\n\r\nclass CharacterHair extends CharacterHeadBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterBodyFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterBodyFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * hair color mix\r\n\t * @override\r\n\t * @returns {typeof HairFragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn HairFragmentTexture;\r\n\t}\r\n}\r\n\r\nclass CharacterFaceBase extends CharacterHeadBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\t//__is_texture(k) {\r\n\t//\treturn (!(k == "delay" || k == "default"));\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\treturn chara.slots.face.fragments.face.textures[chara.emotion].length;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tconst d = this._raw[chara.emotion][chara.emotion_frame].delay;\r\n\t\tif (d != null) {//!isNaN(d) && isFinite(d)\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn 60;\r\n\t}\r\n}\r\nclass CharacterFace extends CharacterFaceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "emotion";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterFaceFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterFaceFragment;\r\n\t}\r\n}\r\nclass CharacterFaceAcc extends CharacterFaceBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "emotion";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterFaceFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterFaceFragment;\r\n\t}\r\n}\r\n\r\nclass CharacterTamingMob extends CharacterAppearance {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {number}\r\n\t */\r\n\tget type() {\r\n\t\treturn this._raw.info.tamingMob;\r\n\t}\r\n\r\n\tget actionMap() {\r\n\t\treturn this._raw.characterAction;\r\n\t}\r\n\r\n\tget emotionMap() {\r\n\t\treturn this._raw.characterEmotion;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {Vec2} relative\r\n\t * @param {FragmentTexture} body\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {Vec2}\r\n\t */\r\n\tadj_pos(relative, body, chara) {\r\n\t\tconst frag = this.fragments[0];//default\r\n\t\tif (frag) {\r\n\t\t\tconst tm = frag.getTexture(chara);\r\n\t\t\tif (tm) {\r\n\t\t\t\treturn relative.plus(tm.navel.minus(body.navel));\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn relative;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetFrameCount(chara) {\r\n\t\treturn chara.slots.body.fragments.body.textures[chara._ride_action].length;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @param {CharacterAnimationBase} chara\r\n\t * @returns {number}\r\n\t */\r\n\tgetDelay(chara) {\r\n\t\tconst d = Math.trunc(this._raw[chara._ride_action][chara.action_frame].delay);//?? _ride_action_frame => action_frame\r\n\t\tif (Number.isSafeInteger(d)) {\r\n\t\t\treturn d;\r\n\t\t}\r\n\t\treturn 120;\r\n\t}\r\n\r\n\tget _animation_type() {\r\n\t\treturn "_ride_action";\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof CharacterTamingMobFragment}\r\n\t */\r\n\tget FragmentConstructor() {\r\n\t\treturn CharacterTamingMobFragment;\r\n\t}\r\n\r\n\t/**\r\n\t * @override\r\n\t * @returns {typeof FragmentTexture}\r\n\t */\r\n\tget FragmentTextureConstructor() {\r\n\t\treturn FragmentTexture;\r\n\t}\r\n}\r\n\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0000\'].FragmentType = CharacterBody;\t\t//\tbody\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0001\'].FragmentType = CharacterHead;\t\t//\telfEar\t\t\t-> CharacterHeadBase -> CharacterHead\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0002\'].FragmentType = CharacterFace;\t\t//\tFace\t\t\t-> CharacterHeadBase -> CharacterFaceBase -> CharacterFace\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0003\'].FragmentType = CharacterHair;\t\t//\tHair\t\t\t-> CharacterHeadBase -> CharacterHair\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0004\'].FragmentType = CharacterHair;\t\t//\tHair\t\t\t-> CharacterHeadBase -> CharacterHair\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0100\'].FragmentType = CharacterEquip;\t\t//\tCap\t\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0101\'].FragmentType = CharacterFaceAcc;\t\t//\taccessoryFace\t-> CharacterHeadBase -> CharacterFaceBase -> CharacterFaceAcc\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0102\'].FragmentType = CharacterEquip;\t\t//\taccessoryEyes\t-> CharacterEquip\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0103\'].FragmentType = CharacterEquip;\t\t//\taccessoryEars\t-> CharacterEquip\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0104\'].FragmentType = CharacterEquip;\t\t//\tCoat\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0105\'].FragmentType = CharacterEquip;\t\t//\tLongcoat\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0106\'].FragmentType = CharacterEquip;\t\t//\tPants\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0107\'].FragmentType = CharacterEquip;\t\t//\tShoes\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0108\'].FragmentType = CharacterEquip;\t\t//\tGlove\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0109\'].FragmentType = CharacterEquip;\t\t//\tShield\t\t\t-> CharacterBody\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0110\'].FragmentType = CharacterEquip;\t\t//\tCape\t\t\t-> CharacterBody\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'0170\'].FragmentType = CharacterEquipCashWeapon;\t//\tcash-weapon\t-> CharacterEquip\r\n\r\n_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"]._info[\'019\'].FragmentType = CharacterTamingMob;\t//\tTamingMob\t\t-> CharacterTamingMob\r\n\r\n\r\nclass CharacterSlots {\r\n\tconstructor() {\r\n\t\t\t\r\n\t\t/** @type {CharacterAppearanceBase[]} */\r\n\t\tthis._ordered_slot = [];\r\n\r\n\r\n\t\t/** @type {CharacterBody} */\r\n\t\tthis.body = null;\r\n\r\n\t\t/** @type {CharacterHead} */\r\n\t\tthis.head = null;\r\n\r\n\t\t/** @type {CharacterFace} */\r\n\t\tthis.face = null;\r\n\r\n\r\n\t\t/** @type {CharacterHair} */\r\n\t\tthis.hair = null;\r\n\t\t\r\n\t\t/** @type {CharacterHair} */\r\n\t\tthis._hair2 = null;\r\n\t\t/** @type {number} 0~1.0 */\r\n\t\tthis._hairMix2 = null;\r\n\t\t/** @type {CharacterHair} */\r\n\t\tthis._hair3 = null;\r\n\t\t/** @type {number} 0~1.0 */\r\n\t\tthis._hairMix3 = null;\r\n\r\n\r\n\t\t/** @type {CharacterEquip} - 1 */\r\n\t\tthis.cap = null;\r\n\r\n\t\t/** @type {CharacterFaceAcc} - 2 */\r\n\t\tthis.accessoryFace = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 3*/\r\n\t\tthis.accessoryEyes = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 4 */\r\n\t\tthis.accessoryEars = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 5 */\r\n\t\tthis.coat = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 5 */\r\n\t\tthis.longcoat = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 6 */\r\n\t\tthis.pants = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 7 */\r\n\t\tthis.shoes = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 8 */\r\n\t\tthis.glove = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 9 */\r\n\t\tthis.cape = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 10 */\r\n\t\tthis.shield = null;\r\n\r\n\t\t/** @type {CharacterEquip} - 11 */\r\n\t\tthis.weapon = null;\r\n\t\t\r\n\t\t/** @type {CharacterTamingMob} */\r\n\t\tthis.tamingMob = null;\r\n\t\t\r\n\t\t{\r\n\t\t\tObject.defineProperty(this, "_ordered_slot", {\r\n\t\t\t\tconfigurable: true,\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: []\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tObject.defineProperty(this, "_hair", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "hair", {\r\n\t\t\t\tenumerable: true,\r\n\t\t\t\tget: function () {\r\n\t\t\t\t\treturn this._hair;\r\n\t\t\t\t},\r\n\t\t\t\tset: function (value) {\r\n\t\t\t\t\tthis._hair = value;\r\n\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\tif (this._hair2 && this._hairMix2) {\r\n\t\t\t\t\t\t\tthis.hairColor2 = this.hairColor2;//force reload\r\n\t\t\t\t\t\t\tthis.hairMix2 = this.hairMix2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (this._hair3 && this._hairMix3) {\r\n\t\t\t\t\t\t\tthis.hairColor3 = this.hairColor3;//force reload\r\n\t\t\t\t\t\t\tthis.hairMix3 = this.hairMix3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tObject.defineProperty(this, "_hair", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hair2", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hairMix2", {\t// 0~1.0\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hair3", {\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t\tObject.defineProperty(this, "_hairMix3", {\t// 0~1.0\r\n\t\t\t\twritable: true,\r\n\t\t\t\tenumerable: false,\r\n\t\t\t\tvalue: null,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tasync __loadColoredHair(color) {\r\n\t\tconst id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getColorHairID(this.hair.id, color);\r\n\t\tconst cateInfo = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(id);\r\n\r\n\t\tif (cateInfo) {\r\n\t\t\tconst url = `/Character/${cateInfo.path + (cateInfo.path ? "/" : "") + id}`;\r\n\t\t\tconst use_category = undefined;\r\n\r\n\t\t\tlet hair = new CharacterHair();\r\n\r\n\t\t\tawait hair.load(url, id, cateInfo, use_category);\r\n\r\n\t\t\treturn hair;\r\n\t\t}\r\n\t}\r\n\r\n\t/** @returns {number} */\r\n\tget hairColor2() {\r\n\t\tif (this._hair2) {\r\n\t\t\treturn Number(_public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getHairColor(this._hair2.id));\r\n\t\t}\r\n\t}\r\n\tset hairColor2(color) {\r\n\t\tif (!color) {\r\n\t\t\tconsole.error(new TypeError());\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet hc2Id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getColorHairID(this.hair.id, color);\r\n\r\n\t\tif (!this._hair2 || hc2Id != this._hair2.id) {\r\n\t\t\tif (hc2Id == this._hair.id) {\r\n\t\t\t\tthis._hair2 = null;\r\n\t\t\t\tthis.hairMix2 = 0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.hair.$promise_hair2 = this.__loadColoredHair(color);\r\n\r\n\t\t\t\tthis.hair.$promise_hair2.then(hair2 => {\r\n\t\t\t\t\tdelete this.hair.$promise_hair2;\r\n\r\n\t\t\t\t\tthis._hair2 = hair2;\r\n\t\t\t\t\tif (this._hair2 && this.hairMix2 != null) {\r\n\t\t\t\t\t\tthis.hairMix2 = this.hairMix2;//force update\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//else {\r\n\t\t\t\t\t//\tthis.hairMix2 = 0;//disable\r\n\t\t\t\t\t//}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/** @returns {number} 0~1.0 */\r\n\tget hairMix2() {\r\n\t\treturn this._hairMix2;\r\n\t}\r\n\tset hairMix2(value) {\r\n\t\tvalue = Number(value);\r\n\r\n\t\tPromise.resolve(this.hair.$promise_hair2).then(() => {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this._hair2;\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet base = this.hair;\r\n\r\n\t\t\tif (!item || !base) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let j in item.fragments) {\r\n\t\t\t\tfor (let k in item.fragments[j].textures) {\r\n\t\t\t\t\tfor (let i = 0; i < item.fragments[j].textures[k].length; ++i) {\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ft = item.fragments[j].textures[k][i];\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ori = base.fragments[j].textures[k][i];\r\n\t\t\t\t\t\tif (ori) {\r\n\t\t\t\t\t\t\tori.graph2 = ft;\r\n\t\t\t\t\t\t\tori.graph2.opacity = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._hairMix2 = value;\r\n\t\t});\r\n\t}\r\n\r\n\t/** @returns {number} 0~1.0 */\r\n\tget hairColor3() {\r\n\t\tif (this._hair3) {\r\n\t\t\treturn Number(_public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getHairColor(this._hair3.id));\r\n\t\t}\r\n\t}\r\n\tset hairColor3(color) {\r\n\t\tif (!color) {\r\n\t\t\tconsole.error(new TypeError());\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet hc3Id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getColorHairID(this.hair.id, color);\r\n\r\n\t\tif (!this._hair3 || this._hair3.id != hc3Id) {\r\n\t\t\tif (this._hair.id == hc3Id || this._hair2.id == hc3Id) {\r\n\t\t\t\tthis._hair3 = null;\r\n\t\t\t\tthis.hairMix3 = 0;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.hair.$promise_hair3 = this.__loadColoredHair(color);\r\n\r\n\t\t\t\tthis.hair.$promise_hair3.then(hair3 => {\r\n\t\t\t\t\tdelete this.hair.$promise_hair3;\r\n\r\n\t\t\t\t\tthis._hair3 = hair3;\r\n\t\t\t\t\tif (this._hair3 && this.hairMix3 != null) {\r\n\t\t\t\t\t\tthis.hairMix3 = this.hairMix3;//force update\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//else {\r\n\t\t\t\t\t//\tthis.hairMix3 = 0;//disable\r\n\t\t\t\t\t//}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/** @returns {number} */\r\n\tget hairMix3() {\r\n\t\treturn this._hairMix3;\r\n\t}\r\n\tset hairMix3(value) {\r\n\t\tvalue = Number(value);\r\n\r\n\t\tPromise.resolve(this.hair.$promise_hair3).then(() => {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this._hair3;\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet base = this.hair;\r\n\r\n\t\t\tif (!item || !base) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let j in item.fragments) {\r\n\t\t\t\tfor (let k in item.fragments[j].textures) {\r\n\t\t\t\t\tfor (let i = 0; i < item.fragments[j].textures[k].length; ++i) {\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ft = item.fragments[j].textures[k][i];\r\n\t\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\t\tlet ori = base.fragments[j].textures[k][i];\r\n\t\t\t\t\t\tif (ori) {\r\n\t\t\t\t\t\t\tori.graph3 = ft;\r\n\t\t\t\t\t\t\tori.graph3.opacity = value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._hairMix3 = value;\r\n\t\t});\r\n\t}\r\n\r\n\t//__order_slot() {\r\n\t//\tlet slot_map = new Map();\r\n\t//\r\n\t//\tfor (let i in this) {\r\n\t//\t\tlet equip = this[i];\r\n\t//\r\n\t//\t\tequip.cs\r\n\t//\t}\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @param {CharacterAppearanceBase} loadedEquip\r\n\t * @param {string} use_category - category which used of cash-weapon\r\n\t */\r\n\tasync _use(id, loadedEquip, use_category) {\r\n\t\tif (!id) {\r\n\t\t\tdebugger\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst cateInfo = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(id);\r\n\r\n\t\tif (cateInfo) {\r\n\t\t\tlet url = `/Character/${cateInfo.path + (cateInfo.path ? "/":"") + id}`;\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item;\r\n\r\n\t\t\tif (loadedEquip instanceof CharacterAppearanceBase) {\r\n\t\t\t\talert("CharacterSlots # _use: param loadedEquip ??");\r\n\t\t\t\tdebugger;\r\n\t\t\t\titem = loadedEquip;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (loadedEquip) {\r\n\t\t\t\t\talert("CharacterSlots # _use: param loadedEquip ??");\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t}\r\n\t\t\t\tconst fragmentType = cateInfo.FragmentType || CharacterEquip;\r\n\r\n\t\t\t\titem = new fragmentType();\r\n\t\t\t}\r\n\t\t\t/** _use_loaded_equip */\r\n\t\t\tif (0) {}\r\n\r\n\t\t\tlet is_exist = loadedEquip || await item.load(url, id, cateInfo, use_category);\r\n\t\t\tif (is_exist) {\r\n\t\t\t\t/** _use_loaded_equip */\r\n\t\t\t\tif (1) {\r\n\t\t\t\t\tif (this[cateInfo.slot]) {\r\n\t\t\t\t\t\tthis[cateInfo.slot]._unload();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis[cateInfo.slot] = item;\r\n\r\n\t\t\t\t\tthis._ordered_slot[item.slot_order] = item;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tconsole.warn("item(" + id + ") is not exist");\r\n\t\t\t}\r\n\r\n\t\t\treturn item;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {boolean}\r\n\t */\r\n\t_unuse(id) {\r\n\t\tif (!id) {\r\n\t\t\tdebugger\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet cateInfo, equip;\r\n\r\n\t\tif (id instanceof CharacterAppearanceBase) {\r\n\t\t\tequip = id;\r\n\t\t\tid = equip.id;\r\n\t\t\tcateInfo = equip.categoryInfo;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcateInfo = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(id);\r\n\t\t}\r\n\t\t\r\n\t\tconst slotName = cateInfo.slot;\r\n\r\n\t\tif (slotName != "head" && slotName != "body") {\r\n\t\t\tif (this[slotName] && this[slotName].id == id) {\r\n\t\t\t\tequip = this[slotName];\r\n\t\t\t\tfor (let slot in equip.islot) {\r\n\t\t\t\t\tlet order = equip.islot[slot];\r\n\t\t\t\t\tif (this._ordered_slot[order]) {\r\n\t\t\t\t\t\tthis._ordered_slot[order]._unload();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdelete this._ordered_slot[order];\r\n\t\t\t\t}\r\n\t\t\t\tthis[slotName] = null;\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\t_clear() {\r\n\t\t//this.body = null;\r\n\t\t//this.head = null;\r\n\t\tthis.face = null;\r\n\t\tthis.hair = null;\r\n\t\tthis.cap = null;\r\n\t\tthis.accessoryFace = null;\r\n\t\tthis.accessoryEyes = null;\r\n\t\tthis.accessoryEars = null;\r\n\t\tthis.coat = null;\r\n\t\tthis.longcoat = null;\r\n\t\tthis.pants = null;\r\n\t\tthis.shoes = null;\r\n\t\tthis.glove = null;\r\n\t\tthis.cape = null;\r\n\t\tthis.shield = null;\r\n\r\n\t\t//temp\r\n\t\tlet head = this.head;\r\n\t\tlet body = this.body;\r\n\r\n\t\t//clear\r\n\t\tthis._ordered_slot = [];\r\n\r\n\t\t//restore\r\n\t\tif (head) {\r\n\t\t\tthis._ordered_slot[head.slot_order] = head;\r\n\t\t}\r\n\t\tif (body) {\r\n\t\t\tthis._ordered_slot[body.slot_order] = body;\r\n\t\t}\r\n\t}\r\n\r\n\t_stringify() {\r\n\t\tlet slots = ["c"];\r\n\t\t\t\r\n\t\tif (this.body) slots.push(this.body.id);\r\n\t\tif (this.head) slots.push(this.head.id);\r\n\t\tif (this.face) slots.push(this.face.id + "|" + this.face.id);\r\n\t\tif (this.hair) {\r\n\t\t\tlet ha = [];\r\n\t\t\tha.push(this.hair.id);\r\n\t\t\tif (this.hairColor2 && this.hairMix2 > 0) ha.push(this.hairColor2 + "%" + Math.trunc(this.hairMix2 * 100));\r\n\t\t\tif (this.hairColor3 && this.hairMix3 > 0) ha.push(this.hairColor3 + "%" + Math.trunc(this.hairMix3 * 100));\r\n\t\t\tslots.push(ha.join("|"));\r\n\t\t}\r\n\t\tif (this.cap) slots.push(this.cap.id);\r\n\t\tif (this.accessoryFace) slots.push(this.accessoryFace.id);\r\n\t\tif (this.accessoryEyes) slots.push(this.accessoryEyes.id);\r\n\t\tif (this.accessoryEars) slots.push(this.accessoryEars.id);\r\n\t\tif (this.coat) slots.push(this.coat.id);\r\n\t\tif (this.longcoat) slots.push(this.longcoat.id);\r\n\t\tif (this.pants) slots.push(this.pants.id);\r\n\t\tif (this.shoes) slots.push(this.shoes.id);\r\n\t\tif (this.glove) slots.push(this.glove.id);\r\n\t\tif (this.shield) slots.push(this.shield.id);\r\n\t\tif (this.cape) slots.push(this.cape.id);\r\n\t\tif (this.weapon) slots.push(this.weapon.id);\r\n\r\n\t\treturn slots.join(",");\r\n\t}\r\n\r\n\ttoJSON() {\r\n\t\tlet slots = [];\r\n\r\n\t\tif (this.body) slots.push(this.body);\r\n\t\tif (this.head) slots.push(this.head);\r\n\t\tif (this.face) slots.push(this.face);\r\n\t\tif (this.hair) slots.push(this.hair);\r\n\t\t//if (this._hair2) slots.push(this._hair2);\r\n\t\t//if (this._hair3) slots.push(this._hair3);\r\n\t\tif (this.cap) slots.push(this.cap);\r\n\t\tif (this.accessoryFace) slots.push(this.accessoryFace);\r\n\t\tif (this.accessoryEyes) slots.push(this.accessoryEyes);\r\n\t\tif (this.accessoryEars) slots.push(this.accessoryEars);\r\n\t\tif (this.coat) slots.push(this.coat);\r\n\t\tif (this.longcoat) slots.push(this.longcoat);\r\n\t\tif (this.pants) slots.push(this.pants);\r\n\t\tif (this.shoes) slots.push(this.shoes);\r\n\t\tif (this.glove) slots.push(this.glove);\r\n\t\tif (this.shield) slots.push(this.shield);\r\n\t\tif (this.cape) slots.push(this.cape);\r\n\t\tif (this.weapon) slots.push(this.weapon);\r\n\r\n\t\treturn slots;\r\n\t}\r\n\r\n\t/**\r\n\t * returns: [face, hair, cap, ..., weapon]\r\n\t */\r\n\t*enumerate() {\r\n\t\tif (this.face) yield this.face;\r\n\t\tif (this.hair) yield this.hair;\r\n\r\n\t\tyield* this.enumerate_equip();\r\n\t}\r\n\t*enumerate_equip() {\r\n\t\tif (this.cap) yield this.cap;\r\n\t\tif (this.accessoryFace) yield this.accessoryFace;\r\n\t\tif (this.accessoryEyes) yield this.accessoryEyes;\r\n\t\tif (this.accessoryEars) yield this.accessoryEars;\r\n\t\tif (this.coat) yield this.coat;\r\n\t\tif (this.longcoat) yield this.longcoat;\r\n\t\tif (this.pants) yield this.pants;\r\n\t\tif (this.shoes) yield this.shoes;\r\n\t\tif (this.glove) yield this.glove;\r\n\t\tif (this.shield) yield this.shield;\r\n\t\tif (this.cape) yield this.cape;\r\n\t\tif (this.weapon) yield this.weapon;\r\n\t}\r\n\t*enumerate_face() {\r\n\t\tif (this.face) yield this.face;\r\n\t\tif (this.accessoryFace) yield this.accessoryFace;\r\n\t}\r\n}\r\n\r\nclass CharacterChangeLog {\r\n\tconstructor() {\r\n\t\t/** @type {"human"|"elf"|"lef"|"highlef"} */\r\n\t\tthis.ear = undefined;\r\n\r\n\t\t/** @type {string[]} */\r\n\t\tthis.useEquip = [];\r\n\r\n\t\t/** @type {string[]} */\r\n\t\tthis.unuseEquip = [];\r\n\t\t\r\n\t\t/** @type {string} - hair2 id */\r\n\t\tthis.hair2 = undefined;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.hairMix2 = undefined;\r\n\r\n\t\t///** @type {string} */\r\n\t\t//this.hair3 = undefined;\r\n\r\n\t\t///** @type {string} */\r\n\t\t//this.hairMix3 = undefined;\r\n\r\n\t\t/** @type {string} weapon => equip id */\r\n\t\tthis.weapon = undefined;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.weaponType = undefined;\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.ear = undefined;\r\n\t\tthis.useEquip = [];\r\n\t\tthis.unuseEquip = [];\r\n\t\tthis.hair2 = undefined;\r\n\t\tthis.hairMix2 = undefined;\r\n\t\t//this.hair3 = undefined;\r\n\t\t//this.hairMix3 = undefined;\r\n\t\tthis.weaponType = undefined;\r\n\t}\r\n}\r\n\r\nclass CharacterAnimationBase {\r\n\tconstructor() {\r\n\t\tthis._$dirty = 0;//force update vue\r\n\r\n\t\t/** @type {string} - 未完成 */\r\n\t\tthis.job = null;\r\n\t\t/** @type {string} - 未完成 */\r\n\t\tthis.subJob = null;\r\n\r\n\r\n\t\t/** @type {ActionAnimation} */\r\n\t\tthis.actani = new _CharacterActionAnimation_js__WEBPACK_IMPORTED_MODULE_8__[/* ActionAnimation */ "a"]();\r\n\r\n\t\t/** @type {number} - animation speed rate */\r\n\t\tthis.speed = 1;\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis.fixed_speed = false;\r\n\r\n\t\t/** @type {boolean} - pause animation */\r\n\t\tthis.pause = false;\r\n\r\n\r\n\t\tthis.hideBody = false;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._ride_action = "stand1";\r\n\r\n\t\t//\taction\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._action = "stand1";\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._action_frame = 0;\r\n\r\n\t\t//\temotion\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._emotion = "blink";\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_frame = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_time = 0;\r\n\r\n\t\t//\r\n\r\n\t\tthis._generator_emotion_frame = this.emotion_frame_sequence_generator(3, 0);//[0,1,2].length\r\n\t\t\r\n\t\tthis.blinkRate = 0.015;\r\n\r\n\t\t/** @type {CharacterSlots} */\r\n\t\tthis.slots = new CharacterSlots();\r\n\r\n\t\t/**\r\n\t\t * is require update render data\r\n\t\t * @type {boolean}\r\n\t\t */\r\n\t\tthis.__require_update = true;\r\n\r\n\t\t/** @type {FragmentTexture[]} */\r\n\t\tthis.__frag_list = [];\r\n\r\n\t\t/** @type {CharacterChangeLog} **/\r\n\t\tthis.$$changeLog = new CharacterChangeLog();\r\n\t}\r\n\r\n\t_clone() {\r\n\t\talert(this.constructor.name + "::_clone");\r\n\r\n\t\t/** @type {CharacterAnimationBase} */\r\n\t\tlet nc = new this.constructor();//not must CharacterRender\r\n\t\tif (!nc) {\r\n\t\t\tdebugger;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tnc.speed = 0;\r\n\r\n\t\tnc.x = this.x;\r\n\t\tnc.y = this.y;\r\n\t\tnc.angle = this.angle;\r\n\r\n\t\tnc.action = this.action;\r\n\t\tnc.action_frame = this.action_frame;\r\n\r\n\t\tnc.emotion = this._emotion;\r\n\t\tnc.emotion_frame = this.emotion_frame;\r\n\r\n\t\tfor (let i in this.slots) {\r\n\t\t\tlet item = this.slots[i];\r\n\t\t\tif (item) {\r\n\t\t\t\tnc.slots[i] = this.slots[i];//not need colne ?\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn nc;\r\n\t}\r\n\t\t\r\n\t_waitFrameTexturesLoaded() {\r\n\t\tlet tasks = [];\r\n\t\tfor (let i in this.slots) {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this.slots[i];\r\n\t\t\tif (item) {\r\n\t\t\t\tfor (let j in item.fragments) {\r\n\t\t\t\t\tlet frag = item.fragments[j];\r\n\t\t\t\t\tlet count = frag.getFrameCount(this);\r\n\t\t\t\t\tfor (let k = 0; k < count; ++k) {\r\n\t\t\t\t\t\tlet ft = frag.getFrameTexture(this, k);\r\n\t\t\t\t\t\tif (ft && !ft._isLoaded_or_doload()) {\r\n\t\t\t\t\t\t\ttasks.push(ft.$promise);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn Promise.all(tasks);\r\n\t}\r\n\r\n\t/**\r\n\t * init animation status\r\n\t */\r\n\tinitAnimation() {\r\n\t\t/** @type {string} */\r\n\t\tthis.action = "stand1";\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._action_frame = 0;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.emotion = "blink";\r\n\t\t\t\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_time = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis._emotion_frame = 0;\r\n\t}\r\n\r\n\t/** @type {number} - 0~1 */\r\n\tgetSpeed() {\r\n\t\tif (this.pause) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this.fixed_speed ? 1 : this.speed;\r\n\t}\r\n\r\n\t/**\r\n\t * @type {boolean}\r\n\t */\r\n\tget elfEar() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.elfEar;\r\n\t\t}\r\n\t}\r\n\tset elfEar(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tthis.slots.head.elfEar = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @type {boolean}\r\n\t */\r\n\tget lefEar() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.lefEar;\r\n\t\t}\r\n\t}\r\n\tset lefEar(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tthis.slots.head.lefEar = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @type {boolean}\r\n\t */\r\n\tget highlefEar() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.highlefEar;\r\n\t\t}\r\n\t}\r\n\tset highlefEar(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tthis.slots.head.highlefEar = value;\r\n\t\t}\r\n\t}\r\n\r\n\t/** @returns {"human"|"elf"|"lef"|"highlef"} */\r\n\tget ear() {\r\n\t\tif (this.slots.head) {\r\n\t\t\treturn this.slots.head.lefEar ? "lef" : (this.slots.head.elfEar ? "elf" : (this.slots.head.highlefEar ? "highlef" : "human"));\r\n\t\t}\r\n\t}\r\n\tset ear(value) {\r\n\t\tif (this.slots.head) {\r\n\t\t\tif (value == "elf") {\r\n\t\t\t\tthis.slots.head.elfEar = true;\r\n\t\t\t\tthis.slots.head.lefEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = false;\r\n\t\t\t\tthis.$$changeLog.ear = value;\r\n\t\t\t}\r\n\t\t\telse if (value == "lef") {\r\n\t\t\t\tthis.slots.head.lefEar = true;\r\n\t\t\t\tthis.slots.head.elfEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = false;\r\n\t\t\t\tthis.$$changeLog.ear = value;\r\n\t\t\t}\r\n\t\t\telse if (value == "highlef") {\r\n\t\t\t\tthis.slots.head.elfEar = false;\r\n\t\t\t\tthis.slots.head.lefEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = true;\r\n\t\t\t\tthis.$$changeLog.ear = value;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.slots.head.elfEar = false;\r\n\t\t\t\tthis.slots.head.lefEar = false;\r\n\t\t\t\tthis.slots.head.highlefEar = false;\r\n\t\t\t\tthis.$$changeLog.ear = "human";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.$$changeLog.ear = undefined;\r\n\t\t}\r\n\t}\r\n\r\n\t/** @type {string} */\r\n\tget action() {\r\n\t\t//if (this.slots.tamingMob) {\r\n\t\t//\tconst actmap = this.slots.tamingMob.actionMap;\r\n\t\t//\tif (actmap) {\r\n\t\t//\t\treturn actmap[this._action];\r\n\t\t//\t}\r\n\t\t//\treturn "sit";//default\r\n\t\t//}\r\n\t\treturn this._action;\r\n\t}\r\n\tset action(act) {\r\n\t\tif (this.slots.tamingMob) {\r\n\t\t\tlet _act;\r\n\r\n\t\t\tthis._ride_action = act;\r\n\r\n\t\t\tif (this.slots.tamingMob.actionMap) {\r\n\t\t\t\t_act = this.slots.tamingMob.actionMap[act];\r\n\r\n\t\t\t\tif (_act == "hideBody") {\r\n\t\t\t\t\tthis.hideBody = true;\r\n\r\n\t\t\t\t\t//TODO: hideBody act=?\r\n\r\n\t\t\t\t\tthis._action = act;\r\n\t\t\t\t\tif (this.actani._action != act) {\r\n\t\t\t\t\t\tthis.actani.reload(act);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__require_update |= true;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.hideBody = false;\r\n\r\n\t\t\t\t\tthis._action = _act;\r\n\t\t\t\t\tif (this.actani._action != _act) {\r\n\t\t\t\t\t\tthis.actani.reload(_act);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__require_update |= true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (act == "rope") {\r\n\t\t\t\t\tthis._action = "rope";//default\r\n\t\t\t\t}\r\n\t\t\t\telse if (act == "ladder") {\r\n\t\t\t\t\tthis._action = "ladder";//default\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._action = "sit";//default\r\n\t\t\t\t\tthis._action_frame = 0;//default\r\n\t\t\t\t}\r\n\t\t\t\tif (this.actani._action != act) {\r\n\t\t\t\t\tthis.actani.reload(act);\r\n\t\t\t\t}\r\n\t\t\t\tthis.__require_update |= true;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.hideBody = false;\r\n\t\t\tthis._ride_action = null;\r\n\r\n\t\t\tif (this.actani._action != act && this.slots.body) {\r\n\t\t\t\tthis._action = act;\r\n\t\t\t\tthis.actani.reload(act);\r\n\r\n\t\t\t\tthis.__require_update |= true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget action_frame() {\r\n\t\treturn this._action_frame;\r\n\t}\r\n\tset action_frame(value) {\r\n\t\tif (value === "") {//from $("input")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (false) {}\r\n\r\n\t\tthis._action_frame = value;\r\n\t\tthis.__require_update |= true;\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget action_frame_count() {\r\n\t\ttry {\r\n\t\t\tif (this.slots.body) {\r\n\t\t\t\treturn this.slots.body.getFrameCount(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t/** @type {string} */\r\n\tget emotion() {\r\n\t\treturn this._emotion;\r\n\t}\r\n\tset emotion(emo) {\r\n\t\tif (this._emotion != emo && this.slots.face && this.slots.face.fragments.face.textures[emo]) {\r\n\t\t\tthis._emotion = emo;\r\n\t\t\tthis._emotion_frame = 0;\r\n\t\t\tthis._emotion_time = 0;\r\n\r\n\t\t\tif (emo == "blink") {\r\n\t\t\t\tthis.blinkRate = 0.015;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis.blinkRate = 1;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._generator_emotion_frame = this.emotion_frame_sequence_generator(this.emotion_frame_count, 0);\r\n\r\n\t\t\tthis.__require_update |= true;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} count of frame\r\n\t * @param {number} start frame\r\n\t */\r\n\t*emotion_frame_sequence_generator(length, start) {\r\n\t\twhile (true) {\r\n\t\t\tif (Math.random() < this.blinkRate) {\r\n\t\t\t\tyield* linearSequence(length, start);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tyield 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/** @type {number} */\r\n\tget emotion_frame() {\r\n\t\treturn this._emotion_frame;\r\n\t}\r\n\tset emotion_frame(value) {\r\n\t\tif (value === "") {//from $("input")\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (false) {}\r\n\r\n\t\tthis._emotion_frame = value;\r\n\t\tthis._emotion_time = 0;\r\n\t\tthis.__require_update |= true;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} next\r\n\t */\r\n\t_get_emotion_next_frame(next) {\r\n\t\tlet r = this._generator_emotion_frame.next().value;\r\n\t\t\r\n\t\tthis._generator_emotion_frame = this.emotion_frame_sequence_generator(this.emotion_frame_count, this._emotion_frame);\r\n\t\t\r\n\t\treturn r;\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget emotion_time() {\r\n\t\treturn this._emotion_time;\r\n\t}\r\n\tset emotion_time(time) {\r\n\t\tif (this.emotion_frame_count) {\r\n\t\t\tif (time < this.emotion_delay) {\r\n\t\t\t\tthis._emotion_time = time;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._emotion_time = 0;\r\n\r\n\t\t\t\tthis._emotion_frame = this._generator_emotion_frame.next().value;\r\n\r\n\t\t\t\tthis.__require_update |= true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {number}\r\n\t */\r\n\tget emotion_delay() {\r\n\t\tif (this.slots.face) {\r\n\t\t\treturn this.slots.face.getDelay(this);\r\n\t\t}\r\n\t\treturn 60;\r\n\t}\r\n\r\n\t/** @type {number} */\r\n\tget emotion_frame_count() {\r\n\t\ttry {\r\n\t\t\tif (this.slots.face) {\r\n\t\t\t\treturn this.slots.face.getFrameCount(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} stamp - 0 <= stamp < Infinity\r\n\t */\r\n\t_update(_stamp) {\r\n\t\tif (this.pause) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet stamp = _stamp * this.getSpeed();\r\n\t\t\r\n\t\tif (this.actani) {\r\n\t\t\tif (this.actani.isEnd() && this.actani.loop) {\r\n\t\t\t\tthis.actani.reset();\r\n\t\t\t}\r\n\r\n\t\t\tthis.actani.update(stamp, this);\r\n\t\t}\r\n\r\n\t\tthis.emotion_time += _stamp;\r\n\r\n\t\tfor (let i in this.slots) {\r\n\t\t\tlet equip = this.slots[i];\r\n\t\t\tif (equip && equip.effect && equip.effect.enable) {\r\n\t\t\t\tequip.effect.update(stamp);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {any} number  0 < stamp * speed < Infinity\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tthis._update(stamp);\r\n\t}\r\n\r\n\t/**\r\n\t * use await this.__synchronize(stamp) update and force wait all resource load\r\n\t * @param {number}\r\n\t */\r\n\t__forceUpdate(stamp) {\r\n\t\tthis._$dirty = Math.random();\r\n\t\tthis._update(stamp | 0);\r\n\t\tthis.__update_frag_list();\r\n\t}\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {number} x\r\n\t * @param {number} y, \r\n\t * @param {number} angle\r\n\t * @param {boolean} flip\r\n\t */\r\n\t_draw(renderer, x, y, angle, flip) {\r\n\t\trenderer.pushGlobalAlpha();\r\n\r\n\t\t//list.filter(a=>a&&a._raw.map).forEach(a=>{ for (let i in a._raw.map) { if (q[i]) { q[i].push(a); } else { q[i] = [a]; } } })\r\n\t\tthis.__draw_list(renderer, this.__frag_list, x, y, angle, flip);\r\n\r\n\t\trenderer.popGlobalAlpha();\r\n\t}\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t * @param {FragmentTexture[]} list\r\n\t */\r\n\t__draw_list(renderer, list, x, y, angle, flip) {\r\n\t\trenderer.pushMatrix();\r\n\r\n\t\trenderer.translate(x, y);\r\n\t\t\r\n\t\tif (0) {}\r\n\r\n\t\trenderer.rotate(window.m_a || angle);\r\n\r\n\t\tif (flip) {\r\n\t\t\trenderer.scale(-1, 1);\r\n\t\t}\r\n\t\t//{\r\n\t\t//\tlet ctx = renderer.ctx;\r\n\t\t//\tctx.beginPath();\r\n\t\t//\tctx.moveTo(0, 0);\r\n\t\t//\tctx.lineTo(100, 0);\r\n\t\t//\tctx.strokeStyle = "#F00";\r\n\t\t//\tctx.stroke();\r\n\t\t//\tctx.beginPath();\r\n\t\t//\tctx.moveTo(0, 0);\r\n\t\t//\tctx.lineTo(0, 100);\r\n\t\t//\tctx.strokeStyle = "#0F0";\r\n\t\t//\tctx.stroke();\r\n\t\t//}\r\n\r\n\t\t{\r\n\t\t\tfor (let i in this.slots) {\r\n\t\t\t\tlet equip = this.slots[i];\r\n\t\t\t\tif (equip && equip.effect) {\r\n\t\t\t\t\tequip.effect.render(renderer, this);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor (let i in list) {\r\n\t\t\t\tlet ft = list[i];\r\n\t\t\t\tft.render(renderer, this);\r\n\t\t\t}\r\n\t\t}\r\n\t\trenderer.popMatrix();\r\n\t}\r\n\t__update_frag_list() {\r\n\t\tthis.__frag_list = [];\r\n\t\t\r\n\t\t/** @type {Array<CharacterAppearanceBase>[]} */\r\n\t\tlet slots = {};\r\n\t\t\r\n\t\tfor (let i = 2; i <= 3; ++i) {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this.slots["_hair" + i];\r\n\t\t\t\r\n\t\t\tthis.__add_equip_to_frag_list(slots, item);\r\n\t\t}\r\n\t\tfor (let i in this.slots._ordered_slot) {\r\n\t\t\t/** @type {CharacterAppearanceBase} */\r\n\t\t\tlet item = this.slots._ordered_slot[i];\r\n\t\t\t\r\n\t\t\tthis.__add_equip_to_frag_list(slots, item);\r\n\t\t}\r\n\t\t\r\n\t\t{//back\r\n\t\t\tlet is_back = false;\r\n\t\t\t\r\n\t\t\tfor (let i in slots) {\r\n\t\t\t\t/** @type {FragmentTexture[]} */\r\n\t\t\t\tlet fts = slots[i];\r\n\t\t\t\tfor (let j in fts) {\r\n\t\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\t\tlet ft = fts[j];\r\n\t\t\t\t\tif (is_back) {\r\n\t\t\t\t\t\tif (ft._place.startsWith("face")) {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (ft._place.startsWith("backHair")) {\r\n\t\t\t\t\t\tis_back = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.__add_frag_to_list(ft);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t{\r\n\t\t\tlet ae = this.__frag_list[114];//HACK: Ae\r\n\t\t\tif (ae) {\r\n\t\t\t\tthis.__frag_list.push(ae);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._calcBoundBox();\r\n\t}\r\n\t/**\r\n\t * @param {Array<CharacterAppearanceBase>[]} slots\r\n\t * @param {CharacterAppearanceBase} item\r\n\t */\r\n\t__add_equip_to_frag_list(slots, item) {\r\n\t\t// if equip not use then value is mumber(slot_order) where this.slots._ordered_slot\r\n\t\tif (item == null) {\r\n\t\t\treturn;//debugger;\r\n\t\t}\r\n\t\telse if (item > 0) {// typeof item == \'number\'; item != null && (item instanceof CharacterAppearanceBase || item >= 0)\r\n\t\t\treturn;//continue;\r\n\t\t}\r\n\r\n\t\t// init slots\r\n\t\tfor (let j in item.vslot) {\r\n\t\t\tlet slot = item.vslot[j];\r\n\t\t\tslots[slot] = [];\r\n\t\t}\r\n\r\n\t\tfor (let j in item.fragments) {//foreach equip place\r\n\t\t\tlet slot = sMap[j];\r\n\t\t\tif (slot != null) {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tlet ft = item.fragments[j].getTexture(this);\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tif (!slots[slot]) {\r\n\t\t\t\t\t\tslots[slot] = [ft];//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tslots[slot].push(ft);//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (j == "default") {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tlet ft = item.fragments[j].getTexture(this);\r\n\t\t\t\tslot = item._raw.info.islot;\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tif (!slots[slot]) {\r\n\t\t\t\t\t\tslots[slot] = [ft];//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tslots[slot].push(ft);//cover ??\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t/** @type {FragmentTexture} */\r\n\t\t\t\tlet ft = item.fragments[j].getTexture(this);\r\n\t\t\t\tif (ft) {\r\n\t\t\t\t\tthis.__add_frag_to_list(ft);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//item.fragments[j].visible = true;\r\n\t\t}\r\n\t}\r\n\t/** @param {FragmentTexture} ft */\r\n\t__add_frag_to_list(ft) {\r\n\t\tft.update(this);\r\n\t\tthis.__frag_list[ft.z] = ft;\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * calc current frame bound box and restore result\r\n\t * @returns {Rectangle}\r\n\t */\r\n\tcalcBoundBox() {\r\n\t\tif (this.__require_update) {\r\n\t\t\treturn this._calcBoundBox();\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn this._boundBox;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * calc current frame bound box and restore result\r\n\t * @returns {Rectangle}\r\n\t */\r\n\t_calcBoundBox() {\r\n\t\tlet left = 0, top = 0, right = 0, bottom = 0;\r\n\r\n\t\tfor (let i in this.__frag_list) {\r\n\t\t\tlet ft = this.__frag_list[i];\r\n\t\t\tif (ft.texture && ft.relative) {\r\n\t\t\t\tlet x0 = ft.relative.x;\r\n\t\t\t\tlet y0 = ft.relative.y;\r\n\t\t\t\tlet x1 = x0 + ft.width;\r\n\t\t\t\tlet y1 = y0 + ft.height;\r\n\r\n\t\t\t\tleft = Math.min(left, x0);\r\n\t\t\t\ttop = Math.min(top, y0);\r\n\t\t\t\tright = Math.max(right, x1);\r\n\t\t\t\tbottom = Math.max(bottom, y1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._boundBox = new _math_js__WEBPACK_IMPORTED_MODULE_7__["Rectangle"](\r\n\t\t\tMath.trunc(left),\r\n\t\t\tMath.trunc(top),\r\n\t\t\tMath.trunc(right - left),\r\n\t\t\tMath.trunc(bottom - top)\r\n\t\t);\r\n\t\treturn this._boundBox;\r\n\t}\r\n\t\r\n\ttoJSON() {\r\n\t\tlet obj = {\r\n\t\t\tslots: this.slots.toJSON(),\r\n\t\t};\r\n\t\tif (this.slots._hair2) {\r\n\t\t\tobj.hair2 = this.slots._hair2.id;\r\n\t\t\tobj.hairMix2 = this.slots.hairMix2;\r\n\t\t}\r\n\r\n\t\tif (this.slots.head.elfEar) {\r\n\t\t\tobj.ear = "elf";\r\n\t\t}\r\n\t\telse if (this.slots.head.lefEar) {\r\n\t\t\tobj.ear = "lef";\r\n\t\t}\r\n\t\telse if (this.slots.head.highlefEar) {\r\n\t\t\tobj.ear = "highlef";\r\n\t\t}\r\n\r\n\t\treturn obj;\r\n\t}\r\n}\r\n\r\nclass CharacterRenderer extends CharacterAnimationBase {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\t/** @type {number} - position x */\r\n\t\tthis.x = 0;\r\n\t\t/** @type {number} - position y */\r\n\t\tthis.y = 0;\r\n\r\n\t\t/** @type {number} - where layer */\r\n\t\tthis.z = 5;\r\n\r\n\t\t/** @type {number} - translate x once frame */\r\n\t\tthis.tx = 0;\r\n\t\t/** @type {number} - translate y once frame */\r\n\t\tthis.ty = 0;\r\n\t\t\r\n\t\tthis.angle = 0;\r\n\t\tthis.front = -1;\r\n\r\n\t\t/** @type {Promise<void>[]} */\r\n\t\tthis.__load_task = [];\r\n\r\n\t\t/** @type {function(IRenderer)} */\r\n\t\tthis.render = function (renderer) {\r\n\t\t\t//not ready to render\r\n\t\t\t//if load then set load render = _render\r\n\t\t}\r\n\r\n\t\t/** @type {Rectangle} */\r\n\t\tthis._boundBox = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._$old_action = null;\r\n\t\t/** @type {string} */\r\n\t\tthis._$old_emotion = null;\r\n\t}\r\n\r\n\tstatic async Init() {\r\n\t\tlet result = await Promise.all([\r\n\t\t\t$get.data("/zmap"),\r\n\t\t\t$get.data("/smap"),\r\n\t\t\tItemEffect.Init(),\r\n\t\t\t_CharacterActionAnimation_js__WEBPACK_IMPORTED_MODULE_8__[/* ActionAnimation */ "a"].Init(),//action definition\r\n\t\t]);\r\n\t\t\r\n\t\tzMap = {};\r\n\t\tObject.keys(result[0]).reverse().forEach((k, i) => zMap[k] = i + 1);\r\n\r\n\t\tsMap = result[1];\r\n\t}\r\n\r\n\tload() {\r\n\t\t//load body and head for calc relative position\r\n\t\tthis.use("00002012");\r\n\t\tthis.use("00012012");\r\n\r\n\t\tlet $promise = Promise.all([...this.__load_task]);\r\n\t\t(function (that, $promise) {\r\n\t\t\t$promise.then(function (result) {\r\n\t\t\t\tthat.initAnimation();\r\n\t\t\t\tthat.render = that._render;\r\n\t\t\t});\r\n\t\t})(this, $promise);\r\n\r\n\t\treturn $promise;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {any} number  0 < stamp * speed < Infinity\r\n\t */\r\n\tupdate(stamp) {\r\n\t\tthis._$old_action = this._action;\r\n\t\tthis._$old_emotion = this.emotion;\r\n\r\n\t\tthis.waitLoaded();\r\n\t\tsuper.update(stamp);\r\n\r\n\t\tif (this.__require_update) {\r\n\t\t\tthis.__update_frag_list();\r\n\t\t\tthis.__require_update = false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {IRenderer} renderer\r\n\t */\r\n\t_render(renderer) {\r\n\t\tconst x = Math.trunc(this.x + this.tx);\r\n\t\tconst y = Math.trunc(this.y + this.ty);\r\n\t\t\r\n\t\tthis._draw(renderer, x, y, this.angle, this.front > 0);\r\n\t\t\r\n\t\t//this.tx = 0;//auto clear\r\n\t\t//this.ty = 0;//auto clear\r\n\t}\r\n\t\r\n\t_setup_test() {\r\n\t\tif (0) {}\r\n\t\telse {\r\n\t\t\tthis.use("00026509");\r\n\r\n\t\t\tthis.use("00041526");\r\n\r\n\t\t\tthis.use("01051429");\r\n\r\n\t\t\tthis.use("01071110");\r\n\r\n\t\t\tthis.elfEar = true;\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\t/**\r\n\t * update and force wait all resource load\r\n\t * @param {number}\r\n\t */\r\n\tasync __synchronize(stamp) {\r\n\t\tthis.__forceUpdate(stamp);\r\n\t\r\n\t\tawait this.waitLoaded();\r\n\t\tawait this._waitFrameTexturesLoaded();\r\n\t}\r\n\tasync waitLoaded() {\r\n\t\tlet tasks = this.__load_task;\r\n\t\tif (tasks && tasks.length) {\r\n\t\t\tawait Promise.all(tasks).then(() => {\r\n\t\t\t\tthis.__load_task = [];\r\n\t\t\t}, function (err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t//isLoading() {\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @param {string} category - category of cash-weapon\r\n\t */\r\n\tasync use(id, category) {\r\n\t\tif (!category) {\r\n\t\t\tcategory = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].getJobWeaponCategory(this.job);\r\n\t\t}\r\n\t\tif (!(id && typeof id == "string")) {\r\n\t\t\tthrow new TypeError("id: string");\r\n\t\t}\r\n\t\tconst item_type = id[0];\r\n\t\tswitch (item_type) {\r\n\t\t\tcase "0"://equip\r\n\t\t\t\t{\r\n\t\t\t\t\tif (_Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].isCashWeapon(id)) {\r\n\t\t\t\t\t\t//this.$$changeLog.weaponType = ss[1];/??\r\n\t\t\t\t\t\tthis.$$changeLog.weapon = id;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.$$changeLog.useEquip.push(id);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//\r\n\t\t\t\t\tlet task = this.slots._use(id, null, category);\r\n\t\t\t\t\tthis.__load_task.push(task);\r\n\t\t\t\t\tlet item = await task;\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (id.startsWith("019")) {\r\n\t\t\t\t\t\tthis.action = this.action;//force update action\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.__update_frag_list();\r\n\t\t\t\t\tthis._calcBoundBox();\r\n\r\n\t\t\t\t\treturn item;\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t */\r\n\tunuse(id) {\r\n\t\tdebugger;\r\n\t\tif (id[0] == "0") {//equip\r\n\t\t\tlet result = this.slots._unuse(id);\r\n\t\t\tif (result) {\r\n\t\t\t\tthis.$$changeLog.unuseEquip.push(id);\r\n\t\t\t\tthis._calcBoundBox();\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {{showears:boolean,showLefEars:boolean,showHighLefEars:boolean,items:[]}} option\r\n\t */\r\n\tset(option) {\r\n\t\tthis.ear = Boolean(option.showears);\r\n\t\tthis.lefEar = Boolean(option.showLefEars);\r\n\t\tthis.highlefEar = Boolean(option.showHighLefEars);\r\n\r\n\t\toption.items.forEach(async (itemData) => {\r\n\t\t\ttry {\r\n\t\t\t\tlet itemId = Number(itemData.itemId | 0).toString().padStart(8, "0");\r\n\t\t\t\tlet item = await this.use(itemId);\r\n\t\t\t\titem.set(itemData);\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\tconsole.error("itemId:", itemData.itemId, ex, itemData);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * another format\r\n\t * @param {{alpha: number, hue: number, saturation: number, brightness: number, contrast: number}[]} equipDataArray\r\n\t */\r\n\tparse(equipDataArray) {\r\n\t\tequipDataArray.forEach(async (itemData) => {\r\n\t\t\ttry {\r\n\t\t\t\tlet itemId = Number(itemData.itemId | 0).toString().padStart(8, "0");\r\n\t\t\t\tlet equip = await this.use(itemId);\r\n\t\t\t\tequip.parse(itemData);\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\tconsole.error("itemId:", itemData.itemId, ex, itemData);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t_parse(code) {\r\n\t\tif (!code) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet es = code.split(",");\r\n\t\tthis.slots._clear();\r\n\t\tes.forEach((v, i, a) => {\r\n\t\t\tif (v.indexOf("|") >= 0) {\r\n\t\t\t\tconst ss = v.split("|");\r\n\t\t\t\tconst cate = _Common_ItemCategoryInfo_js__WEBPACK_IMPORTED_MODULE_1__["ItemCategoryInfo"].get(ss[0]);\r\n\t\t\t\tlet id;\r\n\t\t\t\tif (cate.slot == "face") {\r\n\t\t\t\t\tid = ss[1].trim().padStart(8, 0);\r\n\t\t\t\t\tthis.$$changeLog.useEquip.push(id);\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.use(id);\r\n\r\n\t\t\t\t}\r\n\t\t\t\telse if (cate.slot == "hair") {\r\n\t\t\t\t\tconst slots = this.slots;\r\n\t\t\t\t\tlet h2 = ss[1];\r\n\t\t\t\t\tlet h3 = ss[2];\r\n\t\t\t\t\t//\r\n\t\t\t\t\tid = ss[0].trim().padStart(8, 0);\r\n\t\t\t\t\tthis.$$changeLog.useEquip.push(id);\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.use(id).then(() => {\r\n\t\t\t\t\t\tif (h2 && h2.indexOf("%") >= 0) {\r\n\t\t\t\t\t\t\tlet hc = h2.split("%");\r\n\t\t\t\t\t\t\tconst c2 = hc[0];\r\n\t\t\t\t\t\t\tconst m2 = hc[1] / 100;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tthis.$$changeLog.hair2 = c2;\r\n\t\t\t\t\t\t\tthis.$$changeLog.hairMix2 = m2;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tslots.hairColor2 = c2;\r\n\t\t\t\t\t\t\tslots.hairMix2 = m2;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (h3 && h3.indexOf("%") >= 0) {\r\n\t\t\t\t\t\t\tlet hc = h3.split("%");\r\n\t\t\t\t\t\t\tconst c3 = hc[0];\r\n\t\t\t\t\t\t\tconst m3 = hc[1] / 100;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tthis.$$changeLog.hair3 = c3;\r\n\t\t\t\t\t\t\tthis.$$changeLog.hairMix3 = m3;\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tslots.hairColor3 = hc[0];\r\n\t\t\t\t\t\t\tslots.hairMix4 = hc[1] / 100;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\telse if (cate.slot == "weapon") {\r\n\t\t\t\t\tthis.$$changeLog.weaponType = ss[1];\r\n\t\t\t\t\tthis.$$changeLog.weapon = id;\r\n\t\t\t\t\tthis.use.apply(this, ss, ss[1]);//this.use(ss[0], ss[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (Number.isFinite(parseInt(v, 10))) {\r\n\t\t\t\t\tlet id = v.trim().padStart(8, 0);\r\n\t\t\t\t\tthis.use(id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @type {string} col\r\n\t */\r\n\tget hairColor() {\r\n\t\tif (this.slots.hair) {\r\n\t\t\treturn _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getHairColor(this.slots.hair.id);\r\n\t\t}\r\n\t\treturn "0";\r\n\t}\r\n\tset hairColor(col) {\r\n\t\tif (this.slots.hair && col != this.hairColor) {\r\n\t\t\tlet id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getColorHairID(this.slots.hair.id, col);\r\n\t\t\tthis.use(id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} col\r\n\t */\r\n\tget faceColor() {\r\n\t\tif (this.slots.face) {\r\n\t\t\treturn _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getFaceColor(this.slots.face.id);\r\n\t\t}\r\n\t\treturn "0";\r\n\t}\r\n\tset faceColor(col) {\r\n\t\tif (this.slots.face && col != this.faceColor) {\r\n\t\t\tlet id = _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__[/* CharacterRenderConfig */ "b"].getColorFaceID(this.slots.face.id, col);\r\n\t\t\tthis.use(id);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {CharacterChangeLog} changeLog\r\n\t */\r\n\tcommitChange(changeLog) {\r\n\t\tif (changeLog.ear) {\r\n\t\t\tthis.ear = changeLog.ear;\r\n\t\t}\r\n\r\n\t\tif (this.useEquip) {\r\n\t\t\tfor (let id of this.useEquip) {\r\n\t\t\t\tthis.use(id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.unuseEquip) {\r\n\t\t\tfor (let id of this.unuseEquip) {\r\n\t\t\t\tthis.unuse(id);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (changeLog.hair2 && changeLog.hairMix2) {\r\n\t\t\tthis.slots.hairColor2 = changeLog.hair2;\r\n\t\t\tthis.slots.hairMix2 = changeLog.hairMix2;\r\n\t\t}\r\n\r\n\t\tif (changeLog.hair3 && changeLog.hairMix3) {\r\n\t\t\t//this.slots.hairColor3 = changeLog.hair3;\r\n\t\t\t//this.slots.hairMix3 = changeLog.hairMix3;\r\n\t\t}\r\n\t\t\r\n\t\tif (changeLog.weapon && changeLog.weaponType) {\r\n\t\t\tthis.use(changeLog.weapon, changeLog.weaponType);\r\n\t\t}\r\n\t}\r\n\r\n\t_stringify(genCode) {\r\n\t\tlet result = this.slots._stringify();\r\n\t\tif (genCode) {\r\n\t\t\treturn `chara._parse(\'${result}\')`;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t_outlink_old() {\r\n\t\tif (this.slots.body && this.slots.body.id && this.slots.face && this.slots.face.id && this.action && this.emotion) {\r\n\t\t\tlet link = "https://maplestory.io/api/GMS/latest/character/center/" + this.slots.body.id + "/";\r\n\t\t\tlet slots = [...this.slots.enumerate()].map(a => parseInt(a.id, 10));\r\n\r\n\t\t\tslots[0] = this.slots.face.id + ":" + this.emotion;\r\n\r\n\t\t\tlink += slots.join(",");\r\n\r\n\t\t\tlink += "/" + this.action + "?showears=" + (this.elfEar ? "true" : "false");\r\n\r\n\t\t\tlink += "&showLefEars=" + (this.lefEar ? "true" : "false");\r\n\r\n\t\t\treturn link;\r\n\t\t}\r\n\t\tconsole.log("character need body, face, action, emotion");\r\n\t}\r\n\t\r\n\t_outlink(name) {\r\n\t\tconst animationName = this.action;\r\n\t\tconst frame = this.action_frame;\r\n\t\tconst slots = this.slots;\r\n\t\tconst itemList = makeItemList.call();\r\n\t\treturn "https://maplestory.io/api/character/" +\r\n\t\t\t\titemList +    // not array\r\n\t\t\t\t"/" + animationName + "/" + frame + "?" +\r\n\t\t\t\t"showears=" + this.elfEar +\r\n\t\t\t\t"&showLefEars=" + this.lefEar +\r\n\t\t\t\t"&resize=1" +\r\n\t\t\t\t(name ? ("&name=" + name) : "") +\r\n\t\t\t\t"&flipX=" + Boolean(this.front > 0) +\r\n\t\t\t\t"&bgColor=0,0,0,0";\r\n\t\tfunction makeItemList() {\r\n\t\t\treturn Object.values(slots).filter(a => a).map(item => {\r\n\t\t\t\treturn encodeURIComponent(JSON.stringify(item.toJSON(animationName)));\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\t_download() {\r\n\t\twindow.open(this._outlink());\r\n\t}\r\n\r\n\t_save_as_svg(renderer, filename) {\r\n\t\tthis.__texture_to_base64().then(frag_list => {\r\n\t\t\tlet file_name = `${filename ? (filename+"."):""}${this.action}[${this.action_frame}].${this.emotion}[${this.emotion_frame}].svg`;\r\n\t\t\tlet bound = this.calcBoundBox();\r\n\t\t\tlet size = bound.size;\r\n\t\t\tlet [cx, cy] = [-bound.left, bound.height];\r\n\t\r\n\t\t\tlet svg = \'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" >\';\r\n\r\n\t\t\tsvg += `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink= "http://www.w3.org/1999/xlink" width="${size.x}" height="${size.y}">\\n`;\r\n\r\n\t\t\tsvg += `<g transform="translate(${cx}, ${cy})">`;\r\n\t\t\tfrag_list.forEach(function (ft) {\r\n\t\t\t\tif (ft && ft.relative) {\r\n\t\t\t\t\tlet clz = ft.classList;\r\n\t\t\t\t\tsvg += `\\t<image class="${clz}" opacity="${ft.visible ? ft.opacity : 0}" x="${ft.relative.x}" y="${ft.relative.y}" width="${ft.width}" height="${ft.height}" xlink:href="${ft._url}"></image>\\n`;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tsvg += \'</g>\';\r\n\r\n\t\t\tsvg += \'<text x="0" y="122" fill="transparent">\' + this._stringify(false) + \'</text>\';\r\n\t\t\tsvg += \'<text x="0" y="144" fill="transparent">\' + JSON.stringify(this) + \'</text>\';\r\n\r\n\t\t\tsvg += \'</svg>\';\r\n\r\n\t\t\t//let url = "data:text/plain;utf8," + svg;\r\n\r\n\t\t\tdebugger;\r\n\r\n\t\t\t//window.open(url);\r\n\t\t\tDownloadData(svg, "image/svg+xml;utf8", file_name);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * "data:image/png;base64,[...]"\r\n\t * @param {IRenderer} renderer\r\n\t * @param {string} filename\r\n\t * @returns {string}\r\n\t */\r\n\t_save_as_png(renderer, filename) {\r\n\t\tlet bound = this._calcBoundBox();\r\n\t\tlet size = bound.size;\r\n\t\tlet [x, y] = [-bound.left, bound.height];\r\n\t\tlet angle = 0;\r\n\t\tlet front = false;\r\n\r\n\t\t// use Canvas2, must not fail\r\n\t\ttry {\r\n\t\t\trenderer.$swapCanvas();\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t//save Canvas2 size, current ctx is _ctx2\r\n\t\tconst c2w = renderer._ctx2.canvas.width;\r\n\t\tconst c2h = renderer._ctx2.canvas.height;\r\n\t\t//\r\n\t\trenderer.ctx.canvas.width = size.x;\r\n\t\trenderer.ctx.canvas.height = size.y;\r\n\r\n\t\ttry {\r\n\t\t\tthis._draw(renderer, x, y, angle, front);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\t// nothing\r\n\t\t}\r\n\r\n\t\tlet base64 = renderer.ctx.canvas.toDataURL("image/png");\r\n\t\t{\r\n\t\t\tlet elem = document.createElement("a");\r\n\r\n\t\t\tlet name = `${filename ? (filename+"."):""}${this.action}[${this.action_frame}].${this.emotion}[${this.emotion_frame}].png`;\r\n\r\n\t\t\telem.id = name;\r\n\t\t\telem.download = name;\r\n\t\t\telem.href = base64;\r\n\r\n\t\t\tdocument.body.appendChild(elem);\r\n\t\t\telem.click();\r\n\t\t\tdocument.body.removeChild(elem);\r\n\t\t}\r\n\r\n\t\t//restore Canvas2 size, current ctx is _ctx2\r\n\t\trenderer.ctx.canvas.width = c2w;\r\n\t\trenderer.ctx.canvas.height = c2h;\r\n\r\n\t\t// restore Canvas, must not fail\r\n\t\ttry {\r\n\t\t\trenderer.$swapCanvas();\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\t// nothing\r\n\t\t}\r\n\r\n\t\treturn base64;\r\n\t}\r\n\r\n\t/**\r\n\t * @returns {Promise<FragmentTexture[]>}\r\n\t */\r\n\tasync __texture_to_base64() {\r\n\t\tlet frag_list = this.__frag_list;\r\n\t\tlet tasks = [];\r\n\r\n\t\tfrag_list.forEach(function (ft) {\r\n\t\t\tif (!ft) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!ft._url.startsWith("data:")) {\r\n\t\t\t\ttasks.push((async function () {\r\n\t\t\t\t\t//ft.texture.$src = ft._url;\r\n\t\t\t\t\tft._url = await toDataURL(ft.texture.src);\r\n\t\t\t\t\treturn ft;\r\n\t\t\t\t})());\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttasks.push(ft);\r\n\t\t\t}\r\n\t\t\tif (ft.graph2) {\r\n\t\t\t\tlet src = ft.graph2.texture.src;\r\n\t\t\t\tif (!src.startsWith("data:")) {\r\n\t\t\t\t\ttasks.push((async function () {\r\n\t\t\t\t\t\t//ft.texture.$src = ft._url;\r\n\t\t\t\t\t\tft.graph2._url = await toDataURL(src);\r\n\t\t\t\t\t\treturn ft.graph2;\r\n\t\t\t\t\t})());\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttasks.push(ft.graph2);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (ft.graph3) {\r\n\t\t\t\tlet src = ft.graph3.texture.src;\r\n\t\t\t\tif (!src.startsWith("data:")) {\r\n\t\t\t\t\ttasks.push((async function () {\r\n\t\t\t\t\t\t//ft.texture.$src = ft._url;\r\n\t\t\t\t\t\tft.graph3._url = await toDataURL(src);\r\n\t\t\t\t\t\treturn ft.graph3;\r\n\t\t\t\t\t})());\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttasks.push(ft.graph3);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn Promise.all(tasks);\r\n\t}\r\n}\r\nObject(_init_js__WEBPACK_IMPORTED_MODULE_2__[/* AddInitTask */ "a"])(CharacterRenderer.Init);\r\n\r\nfunction* circularSequence(length, start=0) {\r\n\tlet i = start;\r\n\tfor (; i < length; ++i) {//a: 0, 1, 2, 3, ...b\r\n\t\tyield i;\r\n\t}\r\n\tfor (i -= 2; i > 0; --i) {//b: 2, 1, ...a\r\n\t\tyield i;\r\n\t}\r\n}\r\n\r\nfunction* linearSequence(length, start=0) {\r\n\tfor (let i = start; i < length; ++i) {\r\n\t\tyield i;\r\n\t}\r\n}\r\n\r\nfunction extract_number(input) {\r\n\treturn String(input).match(/(-?\\d+\\.?\\d*)|(\\.\\d*)/g);\r\n}\r\n\r\n/**\r\n * image href to data url\r\n */\r\nfunction toDataURL(url) {\r\n\treturn new Promise(function (resolve, reject) {\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.onload = function () {\r\n\t\t\tlet reader = new FileReader();\r\n\t\t\treader.onloadend = function () {\r\n\t\t\t\tresolve(reader.result);\r\n\t\t\t}\r\n\t\t\treader.onerror = function (ev) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\treject(ev);\r\n\t\t\t}\r\n\t\t\treader.readAsDataURL(xhr.response);\r\n\t\t};\r\n\t\txhr.open(\'GET\', url);\r\n\t\txhr.responseType = \'blob\';\r\n\t\txhr.send();\r\n\t});\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzM2LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvUmVuZGVyZXIvQ2hhcmFjdGVyUmVuZGVyZXIuanM/MjcyOSJdLCJzb3VyY2VzQ29udGVudCI6WyLvu79cclxuaW1wb3J0IHsgQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLCBSZXNvdXJjZU1hbmFnZXIgfSBmcm9tIFwiLi4vLi4vLi4vcHVibGljL2phdmFzY3JpcHRzL3Jlc291cmNlLmpzXCI7XHJcbmltcG9ydCB7IEl0ZW1DYXRlZ29yeUluZm8gfSBmcm9tIFwiLi4vLi4vQ29tbW9uL0l0ZW1DYXRlZ29yeUluZm8uanNcIjtcclxuaW1wb3J0IHsgQWRkSW5pdFRhc2sgfSBmcm9tIFwiLi4vLi4vaW5pdC5qc1wiO1xyXG5pbXBvcnQgeyBBbmltYXRpb24gfSBmcm9tIFwiLi4vQW5pbWF0aW9uXCI7XHJcbmltcG9ydCB7IGVuZ2luZSB9IGZyb20gXCIuLi9FbmdpbmUuanNcIjtcclxuaW1wb3J0IHsgSVJlbmRlcmVyLCBJbWFnZUZpbHRlciB9IGZyb20gXCIuLi9JUmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IHsgU3ByaXRlLCBTcHJpdGVCYXNlIH0gZnJvbSBcIi4uL1Nwcml0ZS5qc1wiO1xyXG5pbXBvcnQgeyBSZWN0YW5nbGUsIFZlYzIgfSBmcm9tIFwiLi4vbWF0aC5qc1wiO1xyXG5pbXBvcnQgeyBBY3Rpb25BbmltYXRpb24gfSBmcm9tIFwiLi9DaGFyYWN0ZXJBY3Rpb25BbmltYXRpb24uanNcIjtcclxuXHJcblxyXG5sZXQgek1hcCA9IHt9O1xyXG5sZXQgc01hcCA9IHt9O1xyXG5cclxuXHJcbi8qKlxyXG4gKiAwMDAyNjYyMy5ibGlua1sxXS5icm93IGhhcyBidWdcclxuICogJ1dlYXBvbi8wMTcwMjY5NCcgaXMgTG9uZ2NvYXQoaXNsb3QpXHJcbiAqIGhvdyB0byB1c2UgY2FzaC13ZWFwb24gKGV4OiAwMTcwMjUwNHwwMTUyKVxyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBtdWx0aS1pbWFnZS1zcHJpdGVcclxuICovXHJcbmNsYXNzIEZyYWdtZW50VGV4dHVyZSBleHRlbmRzIFNwcml0ZUJhc2Uge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7d3pwcm9wZXJ0eX0gcmF3XHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGZ1bGxfcGF0aFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgZnVsbF9wYXRoKSB7XHJcblx0XHRzdXBlcihyYXcsIGZ1bGxfcGF0aCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3Jhdy5vcmlnaW4pIHtcclxuXHRcdFx0dGhpcy5fcmF3Lm9yaWdpbi5fX3Byb3RvX18gPSBWZWMyLnByb3RvdHlwZTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuX3Jhdy5tYXApIHtcclxuXHRcdFx0dGhpcy5fcmF3Lm1hcFtpXS5fX3Byb3RvX18gPSBWZWMyLnByb3RvdHlwZTtcclxuXHRcdH1cclxuXHJcblx0XHQvKipcclxuXHRcdCAqIGlmIHRoaXMucmVsYXRpdmUgPT0gbnVsbCB0aGVuIHJlbW92ZSB0aGlzXHJcblx0XHQgKiBAdHlwZSB7VmVjMn1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5yZWxhdGl2ZSA9IG5ldyBWZWMyKDAsIDApO1xyXG5cdFx0XHJcblx0XHR0aGlzLmNhbGNSZWxhdGl2ZSA9IHRoaXMuX2NhbGNSZWxhdGl2ZTsvL3RoaXMuX2dldFJlbGF0aXZlRnVuY3Rpb24oKTsvL3RoaXMuX19vbGRfY2FsY1JlbGF0aXZlOy8vXHJcblxyXG5cdFx0dGhpcy5maWx0ZXIgPSBuZXcgSW1hZ2VGaWx0ZXIoKTtcclxuXHRcdHRoaXMub3BhY2l0eSA9IDE7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtib29sZWFufSAqL1xyXG5cdFx0dGhpcy52aXNpYmxlID0gdHJ1ZTtcclxuXHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9IC0gZXh0cmEgcHJvcGVydHkuICovXHJcblx0XHR0aGlzLl9zbG90ID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gLSBleHRyYSBwcm9wZXJ0eS4g5Zyo5ZOq5YCL6YOo5L2NICovXHJcblx0XHR0aGlzLl9wbGFjZSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9IC0gZXh0cmEgcHJvcGVydHk6IF9zbG90IGl0ZW1JZCwgX3BsYWNlLCBfcmF3LnogeiAqL1xyXG5cdFx0dGhpcy5jbGFzc0xpc3QgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgeigpIHtcclxuXHRcdHJldHVybiB6TWFwW3RoaXMuX3Jhdy56XSB8fCAxO1xyXG5cdH1cclxuXHRzZXQgeihub3RfdmFsdWUpIHtcclxuXHRcdGNvbnNvbGUuZXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgb3JkZXIoKSB7XHJcblx0XHRkZWJ1Z2dlcjtcclxuXHRcdHJldHVybiB0aGlzLno7XHJcblx0fVxyXG5cdHNldCBvcmRlcihub3RfdmFsdWUpIHtcclxuXHRcdGRlYnVnZ2VyO1xyXG5cdFx0Y29uc29sZS5lcnJvcihuZXcgVHlwZUVycm9yKFwiTm90IGltcGxlbWVudFwiKSk7XHJcblx0fVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IG9yaWdpbigpIHsgcmV0dXJuIHRoaXMuX3Jhdy5vcmlnaW4gfHwgVmVjMi5lbXB0eTsgfVxyXG5cclxuXHRpc0hhc0FuY2hvcigpIHsgcmV0dXJuICEhdGhpcy5fcmF3Lm1hcDsgfVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IGJyb3coKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLmJyb3c7IH1cclxuXHRpc0FuY2hvckJyb3coKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAuYnJvdzsgfVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IG5lY2soKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLm5lY2s7IH1cclxuXHRpc0FuY2hvck5lY2soKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAubmVjazsgfVxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IG5hdmVsKCkgeyByZXR1cm4gdGhpcy5fcmF3Lm1hcC5uYXZlbDsgfVxyXG5cdGlzQW5jaG9yTmF2ZWwoKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAubmF2ZWw7IH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtWZWMyfSAqL1xyXG5cdGdldCBoYW5kKCkgeyByZXR1cm4gdGhpcy5fcmF3Lm1hcC5oYW5kOyB9XHJcblx0aXNBbmNob3JIYW5kKCkgeyByZXR1cm4gISF0aGlzLl9yYXcubWFwLmhhbmQ7IH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtWZWMyfSAqL1xyXG5cdGdldCBoYW5kTW92ZSgpIHsgcmV0dXJuIHRoaXMuX3Jhdy5tYXAuaGFuZE1vdmU7IH1cclxuXHRpc0FuY2hvckhhbmRNb3ZlKCkgeyByZXR1cm4gISF0aGlzLl9yYXcubWFwLmhhbmRNb3ZlOyB9XHJcblxyXG5cclxuXHQvKiogQHJldHVybnMge1ZlYzJ9ICovXHJcblx0Z2V0IF9lYXJCZWxvd0hlYWQoKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLmVhckJlbG93SGVhZDsgfVxyXG5cdGlzQW5jaG9yX0VhckJlbG93SGVhZCgpIHsgcmV0dXJuICEhdGhpcy5fcmF3Lm1hcC5lYXJCZWxvd0hlYWQ7IH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtWZWMyfSAqL1xyXG5cdGdldCBfZWFyT3ZlckhlYWQoKSB7IHJldHVybiB0aGlzLl9yYXcubWFwLmVhck92ZXJIZWFkOyB9XHJcblx0aXNBbmNob3JfRWFyT3ZlckhlYWQoKSB7IHJldHVybiAhIXRoaXMuX3Jhdy5tYXAuZWFyT3ZlckhlYWQ7IH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IHRoYXQgLSB0aGlzXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJhc2UgLSBwYXJlbnRcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYW5jaG9yIC0gYW5jaG9yIG5hbWVcclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfYW5jaG9yKHRoYXQsIGJhc2UsIGFuY2hvcikge1xyXG5cdFx0cmV0dXJuIGJhc2VbYW5jaG9yXS5taW51cyh0aGF0W2FuY2hvcl0pLnBsdXMoYmFzZS5vcmlnaW4ubWludXModGhhdC5vcmlnaW4pKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlKGNoYXJhLCBib2R5LCBoZWFkKSB7XHJcblx0XHR0aGlzLmNhbGNSZWxhdGl2ZSA9IHRoaXMuX2dldFJlbGF0aXZlRnVuY3Rpb24oY2hhcmEpO1xyXG5cdFx0cmV0dXJuIHRoaXMuY2FsY1JlbGF0aXZlKGNoYXJhLCBib2R5LCBoZWFkKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtmdW5jdGlvbihDaGFyYWN0ZXJBbmltYXRpb25CYXNlLEZyYWdtZW50VGV4dHVyZSxGcmFnbWVudFRleHR1cmUpOlZlYzJ9XHJcblx0ICovXHJcblx0X2dldFJlbGF0aXZlRnVuY3Rpb24oY2hhcmEpIHtcclxuXHRcdGlmICghdGhpcy5pc0hhc0FuY2hvcigpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVFbXB0eTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmlzQW5jaG9yTmVjaygpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVfbmVjaztcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmlzQW5jaG9yQnJvdygpKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVfYnJvdztcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmlzQW5jaG9yTmF2ZWwoKSkge1xyXG5cdFx0XHRpZiAodGhpcyA9PSBjaGFyYS5zbG90cy5ib2R5KSB7XHJcblx0XHRcdFx0cmV0dXJuIHRoaXMuX2dldE9yaWdpbjtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm4gdGhpcy5fY2FsY1JlbGF0aXZlX25hdmVsO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuaXNBbmNob3JIYW5kKCkpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2NhbGNSZWxhdGl2ZV9oYW5kO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHRoaXMuaXNBbmNob3JIYW5kTW92ZSgpKSB7XHJcblx0XHRcdGlmICh0aGlzLl91cmwubGFzdEluZGV4T2YoXCJsSGFuZFwiKSA+IDApIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5fY2FsY1JlbGF0aXZlX2hhbmRNb3ZlX2xIYW5kO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiB0aGlzLl9jYWxjUmVsYXRpdmVfaGFuZE1vdmU7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlRW1wdHkoY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdHJldHVybiBWZWMyLmVtcHR5O1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJvZHlcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gW2hlYWRdXHJcblx0ICogQHJldHVybnMge1ZlYzJ9XHJcblx0ICovXHJcblx0X2dldE9yaWdpbihjaGFyYSwgYm9keSwgaGVhZCkge1xyXG5cdFx0cmV0dXJuIHRoaXMub3JpZ2luO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBuZWNrIG9uIHRoZSBuYXZlbFxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX25lY2soY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdHJldHVybiB0aGlzLl9hbmNob3IodGhpcywgYm9keSwgXCJuZWNrXCIpLm1pbnVzKGJvZHkub3JpZ2luKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogYnJvdyBvbiB0aGUgaGVhZCAmIGhlYWQgb24gdGhlIG5lY2sgJiBuZWNrIG9uIHRoZSBuYXZlbFxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX2Jyb3coY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdHJldHVybiB0aGlzLl9hbmNob3IodGhpcywgaGVhZCwgXCJicm93XCIpLnBsdXModGhpcy5fYW5jaG9yKGhlYWQsIGJvZHksIFwibmVja1wiKSkubWludXMoYm9keS5vcmlnaW4pOy8vYW5jaG9yX2Jyb3crKC03LC0zMylcclxuXHR9XHJcblx0LyoqXHJcblx0ICogdGhpcyBpcyBvcmlnaW4gcG9pbnQsIG5vIGFuY2hvclxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX25hdmVsKGNoYXJhLCBib2R5LCBoZWFkKSB7XHJcblx0XHRyZXR1cm4gYm9keS5uYXZlbC5taW51cyh0aGlzLm5hdmVsKS5taW51cyh0aGlzLm9yaWdpbik7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gYm9keVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBbaGVhZF1cclxuXHQgKiBAcmV0dXJucyB7VmVjMn1cclxuXHQgKi9cclxuXHRfY2FsY1JlbGF0aXZlX2hhbmQoY2hhcmEsIGJvZHksIGhlYWQpIHtcclxuXHRcdGNvbnN0IGhhbmQgPSBjaGFyYS5zbG90cy5ib2R5LmZyYWdtZW50cy5hcm0uZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRpZiAoaGFuZCA9PSBudWxsKSB7XHJcblx0XHRcdHJldHVybiBWZWMyLmVtcHR5Lm1pbnVzKHRoaXMuaGFuZCkubWludXModGhpcy5vcmlnaW4pLm1pbnVzKGJvZHkub3JpZ2luKTtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGhpcy5fYW5jaG9yKHRoaXMsIGhhbmQsIFwiaGFuZFwiKS5taW51cyh0aGlzLl9hbmNob3IoYm9keSwgaGFuZCwgXCJuYXZlbFwiKSkubWludXMoYm9keS5vcmlnaW4pO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJvZHlcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gW2hlYWRdXHJcblx0ICogQHJldHVybnMge1ZlYzJ9XHJcblx0ICovXHJcblx0X2NhbGNSZWxhdGl2ZV9oYW5kTW92ZShjaGFyYSwgYm9keSwgaGVhZCkge1xyXG5cdFx0cmV0dXJuIFZlYzIuZW1wdHkubWludXModGhpcy5vcmlnaW4pLm1pbnVzKHRoaXMuaGFuZE1vdmUpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHBhcmFtIHtGcmFnbWVudFRleHR1cmV9IGJvZHlcclxuXHQgKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gW2hlYWRdXHJcblx0ICogQHJldHVybnMge1ZlYzJ9XHJcblx0ICovXHJcblx0X2NhbGNSZWxhdGl2ZV9oYW5kTW92ZV9sSGFuZChjaGFyYSwgYm9keSwgaGVhZCkge1xyXG5cdFx0cmV0dXJuIFZlYzIuZW1wdHkubWludXModGhpcy5vcmlnaW4pO1xyXG5cdH1cclxuXHRcclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqL1xyXG5cdHVwZGF0ZShjaGFyYSkge1xyXG5cdFx0aWYgKGNoYXJhLnNsb3RzLmJvZHkgJiYgY2hhcmEuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHRjb25zdCBib2R5ID0gY2hhcmEuc2xvdHMuYm9keS5mcmFnbWVudHMuYm9keS5nZXRUZXh0dXJlKGNoYXJhKTtcclxuXHRcdFx0Y29uc3QgaGVhZCA9IGNoYXJhLnNsb3RzLmhlYWQuZnJhZ21lbnRzLmhlYWQuZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRcdGlmIChib2R5ICYmIGhlYWQpIHtcclxuXHRcdFx0XHR0aGlzLnJlbGF0aXZlID0gdGhpcy5jYWxjUmVsYXRpdmUoY2hhcmEsIGJvZHksIGhlYWQpO1xyXG5cclxuXHRcdFx0XHRjb25zdCB0YW1pbmdNb2IgPSBjaGFyYS5zbG90cy50YW1pbmdNb2I7XHJcblx0XHRcdFx0aWYgKHRhbWluZ01vYikge1xyXG5cdFx0XHRcdFx0dGhpcy5yZWxhdGl2ZSA9IHRhbWluZ01vYi5hZGpfcG9zKHRoaXMucmVsYXRpdmUsIGJvZHksIGNoYXJhKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKi9cclxuXHRyZW5kZXIocmVuZGVyZXIsIGNoYXJhKSB7XHJcblx0XHRpZiAoISh0aGlzLnJlbGF0aXZlICYmIHRoaXMudmlzaWJsZSkpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0Y29uc3QgeCA9IHRoaXMucmVsYXRpdmUueDtcclxuXHRcdGNvbnN0IHkgPSB0aGlzLnJlbGF0aXZlLnk7XHJcblxyXG5cdFx0cmVuZGVyZXIuZ2xvYmFsQWxwaGEgPSB0aGlzLm9wYWNpdHk7XHJcblx0XHRpZiAodGhpcy5maWx0ZXIuaXNFbXB0eSkge1xyXG5cdFx0XHRyZW5kZXJlci5kcmF3R3JhcGgyKHRoaXMsIHgsIHkpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJlbmRlcmVyLmN0eC5maWx0ZXIgPSB0aGlzLmZpbHRlci50b1N0cmluZygpO1xyXG5cdFx0XHRyZW5kZXJlci5kcmF3R3JhcGgyKHRoaXMsIHgsIHkpO1xyXG5cdFx0XHRyZW5kZXJlci5jdHguZmlsdGVyID0gXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBCb2R5RnJhZ21lbnRUZXh0dXJlIGV4dGVuZHMgRnJhZ21lbnRUZXh0dXJlIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICovXHJcblx0dXBkYXRlKGNoYXJhKSB7XHJcblx0XHRzdXBlci51cGRhdGUoY2hhcmEpO1xyXG5cdFx0dGhpcy52aXNpYmxlID0gIWNoYXJhLmhpZGVCb2R5O1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgSGFpckZyYWdtZW50VGV4dHVyZSBleHRlbmRzIEZyYWdtZW50VGV4dHVyZSB7XHJcblx0Y29uc3RydWN0b3IoLi4uYXJncykge1xyXG5cdFx0c3VwZXIoLi4uYXJncyk7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtIYWlyRnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0dGhpcy5ncmFwaDIgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7SGFpckZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdHRoaXMuZ3JhcGgzID0gbnVsbDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKi9cclxuXHR1cGRhdGUoY2hhcmEpIHtcclxuXHRcdGlmIChjaGFyYS5zbG90cy5ib2R5ICYmIGNoYXJhLnNsb3RzLmhlYWQpIHtcclxuXHRcdFx0Y29uc3QgYm9keSA9IGNoYXJhLnNsb3RzLmJvZHkuZnJhZ21lbnRzLmJvZHkuZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRcdGNvbnN0IGhlYWQgPSBjaGFyYS5zbG90cy5oZWFkLmZyYWdtZW50cy5oZWFkLmdldFRleHR1cmUoY2hhcmEpO1xyXG5cdFx0XHRpZiAoYm9keSAmJiBoZWFkKSB7XHJcblx0XHRcdFx0dGhpcy5yZWxhdGl2ZSA9IHRoaXMuY2FsY1JlbGF0aXZlKGNoYXJhLCBib2R5LCBoZWFkKTtcclxuXHJcblx0XHRcdFx0Y29uc3QgdGFtaW5nTW9iID0gY2hhcmEuc2xvdHMudGFtaW5nTW9iO1xyXG5cdFx0XHRcdGlmICh0YW1pbmdNb2IpIHtcclxuXHRcdFx0XHRcdHRoaXMucmVsYXRpdmUgPSB0YW1pbmdNb2IuYWRqX3Bvcyh0aGlzLnJlbGF0aXZlLCBib2R5LCBjaGFyYSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAodGhpcy5ncmFwaDIpIHtcclxuXHRcdFx0XHRcdHRoaXMuZ3JhcGgyLnJlbGF0aXZlID0gdGhpcy5yZWxhdGl2ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKHRoaXMuZ3JhcGgzKSB7XHJcblx0XHRcdFx0XHR0aGlzLmdyYXBoMy5yZWxhdGl2ZSA9IHRoaXMucmVsYXRpdmU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICovXHJcblx0cmVuZGVyKHJlbmRlcmVyLCBjaGFyYSkge1xyXG5cdFx0aWYgKCF0aGlzLnJlbGF0aXZlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRyZW5kZXJlci5nbG9iYWxBbHBoYSA9IHRoaXMub3BhY2l0eSB8fCAxO1xyXG5cdFx0aWYgKHRoaXMuZmlsdGVyLmlzRW1wdHkpIHtcclxuXHRcdFx0dGhpcy5fcmVuZGVyKHJlbmRlcmVyKTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRyZW5kZXJlci5jdHguZmlsdGVyID0gdGhpcy5maWx0ZXIudG9TdHJpbmcoKTtcclxuXHRcdFx0dGhpcy5fcmVuZGVyKHJlbmRlcmVyKTtcclxuXHRcdFx0cmVuZGVyZXIuY3R4LmZpbHRlciA9IFwibm9uZVwiO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRfcmVuZGVyKHJlbmRlcmVyKSB7XHJcblx0XHRjb25zdCB4ID0gdGhpcy5yZWxhdGl2ZS54O1xyXG5cdFx0Y29uc3QgeSA9IHRoaXMucmVsYXRpdmUueTtcclxuXHJcblx0XHRyZW5kZXJlci5kcmF3R3JhcGgyKHRoaXMsIHgsIHkpO1xyXG5cclxuXHRcdGlmICh0aGlzLmdyYXBoMiAmJiB0aGlzLmdyYXBoMi5vcGFjaXR5KSB7Ly9jb2xvcjJcclxuXHRcdFx0cmVuZGVyZXIuZ2xvYmFsQWxwaGEgPSB0aGlzLmdyYXBoMi5vcGFjaXR5O1xyXG5cclxuXHRcdFx0cmVuZGVyZXIuZHJhd0dyYXBoMih0aGlzLmdyYXBoMiwgeCwgeSk7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5ncmFwaDMgJiYgdGhpcy5ncmFwaDMub3BhY2l0eSkgey8vY29sb3IzXHJcblx0XHRcdHJlbmRlcmVyLmdsb2JhbEFscGhhID0gdGhpcy5ncmFwaDMub3BhY2l0eTtcclxuXHJcblx0XHRcdHJlbmRlcmVyLmRyYXdHcmFwaDIodGhpcy5ncmFwaDMsIHgsIHkpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuXHJcbmNsYXNzIEl0ZW1FZmZlY3RBbmltYXRpb24gZXh0ZW5kcyBBbmltYXRpb24ge1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHRzdXBlcihyYXcsIHVybCk7XHJcblx0XHRcclxuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9yYXdcIiwge1xyXG5cdFx0XHR2YWx1ZTogcmF3LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly90aGlzLl91cmwgPSB0aGlzLl91cmw7XHJcblxyXG5cdFx0dGhpcy5fX2dldEF0dHIoXCJ6XCIsIC0xKTtcclxuXHRcdHRoaXMuX19nZXRBdHRyKFwicG9zXCIsIDEpO1xyXG5cclxuXHRcdHN1cGVyLmxvYWQoKTtcclxuXHR9XHJcblx0X19nZXRBdHRyKGF0dHIsIGRlZlZhbCkge1xyXG5cdFx0aWYgKGF0dHIgaW4gdGhpcy5fcmF3KSB7XHJcblx0XHRcdHRoaXNbYXR0cl0gPSB0aGlzLl9yYXdbYXR0cl07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpc1thdHRyXSA9IGRlZlZhbDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbn0gYWN0aW9uRXhjZXB0Um90YXRpb25cclxuXHQgKiBAcGFyYW0ge251bWJlcn0gYW5nbGVcclxuXHQgKiBAcGFyYW0ge2Jvb2xlYW59IGZsaXBcclxuXHQgKi9cclxuXHRyZW5kZXIocmVuZGVyZXIsIGFjdGlvbkV4Y2VwdFJvdGF0aW9uLCBhbmdsZSwgZmxpcCkge1xyXG5cdFx0aWYgKGFjdGlvbkV4Y2VwdFJvdGF0aW9uKSB7XHJcblx0XHRcdHRoaXMuZHJhdyhyZW5kZXJlciwgMCwgMCwgLWFuZ2xlLCBmbGlwKTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRjb25zdCBveSA9IC10aGlzLnRleHR1cmUuaGVpZ2h0ICogMC4yNTtcclxuXHRcdFx0dGhpcy5kcmF3KHJlbmRlcmVyLCAwLCBveSwgMCwgZmxpcCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vL1x0L2RhdGEvRWZmZWN0L0l0ZW1FZmYvMTEwMjkxOFxyXG5jbGFzcyBJdGVtRWZmZWN0IHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMuX3VybCA9IG51bGw7XHJcblx0XHR0aGlzLl9yYXcgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7e1thbmltYXRpb25OYW1lOnN0cmluZ106SXRlbUVmZmVjdEFuaW1hdGlvbn19ICovXHJcblx0XHR0aGlzLmFuaW1hdGlvbiA9IHt9O1xyXG5cclxuXHRcdHRoaXMuYWN0aW9uID0gbnVsbDtcclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblx0XHR0aGlzLmZyYW1lID0gMDtcclxuXHJcblx0XHR0aGlzLmZpeGVkID0gMDtcclxuXHRcdHRoaXMueiA9IC0yO1xyXG5cdFx0dGhpcy5hY3Rpb24gPSAxO1xyXG5cdFx0dGhpcy5hY3Rpb25FeGNlcHRSb3RhdGlvbiA9IDA7XHJcblx0XHRcclxuXHRcdHRoaXMuZW5hYmxlID0gdHJ1ZTtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBhc3luYyBJbml0KCkge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0LyoqIEB0eXBlIHtTZXQ8c3RyaW5nPn0gKi9cclxuXHRcdFx0bGV0IGl0ZW1FZmZlY3RMaXN0ID0gSXRlbUVmZmVjdC5fbGlzdDtcclxuXHJcblx0XHRcdC8qKiBAdHlwZSB7c3RyaW5nW119ICovXHJcblx0XHRcdGxldCByYXcgPSBhd2FpdCAkZ2V0Lmxpc3QoXCIvRWZmZWN0L0l0ZW1FZmZcIik7XHJcblxyXG5cdFx0XHRpdGVtRWZmZWN0TGlzdC5jbGVhcigpO1xyXG5cclxuXHRcdFx0cmF3LmZvckVhY2goaWQgPT4ge1xyXG5cdFx0XHRcdGl0ZW1FZmZlY3RMaXN0LmFkZChwYXJzZUludChpZCwgMTApKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogaWYgKCFleGlzdCkgcmV0dXJuIG51bGxcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZXF1aXBJRFxyXG5cdCAqIEByZXR1cm5zIHtQcm9taXNlPEl0ZW1FZmZlY3Q+fVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBhc3luYyBsb2FkKGVxdWlwSUQpIHtcclxuXHRcdGNvbnN0IGlkID0gTnVtYmVyKGVxdWlwSUQpO1xyXG5cclxuXHRcdGlmIChJdGVtRWZmZWN0Ll9saXN0LmhhcyhpZCkpIHtcclxuXHRcdFx0bGV0IGVmZiA9IG5ldyBJdGVtRWZmZWN0KCk7XHJcblx0XHRcdGF3YWl0IGVmZi5sb2FkKGVxdWlwSUQpO1xyXG5cdFx0XHRyZXR1cm4gZWZmO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogaWYgKCFleGlzdCkgcmV0dXJuIG51bGxcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZXF1aXBJRFxyXG5cdCAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxyXG5cdCAqL1xyXG5cdGFzeW5jIGxvYWQoZXF1aXBJRCkge1xyXG5cdFx0Y29uc3QgaWQgPSBOdW1iZXIoZXF1aXBJRCk7XHJcblx0XHRjb25zdCB1cmwgPSBgL0VmZmVjdC9JdGVtRWZmLyR7aWR9L2VmZmVjdGA7XHJcblx0XHRsZXQgcmF3O1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdHJhdyA9IGF3YWl0ICRnZXQuZGF0YSh1cmwpO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdHRocm93IGV4O1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChyYXcpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2xvYWQoZXF1aXBJRCwgdXJsLCByYXcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YW1wXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFjdGlvblxyXG5cdCAqL1xyXG5cdHVwZGF0ZShzdGFtcCwgYWN0aW9uKSB7XHJcblx0XHRpZiAoYWN0aW9uIGluIHRoaXMuYW5pbWF0aW9uKSB7XHJcblx0XHRcdHRoaXMuYWN0aW9uID0gYWN0aW9uO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuYWN0aW9uID0gXCJkZWZhdWx0XCI7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMuYW5pbWF0aW9uW3RoaXMuYWN0aW9uXSkge1xyXG5cdFx0XHR0aGlzLmFuaW1hdGlvblt0aGlzLmFjdGlvbl0udXBkYXRlKHN0YW1wKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyUmVuZGVyZXJ9IGNoYXJhXHJcblx0ICovXHJcblx0cmVuZGVyKHJlbmRlcmVyLCBjaGFyYSkge1xyXG5cdFx0aWYgKHRoaXMuYW5pbWF0aW9uICYmIHRoaXMuYW5pbWF0aW9uW3RoaXMuYWN0aW9uXSkge1xyXG5cdFx0XHR0aGlzLmFuaW1hdGlvblt0aGlzLmFjdGlvbl0ucmVuZGVyKHJlbmRlcmVyLCB0aGlzLmFjdGlvbkV4Y2VwdFJvdGF0aW9uLCBjaGFyYS5hbmdsZSwgY2hhcmEuZnJvbnQgPiAwKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcElEXHJcblx0ICogQHBhcmFtIHtvYmplY3R9IHJhd19kYXRhXHJcblx0ICovXHJcblx0X2xvYWQoZXF1aXBJRCwgdXJsLCByYXcpIHtcclxuXHRcdHRoaXMuaWQgPSBlcXVpcElEO1xyXG5cclxuXHRcdGlmICghcmF3KSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0fVxyXG5cdFx0Ly90aGlzLl91cmwgPSB1cmw7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfcmF3XCIsIHtcclxuXHRcdFx0dmFsdWU6IHJhdyxcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuX19jb25zdHJ1Y3QoKTtcclxuXHR9XHJcblx0X19jb25zdHJ1Y3QoKSB7XHJcblx0XHR0aGlzLl9fZ2V0QXR0cihcImZpeGVkXCIsIDApO1xyXG5cdFx0dGhpcy5fX2dldEF0dHIoXCJ6XCIsIC0xKTtcclxuXHRcdHRoaXMuX19nZXRBdHRyKFwiYWN0aW9uXCIsIDEpO1xyXG5cdFx0dGhpcy5fX2dldEF0dHIoXCJhY3Rpb25FeGNlcHRSb3RhdGlvblwiLCAwKTtcclxuXHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuX3Jhdykge1xyXG5cdFx0XHRpZiAodGhpcy5fcmF3W2ldICYmIHR5cGVvZiB0aGlzLl9yYXdbaV0gPT0gXCJvYmplY3RcIiAmJiAnMCcgaW4gdGhpcy5fcmF3W2ldKSB7Ly9hbmltYXRpb24gaGFzIGZyYW1lc1xyXG5cdFx0XHRcdHRoaXMuYW5pbWF0aW9uW2ldID0gbmV3IEl0ZW1FZmZlY3RBbmltYXRpb24odGhpcy5fcmF3W2ldLCBbdGhpcy5fdXJsLCBpXS5qb2luKFwiL1wiKSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0X19nZXRBdHRyKGF0dHIsIGRlZlZhbCkge1xyXG5cdFx0aWYgKGF0dHIgaW4gdGhpcy5fcmF3KSB7XHJcblx0XHRcdHRoaXNbYXR0cl0gPSB0aGlzLl9yYXdbYXR0cl07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpc1thdHRyXSA9IGRlZlZhbDtcclxuXHRcdH1cclxuXHR9XHJcbn1cclxuLyoqIEB0eXBlIHtTZXQ8c3RyaW5nPn0gKi9cclxuSXRlbUVmZmVjdC5fbGlzdCA9IG5ldyBTZXQoKTtcclxuXHJcbmNsYXNzIENoYXJhY3RlckZyYWdtZW50QmFzZSB7XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHt7W2FjdGlvbjpzdHJpbmddOiBGcmFnbWVudFRleHR1cmVbXX19IHRleHR1cmVzXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IodGV4dHVyZXMpIHtcclxuXHRcdC8qKiBAdHlwZSB7e1thY3Rpb246c3RyaW5nXTogRnJhZ21lbnRUZXh0dXJlW119fSAtIHRleHR1cmVzW2FjdGlvbjpzdHJpbmddW2ZyYW1lOm51bWJlcl0gKi9cclxuXHRcdHRoaXMudGV4dHVyZXMgPSB0ZXh0dXJlcztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0VGV4dHVyZShjaGFyYSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBmcmFtZVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBmcmFtZSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVDb3VudChjaGFyYSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAZmluYWwgXHJcbiAqL1xyXG5jbGFzcyBDaGFyYWN0ZXJCb2R5RnJhZ21lbnQgZXh0ZW5kcyBDaGFyYWN0ZXJGcmFnbWVudEJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKHRleHR1cmVzKSB7XHJcblx0XHRzdXBlcih0ZXh0dXJlcyk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge0ZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXRUZXh0dXJlKGNoYXJhKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5nZXRGcmFtZVRleHR1cmUoY2hhcmEsIGNoYXJhLmFjdGlvbl9mcmFtZSk7XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gZnJhbWVcclxuXHQgKiBAcmV0dXJucyB7RnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lVGV4dHVyZShjaGFyYSwgZnJhbWUpIHtcclxuXHRcdGlmICghKGNoYXJhLmFjdGlvbiBpbiB0aGlzLnRleHR1cmVzKSkge1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHRcdGxldCBmdCA9IHRoaXMudGV4dHVyZXNbY2hhcmEuYWN0aW9uXVtmcmFtZV07Ly9pZiBmcmFtZSBub3QgZXhpc3QgdGhlbiByZXR1cm4gdW5kZWZpbmVkXHJcblx0XHRyZXR1cm4gZnQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXRGcmFtZUNvdW50KGNoYXJhKSB7XHJcblx0XHRpZiAodGhpcy50ZXh0dXJlc1tjaGFyYS5hY3Rpb25dKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnRleHR1cmVzW2NoYXJhLmFjdGlvbl0ubGVuZ3RoO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDA7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQGZpbmFsIFxyXG4gKi9cclxuY2xhc3MgQ2hhcmFjdGVyRmFjZUZyYWdtZW50IGV4dGVuZHMgQ2hhcmFjdGVyRnJhZ21lbnRCYXNlIHtcclxuXHRjb25zdHJ1Y3Rvcih0ZXh0dXJlcykge1xyXG5cdFx0c3VwZXIodGV4dHVyZXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0VGV4dHVyZShjaGFyYSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBjaGFyYS5lbW90aW9uX2ZyYW1lKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gZnJhbWVcclxuXHQgKiBAcmV0dXJucyB7RnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lVGV4dHVyZShjaGFyYSwgZnJhbWUpIHtcclxuXHRcdGlmICghKGNoYXJhLmVtb3Rpb24gaW4gdGhpcy50ZXh0dXJlcykpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRsZXQgZnQgPSB0aGlzLnRleHR1cmVzW2NoYXJhLmVtb3Rpb25dW2ZyYW1lXTtcclxuXHRcdHJldHVybiBmdDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lQ291bnQoY2hhcmEpIHtcclxuXHRcdGlmICh0aGlzLnRleHR1cmVzW2NoYXJhLmVtb3Rpb25dKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnRleHR1cmVzW2NoYXJhLmVtb3Rpb25dLmxlbmd0aDtcclxuXHRcdH1cclxuXHRcdHJldHVybiAwO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEBmaW5hbCBcclxuICovXHJcbmNsYXNzIENoYXJhY3RlclRhbWluZ01vYkZyYWdtZW50IGV4dGVuZHMgQ2hhcmFjdGVyRnJhZ21lbnRCYXNlIHtcclxuXHRjb25zdHJ1Y3Rvcih0ZXh0dXJlcykge1xyXG5cdFx0c3VwZXIodGV4dHVyZXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0VGV4dHVyZShjaGFyYSkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZ2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBjaGFyYS5hY3RhbmkuYWN0aW9uRnJhbWUpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBmcmFtZSAtIG5vdCBzeW5jIGNoYXJhLl9mcmFtZVxyXG5cdCAqIEByZXR1cm5zIHtGcmFnbWVudFRleHR1cmV9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVUZXh0dXJlKGNoYXJhLCBmcmFtZSkge1xyXG5cdFx0aWYgKCEoY2hhcmEuX3JpZGVfYWN0aW9uIGluIHRoaXMudGV4dHVyZXMpKSB7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdFx0bGV0IGZ0ID0gdGhpcy50ZXh0dXJlc1tjaGFyYS5fcmlkZV9hY3Rpb25dW2ZyYW1lXTsvL2lmIGZyYW1lIG5vdCBleGlzdCB0aGVuIHJldHVybiB1bmRlZmluZWRcclxuXHRcdHJldHVybiBmdDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gY2hhcmFcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldEZyYW1lQ291bnQoY2hhcmEpIHtcclxuXHRcdGlmICh0aGlzLnRleHR1cmVzW2NoYXJhLl9yaWRlX2FjdGlvbl0pIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMudGV4dHVyZXNbY2hhcmEuX3JpZGVfYWN0aW9uXS5sZW5ndGg7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIEVxdWlwSW1hZ2VGaWx0ZXIge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9IGVxdWlwXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IoZXF1aXApIHtcclxuXHRcdHRoaXMuZXF1aXAgPSBlcXVpcDtcclxuXHR9XHJcblxyXG5cdGdldCBodWUoKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRpZiAoIWVxdWlwKSB7XHJcblx0XHRcdHJldHVybiAwO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZ0LmZpbHRlci5odWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMDtcclxuXHR9XHJcblx0c2V0IGh1ZSh2YWx1ZSkge1xyXG5cdFx0Y29uc3QgZXF1aXAgPSB0aGlzLmVxdWlwO1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0ZnQuZmlsdGVyLmh1ZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Z2V0IHNhdCgpIHtcclxuXHRcdGNvbnN0IGVxdWlwID0gdGhpcy5lcXVpcDtcclxuXHRcdGlmICghZXF1aXApIHtcclxuXHRcdFx0cmV0dXJuIDEwMDtcclxuXHRcdH1cclxuXHRcdGZvciAobGV0IGkgaW4gZXF1aXAuZnJhZ21lbnRzKSB7XHJcblx0XHRcdGZvciAobGV0IGogaW4gZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal0ubGVuZ3RoOyArK2spIHtcclxuXHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0bGV0IGZ0ID0gZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdW2tdO1xyXG5cdFx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmdC5maWx0ZXIuc2F0O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDEwMDtcclxuXHR9XHJcblx0c2V0IHNhdCh2YWx1ZSkge1xyXG5cdFx0Y29uc3QgZXF1aXAgPSB0aGlzLmVxdWlwO1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0ZnQuZmlsdGVyLnNhdCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRnZXQgYnJpKCkge1xyXG5cdFx0Y29uc3QgZXF1aXAgPSB0aGlzLmVxdWlwO1xyXG5cdFx0aWYgKCFlcXVpcCkge1xyXG5cdFx0XHRyZXR1cm4gMTAwO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChsZXQgaSBpbiBlcXVpcC5mcmFnbWVudHMpIHtcclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBlcXVpcC5mcmFnbWVudHNbaV0udGV4dHVyZXNbal1ba107XHJcblx0XHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGZ0LmZpbHRlci5icmk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMTAwO1xyXG5cdH1cclxuXHRzZXQgYnJpKHZhbHVlKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRmb3IgKGxldCBpIGluIGVxdWlwLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuYnJpID0gdmFsdWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRnZXQgY29udHJhc3QoKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRpZiAoIWVxdWlwKSB7XHJcblx0XHRcdHJldHVybiAxMDA7XHJcblx0XHR9XHJcblx0XHRmb3IgKGxldCBpIGluIGVxdWlwLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4gZnQuZmlsdGVyLmNvbnRyYXN0O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDEwMDtcclxuXHR9XHJcblx0c2V0IGNvbnRyYXN0KHZhbHVlKSB7XHJcblx0XHRjb25zdCBlcXVpcCA9IHRoaXMuZXF1aXA7XHJcblx0XHRmb3IgKGxldCBpIGluIGVxdWlwLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlcykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgZXF1aXAuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IGVxdWlwLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRmdC5maWx0ZXIuY29udHJhc3QgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHRvSlNPTigpIHtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGh1ZTogdGhpcy5odWUsXHJcblx0XHRcdHNhdHVyYXRpb246IGZpeGVkTnVtKHRoaXMuc2F0KSxcclxuXHRcdFx0YnJpZ2h0bmVzczogZml4ZWROdW0odGhpcy5icmkpLFxyXG5cdFx0XHRjb250cmFzdDogZml4ZWROdW0odGhpcy5jb250cmFzdCksXHJcblx0XHR9O1xyXG5cdFx0ZnVuY3Rpb24gZml4ZWROdW0odmFsKSB7XHJcblx0XHRcdHJldHVybiBOdW1iZXIoKHZhbCAvIDEwMCkudG9GaXhlZCgxKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3todWU6IG51bWJlciwgc2F0dXJhdGlvbjogbnVtYmVyLCBicmlnaHRuZXNzOiBudW1iZXIsIGNvbnRyYXN0OiBudW1iZXJ9fSBkYXRhXHJcblx0ICovXHJcblx0cGFyc2UoZGF0YSkge1xyXG5cdFx0bGV0IHsgaHVlID0gMCwgc2F0dXJhdGlvbiA9IDEsIGJyaWdodG5lc3MgPSAxLCBjb250cmFzdCA9IDEgfSA9IGRhdGE7XHJcblx0XHR0aGlzLmh1ZSA9IE51bWJlcihodWUpO1xyXG5cdFx0dGhpcy5zYXQgPSBOdW1iZXIoc2F0dXJhdGlvbikgKiAxMDA7XHJcblx0XHR0aGlzLmJyaSA9IE51bWJlcihicmlnaHRuZXNzKSAqIDEwMDtcclxuXHRcdHRoaXMuY29udHJhc3QgPSBOdW1iZXIoY29udHJhc3QpICogMTAwO1xyXG5cdH1cclxufVxyXG5cclxuLyoqXHJcbiAqIEBpbnRlcmZhY2VcclxuICovXHJcbmNsYXNzIElDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdmlydHVhbFxyXG5cdCAqL1xyXG5cdGlzTG9hZGVkKCkge1xyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKi9cclxuXHRfdW5sb2FkKCkge1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXRGcmFtZUNvdW50KGNoYXJhKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXREZWxheShjaGFyYSkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB2aXJ0dWFsXHJcblx0ICovXHJcblx0dG9KU09OKCkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudFwiKTtcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGlkOiAtMSwvL2ludmFsaWQgSURcclxuXHRcdH07XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogPz9cclxuICovXHJcbmNsYXNzIF9DaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZVNsb3RMaW5rIGV4dGVuZHMgSUNoYXJhY3RlckFwcGVhcmFuY2VCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcihzbG90X2xpbmspIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0XHR0aGlzLnNsb3RfbGluayA9IHNsb3RfbGluazsvLz8/XHJcblx0fVxyXG5cclxuXHR0b0pTT04oKSB7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRpZDogc2xvdF9saW5rLC8vPz9cclxuXHRcdH07XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogY2hhcmFjdGVyIGxvYWRlclxyXG4gKi9cclxuY2xhc3MgQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2UgZXh0ZW5kcyBJQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHRcdFx0XHJcblx0XHR0aGlzLl9yYXcgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0Ly90aGlzLl91cmwgPSBudWxsO1xyXG5cdFx0XHRcclxuXHRcdC8qKiBAdHlwZSB7SXRlbUVmZmVjdH0gKi9cclxuXHRcdHRoaXMuZWZmZWN0ID0gbnVsbDtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIEB0eXBlIHt7W3BsYWNlOnN0cmluZ106Q2hhcmFjdGVyRnJhZ21lbnRCYXNlfX1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5mcmFnbWVudHMgPSBudWxsO1xyXG5cclxuXHRcdHRoaXMuX29ubG9hZCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmlkID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0l0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0XHR0aGlzLmNhdGVnb3J5SW5mbyA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLnNsb3Rfb3JkZXIgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7b2JqZWN0PHN0cmluZywgbnVtYmVyPn0gKi9cclxuXHRcdHRoaXMuaXNsb3QgPSB7fTtcclxuXHJcblx0XHQvKiogQHR5cGUge29iamVjdDxzdHJpbmcsIG51bWJlcj59ICovXHJcblx0XHR0aGlzLnZzbG90ID0ge307XHJcblxyXG5cdFx0dGhpcy5maWx0ZXIgPSBuZXcgRXF1aXBJbWFnZUZpbHRlcih0aGlzKTtcclxuXHR9XHJcblxyXG5cdGlzTG9hZGVkKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZnJhZ21lbnRzICE9IG51bGw7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge2Z1bmN0aW9uKENoYXJhY3RlckFwcGVhcmFuY2VCYXNlKTp2b2lkfSAqL1xyXG5cdGdldCBfb25sb2FkKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX19vbmxvYWQ7XHJcblx0fVxyXG5cdHNldCBfb25sb2FkKGZ1bmMpIHtcclxuXHRcdHRoaXMuX19vbmxvYWQgPSBmdW5jO1xyXG5cdFx0aWYgKHRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHR0aGlzLl9fb25sb2FkLmNhbGwodGhpcywgdGhpcyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHBhcmFtIHtJdGVtQ2F0ZWdvcnlJbmZvfSBjYXRlSW5mb1xyXG5cdCAqIEBwYXJhbSB7dm9pZH0gdXNlX2NhdGVnb3J5IC0gbm8gdXNlXHJcblx0ICogQHJldHVybnMge1Byb21pc2U8Ym9vbGVhbj59IC0gdHJ1ZSBpZiBpdGVtIGV4aXN0XHJcblx0ICovXHJcblx0YXN5bmMgbG9hZCh1cmwsIGlkLCBjYXRlSW5mbywgdXNlX2NhdGVnb3J5KSB7XHJcblx0XHRsZXQgcmF3O1xyXG5cclxuXHRcdHRoaXMuaWQgPSBpZDtcclxuXHRcdHRoaXMuY2F0ZWdvcnlJbmZvID0gY2F0ZUluZm87XHJcblx0XHRcclxuXHRcdHRyeSB7XHJcblx0XHRcdGlmIChSZXNvdXJjZU1hbmFnZXIuaXNFcXVpcEV4aXN0KGlkLCBjYXRlSW5mbykpIHtcclxuXHRcdFx0XHRyYXcgPSBhd2FpdCBSZXNvdXJjZU1hbmFnZXIuZ2V0SXRlbShpZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHR0aHJvdyBleDtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aWYgKCFyYXcgJiYgbG9hZF9leHRlcm5faXRlbV9kYXRhKSB7XHJcblx0XHRcdFx0cmF3ID0gYXdhaXQgbG9hZF9leHRlcm5faXRlbV9kYXRhKGlkLCBjYXRlSW5mby5saXN0UGF0aCB8fCBjYXRlSW5mby5wYXRoIHx8IGNhdGVJbmZvLnNsb3QpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0dGhyb3cgZXg7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly90aGlzLl91cmwgPSB1cmw7XHJcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfcmF3XCIsIHtcclxuXHRcdFx0dmFsdWU6IHJhdyxcclxuXHRcdH0pO1xyXG5cclxuXHRcdHRoaXMuX19sb2FkX3Nsb3QoKTtcclxuXHJcblx0XHR0aGlzLl9fbG9hZF9mcmFnbWVudHMoKTtcclxuXHJcblx0XHRpZiAodGhpcy5fb25sb2FkKSB7XHJcblx0XHRcdHRoaXMuX29ubG9hZC5jYWxsKHRoaXMsIHRoaXMpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vLy8gaWYgbm90IGJvZHksIGhlYWQsIGZhY2UsIGhhaXIgdGhlbiB0cnkgbG9hZCBlZmZlY3RcclxuXHRcdC8vaWYgKGlkID49IFwiMDAwNTAwMDBcIikge1xyXG5cdFx0XHQvLyBsb2FkIGlmIGV4aXN0XHJcblx0XHRcdEl0ZW1FZmZlY3QubG9hZCh0aGlzLmlkKS50aGVuKGEgPT4gdGhpcy5lZmZlY3QgPSBhKTsvLzAxMTAyOTE4XHQvLzAxMTAyOTE1XHJcblx0XHQvL31cclxuXHJcblx0XHRyZXR1cm4gdHJ1ZTtcclxuXHR9XHJcblx0X19sb2FkX2ZyYWdtZW50cygpIHtcclxuXHRcdGNvbnN0IEZyYWdtZW50Q29uc3RydWN0b3IgPSB0aGlzLkZyYWdtZW50Q29uc3RydWN0b3I7XHJcblxyXG5cdFx0Ly9PYmplY3Qua2V5cyh0aGlzLl9yYXdfdGV4dHVyZXMpLm1hcChrID0+IHsgcmV0dXJuICcwJyBpbiB0aGlzLl9yYXdfdGV4dHVyZXNba107IH0pXHJcblxyXG5cdFx0bGV0IGFjdGlvbl9saXN0ID0gT2JqZWN0LmtleXModGhpcy5fcmF3X3RleHR1cmVzKTtcclxuXHJcblx0XHRsZXQgdGV4dHVyZXMgPSB7fTtcclxuXHRcdGZvciAobGV0IGFjdGlvbiBvZiBhY3Rpb25fbGlzdCkge1xyXG5cdFx0XHRpZiAodHlwZW9mIHRoaXMuX3Jhd190ZXh0dXJlc1thY3Rpb25dID09IFwib2JqZWN0XCIgJiYgXCIwXCIgaW4gdGhpcy5fcmF3X3RleHR1cmVzW2FjdGlvbl0pIHtcclxuXHRcdFx0XHRsZXQgX3VybCA9IHRoaXMuX2Jhc2VfcGF0aCArIGFjdGlvbjtcclxuXHJcblx0XHRcdFx0dGV4dHVyZXNbYWN0aW9uXSA9IHRoaXMuX19sb2FkX2ZyYW1lX3RleHR1cmVzKHRoaXMuX3Jhd190ZXh0dXJlc1thY3Rpb25dLCBfdXJsKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBmcmFnbWVudF90ZXh0dXJlcyA9IHt9O1xyXG5cdFx0Zm9yIChsZXQgYWN0aW9uIGluIHRleHR1cmVzKSB7XHJcblx0XHRcdGZvciAobGV0IGZyYW1lIGluIHRleHR1cmVzW2FjdGlvbl0pIHtcclxuXHRcdFx0XHRmb3IgKGxldCBwbGFjZSBpbiB0ZXh0dXJlc1thY3Rpb25dW2ZyYW1lXSkge1xyXG5cdFx0XHRcdFx0aWYgKCEocGxhY2UgaW4gZnJhZ21lbnRfdGV4dHVyZXMpKSB7XHJcblx0XHRcdFx0XHRcdGZyYWdtZW50X3RleHR1cmVzW3BsYWNlXSA9IHt9O1xyXG5cdFx0XHRcdFx0XHQvL2ZyYWdtZW50X3RleHR1cmVzW3BsYWNlXS52aXNpYmxlID0gdHJ1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICghKGFjdGlvbiBpbiBmcmFnbWVudF90ZXh0dXJlc1twbGFjZV0pKSB7XHJcblx0XHRcdFx0XHRcdGZyYWdtZW50X3RleHR1cmVzW3BsYWNlXVthY3Rpb25dID0gW107XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRmcmFnbWVudF90ZXh0dXJlc1twbGFjZV1bYWN0aW9uXVtmcmFtZV0gPSB0ZXh0dXJlc1thY3Rpb25dW2ZyYW1lXVtwbGFjZV07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IGZyYWdtZW50cyA9IHt9O1xyXG5cdFx0Zm9yIChsZXQgZnJhZyBpbiBmcmFnbWVudF90ZXh0dXJlcykge1xyXG5cdFx0XHRmcmFnbWVudHNbZnJhZ10gPSBuZXcgRnJhZ21lbnRDb25zdHJ1Y3RvcihmcmFnbWVudF90ZXh0dXJlc1tmcmFnXSk7XHJcblx0XHR9XHJcblx0XHR0aGlzLmZyYWdtZW50cyA9IGZyYWdtZW50cztcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IF91cmxcclxuXHQgKiBAcmV0dXJucyB7e1twbGFjZTpzdHJpbmddOkZyYWdtZW50VGV4dHVyZX1bXX0gLSBhcnJheSAtIHRleHR1cmVzW2ZyYW1lXVtwbGFjZV1cclxuXHQgKi9cclxuXHRfX2xvYWRfZnJhbWVfdGV4dHVyZXMoX3JhdywgX3VybCkge1xyXG5cdFx0bGV0IHRleHR1cmVzID0gW107XHJcblx0XHRmb3IgKGxldCBmcmFtZSA9IDA7IGZyYW1lIGluIF9yYXc7ICsrZnJhbWUpIHtcclxuXHRcdFx0bGV0IHVybCA9IGAke191cmx9LyR7ZnJhbWV9YDtcclxuXHRcdFx0dGV4dHVyZXNbZnJhbWVdID0gdGhpcy5fX2xvYWRfcGxhY2VfdGV4dHVyZXMoX3Jhd1tmcmFtZV0sIHVybCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gdGV4dHVyZXM7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBfdXJsXHJcblx0ICogQHJldHVybnMge3tbcGxhY2U6c3RyaW5nXTpGcmFnbWVudFRleHR1cmV9fSAtIG9iamVjdCAtIHRleHR1cmVzW3BsYWNlXVxyXG5cdCAqL1xyXG5cdF9fbG9hZF9wbGFjZV90ZXh0dXJlcyhfcmF3LCBfdXJsKSB7XHJcblx0XHRsZXQgdGV4dHVyZXMgPSB7fTtcclxuXHRcdGZvciAobGV0IHBsYWNlIGluIF9yYXcpIHtcclxuXHRcdFx0bGV0IHBhdGggPSBgJHtfdXJsfS8ke3BsYWNlfWA7XHJcblx0XHRcdGxldCByYXcgPSBfcmF3W3BsYWNlXTtcclxuXHJcblx0XHRcdGlmIChyYXcpIHtcclxuXHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRjb25zdCBGcmFnbWVudFRleHR1cmVDb25zdHJ1Y3RvciA9IHRoaXMuRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3I7XHJcblx0XHRcdFx0bGV0IGZ0O1xyXG5cdFx0XHRcdGlmIChyYXdbXCJcIl0gPT0gXCJcIikge1xyXG5cdFx0XHRcdFx0ZnQuX3VybCA9IHBhdGg7XHJcblx0XHRcdFx0XHQvL2Z0Ll91cmwgPSBwYXRoO1xyXG5cdFx0XHRcdFx0dGV4dHVyZXNbcGxhY2VdID0gZnRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAodHlwZW9mIHJhd1tcIlwiXSA9PSAnc3RyaW5nJykge1xyXG5cdFx0XHRcdFx0ZnQgPSBuZXcgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IocmF3KTtcclxuXHRcdFx0XHRcdC8vZnQuX3VybCA9IHJhd1tcIlwiXTtcclxuXHRcdFx0XHRcdHRleHR1cmVzW3BsYWNlXSA9IGZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmIChwbGFjZSA9PSBcImhhaXJTaGFkZVwiKSB7XHJcblx0XHRcdFx0XHRmdCA9IG5ldyBGcmFnbWVudFRleHR1cmVDb25zdHJ1Y3RvcihyYXdbMF0pO1xyXG5cdFx0XHRcdFx0Ly9mdC5fdXJsID0gcGF0aCArIFwiLzBcIjtcclxuXHRcdFx0XHRcdHRleHR1cmVzW3BsYWNlXSA9IGZ0O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdGZ0Ll9zbG90ID0gdGhpcy5jYXRlZ29yeUluZm8uc2xvdDtcclxuXHRcdFx0XHRcdGZ0Ll9wbGFjZSA9IHBsYWNlO1xyXG5cclxuXHRcdFx0XHRcdGZ0LmNsYXNzTGlzdCA9IFtcclxuXHRcdFx0XHRcdFx0ZnQuX3Nsb3QsXHJcblx0XHRcdFx0XHRcdFwiaXRlbVwiICsgdGhpcy5pZCxcclxuXHRcdFx0XHRcdFx0ZnQuX3BsYWNlLFxyXG5cdFx0XHRcdFx0XHRmdC5fcmF3LnosXHJcblx0XHRcdFx0XHRcdCd6JyArIGZ0LnpcclxuXHRcdFx0XHRcdF0uam9pbignICcpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRleHR1cmVzO1xyXG5cdH1cclxuXHRfX2xvYWRfc2xvdCgpIHtcclxuXHRcdGlmICghdGhpcy5fcmF3LmluZm8uaXNsb3QpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBpc2xvdHMgPSB0aGlzLl9yYXcuaW5mby5pc2xvdC5tYXRjaCgvKFtBLVpdW2EtejAtOV0pL2cpO1xyXG5cdFx0Zm9yIChsZXQgaSBpbiBpc2xvdHMpIHtcclxuXHRcdFx0Y29uc3Qgc2xvdCA9IGlzbG90c1tpXTtcclxuXHRcdFx0Y29uc3Qgc2xvdF9vcmRlciA9IHpNYXBbc2xvdF07XHJcblx0XHRcdHRoaXMuaXNsb3Rbc2xvdF0gPSBzbG90X29yZGVyO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRpZiAoc2xvdF9vcmRlciA+IHRoaXMuc2xvdF9vcmRlcikgey8vdGhpcy5zbG90X29yZGVyID0gTWF0aC5tYXgodGhpcy5zbG90X29yZGVyLCBzbG90X29yZGVyKTtcclxuXHRcdFx0XHR0aGlzLnNsb3Rfb3JkZXIgPSBzbG90X29yZGVyO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHZzbG90cyA9IHRoaXMuX3Jhdy5pbmZvLnZzbG90Lm1hdGNoKC8oW0EtWl1bYS16MC05XSkvZyk7XHJcblx0XHRmb3IgKGxldCBpIGluIHZzbG90cykge1xyXG5cdFx0XHRjb25zdCBzbG90ID0gdnNsb3RzW2ldO1xyXG5cdFx0XHR0aGlzLnZzbG90W3Nsb3RdID0gc2xvdDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdF91bmxvYWQoKSB7XHJcblx0XHR0aGlzLmZyYWdtZW50cyA9IG51bGw7XHJcblx0XHR0aGlzLmVmZmVjdCA9PSBudWxsO1xyXG5cdH1cclxuXHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBbYW5pbWF0aW9uTmFtZV0gLSBhY3Rpb24gYW5pbWF0aW9uXHJcblx0ICovXHJcblx0dG9KU09OKGFuaW1hdGlvbk5hbWUgPSBcInN0YW5kMVwiKSB7XHJcblx0XHRsZXQgcmVnaW9uLCB2ZXJzaW9uO1xyXG5cdFx0aWYgKHRoaXMuX3Jhdy5pbmZvLl9fdikge1xyXG5cdFx0XHRjb25zdCBtID0gdGhpcy5fcmF3LmluZm8uX192LnRvVXBwZXJDYXNlKCkubWF0Y2goLyhbQS1aXSopKFswLTlcXC5dKikvKTtcclxuXHRcdFx0cmVnaW9uID0gKGZ1bmN0aW9uIChyKSB7XHJcblx0XHRcdFx0Y29uc3QgbW0gPSB7XHJcblx0XHRcdFx0XHRcIkdNU1wiOiBcIkdNU1wiLFxyXG5cdFx0XHRcdFx0XCJDTVNcIjogXCJDTVNcIixcclxuXHRcdFx0XHRcdFwiS01TXCI6IFwiS01TXCIsXHJcblx0XHRcdFx0XHRcIkpNU1wiOiBcIkpNU1wiLFxyXG5cdFx0XHRcdFx0XCJTRUFcIjogXCJTRUFcIixcclxuXHRcdFx0XHRcdFwiVE1TXCI6IFwiVE1TXCIsXHJcblx0XHRcdFx0XHRcIlRITVNcIjogXCJUSE1TXCIsXHJcblx0XHRcdFx0XHRcIlRXTVNcIjogXCJUV01TXCIsXHJcblx0XHRcdFx0fTtcclxuXHRcdFx0XHRsZXQgcmVzdWx0ID0gbW1bcl07XHJcblx0XHRcdFx0aWYgKCFyZXN1bHQpIHtcclxuXHRcdFx0XHRcdHJlc3VsdCA9IFJlc291cmNlTWFuYWdlci5kYXRhUmVnaW9uO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRyZXR1cm4gcmVzdWx0O1xyXG5cdFx0XHR9KShbbVsxXV0pO1xyXG5cdFx0XHR2ZXJzaW9uID0gbVsyXSB8fCBSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb247XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmVnaW9uID0gUmVzb3VyY2VNYW5hZ2VyLmRhdGFSZWdpb247XHJcblx0XHRcdHZlcnNpb24gPSBSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb247XHJcblx0XHR9XHJcblx0XHRjb25zdCBmaWx0ZXIgPSB0aGlzLmZpbHRlcjtcclxuXHJcblx0XHRsZXQgb2JqID0ge1xyXG5cdFx0XHRpdGVtSWQ6IE51bWJlcih0aGlzLmlkKSxcclxuXHRcdFx0cmVnaW9uOiByZWdpb24sXHJcblx0XHRcdHZlcnNpb246IHZlcnNpb24sXHJcblx0XHRcdGh1ZTogZmlsdGVyLmh1ZSxcclxuXHRcdFx0c2F0dXJhdGlvbjogZml4ZWROdW0oZmlsdGVyLnNhdCksXHJcblx0XHRcdGJyaWdodG5lc3M6IGZpeGVkTnVtKGZpbHRlci5icmkpLFxyXG5cdFx0XHRjb250cmFzdDogZml4ZWROdW0oZmlsdGVyLmNvbnRyYXN0KSxcclxuXHRcdFx0YWxwaGE6IE51bWJlcigodGhpcy5vcGFjaXR5KS50b0ZpeGVkKDEpKSxcclxuXHRcdH07XHJcblx0XHRpZiAoYW5pbWF0aW9uTmFtZSkge1xyXG5cdFx0XHRvYmouYW5pbWF0aW9uTmFtZSA9IGFuaW1hdGlvbk5hbWU7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cclxuXHRcdGZ1bmN0aW9uIGZpeGVkTnVtKHZhbCkge1xyXG5cdFx0XHRyZXR1cm4gTnVtYmVyKCh2YWwgLyAxMDApLnRvRml4ZWQoMSkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogYW5vdGhlciBmb3JtYXRcclxuXHQgKiBAcGFyYW0ge3thbHBoYTogbnVtYmVyLCBodWU6IG51bWJlciwgc2F0dXJhdGlvbjogbnVtYmVyLCBicmlnaHRuZXNzOiBudW1iZXIsIGNvbnRyYXN0OiBudW1iZXJ9fSBkYXRhXHJcblx0ICovXHJcblx0cGFyc2UoZGF0YSkge1xyXG5cdFx0bGV0IHsgYWxwaGEgPSAxIH0gPSBkYXRhO1xyXG5cdFx0dGhpcy5maWx0ZXIucGFyc2UoZGF0YSk7XHJcblx0XHR0aGlzLm9wYWNpdHkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihhbHBoYSwgMSkpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtQYXJ0aWFsPHtvcGFjaXR5Om51bWJlcixodWU6bnVtYmVyLHNhdDpudW1iZXIsYnJpOm51bWJlcixjb250cmFzdDpudW1iZXJ9Pn0gb3B0aW9uXHJcblx0ICovXHJcblx0c2V0KG9wdGlvbikge1xyXG5cdFx0Y29uc3QgeyBvcGFjaXR5ID0gMSwgaHVlID0gMCwgc2F0ID0gMTAwLCBicmkgPSAxMDAsIGNvbnRyYXN0ID0gMTAwIH0gPSBvcHRpb247XHJcblx0XHR0aGlzLm9wYWNpdHkgPSBvcGFjaXR5O1xyXG5cdFx0dGhpcy5maWx0ZXIuaHVlID0gaHVlO1xyXG5cdFx0dGhpcy5maWx0ZXIuc2F0ID0gc2F0O1xyXG5cdFx0dGhpcy5maWx0ZXIuYnJpID0gYnJpO1xyXG5cdFx0dGhpcy5maWx0ZXIuY29udHJhc3QgPSBjb250cmFzdDtcclxuXHR9XHJcblxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0IG9wYWNpdHkoKSB7XHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuZnJhZ21lbnRzKSB7XHJcblx0XHRcdGZvciAobGV0IGogaW4gdGhpcy5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdW2tdO1xyXG5cdFx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmdC5vcGFjaXR5O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIDE7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBvcGFjaXR5XHJcblx0ICovXHJcblx0c2V0IG9wYWNpdHkob3BhY2l0eSkge1xyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLmZyYWdtZW50cykge1xyXG5cdFx0XHRmb3IgKGxldCBqIGluIHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgayA9IDA7IGsgPCB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXS5sZW5ndGg7ICsraykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSB0aGlzLmZyYWdtZW50c1tpXS50ZXh0dXJlc1tqXVtrXTtcclxuXHRcdFx0XHRcdGlmIChmdCkge1xyXG5cdFx0XHRcdFx0XHRmdC5vcGFjaXR5ID0gb3BhY2l0eTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBodWUgMCB+IDM2MFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBzYXQgMCB+IDEwMFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBicmkgMCB+IDEwMFxyXG5cdCAqL1xyXG5cdHNldEZpbHRlcihodWUsIHNhdCwgYnJpKSB7XHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuZnJhZ21lbnRzKSB7XHJcblx0XHRcdGZvciAobGV0IGogaW4gdGhpcy5mcmFnbWVudHNbaV0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrID0gMDsgayA8IHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdLmxlbmd0aDsgKytrKSB7XHJcblx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdGxldCBmdCA9IHRoaXMuZnJhZ21lbnRzW2ldLnRleHR1cmVzW2pdW2tdO1xyXG5cdFx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHRcdGZ0LmZpbHRlci5odWUgPSBodWU7XHJcblx0XHRcdFx0XHRcdGZ0LmZpbHRlci5zYXQgPSBzYXQ7XHJcblx0XHRcdFx0XHRcdGZ0LmZpbHRlci5icmkgPSBicmk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBnZXQgaWNvbiB1cmxcclxuXHQgKiBAc2VlIHtAbGluayBJdGVtQ2F0ZWdvcnlJbmZvLmdldEljb25Vcmx9XHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRnZXRJY29uVXJsKCkge1xyXG5cdFx0Y29uc3QgaWNvbiA9IHRoaXMuX3Jhdy5pbmZvLmljb247XHJcblx0XHRpZiAoaWNvbikge1xyXG5cdFx0XHRyZXR1cm4gaWNvbltcIlwiXTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0cmV0dXJuIEl0ZW1DYXRlZ29yeUluZm8uZ2V0SWNvblVybCh0aGlzLmlkKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGdldCBpY29uUmF3IHVybFxyXG5cdCAqIEBzZWUge0BsaW5rIEl0ZW1DYXRlZ29yeUluZm8uZ2V0SWNvblJhd1VybH1cclxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG5cdCAqL1xyXG5cdGdldEljb25SYXdVcmwoKSB7XHJcblx0XHRjb25zdCBpY29uUmF3ID0gdGhpcy5fcmF3LmluZm8uaWNvblJhdztcclxuXHRcdGlmIChpY29uUmF3KSB7XHJcblx0XHRcdHJldHVybiBpY29uUmF3W1wiXCJdO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRyZXR1cm4gSXRlbUNhdGVnb3J5SW5mby5nZXRJY29uUmF3VXJsKHRoaXMuaWQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAdHlwZSB7c3RyaW5nfVxyXG5cdCAqL1xyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgSW1wbGVtZW50XCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHZpcnR1YWxcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIENoYXJhY3RlckZyYWdtZW50QmFzZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAdmlydHVhbFxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgRnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudFRleHR1cmVDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRocm93IG5ldyBFcnJvcihcIk5vdCBpbXBsZW1lbnRcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcmV0dXJucyB7e1thY3Rpb25zOnN0cmluZ106e1tcIjBcIl06U3ByaXRlLFtmcmFtZXM6c3RyaW5nXTpTcHJpdGV9fX0gcmF3X3RleHR1cmVzWy4uLmFjdGlvbnNdWy4uLmZyYW1lc11bLi4uZnJhZ21lbnRzXVxyXG5cdCAqL1xyXG5cdGdldCBfcmF3X3RleHR1cmVzKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3JhdztcclxuXHR9XHJcblxyXG5cdGdldCBfYmFzZV9wYXRoKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3VybDtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAYWJzdHJhY3RcclxuICovXHJcbmNsYXNzIENoYXJhY3RlckFwcGVhcmFuY2UgZXh0ZW5kcyBDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRzdXBlcigpO1xyXG5cdH1cclxuXHQvL19faXNfdGV4dHVyZShrKSB7XHJcblx0Ly9cdHJldHVybiAoIShrID09IFwiZmFjZVwiIHx8IGsgPT0gXCJkZWxheVwiIHx8IGsgPT0gXCJkZWZhdWx0XCIpKTtcclxuXHQvL31cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVDb3VudChjaGFyYSkge1xyXG5cdFx0cmV0dXJuIGNoYXJhLnNsb3RzLmJvZHkuZnJhZ21lbnRzLmJvZHkudGV4dHVyZXNbY2hhcmEuYWN0aW9uXS5sZW5ndGg7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXREZWxheShjaGFyYSkge1xyXG5cdFx0Y29uc3QgZCA9IHRoaXMuX3Jhd1tjaGFyYS5hY3Rpb25dW2NoYXJhLmFjdGlvbl9mcmFtZV0uZGVsYXk7XHJcblx0XHRpZiAoTnVtYmVyLmlzU2FmZUludGVnZXIoZCkpIHtcclxuXHRcdFx0cmV0dXJuIGQ7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMTIwO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgQ2hhcmFjdGVyQm9keSBleHRlbmRzIENoYXJhY3RlckFwcGVhcmFuY2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJhY3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyQm9keUZyYWdtZW50fVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudENvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlckJvZHlGcmFnbWVudDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQm9keUZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQm9keUZyYWdtZW50VGV4dHVyZTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENoYXJhY3RlckVxdWlwIGV4dGVuZHMgQ2hhcmFjdGVyQXBwZWFyYW5jZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRzdXBlcigpO1xyXG5cdH1cclxuXHJcblx0Z2V0IF9hbmltYXRpb25fdHlwZSgpIHtcclxuXHRcdHJldHVybiBcImFjdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyQm9keUZyYWdtZW50O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBCb2R5RnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudFRleHR1cmVDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBCb2R5RnJhZ21lbnRUZXh0dXJlO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgQ2hhcmFjdGVyRXF1aXBDYXNoV2VhcG9uIGV4dGVuZHMgQ2hhcmFjdGVyRXF1aXAge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHRcdHRoaXMudXNlX2NhdGVnb3J5ID0gbnVsbDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWRcclxuXHQgKiBAcGFyYW0ge0l0ZW1DYXRlZ29yeUluZm99IGNhdGVJbmZvXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHVzZV9jYXRlZ29yeSAtIGNhc2gtd2VhcG9uIGFzIFtjYXRlZ29yeV1cclxuXHQgKiBAcmV0dXJucyB7UHJvbWlzZTxib29sZWFuPn0gLSB0cnVlIGlmIGl0ZW0gZXhpc3RcclxuXHQgKi9cclxuXHRhc3luYyBsb2FkKHVybCwgaWQsIGNhdGVJbmZvLCB1c2VfY2F0ZWdvcnkpIHtcclxuXHRcdGlmICghdXNlX2NhdGVnb3J5ICYmIHVzZV9jYXRlZ29yeSAhPSBcIlwiKSB7XHJcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoXCJ1c2VfY2F0ZWdvcnlcIik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy51c2VfY2F0ZWdvcnkgPSB1c2VfY2F0ZWdvcnkuc2xpY2UoMiwgNCk7XHJcblxyXG5cdFx0cmV0dXJuIHN1cGVyLmxvYWQodXJsLCBpZCwgY2F0ZUluZm8pO1xyXG5cdH1cclxuXHJcblx0Z2V0IF9hbmltYXRpb25fdHlwZSgpIHtcclxuXHRcdHJldHVybiBcImFjdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyQm9keUZyYWdtZW50O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHJldHVybnMge29iamVjdH0gcmF3X3RleHR1cmVzWy4uLmFjdGlvbnNdWy4uLmZyYW1lc11bLi4uZnJhZ21lbnRzXVxyXG5cdCAqL1xyXG5cdGdldCBfcmF3X3RleHR1cmVzKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3Jhd1t0aGlzLnVzZV9jYXRlZ29yeV07XHJcblx0fVxyXG5cclxuXHRnZXQgX2Jhc2VfcGF0aCgpIHtcclxuXHRcdHJldHVybiB0aGlzLl91cmwgKyB0aGlzLnVzZV9jYXRlZ29yeTtcclxuXHR9XHJcbn1cclxuXHJcblxyXG5jbGFzcyBDaGFyYWN0ZXJIZWFkQmFzZSBleHRlbmRzIENoYXJhY3RlckFwcGVhcmFuY2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJhY3Rpb25cIjtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgQ2hhcmFjdGVyQm9keUZyYWdtZW50fVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudENvbnN0cnVjdG9yKCkge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlckJvZHlGcmFnbWVudDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgRnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudFRleHR1cmVDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBGcmFnbWVudFRleHR1cmU7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBDaGFyYWN0ZXJIZWFkIGV4dGVuZHMgQ2hhcmFjdGVySGVhZEJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHRcdHRoaXMuZWxmRWFyRnJhZ21lbnQgPSBudWxsO1xyXG5cdFx0dGhpcy5sZWZFYXJGcmFnbWVudCA9IG51bGw7XHJcblx0XHR0aGlzLmhpZ2hsZWZFYXJGcmFnbWVudCA9IG51bGw7XHJcblx0fVxyXG5cdF9fbG9hZF9mcmFnbWVudHMoKSB7XHJcblx0XHRzdXBlci5fX2xvYWRfZnJhZ21lbnRzKClcclxuXHRcdFxyXG5cdFx0aWYgKHRoaXMuZnJhZ21lbnRzKSB7XHJcblx0XHRcdGlmICh0aGlzLmZyYWdtZW50cy5lYXIpIHtcclxuXHRcdFx0XHR0aGlzLmVsZkVhckZyYWdtZW50ID0gdGhpcy5mcmFnbWVudHMuZWFyO1xyXG5cdFx0XHRcdGRlbGV0ZSB0aGlzLmZyYWdtZW50cy5lYXI7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRoaXMuZnJhZ21lbnRzLmxlZkVhcikge1xyXG5cdFx0XHRcdHRoaXMubGVmRWFyRnJhZ21lbnQgPSB0aGlzLmZyYWdtZW50cy5sZWZFYXI7XHJcblx0XHRcdFx0ZGVsZXRlIHRoaXMuZnJhZ21lbnRzLmxlZkVhcjtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAodGhpcy5mcmFnbWVudHMuaGlnaGxlZkVhcikge1xyXG5cdFx0XHRcdHRoaXMuaGlnaGxlZkVhckZyYWdtZW50ID0gdGhpcy5mcmFnbWVudHMuaGlnaGxlZkVhcjtcclxuXHRcdFx0XHRkZWxldGUgdGhpcy5mcmFnbWVudHMuaGlnaGxlZkVhcjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHRnZXQgZWxmRWFyKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuZnJhZ21lbnRzLmVhciAhPSBudWxsO1xyXG5cdH1cclxuXHRzZXQgZWxmRWFyKHZhbHVlKSB7XHJcblx0XHRpZiAoIXRoaXMuZWxmRWFyRnJhZ21lbnQpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdHRoaXMuZnJhZ21lbnRzLmVhciA9IHRoaXMuZWxmRWFyRnJhZ21lbnQ7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0ZGVsZXRlIHRoaXMuZnJhZ21lbnRzLmVhcjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGdldCBsZWZFYXIoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5mcmFnbWVudHMubGVmRWFyICE9IG51bGw7XHJcblx0fVxyXG5cdHNldCBsZWZFYXIodmFsdWUpIHtcclxuXHRcdGlmICghdGhpcy5sZWZFYXJGcmFnbWVudCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0dGhpcy5mcmFnbWVudHMubGVmRWFyID0gdGhpcy5sZWZFYXJGcmFnbWVudDtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWxldGUgdGhpcy5mcmFnbWVudHMubGVmRWFyO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Z2V0IGhpZ2hsZWZFYXIoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5mcmFnbWVudHMuaGlnaGxlZkVhciAhPSBudWxsO1xyXG5cdH1cclxuXHRzZXQgaGlnaGxlZkVhcih2YWx1ZSkge1xyXG5cdFx0aWYgKCF0aGlzLmhpZ2hsZWZFYXJGcmFnbWVudCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0dGhpcy5mcmFnbWVudHMuaGlnaGxlZkVhciA9IHRoaXMuaGlnaGxlZkVhckZyYWdtZW50O1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGRlbGV0ZSB0aGlzLmZyYWdtZW50cy5oaWdobGVmRWFyO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Z2V0IF9hbmltYXRpb25fdHlwZSgpIHtcclxuXHRcdHJldHVybiBcImFjdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyQm9keUZyYWdtZW50O1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgQ2hhcmFjdGVySGFpciBleHRlbmRzIENoYXJhY3RlckhlYWRCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHRnZXQgX2FuaW1hdGlvbl90eXBlKCkge1xyXG5cdFx0cmV0dXJuIFwiYWN0aW9uXCI7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIENoYXJhY3RlckJvZHlGcmFnbWVudH1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBDaGFyYWN0ZXJCb2R5RnJhZ21lbnQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBoYWlyIGNvbG9yIG1peFxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgSGFpckZyYWdtZW50VGV4dHVyZX1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRUZXh0dXJlQ29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gSGFpckZyYWdtZW50VGV4dHVyZTtcclxuXHR9XHJcbn1cclxuXHJcbmNsYXNzIENoYXJhY3RlckZhY2VCYXNlIGV4dGVuZHMgQ2hhcmFjdGVySGVhZEJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblx0Ly9fX2lzX3RleHR1cmUoaykge1xyXG5cdC8vXHRyZXR1cm4gKCEoayA9PSBcImRlbGF5XCIgfHwgayA9PSBcImRlZmF1bHRcIikpO1xyXG5cdC8vfVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXRGcmFtZUNvdW50KGNoYXJhKSB7XHJcblx0XHRyZXR1cm4gY2hhcmEuc2xvdHMuZmFjZS5mcmFnbWVudHMuZmFjZS50ZXh0dXJlc1tjaGFyYS5lbW90aW9uXS5sZW5ndGg7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXREZWxheShjaGFyYSkge1xyXG5cdFx0Y29uc3QgZCA9IHRoaXMuX3Jhd1tjaGFyYS5lbW90aW9uXVtjaGFyYS5lbW90aW9uX2ZyYW1lXS5kZWxheTtcclxuXHRcdGlmIChkICE9IG51bGwpIHsvLyFpc05hTihkKSAmJiBpc0Zpbml0ZShkKVxyXG5cdFx0XHRyZXR1cm4gZDtcclxuXHRcdH1cclxuXHRcdHJldHVybiA2MDtcclxuXHR9XHJcbn1cclxuY2xhc3MgQ2hhcmFjdGVyRmFjZSBleHRlbmRzIENoYXJhY3RlckZhY2VCYXNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHRnZXQgX2FuaW1hdGlvbl90eXBlKCkge1xyXG5cdFx0cmV0dXJuIFwiZW1vdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJGYWNlRnJhZ21lbnR9XHJcblx0ICovXHJcblx0Z2V0IEZyYWdtZW50Q29uc3RydWN0b3IoKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyRmFjZUZyYWdtZW50O1xyXG5cdH1cclxufVxyXG5jbGFzcyBDaGFyYWN0ZXJGYWNlQWNjIGV4dGVuZHMgQ2hhcmFjdGVyRmFjZUJhc2Uge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0c3VwZXIoKTtcclxuXHR9XHJcblxyXG5cdGdldCBfYW5pbWF0aW9uX3R5cGUoKSB7XHJcblx0XHRyZXR1cm4gXCJlbW90aW9uXCI7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcmV0dXJucyB7dHlwZW9mIENoYXJhY3RlckZhY2VGcmFnbWVudH1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBDaGFyYWN0ZXJGYWNlRnJhZ21lbnQ7XHJcblx0fVxyXG59XHJcblxyXG5jbGFzcyBDaGFyYWN0ZXJUYW1pbmdNb2IgZXh0ZW5kcyBDaGFyYWN0ZXJBcHBlYXJhbmNlIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHN1cGVyKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGdldCB0eXBlKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3Jhdy5pbmZvLnRhbWluZ01vYjtcclxuXHR9XHJcblxyXG5cdGdldCBhY3Rpb25NYXAoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fcmF3LmNoYXJhY3RlckFjdGlvbjtcclxuXHR9XHJcblxyXG5cdGdldCBlbW90aW9uTWFwKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX3Jhdy5jaGFyYWN0ZXJFbW90aW9uO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtWZWMyfSByZWxhdGl2ZVxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlfSBib2R5XHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtWZWMyfVxyXG5cdCAqL1xyXG5cdGFkal9wb3MocmVsYXRpdmUsIGJvZHksIGNoYXJhKSB7XHJcblx0XHRjb25zdCBmcmFnID0gdGhpcy5mcmFnbWVudHNbMF07Ly9kZWZhdWx0XHJcblx0XHRpZiAoZnJhZykge1xyXG5cdFx0XHRjb25zdCB0bSA9IGZyYWcuZ2V0VGV4dHVyZShjaGFyYSk7XHJcblx0XHRcdGlmICh0bSkge1xyXG5cdFx0XHRcdHJldHVybiByZWxhdGl2ZS5wbHVzKHRtLm5hdmVsLm1pbnVzKGJvZHkubmF2ZWwpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJlbGF0aXZlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJBbmltYXRpb25CYXNlfSBjaGFyYVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0RnJhbWVDb3VudChjaGFyYSkge1xyXG5cdFx0cmV0dXJuIGNoYXJhLnNsb3RzLmJvZHkuZnJhZ21lbnRzLmJvZHkudGV4dHVyZXNbY2hhcmEuX3JpZGVfYWN0aW9uXS5sZW5ndGg7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAb3ZlcnJpZGVcclxuXHQgKiBAcGFyYW0ge0NoYXJhY3RlckFuaW1hdGlvbkJhc2V9IGNoYXJhXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXREZWxheShjaGFyYSkge1xyXG5cdFx0Y29uc3QgZCA9IE1hdGgudHJ1bmModGhpcy5fcmF3W2NoYXJhLl9yaWRlX2FjdGlvbl1bY2hhcmEuYWN0aW9uX2ZyYW1lXS5kZWxheSk7Ly8/PyBfcmlkZV9hY3Rpb25fZnJhbWUgPT4gYWN0aW9uX2ZyYW1lXHJcblx0XHRpZiAoTnVtYmVyLmlzU2FmZUludGVnZXIoZCkpIHtcclxuXHRcdFx0cmV0dXJuIGQ7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gMTIwO1xyXG5cdH1cclxuXHJcblx0Z2V0IF9hbmltYXRpb25fdHlwZSgpIHtcclxuXHRcdHJldHVybiBcIl9yaWRlX2FjdGlvblwiO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQG92ZXJyaWRlXHJcblx0ICogQHJldHVybnMge3R5cGVvZiBDaGFyYWN0ZXJUYW1pbmdNb2JGcmFnbWVudH1cclxuXHQgKi9cclxuXHRnZXQgRnJhZ21lbnRDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBDaGFyYWN0ZXJUYW1pbmdNb2JGcmFnbWVudDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBvdmVycmlkZVxyXG5cdCAqIEByZXR1cm5zIHt0eXBlb2YgRnJhZ21lbnRUZXh0dXJlfVxyXG5cdCAqL1xyXG5cdGdldCBGcmFnbWVudFRleHR1cmVDb25zdHJ1Y3RvcigpIHtcclxuXHRcdHJldHVybiBGcmFnbWVudFRleHR1cmU7XHJcblx0fVxyXG59XHJcblxyXG5cclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDAwMCddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckJvZHk7XHRcdC8vXHRib2R5XHRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMDAxJ10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVySGVhZDtcdFx0Ly9cdGVsZkVhclx0XHRcdC0+IENoYXJhY3RlckhlYWRCYXNlIC0+IENoYXJhY3RlckhlYWRcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDAwMiddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckZhY2U7XHRcdC8vXHRGYWNlXHRcdFx0LT4gQ2hhcmFjdGVySGVhZEJhc2UgLT4gQ2hhcmFjdGVyRmFjZUJhc2UgLT4gQ2hhcmFjdGVyRmFjZVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMDAzJ10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVySGFpcjtcdFx0Ly9cdEhhaXJcdFx0XHQtPiBDaGFyYWN0ZXJIZWFkQmFzZSAtPiBDaGFyYWN0ZXJIYWlyXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAwMDQnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJIYWlyO1x0XHQvL1x0SGFpclx0XHRcdC0+IENoYXJhY3RlckhlYWRCYXNlIC0+IENoYXJhY3RlckhhaXJcclxuXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDAnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdENhcFx0XHRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTAxJ10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRmFjZUFjYztcdFx0Ly9cdGFjY2Vzc29yeUZhY2VcdC0+IENoYXJhY3RlckhlYWRCYXNlIC0+IENoYXJhY3RlckZhY2VCYXNlIC0+IENoYXJhY3RlckZhY2VBY2NcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwMiddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0YWNjZXNzb3J5RXllc1x0LT4gQ2hhcmFjdGVyRXF1aXBcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwMyddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0YWNjZXNzb3J5RWFyc1x0LT4gQ2hhcmFjdGVyRXF1aXBcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwNCddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0Q29hdFx0XHRcdC0+IENoYXJhY3RlckJvZHlcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwNSddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0TG9uZ2NvYXRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTA2J10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRXF1aXA7XHRcdC8vXHRQYW50c1x0XHRcdC0+IENoYXJhY3RlckJvZHlcclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDEwNyddLkZyYWdtZW50VHlwZSA9IENoYXJhY3RlckVxdWlwO1x0XHQvL1x0U2hvZXNcdFx0XHQtPiBDaGFyYWN0ZXJCb2R5XHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMDgnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdEdsb3ZlXHRcdFx0LT4gQ2hhcmFjdGVyQm9keVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTA5J10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRXF1aXA7XHRcdC8vXHRTaGllbGRcdFx0XHQtPiBDaGFyYWN0ZXJCb2R5XHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm9bJzAxMTAnXS5GcmFnbWVudFR5cGUgPSBDaGFyYWN0ZXJFcXVpcDtcdFx0Ly9cdENhcGVcdFx0XHQtPiBDaGFyYWN0ZXJCb2R5XHJcblxyXG5JdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvWycwMTcwJ10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyRXF1aXBDYXNoV2VhcG9uO1x0Ly9cdGNhc2gtd2VhcG9uXHQtPiBDaGFyYWN0ZXJFcXVpcFxyXG5cclxuSXRlbUNhdGVnb3J5SW5mby5faW5mb1snMDE5J10uRnJhZ21lbnRUeXBlID0gQ2hhcmFjdGVyVGFtaW5nTW9iO1x0Ly9cdFRhbWluZ01vYlx0XHQtPiBDaGFyYWN0ZXJUYW1pbmdNb2JcclxuXHJcblxyXG5jbGFzcyBDaGFyYWN0ZXJTbG90cyB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRcdFxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZVtdfSAqL1xyXG5cdFx0dGhpcy5fb3JkZXJlZF9zbG90ID0gW107XHJcblxyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQm9keX0gKi9cclxuXHRcdHRoaXMuYm9keSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJIZWFkfSAqL1xyXG5cdFx0dGhpcy5oZWFkID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckZhY2V9ICovXHJcblx0XHR0aGlzLmZhY2UgPSBudWxsO1xyXG5cclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckhhaXJ9ICovXHJcblx0XHR0aGlzLmhhaXIgPSBudWxsO1xyXG5cdFx0XHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckhhaXJ9ICovXHJcblx0XHR0aGlzLl9oYWlyMiA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gMH4xLjAgKi9cclxuXHRcdHRoaXMuX2hhaXJNaXgyID0gbnVsbDtcclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVySGFpcn0gKi9cclxuXHRcdHRoaXMuX2hhaXIzID0gbnVsbDtcclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAwfjEuMCAqL1xyXG5cdFx0dGhpcy5faGFpck1peDMgPSBudWxsO1xyXG5cclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDEgKi9cclxuXHRcdHRoaXMuY2FwID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckZhY2VBY2N9IC0gMiAqL1xyXG5cdFx0dGhpcy5hY2Nlc3NvcnlGYWNlID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDMqL1xyXG5cdFx0dGhpcy5hY2Nlc3NvcnlFeWVzID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDQgKi9cclxuXHRcdHRoaXMuYWNjZXNzb3J5RWFycyA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSA1ICovXHJcblx0XHR0aGlzLmNvYXQgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyRXF1aXB9IC0gNSAqL1xyXG5cdFx0dGhpcy5sb25nY29hdCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSA2ICovXHJcblx0XHR0aGlzLnBhbnRzID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDcgKi9cclxuXHRcdHRoaXMuc2hvZXMgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyRXF1aXB9IC0gOCAqL1xyXG5cdFx0dGhpcy5nbG92ZSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJFcXVpcH0gLSA5ICovXHJcblx0XHR0aGlzLmNhcGUgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyRXF1aXB9IC0gMTAgKi9cclxuXHRcdHRoaXMuc2hpZWxkID0gbnVsbDtcclxuXHJcblx0XHQvKiogQHR5cGUge0NoYXJhY3RlckVxdWlwfSAtIDExICovXHJcblx0XHR0aGlzLndlYXBvbiA9IG51bGw7XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyVGFtaW5nTW9ifSAqL1xyXG5cdFx0dGhpcy50YW1pbmdNb2IgPSBudWxsO1xyXG5cdFx0XHJcblx0XHR7XHJcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIl9vcmRlcmVkX3Nsb3RcIiwge1xyXG5cdFx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuXHRcdFx0XHR3cml0YWJsZTogdHJ1ZSxcclxuXHRcdFx0XHRlbnVtZXJhYmxlOiBmYWxzZSxcclxuXHRcdFx0XHR2YWx1ZTogW11cclxuXHRcdFx0fSk7XHJcblx0XHRcdFxyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfaGFpclwiLCB7XHJcblx0XHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXHJcblx0XHRcdFx0dmFsdWU6IG51bGwsXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJoYWlyXCIsIHtcclxuXHRcdFx0XHRlbnVtZXJhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGdldDogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRoaXMuX2hhaXI7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdFx0XHRcdFx0dGhpcy5faGFpciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdFx0XHRcdGlmICh0aGlzLl9oYWlyMiAmJiB0aGlzLl9oYWlyTWl4Mikge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFpckNvbG9yMiA9IHRoaXMuaGFpckNvbG9yMjsvL2ZvcmNlIHJlbG9hZFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFpck1peDIgPSB0aGlzLmhhaXJNaXgyO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGlmICh0aGlzLl9oYWlyMyAmJiB0aGlzLl9oYWlyTWl4Mykge1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFpckNvbG9yMyA9IHRoaXMuaGFpckNvbG9yMzsvL2ZvcmNlIHJlbG9hZFxyXG5cdFx0XHRcdFx0XHRcdHRoaXMuaGFpck1peDMgPSB0aGlzLmhhaXJNaXgzO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0fSk7XHJcblx0XHRcdFxyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfaGFpclwiLCB7XHJcblx0XHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXHJcblx0XHRcdFx0dmFsdWU6IG51bGwsXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfaGFpcjJcIiwge1xyXG5cdFx0XHRcdHdyaXRhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdHZhbHVlOiBudWxsLFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2hhaXJNaXgyXCIsIHtcdC8vIDB+MS4wXHJcblx0XHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXHJcblx0XHRcdFx0dmFsdWU6IG51bGwsXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJfaGFpcjNcIiwge1xyXG5cdFx0XHRcdHdyaXRhYmxlOiB0cnVlLFxyXG5cdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdHZhbHVlOiBudWxsLFxyXG5cdFx0XHR9KTtcclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiX2hhaXJNaXgzXCIsIHtcdC8vIDB+MS4wXHJcblx0XHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdFx0ZW51bWVyYWJsZTogZmFsc2UsXHJcblx0XHRcdFx0dmFsdWU6IG51bGwsXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgX19sb2FkQ29sb3JlZEhhaXIoY29sb3IpIHtcclxuXHRcdGNvbnN0IGlkID0gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldENvbG9ySGFpcklEKHRoaXMuaGFpci5pZCwgY29sb3IpO1xyXG5cdFx0Y29uc3QgY2F0ZUluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldChpZCk7XHJcblxyXG5cdFx0aWYgKGNhdGVJbmZvKSB7XHJcblx0XHRcdGNvbnN0IHVybCA9IGAvQ2hhcmFjdGVyLyR7Y2F0ZUluZm8ucGF0aCArIChjYXRlSW5mby5wYXRoID8gXCIvXCIgOiBcIlwiKSArIGlkfWA7XHJcblx0XHRcdGNvbnN0IHVzZV9jYXRlZ29yeSA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHRcdGxldCBoYWlyID0gbmV3IENoYXJhY3RlckhhaXIoKTtcclxuXHJcblx0XHRcdGF3YWl0IGhhaXIubG9hZCh1cmwsIGlkLCBjYXRlSW5mbywgdXNlX2NhdGVnb3J5KTtcclxuXHJcblx0XHRcdHJldHVybiBoYWlyO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqIEByZXR1cm5zIHtudW1iZXJ9ICovXHJcblx0Z2V0IGhhaXJDb2xvcjIoKSB7XHJcblx0XHRpZiAodGhpcy5faGFpcjIpIHtcclxuXHRcdFx0cmV0dXJuIE51bWJlcihDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0SGFpckNvbG9yKHRoaXMuX2hhaXIyLmlkKSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdHNldCBoYWlyQ29sb3IyKGNvbG9yKSB7XHJcblx0XHRpZiAoIWNvbG9yKSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IobmV3IFR5cGVFcnJvcigpKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0bGV0IGhjMklkID0gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldENvbG9ySGFpcklEKHRoaXMuaGFpci5pZCwgY29sb3IpO1xyXG5cclxuXHRcdGlmICghdGhpcy5faGFpcjIgfHwgaGMySWQgIT0gdGhpcy5faGFpcjIuaWQpIHtcclxuXHRcdFx0aWYgKGhjMklkID09IHRoaXMuX2hhaXIuaWQpIHtcclxuXHRcdFx0XHR0aGlzLl9oYWlyMiA9IG51bGw7XHJcblx0XHRcdFx0dGhpcy5oYWlyTWl4MiA9IDA7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5oYWlyLiRwcm9taXNlX2hhaXIyID0gdGhpcy5fX2xvYWRDb2xvcmVkSGFpcihjb2xvcik7XHJcblxyXG5cdFx0XHRcdHRoaXMuaGFpci4kcHJvbWlzZV9oYWlyMi50aGVuKGhhaXIyID0+IHtcclxuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLmhhaXIuJHByb21pc2VfaGFpcjI7XHJcblxyXG5cdFx0XHRcdFx0dGhpcy5faGFpcjIgPSBoYWlyMjtcclxuXHRcdFx0XHRcdGlmICh0aGlzLl9oYWlyMiAmJiB0aGlzLmhhaXJNaXgyICE9IG51bGwpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5oYWlyTWl4MiA9IHRoaXMuaGFpck1peDI7Ly9mb3JjZSB1cGRhdGVcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vZWxzZSB7XHJcblx0XHRcdFx0XHQvL1x0dGhpcy5oYWlyTWl4MiA9IDA7Ly9kaXNhYmxlXHJcblx0XHRcdFx0XHQvL31cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHQvKiogQHJldHVybnMge251bWJlcn0gMH4xLjAgKi9cclxuXHRnZXQgaGFpck1peDIoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5faGFpck1peDI7XHJcblx0fVxyXG5cdHNldCBoYWlyTWl4Mih2YWx1ZSkge1xyXG5cdFx0dmFsdWUgPSBOdW1iZXIodmFsdWUpO1xyXG5cclxuXHRcdFByb21pc2UucmVzb2x2ZSh0aGlzLmhhaXIuJHByb21pc2VfaGFpcjIpLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHQvKiogQHR5cGUge0NoYXJhY3RlckFwcGVhcmFuY2VCYXNlfSAqL1xyXG5cdFx0XHRsZXQgaXRlbSA9IHRoaXMuX2hhaXIyO1xyXG5cdFx0XHQvKiogQHR5cGUge0NoYXJhY3RlckFwcGVhcmFuY2VCYXNlfSAqL1xyXG5cdFx0XHRsZXQgYmFzZSA9IHRoaXMuaGFpcjtcclxuXHJcblx0XHRcdGlmICghaXRlbSB8fCAhYmFzZSkge1xyXG5cdFx0XHRcdHJldHVybjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Zm9yIChsZXQgaiBpbiBpdGVtLmZyYWdtZW50cykge1xyXG5cdFx0XHRcdGZvciAobGV0IGsgaW4gaXRlbS5mcmFnbWVudHNbal0udGV4dHVyZXMpIHtcclxuXHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgaXRlbS5mcmFnbWVudHNbal0udGV4dHVyZXNba10ubGVuZ3RoOyArK2kpIHtcclxuXHRcdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRcdGxldCBmdCA9IGl0ZW0uZnJhZ21lbnRzW2pdLnRleHR1cmVzW2tdW2ldO1xyXG5cdFx0XHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRcdFx0bGV0IG9yaSA9IGJhc2UuZnJhZ21lbnRzW2pdLnRleHR1cmVzW2tdW2ldO1xyXG5cdFx0XHRcdFx0XHRpZiAob3JpKSB7XHJcblx0XHRcdFx0XHRcdFx0b3JpLmdyYXBoMiA9IGZ0O1xyXG5cdFx0XHRcdFx0XHRcdG9yaS5ncmFwaDIub3BhY2l0eSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdHRoaXMuX2hhaXJNaXgyID0gdmFsdWU7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8qKiBAcmV0dXJucyB7bnVtYmVyfSAwfjEuMCAqL1xyXG5cdGdldCBoYWlyQ29sb3IzKCkge1xyXG5cdFx0aWYgKHRoaXMuX2hhaXIzKSB7XHJcblx0XHRcdHJldHVybiBOdW1iZXIoQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldEhhaXJDb2xvcih0aGlzLl9oYWlyMy5pZCkpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRzZXQgaGFpckNvbG9yMyhjb2xvcikge1xyXG5cdFx0aWYgKCFjb2xvcikge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKG5ldyBUeXBlRXJyb3IoKSk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBoYzNJZCA9IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckhhaXJJRCh0aGlzLmhhaXIuaWQsIGNvbG9yKTtcclxuXHJcblx0XHRpZiAoIXRoaXMuX2hhaXIzIHx8IHRoaXMuX2hhaXIzLmlkICE9IGhjM0lkKSB7XHJcblx0XHRcdGlmICh0aGlzLl9oYWlyLmlkID09IGhjM0lkIHx8IHRoaXMuX2hhaXIyLmlkID09IGhjM0lkKSB7XHJcblx0XHRcdFx0dGhpcy5faGFpcjMgPSBudWxsO1xyXG5cdFx0XHRcdHRoaXMuaGFpck1peDMgPSAwO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuaGFpci4kcHJvbWlzZV9oYWlyMyA9IHRoaXMuX19sb2FkQ29sb3JlZEhhaXIoY29sb3IpO1xyXG5cclxuXHRcdFx0XHR0aGlzLmhhaXIuJHByb21pc2VfaGFpcjMudGhlbihoYWlyMyA9PiB7XHJcblx0XHRcdFx0XHRkZWxldGUgdGhpcy5oYWlyLiRwcm9taXNlX2hhaXIzO1xyXG5cclxuXHRcdFx0XHRcdHRoaXMuX2hhaXIzID0gaGFpcjM7XHJcblx0XHRcdFx0XHRpZiAodGhpcy5faGFpcjMgJiYgdGhpcy5oYWlyTWl4MyAhPSBudWxsKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuaGFpck1peDMgPSB0aGlzLmhhaXJNaXgzOy8vZm9yY2UgdXBkYXRlXHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvL2Vsc2Uge1xyXG5cdFx0XHRcdFx0Ly9cdHRoaXMuaGFpck1peDMgPSAwOy8vZGlzYWJsZVxyXG5cdFx0XHRcdFx0Ly99XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0LyoqIEByZXR1cm5zIHtudW1iZXJ9ICovXHJcblx0Z2V0IGhhaXJNaXgzKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2hhaXJNaXgzO1xyXG5cdH1cclxuXHRzZXQgaGFpck1peDModmFsdWUpIHtcclxuXHRcdHZhbHVlID0gTnVtYmVyKHZhbHVlKTtcclxuXHJcblx0XHRQcm9taXNlLnJlc29sdmUodGhpcy5oYWlyLiRwcm9taXNlX2hhaXIzKS50aGVuKCgpID0+IHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGl0ZW0gPSB0aGlzLl9oYWlyMztcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGJhc2UgPSB0aGlzLmhhaXI7XHJcblxyXG5cdFx0XHRpZiAoIWl0ZW0gfHwgIWJhc2UpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGZvciAobGV0IGogaW4gaXRlbS5mcmFnbWVudHMpIHtcclxuXHRcdFx0XHRmb3IgKGxldCBrIGluIGl0ZW0uZnJhZ21lbnRzW2pdLnRleHR1cmVzKSB7XHJcblx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGl0ZW0uZnJhZ21lbnRzW2pdLnRleHR1cmVzW2tdLmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdFx0XHRsZXQgZnQgPSBpdGVtLmZyYWdtZW50c1tqXS50ZXh0dXJlc1trXVtpXTtcclxuXHRcdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRcdGxldCBvcmkgPSBiYXNlLmZyYWdtZW50c1tqXS50ZXh0dXJlc1trXVtpXTtcclxuXHRcdFx0XHRcdFx0aWYgKG9yaSkge1xyXG5cdFx0XHRcdFx0XHRcdG9yaS5ncmFwaDMgPSBmdDtcclxuXHRcdFx0XHRcdFx0XHRvcmkuZ3JhcGgzLm9wYWNpdHkgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLl9oYWlyTWl4MyA9IHZhbHVlO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvL19fb3JkZXJfc2xvdCgpIHtcclxuXHQvL1x0bGV0IHNsb3RfbWFwID0gbmV3IE1hcCgpO1xyXG5cdC8vXHJcblx0Ly9cdGZvciAobGV0IGkgaW4gdGhpcykge1xyXG5cdC8vXHRcdGxldCBlcXVpcCA9IHRoaXNbaV07XHJcblx0Ly9cclxuXHQvL1x0XHRlcXVpcC5jc1xyXG5cdC8vXHR9XHJcblx0Ly99XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9IGxvYWRlZEVxdWlwXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHVzZV9jYXRlZ29yeSAtIGNhdGVnb3J5IHdoaWNoIHVzZWQgb2YgY2FzaC13ZWFwb25cclxuXHQgKi9cclxuXHRhc3luYyBfdXNlKGlkLCBsb2FkZWRFcXVpcCwgdXNlX2NhdGVnb3J5KSB7XHJcblx0XHRpZiAoIWlkKSB7XHJcblx0XHRcdGRlYnVnZ2VyXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGNvbnN0IGNhdGVJbmZvID0gSXRlbUNhdGVnb3J5SW5mby5nZXQoaWQpO1xyXG5cclxuXHRcdGlmIChjYXRlSW5mbykge1xyXG5cdFx0XHRsZXQgdXJsID0gYC9DaGFyYWN0ZXIvJHtjYXRlSW5mby5wYXRoICsgKGNhdGVJbmZvLnBhdGggPyBcIi9cIjpcIlwiKSArIGlkfWA7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9ICovXHJcblx0XHRcdGxldCBpdGVtO1xyXG5cclxuXHRcdFx0aWYgKGxvYWRlZEVxdWlwIGluc3RhbmNlb2YgQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2UpIHtcclxuXHRcdFx0XHRhbGVydChcIkNoYXJhY3RlclNsb3RzICMgX3VzZTogcGFyYW0gbG9hZGVkRXF1aXAgPz9cIik7XHJcblx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0aXRlbSA9IGxvYWRlZEVxdWlwO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGlmIChsb2FkZWRFcXVpcCkge1xyXG5cdFx0XHRcdFx0YWxlcnQoXCJDaGFyYWN0ZXJTbG90cyAjIF91c2U6IHBhcmFtIGxvYWRlZEVxdWlwID8/XCIpO1xyXG5cdFx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGNvbnN0IGZyYWdtZW50VHlwZSA9IGNhdGVJbmZvLkZyYWdtZW50VHlwZSB8fCBDaGFyYWN0ZXJFcXVpcDtcclxuXHJcblx0XHRcdFx0aXRlbSA9IG5ldyBmcmFnbWVudFR5cGUoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvKiogX3VzZV9sb2FkZWRfZXF1aXAgKi9cclxuXHRcdFx0aWYgKDApIHtcclxuXHRcdFx0XHRpZiAodGhpc1tjYXRlSW5mby5zbG90XSkge1xyXG5cdFx0XHRcdFx0dGhpc1tjYXRlSW5mby5zbG90XS5fdW5sb2FkKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRoaXNbY2F0ZUluZm8uc2xvdF0gPSBpdGVtO1xyXG5cclxuXHRcdFx0XHR0aGlzLl9vcmRlcmVkX3Nsb3RbaXRlbS5zbG90X29yZGVyXSA9IGl0ZW07XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGxldCBpc19leGlzdCA9IGxvYWRlZEVxdWlwIHx8IGF3YWl0IGl0ZW0ubG9hZCh1cmwsIGlkLCBjYXRlSW5mbywgdXNlX2NhdGVnb3J5KTtcclxuXHRcdFx0aWYgKGlzX2V4aXN0KSB7XHJcblx0XHRcdFx0LyoqIF91c2VfbG9hZGVkX2VxdWlwICovXHJcblx0XHRcdFx0aWYgKDEpIHtcclxuXHRcdFx0XHRcdGlmICh0aGlzW2NhdGVJbmZvLnNsb3RdKSB7XHJcblx0XHRcdFx0XHRcdHRoaXNbY2F0ZUluZm8uc2xvdF0uX3VubG9hZCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0dGhpc1tjYXRlSW5mby5zbG90XSA9IGl0ZW07XHJcblxyXG5cdFx0XHRcdFx0dGhpcy5fb3JkZXJlZF9zbG90W2l0ZW0uc2xvdF9vcmRlcl0gPSBpdGVtO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oXCJpdGVtKFwiICsgaWQgKyBcIikgaXMgbm90IGV4aXN0XCIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRyZXR1cm4gaXRlbTtcclxuXHRcdH1cclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0X3VudXNlKGlkKSB7XHJcblx0XHRpZiAoIWlkKSB7XHJcblx0XHRcdGRlYnVnZ2VyXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBjYXRlSW5mbywgZXF1aXA7XHJcblxyXG5cdFx0aWYgKGlkIGluc3RhbmNlb2YgQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2UpIHtcclxuXHRcdFx0ZXF1aXAgPSBpZDtcclxuXHRcdFx0aWQgPSBlcXVpcC5pZDtcclxuXHRcdFx0Y2F0ZUluZm8gPSBlcXVpcC5jYXRlZ29yeUluZm87XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Y2F0ZUluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldChpZCk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IHNsb3ROYW1lID0gY2F0ZUluZm8uc2xvdDtcclxuXHJcblx0XHRpZiAoc2xvdE5hbWUgIT0gXCJoZWFkXCIgJiYgc2xvdE5hbWUgIT0gXCJib2R5XCIpIHtcclxuXHRcdFx0aWYgKHRoaXNbc2xvdE5hbWVdICYmIHRoaXNbc2xvdE5hbWVdLmlkID09IGlkKSB7XHJcblx0XHRcdFx0ZXF1aXAgPSB0aGlzW3Nsb3ROYW1lXTtcclxuXHRcdFx0XHRmb3IgKGxldCBzbG90IGluIGVxdWlwLmlzbG90KSB7XHJcblx0XHRcdFx0XHRsZXQgb3JkZXIgPSBlcXVpcC5pc2xvdFtzbG90XTtcclxuXHRcdFx0XHRcdGlmICh0aGlzLl9vcmRlcmVkX3Nsb3Rbb3JkZXJdKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMuX29yZGVyZWRfc2xvdFtvcmRlcl0uX3VubG9hZCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0ZGVsZXRlIHRoaXMuX29yZGVyZWRfc2xvdFtvcmRlcl07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHRoaXNbc2xvdE5hbWVdID0gbnVsbDtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRfY2xlYXIoKSB7XHJcblx0XHQvL3RoaXMuYm9keSA9IG51bGw7XHJcblx0XHQvL3RoaXMuaGVhZCA9IG51bGw7XHJcblx0XHR0aGlzLmZhY2UgPSBudWxsO1xyXG5cdFx0dGhpcy5oYWlyID0gbnVsbDtcclxuXHRcdHRoaXMuY2FwID0gbnVsbDtcclxuXHRcdHRoaXMuYWNjZXNzb3J5RmFjZSA9IG51bGw7XHJcblx0XHR0aGlzLmFjY2Vzc29yeUV5ZXMgPSBudWxsO1xyXG5cdFx0dGhpcy5hY2Nlc3NvcnlFYXJzID0gbnVsbDtcclxuXHRcdHRoaXMuY29hdCA9IG51bGw7XHJcblx0XHR0aGlzLmxvbmdjb2F0ID0gbnVsbDtcclxuXHRcdHRoaXMucGFudHMgPSBudWxsO1xyXG5cdFx0dGhpcy5zaG9lcyA9IG51bGw7XHJcblx0XHR0aGlzLmdsb3ZlID0gbnVsbDtcclxuXHRcdHRoaXMuY2FwZSA9IG51bGw7XHJcblx0XHR0aGlzLnNoaWVsZCA9IG51bGw7XHJcblxyXG5cdFx0Ly90ZW1wXHJcblx0XHRsZXQgaGVhZCA9IHRoaXMuaGVhZDtcclxuXHRcdGxldCBib2R5ID0gdGhpcy5ib2R5O1xyXG5cclxuXHRcdC8vY2xlYXJcclxuXHRcdHRoaXMuX29yZGVyZWRfc2xvdCA9IFtdO1xyXG5cclxuXHRcdC8vcmVzdG9yZVxyXG5cdFx0aWYgKGhlYWQpIHtcclxuXHRcdFx0dGhpcy5fb3JkZXJlZF9zbG90W2hlYWQuc2xvdF9vcmRlcl0gPSBoZWFkO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGJvZHkpIHtcclxuXHRcdFx0dGhpcy5fb3JkZXJlZF9zbG90W2JvZHkuc2xvdF9vcmRlcl0gPSBib2R5O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0X3N0cmluZ2lmeSgpIHtcclxuXHRcdGxldCBzbG90cyA9IFtcImNcIl07XHJcblx0XHRcdFxyXG5cdFx0aWYgKHRoaXMuYm9keSkgc2xvdHMucHVzaCh0aGlzLmJvZHkuaWQpO1xyXG5cdFx0aWYgKHRoaXMuaGVhZCkgc2xvdHMucHVzaCh0aGlzLmhlYWQuaWQpO1xyXG5cdFx0aWYgKHRoaXMuZmFjZSkgc2xvdHMucHVzaCh0aGlzLmZhY2UuaWQgKyBcInxcIiArIHRoaXMuZmFjZS5pZCk7XHJcblx0XHRpZiAodGhpcy5oYWlyKSB7XHJcblx0XHRcdGxldCBoYSA9IFtdO1xyXG5cdFx0XHRoYS5wdXNoKHRoaXMuaGFpci5pZCk7XHJcblx0XHRcdGlmICh0aGlzLmhhaXJDb2xvcjIgJiYgdGhpcy5oYWlyTWl4MiA+IDApIGhhLnB1c2godGhpcy5oYWlyQ29sb3IyICsgXCIlXCIgKyBNYXRoLnRydW5jKHRoaXMuaGFpck1peDIgKiAxMDApKTtcclxuXHRcdFx0aWYgKHRoaXMuaGFpckNvbG9yMyAmJiB0aGlzLmhhaXJNaXgzID4gMCkgaGEucHVzaCh0aGlzLmhhaXJDb2xvcjMgKyBcIiVcIiArIE1hdGgudHJ1bmModGhpcy5oYWlyTWl4MyAqIDEwMCkpO1xyXG5cdFx0XHRzbG90cy5wdXNoKGhhLmpvaW4oXCJ8XCIpKTtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmNhcCkgc2xvdHMucHVzaCh0aGlzLmNhcC5pZCk7XHJcblx0XHRpZiAodGhpcy5hY2Nlc3NvcnlGYWNlKSBzbG90cy5wdXNoKHRoaXMuYWNjZXNzb3J5RmFjZS5pZCk7XHJcblx0XHRpZiAodGhpcy5hY2Nlc3NvcnlFeWVzKSBzbG90cy5wdXNoKHRoaXMuYWNjZXNzb3J5RXllcy5pZCk7XHJcblx0XHRpZiAodGhpcy5hY2Nlc3NvcnlFYXJzKSBzbG90cy5wdXNoKHRoaXMuYWNjZXNzb3J5RWFycy5pZCk7XHJcblx0XHRpZiAodGhpcy5jb2F0KSBzbG90cy5wdXNoKHRoaXMuY29hdC5pZCk7XHJcblx0XHRpZiAodGhpcy5sb25nY29hdCkgc2xvdHMucHVzaCh0aGlzLmxvbmdjb2F0LmlkKTtcclxuXHRcdGlmICh0aGlzLnBhbnRzKSBzbG90cy5wdXNoKHRoaXMucGFudHMuaWQpO1xyXG5cdFx0aWYgKHRoaXMuc2hvZXMpIHNsb3RzLnB1c2godGhpcy5zaG9lcy5pZCk7XHJcblx0XHRpZiAodGhpcy5nbG92ZSkgc2xvdHMucHVzaCh0aGlzLmdsb3ZlLmlkKTtcclxuXHRcdGlmICh0aGlzLnNoaWVsZCkgc2xvdHMucHVzaCh0aGlzLnNoaWVsZC5pZCk7XHJcblx0XHRpZiAodGhpcy5jYXBlKSBzbG90cy5wdXNoKHRoaXMuY2FwZS5pZCk7XHJcblx0XHRpZiAodGhpcy53ZWFwb24pIHNsb3RzLnB1c2godGhpcy53ZWFwb24uaWQpO1xyXG5cclxuXHRcdHJldHVybiBzbG90cy5qb2luKFwiLFwiKTtcclxuXHR9XHJcblxyXG5cdHRvSlNPTigpIHtcclxuXHRcdGxldCBzbG90cyA9IFtdO1xyXG5cclxuXHRcdGlmICh0aGlzLmJvZHkpIHNsb3RzLnB1c2godGhpcy5ib2R5KTtcclxuXHRcdGlmICh0aGlzLmhlYWQpIHNsb3RzLnB1c2godGhpcy5oZWFkKTtcclxuXHRcdGlmICh0aGlzLmZhY2UpIHNsb3RzLnB1c2godGhpcy5mYWNlKTtcclxuXHRcdGlmICh0aGlzLmhhaXIpIHNsb3RzLnB1c2godGhpcy5oYWlyKTtcclxuXHRcdC8vaWYgKHRoaXMuX2hhaXIyKSBzbG90cy5wdXNoKHRoaXMuX2hhaXIyKTtcclxuXHRcdC8vaWYgKHRoaXMuX2hhaXIzKSBzbG90cy5wdXNoKHRoaXMuX2hhaXIzKTtcclxuXHRcdGlmICh0aGlzLmNhcCkgc2xvdHMucHVzaCh0aGlzLmNhcCk7XHJcblx0XHRpZiAodGhpcy5hY2Nlc3NvcnlGYWNlKSBzbG90cy5wdXNoKHRoaXMuYWNjZXNzb3J5RmFjZSk7XHJcblx0XHRpZiAodGhpcy5hY2Nlc3NvcnlFeWVzKSBzbG90cy5wdXNoKHRoaXMuYWNjZXNzb3J5RXllcyk7XHJcblx0XHRpZiAodGhpcy5hY2Nlc3NvcnlFYXJzKSBzbG90cy5wdXNoKHRoaXMuYWNjZXNzb3J5RWFycyk7XHJcblx0XHRpZiAodGhpcy5jb2F0KSBzbG90cy5wdXNoKHRoaXMuY29hdCk7XHJcblx0XHRpZiAodGhpcy5sb25nY29hdCkgc2xvdHMucHVzaCh0aGlzLmxvbmdjb2F0KTtcclxuXHRcdGlmICh0aGlzLnBhbnRzKSBzbG90cy5wdXNoKHRoaXMucGFudHMpO1xyXG5cdFx0aWYgKHRoaXMuc2hvZXMpIHNsb3RzLnB1c2godGhpcy5zaG9lcyk7XHJcblx0XHRpZiAodGhpcy5nbG92ZSkgc2xvdHMucHVzaCh0aGlzLmdsb3ZlKTtcclxuXHRcdGlmICh0aGlzLnNoaWVsZCkgc2xvdHMucHVzaCh0aGlzLnNoaWVsZCk7XHJcblx0XHRpZiAodGhpcy5jYXBlKSBzbG90cy5wdXNoKHRoaXMuY2FwZSk7XHJcblx0XHRpZiAodGhpcy53ZWFwb24pIHNsb3RzLnB1c2godGhpcy53ZWFwb24pO1xyXG5cclxuXHRcdHJldHVybiBzbG90cztcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIHJldHVybnM6IFtmYWNlLCBoYWlyLCBjYXAsIC4uLiwgd2VhcG9uXVxyXG5cdCAqL1xyXG5cdCplbnVtZXJhdGUoKSB7XHJcblx0XHRpZiAodGhpcy5mYWNlKSB5aWVsZCB0aGlzLmZhY2U7XHJcblx0XHRpZiAodGhpcy5oYWlyKSB5aWVsZCB0aGlzLmhhaXI7XHJcblxyXG5cdFx0eWllbGQqIHRoaXMuZW51bWVyYXRlX2VxdWlwKCk7XHJcblx0fVxyXG5cdCplbnVtZXJhdGVfZXF1aXAoKSB7XHJcblx0XHRpZiAodGhpcy5jYXApIHlpZWxkIHRoaXMuY2FwO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RmFjZSkgeWllbGQgdGhpcy5hY2Nlc3NvcnlGYWNlO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RXllcykgeWllbGQgdGhpcy5hY2Nlc3NvcnlFeWVzO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RWFycykgeWllbGQgdGhpcy5hY2Nlc3NvcnlFYXJzO1xyXG5cdFx0aWYgKHRoaXMuY29hdCkgeWllbGQgdGhpcy5jb2F0O1xyXG5cdFx0aWYgKHRoaXMubG9uZ2NvYXQpIHlpZWxkIHRoaXMubG9uZ2NvYXQ7XHJcblx0XHRpZiAodGhpcy5wYW50cykgeWllbGQgdGhpcy5wYW50cztcclxuXHRcdGlmICh0aGlzLnNob2VzKSB5aWVsZCB0aGlzLnNob2VzO1xyXG5cdFx0aWYgKHRoaXMuZ2xvdmUpIHlpZWxkIHRoaXMuZ2xvdmU7XHJcblx0XHRpZiAodGhpcy5zaGllbGQpIHlpZWxkIHRoaXMuc2hpZWxkO1xyXG5cdFx0aWYgKHRoaXMuY2FwZSkgeWllbGQgdGhpcy5jYXBlO1xyXG5cdFx0aWYgKHRoaXMud2VhcG9uKSB5aWVsZCB0aGlzLndlYXBvbjtcclxuXHR9XHJcblx0KmVudW1lcmF0ZV9mYWNlKCkge1xyXG5cdFx0aWYgKHRoaXMuZmFjZSkgeWllbGQgdGhpcy5mYWNlO1xyXG5cdFx0aWYgKHRoaXMuYWNjZXNzb3J5RmFjZSkgeWllbGQgdGhpcy5hY2Nlc3NvcnlGYWNlO1xyXG5cdH1cclxufVxyXG5cclxuY2xhc3MgQ2hhcmFjdGVyQ2hhbmdlTG9nIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdC8qKiBAdHlwZSB7XCJodW1hblwifFwiZWxmXCJ8XCJsZWZcInxcImhpZ2hsZWZcIn0gKi9cclxuXHRcdHRoaXMuZWFyID0gdW5kZWZpbmVkO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nW119ICovXHJcblx0XHR0aGlzLnVzZUVxdWlwID0gW107XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmdbXX0gKi9cclxuXHRcdHRoaXMudW51c2VFcXVpcCA9IFtdO1xyXG5cdFx0XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gLSBoYWlyMiBpZCAqL1xyXG5cdFx0dGhpcy5oYWlyMiA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuaGFpck1peDIgPSB1bmRlZmluZWQ7XHJcblxyXG5cdFx0Ly8vKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdC8vdGhpcy5oYWlyMyA9IHVuZGVmaW5lZDtcclxuXHJcblx0XHQvLy8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0Ly90aGlzLmhhaXJNaXgzID0gdW5kZWZpbmVkO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSB3ZWFwb24gPT4gZXF1aXAgaWQgKi9cclxuXHRcdHRoaXMud2VhcG9uID0gdW5kZWZpbmVkO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy53ZWFwb25UeXBlID0gdW5kZWZpbmVkO1xyXG5cdH1cclxuXHJcblx0Y2xlYXIoKSB7XHJcblx0XHR0aGlzLmVhciA9IHVuZGVmaW5lZDtcclxuXHRcdHRoaXMudXNlRXF1aXAgPSBbXTtcclxuXHRcdHRoaXMudW51c2VFcXVpcCA9IFtdO1xyXG5cdFx0dGhpcy5oYWlyMiA9IHVuZGVmaW5lZDtcclxuXHRcdHRoaXMuaGFpck1peDIgPSB1bmRlZmluZWQ7XHJcblx0XHQvL3RoaXMuaGFpcjMgPSB1bmRlZmluZWQ7XHJcblx0XHQvL3RoaXMuaGFpck1peDMgPSB1bmRlZmluZWQ7XHJcblx0XHR0aGlzLndlYXBvblR5cGUgPSB1bmRlZmluZWQ7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ2hhcmFjdGVyQW5pbWF0aW9uQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHR0aGlzLl8kZGlydHkgPSAwOy8vZm9yY2UgdXBkYXRlIHZ1ZVxyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAtIOacquWujOaIkCAqL1xyXG5cdFx0dGhpcy5qb2IgPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9IC0g5pyq5a6M5oiQICovXHJcblx0XHR0aGlzLnN1YkpvYiA9IG51bGw7XHJcblxyXG5cclxuXHRcdC8qKiBAdHlwZSB7QWN0aW9uQW5pbWF0aW9ufSAqL1xyXG5cdFx0dGhpcy5hY3RhbmkgPSBuZXcgQWN0aW9uQW5pbWF0aW9uKCk7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IC0gYW5pbWF0aW9uIHNwZWVkIHJhdGUgKi9cclxuXHRcdHRoaXMuc3BlZWQgPSAxO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Ym9vbGVhbn0gKi9cclxuXHRcdHRoaXMuZml4ZWRfc3BlZWQgPSBmYWxzZTtcclxuXHJcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59IC0gcGF1c2UgYW5pbWF0aW9uICovXHJcblx0XHR0aGlzLnBhdXNlID0gZmFsc2U7XHJcblxyXG5cclxuXHRcdHRoaXMuaGlkZUJvZHkgPSBmYWxzZTtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuX3JpZGVfYWN0aW9uID0gXCJzdGFuZDFcIjtcclxuXHJcblx0XHQvL1x0YWN0aW9uXHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLl9hY3Rpb24gPSBcInN0YW5kMVwiO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdFx0dGhpcy5fYWN0aW9uX2ZyYW1lID0gMDtcclxuXHJcblx0XHQvL1x0ZW1vdGlvblxyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy5fZW1vdGlvbiA9IFwiYmxpbmtcIjtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMuX2Vtb3Rpb25fZnJhbWUgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdFx0dGhpcy5fZW1vdGlvbl90aW1lID0gMDtcclxuXHJcblx0XHQvL1xyXG5cclxuXHRcdHRoaXMuX2dlbmVyYXRvcl9lbW90aW9uX2ZyYW1lID0gdGhpcy5lbW90aW9uX2ZyYW1lX3NlcXVlbmNlX2dlbmVyYXRvcigzLCAwKTsvL1swLDEsMl0ubGVuZ3RoXHJcblx0XHRcclxuXHRcdHRoaXMuYmxpbmtSYXRlID0gMC4wMTU7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJTbG90c30gKi9cclxuXHRcdHRoaXMuc2xvdHMgPSBuZXcgQ2hhcmFjdGVyU2xvdHMoKTtcclxuXHJcblx0XHQvKipcclxuXHRcdCAqIGlzIHJlcXVpcmUgdXBkYXRlIHJlbmRlciBkYXRhXHJcblx0XHQgKiBAdHlwZSB7Ym9vbGVhbn1cclxuXHRcdCAqL1xyXG5cdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlID0gdHJ1ZTtcclxuXHJcblx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZVtdfSAqL1xyXG5cdFx0dGhpcy5fX2ZyYWdfbGlzdCA9IFtdO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQ2hhbmdlTG9nfSAqKi9cclxuXHRcdHRoaXMuJCRjaGFuZ2VMb2cgPSBuZXcgQ2hhcmFjdGVyQ2hhbmdlTG9nKCk7XHJcblx0fVxyXG5cclxuXHRfY2xvbmUoKSB7XHJcblx0XHRhbGVydCh0aGlzLmNvbnN0cnVjdG9yLm5hbWUgKyBcIjo6X2Nsb25lXCIpO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7Q2hhcmFjdGVyQW5pbWF0aW9uQmFzZX0gKi9cclxuXHRcdGxldCBuYyA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKCk7Ly9ub3QgbXVzdCBDaGFyYWN0ZXJSZW5kZXJcclxuXHRcdGlmICghbmMpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRuYy5zcGVlZCA9IDA7XHJcblxyXG5cdFx0bmMueCA9IHRoaXMueDtcclxuXHRcdG5jLnkgPSB0aGlzLnk7XHJcblx0XHRuYy5hbmdsZSA9IHRoaXMuYW5nbGU7XHJcblxyXG5cdFx0bmMuYWN0aW9uID0gdGhpcy5hY3Rpb247XHJcblx0XHRuYy5hY3Rpb25fZnJhbWUgPSB0aGlzLmFjdGlvbl9mcmFtZTtcclxuXHJcblx0XHRuYy5lbW90aW9uID0gdGhpcy5fZW1vdGlvbjtcclxuXHRcdG5jLmVtb3Rpb25fZnJhbWUgPSB0aGlzLmVtb3Rpb25fZnJhbWU7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLnNsb3RzKSB7XHJcblx0XHRcdGxldCBpdGVtID0gdGhpcy5zbG90c1tpXTtcclxuXHRcdFx0aWYgKGl0ZW0pIHtcclxuXHRcdFx0XHRuYy5zbG90c1tpXSA9IHRoaXMuc2xvdHNbaV07Ly9ub3QgbmVlZCBjb2xuZSA/XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBuYztcclxuXHR9XHJcblx0XHRcclxuXHRfd2FpdEZyYW1lVGV4dHVyZXNMb2FkZWQoKSB7XHJcblx0XHRsZXQgdGFza3MgPSBbXTtcclxuXHRcdGZvciAobGV0IGkgaW4gdGhpcy5zbG90cykge1xyXG5cdFx0XHQvKiogQHR5cGUge0NoYXJhY3RlckFwcGVhcmFuY2VCYXNlfSAqL1xyXG5cdFx0XHRsZXQgaXRlbSA9IHRoaXMuc2xvdHNbaV07XHJcblx0XHRcdGlmIChpdGVtKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgaiBpbiBpdGVtLmZyYWdtZW50cykge1xyXG5cdFx0XHRcdFx0bGV0IGZyYWcgPSBpdGVtLmZyYWdtZW50c1tqXTtcclxuXHRcdFx0XHRcdGxldCBjb3VudCA9IGZyYWcuZ2V0RnJhbWVDb3VudCh0aGlzKTtcclxuXHRcdFx0XHRcdGZvciAobGV0IGsgPSAwOyBrIDwgY291bnQ7ICsraykge1xyXG5cdFx0XHRcdFx0XHRsZXQgZnQgPSBmcmFnLmdldEZyYW1lVGV4dHVyZSh0aGlzLCBrKTtcclxuXHRcdFx0XHRcdFx0aWYgKGZ0ICYmICFmdC5faXNMb2FkZWRfb3JfZG9sb2FkKCkpIHtcclxuXHRcdFx0XHRcdFx0XHR0YXNrcy5wdXNoKGZ0LiRwcm9taXNlKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFByb21pc2UuYWxsKHRhc2tzKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGluaXQgYW5pbWF0aW9uIHN0YXR1c1xyXG5cdCAqL1xyXG5cdGluaXRBbmltYXRpb24oKSB7XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuYWN0aW9uID0gXCJzdGFuZDFcIjtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMuX2FjdGlvbl9mcmFtZSA9IDA7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmVtb3Rpb24gPSBcImJsaW5rXCI7XHJcblx0XHRcdFxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLl9lbW90aW9uX3RpbWUgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdFx0dGhpcy5fZW1vdGlvbl9mcmFtZSA9IDA7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge251bWJlcn0gLSAwfjEgKi9cclxuXHRnZXRTcGVlZCgpIHtcclxuXHRcdGlmICh0aGlzLnBhdXNlKSB7XHJcblx0XHRcdHJldHVybiAwO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHRoaXMuZml4ZWRfc3BlZWQgPyAxIDogdGhpcy5zcGVlZDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB0eXBlIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdGdldCBlbGZFYXIoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnNsb3RzLmhlYWQuZWxmRWFyO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRzZXQgZWxmRWFyKHZhbHVlKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkKSB7XHJcblx0XHRcdHRoaXMuc2xvdHMuaGVhZC5lbGZFYXIgPSB2YWx1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB0eXBlIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdGdldCBsZWZFYXIoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnNsb3RzLmhlYWQubGVmRWFyO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRzZXQgbGVmRWFyKHZhbHVlKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkKSB7XHJcblx0XHRcdHRoaXMuc2xvdHMuaGVhZC5sZWZFYXIgPSB2YWx1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB0eXBlIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdGdldCBoaWdobGVmRWFyKCkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5zbG90cy5oZWFkLmhpZ2hsZWZFYXI7XHJcblx0XHR9XHJcblx0fVxyXG5cdHNldCBoaWdobGVmRWFyKHZhbHVlKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oZWFkKSB7XHJcblx0XHRcdHRoaXMuc2xvdHMuaGVhZC5oaWdobGVmRWFyID0gdmFsdWU7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiogQHJldHVybnMge1wiaHVtYW5cInxcImVsZlwifFwibGVmXCJ8XCJoaWdobGVmXCJ9ICovXHJcblx0Z2V0IGVhcigpIHtcclxuXHRcdGlmICh0aGlzLnNsb3RzLmhlYWQpIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuc2xvdHMuaGVhZC5sZWZFYXIgPyBcImxlZlwiIDogKHRoaXMuc2xvdHMuaGVhZC5lbGZFYXIgPyBcImVsZlwiIDogKHRoaXMuc2xvdHMuaGVhZC5oaWdobGVmRWFyID8gXCJoaWdobGVmXCIgOiBcImh1bWFuXCIpKTtcclxuXHRcdH1cclxuXHR9XHJcblx0c2V0IGVhcih2YWx1ZSkge1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuaGVhZCkge1xyXG5cdFx0XHRpZiAodmFsdWUgPT0gXCJlbGZcIikge1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5lbGZFYXIgPSB0cnVlO1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5sZWZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuaGlnaGxlZkVhciA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cuZWFyID0gdmFsdWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAodmFsdWUgPT0gXCJsZWZcIikge1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5sZWZFYXIgPSB0cnVlO1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5lbGZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuaGlnaGxlZkVhciA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cuZWFyID0gdmFsdWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAodmFsdWUgPT0gXCJoaWdobGVmXCIpIHtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQuZWxmRWFyID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5zbG90cy5oZWFkLmxlZkVhciA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5oaWdobGVmRWFyID0gdHJ1ZTtcclxuXHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmVhciA9IHZhbHVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuc2xvdHMuaGVhZC5lbGZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLnNsb3RzLmhlYWQubGVmRWFyID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5zbG90cy5oZWFkLmhpZ2hsZWZFYXIgPSBmYWxzZTtcclxuXHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmVhciA9IFwiaHVtYW5cIjtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cuZWFyID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0Z2V0IGFjdGlvbigpIHtcclxuXHRcdC8vaWYgKHRoaXMuc2xvdHMudGFtaW5nTW9iKSB7XHJcblx0XHQvL1x0Y29uc3QgYWN0bWFwID0gdGhpcy5zbG90cy50YW1pbmdNb2IuYWN0aW9uTWFwO1xyXG5cdFx0Ly9cdGlmIChhY3RtYXApIHtcclxuXHRcdC8vXHRcdHJldHVybiBhY3RtYXBbdGhpcy5fYWN0aW9uXTtcclxuXHRcdC8vXHR9XHJcblx0XHQvL1x0cmV0dXJuIFwic2l0XCI7Ly9kZWZhdWx0XHJcblx0XHQvL31cclxuXHRcdHJldHVybiB0aGlzLl9hY3Rpb247XHJcblx0fVxyXG5cdHNldCBhY3Rpb24oYWN0KSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy50YW1pbmdNb2IpIHtcclxuXHRcdFx0bGV0IF9hY3Q7XHJcblxyXG5cdFx0XHR0aGlzLl9yaWRlX2FjdGlvbiA9IGFjdDtcclxuXHJcblx0XHRcdGlmICh0aGlzLnNsb3RzLnRhbWluZ01vYi5hY3Rpb25NYXApIHtcclxuXHRcdFx0XHRfYWN0ID0gdGhpcy5zbG90cy50YW1pbmdNb2IuYWN0aW9uTWFwW2FjdF07XHJcblxyXG5cdFx0XHRcdGlmIChfYWN0ID09IFwiaGlkZUJvZHlcIikge1xyXG5cdFx0XHRcdFx0dGhpcy5oaWRlQm9keSA9IHRydWU7XHJcblxyXG5cdFx0XHRcdFx0Ly9UT0RPOiBoaWRlQm9keSBhY3Q9P1xyXG5cclxuXHRcdFx0XHRcdHRoaXMuX2FjdGlvbiA9IGFjdDtcclxuXHRcdFx0XHRcdGlmICh0aGlzLmFjdGFuaS5fYWN0aW9uICE9IGFjdCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmFjdGFuaS5yZWxvYWQoYWN0KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSB8PSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuaGlkZUJvZHkgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0XHR0aGlzLl9hY3Rpb24gPSBfYWN0O1xyXG5cdFx0XHRcdFx0aWYgKHRoaXMuYWN0YW5pLl9hY3Rpb24gIT0gX2FjdCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmFjdGFuaS5yZWxvYWQoX2FjdCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0aWYgKGFjdCA9PSBcInJvcGVcIikge1xyXG5cdFx0XHRcdFx0dGhpcy5fYWN0aW9uID0gXCJyb3BlXCI7Ly9kZWZhdWx0XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYgKGFjdCA9PSBcImxhZGRlclwiKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9hY3Rpb24gPSBcImxhZGRlclwiOy8vZGVmYXVsdFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuX2FjdGlvbiA9IFwic2l0XCI7Ly9kZWZhdWx0XHJcblx0XHRcdFx0XHR0aGlzLl9hY3Rpb25fZnJhbWUgPSAwOy8vZGVmYXVsdFxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAodGhpcy5hY3RhbmkuX2FjdGlvbiAhPSBhY3QpIHtcclxuXHRcdFx0XHRcdHRoaXMuYWN0YW5pLnJlbG9hZChhY3QpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuaGlkZUJvZHkgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5fcmlkZV9hY3Rpb24gPSBudWxsO1xyXG5cclxuXHRcdFx0aWYgKHRoaXMuYWN0YW5pLl9hY3Rpb24gIT0gYWN0ICYmIHRoaXMuc2xvdHMuYm9keSkge1xyXG5cdFx0XHRcdHRoaXMuX2FjdGlvbiA9IGFjdDtcclxuXHRcdFx0XHR0aGlzLmFjdGFuaS5yZWxvYWQoYWN0KTtcclxuXHJcblx0XHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlIHw9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdGdldCBhY3Rpb25fZnJhbWUoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fYWN0aW9uX2ZyYW1lO1xyXG5cdH1cclxuXHRzZXQgYWN0aW9uX2ZyYW1lKHZhbHVlKSB7XHJcblx0XHRpZiAodmFsdWUgPT09IFwiXCIpIHsvL2Zyb20gJChcImlucHV0XCIpXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcblx0XHRcdGlmICghKHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJykpIHtcclxuXHRcdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0XHR0aGlzLl9hY3Rpb25fZnJhbWUgPSBOdW1iZXIodmFsdWUpIHwgMDtcclxuXHRcdFx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLl9hY3Rpb25fZnJhbWUgPSB2YWx1ZTtcclxuXHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSB8PSB0cnVlO1xyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0Z2V0IGFjdGlvbl9mcmFtZV9jb3VudCgpIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGlmICh0aGlzLnNsb3RzLmJvZHkpIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5zbG90cy5ib2R5LmdldEZyYW1lQ291bnQodGhpcyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdHJldHVybiAwO1xyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0Z2V0IGVtb3Rpb24oKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fZW1vdGlvbjtcclxuXHR9XHJcblx0c2V0IGVtb3Rpb24oZW1vKSB7XHJcblx0XHRpZiAodGhpcy5fZW1vdGlvbiAhPSBlbW8gJiYgdGhpcy5zbG90cy5mYWNlICYmIHRoaXMuc2xvdHMuZmFjZS5mcmFnbWVudHMuZmFjZS50ZXh0dXJlc1tlbW9dKSB7XHJcblx0XHRcdHRoaXMuX2Vtb3Rpb24gPSBlbW87XHJcblx0XHRcdHRoaXMuX2Vtb3Rpb25fZnJhbWUgPSAwO1xyXG5cdFx0XHR0aGlzLl9lbW90aW9uX3RpbWUgPSAwO1xyXG5cclxuXHRcdFx0aWYgKGVtbyA9PSBcImJsaW5rXCIpIHtcclxuXHRcdFx0XHR0aGlzLmJsaW5rUmF0ZSA9IDAuMDE1O1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMuYmxpbmtSYXRlID0gMTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5fZ2VuZXJhdG9yX2Vtb3Rpb25fZnJhbWUgPSB0aGlzLmVtb3Rpb25fZnJhbWVfc2VxdWVuY2VfZ2VuZXJhdG9yKHRoaXMuZW1vdGlvbl9mcmFtZV9jb3VudCwgMCk7XHJcblxyXG5cdFx0XHR0aGlzLl9fcmVxdWlyZV91cGRhdGUgfD0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBjb3VudCBvZiBmcmFtZVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCBmcmFtZVxyXG5cdCAqL1xyXG5cdCplbW90aW9uX2ZyYW1lX3NlcXVlbmNlX2dlbmVyYXRvcihsZW5ndGgsIHN0YXJ0KSB7XHJcblx0XHR3aGlsZSAodHJ1ZSkge1xyXG5cdFx0XHRpZiAoTWF0aC5yYW5kb20oKSA8IHRoaXMuYmxpbmtSYXRlKSB7XHJcblx0XHRcdFx0eWllbGQqIGxpbmVhclNlcXVlbmNlKGxlbmd0aCwgc3RhcnQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHlpZWxkIDA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0Z2V0IGVtb3Rpb25fZnJhbWUoKSB7XHJcblx0XHRyZXR1cm4gdGhpcy5fZW1vdGlvbl9mcmFtZTtcclxuXHR9XHJcblx0c2V0IGVtb3Rpb25fZnJhbWUodmFsdWUpIHtcclxuXHRcdGlmICh2YWx1ZSA9PT0gXCJcIikgey8vZnJvbSAkKFwiaW5wdXRcIilcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcclxuXHRcdFx0aWYgKCEodHlwZW9mIHZhbHVlID09ICdudW1iZXInKSkge1xyXG5cdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdHRoaXMuX2Vtb3Rpb25fZnJhbWUgPSBOdW1iZXIodmFsdWUpIHwgMDtcclxuXHRcdFx0XHR0aGlzLl9lbW90aW9uX3RpbWUgPSAwO1xyXG5cdFx0XHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSB8PSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fZW1vdGlvbl9mcmFtZSA9IHZhbHVlO1xyXG5cdFx0dGhpcy5fZW1vdGlvbl90aW1lID0gMDtcclxuXHRcdHRoaXMuX19yZXF1aXJlX3VwZGF0ZSB8PSB0cnVlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IG5leHRcclxuXHQgKi9cclxuXHRfZ2V0X2Vtb3Rpb25fbmV4dF9mcmFtZShuZXh0KSB7XHJcblx0XHRsZXQgciA9IHRoaXMuX2dlbmVyYXRvcl9lbW90aW9uX2ZyYW1lLm5leHQoKS52YWx1ZTtcclxuXHRcdFxyXG5cdFx0dGhpcy5fZ2VuZXJhdG9yX2Vtb3Rpb25fZnJhbWUgPSB0aGlzLmVtb3Rpb25fZnJhbWVfc2VxdWVuY2VfZ2VuZXJhdG9yKHRoaXMuZW1vdGlvbl9mcmFtZV9jb3VudCwgdGhpcy5fZW1vdGlvbl9mcmFtZSk7XHJcblx0XHRcclxuXHRcdHJldHVybiByO1xyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0Z2V0IGVtb3Rpb25fdGltZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLl9lbW90aW9uX3RpbWU7XHJcblx0fVxyXG5cdHNldCBlbW90aW9uX3RpbWUodGltZSkge1xyXG5cdFx0aWYgKHRoaXMuZW1vdGlvbl9mcmFtZV9jb3VudCkge1xyXG5cdFx0XHRpZiAodGltZSA8IHRoaXMuZW1vdGlvbl9kZWxheSkge1xyXG5cdFx0XHRcdHRoaXMuX2Vtb3Rpb25fdGltZSA9IHRpbWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5fZW1vdGlvbl90aW1lID0gMDtcclxuXHJcblx0XHRcdFx0dGhpcy5fZW1vdGlvbl9mcmFtZSA9IHRoaXMuX2dlbmVyYXRvcl9lbW90aW9uX2ZyYW1lLm5leHQoKS52YWx1ZTtcclxuXHJcblx0XHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlIHw9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9XHJcblx0ICovXHJcblx0Z2V0IGVtb3Rpb25fZGVsYXkoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5mYWNlKSB7XHJcblx0XHRcdHJldHVybiB0aGlzLnNsb3RzLmZhY2UuZ2V0RGVsYXkodGhpcyk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gNjA7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRnZXQgZW1vdGlvbl9mcmFtZV9jb3VudCgpIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGlmICh0aGlzLnNsb3RzLmZhY2UpIHtcclxuXHRcdFx0XHRyZXR1cm4gdGhpcy5zbG90cy5mYWNlLmdldEZyYW1lQ291bnQodGhpcyk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdHJldHVybiAwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YW1wIC0gMCA8PSBzdGFtcCA8IEluZmluaXR5XHJcblx0ICovXHJcblx0X3VwZGF0ZShfc3RhbXApIHtcclxuXHRcdGlmICh0aGlzLnBhdXNlKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgc3RhbXAgPSBfc3RhbXAgKiB0aGlzLmdldFNwZWVkKCk7XHJcblx0XHRcclxuXHRcdGlmICh0aGlzLmFjdGFuaSkge1xyXG5cdFx0XHRpZiAodGhpcy5hY3RhbmkuaXNFbmQoKSAmJiB0aGlzLmFjdGFuaS5sb29wKSB7XHJcblx0XHRcdFx0dGhpcy5hY3RhbmkucmVzZXQoKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5hY3RhbmkudXBkYXRlKHN0YW1wLCB0aGlzKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmVtb3Rpb25fdGltZSArPSBfc3RhbXA7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLnNsb3RzKSB7XHJcblx0XHRcdGxldCBlcXVpcCA9IHRoaXMuc2xvdHNbaV07XHJcblx0XHRcdGlmIChlcXVpcCAmJiBlcXVpcC5lZmZlY3QgJiYgZXF1aXAuZWZmZWN0LmVuYWJsZSkge1xyXG5cdFx0XHRcdGVxdWlwLmVmZmVjdC51cGRhdGUoc3RhbXApO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7YW55fSBudW1iZXIgIDAgPCBzdGFtcCAqIHNwZWVkIDwgSW5maW5pdHlcclxuXHQgKi9cclxuXHR1cGRhdGUoc3RhbXApIHtcclxuXHRcdHRoaXMuX3VwZGF0ZShzdGFtcCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiB1c2UgYXdhaXQgdGhpcy5fX3N5bmNocm9uaXplKHN0YW1wKSB1cGRhdGUgYW5kIGZvcmNlIHdhaXQgYWxsIHJlc291cmNlIGxvYWRcclxuXHQgKiBAcGFyYW0ge251bWJlcn1cclxuXHQgKi9cclxuXHRfX2ZvcmNlVXBkYXRlKHN0YW1wKSB7XHJcblx0XHR0aGlzLl8kZGlydHkgPSBNYXRoLnJhbmRvbSgpO1xyXG5cdFx0dGhpcy5fdXBkYXRlKHN0YW1wIHwgMCk7XHJcblx0XHR0aGlzLl9fdXBkYXRlX2ZyYWdfbGlzdCgpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXJcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5LCBcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gYW5nbGVcclxuXHQgKiBAcGFyYW0ge2Jvb2xlYW59IGZsaXBcclxuXHQgKi9cclxuXHRfZHJhdyhyZW5kZXJlciwgeCwgeSwgYW5nbGUsIGZsaXApIHtcclxuXHRcdHJlbmRlcmVyLnB1c2hHbG9iYWxBbHBoYSgpO1xyXG5cclxuXHRcdC8vbGlzdC5maWx0ZXIoYT0+YSYmYS5fcmF3Lm1hcCkuZm9yRWFjaChhPT57IGZvciAobGV0IGkgaW4gYS5fcmF3Lm1hcCkgeyBpZiAocVtpXSkgeyBxW2ldLnB1c2goYSk7IH0gZWxzZSB7IHFbaV0gPSBbYV07IH0gfSB9KVxyXG5cdFx0dGhpcy5fX2RyYXdfbGlzdChyZW5kZXJlciwgdGhpcy5fX2ZyYWdfbGlzdCwgeCwgeSwgYW5nbGUsIGZsaXApO1xyXG5cclxuXHRcdHJlbmRlcmVyLnBvcEdsb2JhbEFscGhhKCk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7RnJhZ21lbnRUZXh0dXJlW119IGxpc3RcclxuXHQgKi9cclxuXHRfX2RyYXdfbGlzdChyZW5kZXJlciwgbGlzdCwgeCwgeSwgYW5nbGUsIGZsaXApIHtcclxuXHRcdHJlbmRlcmVyLnB1c2hNYXRyaXgoKTtcclxuXHJcblx0XHRyZW5kZXJlci50cmFuc2xhdGUoeCwgeSk7XHJcblx0XHRcclxuXHRcdGlmICgwKSB7XHJcblx0XHRcdGxldCBjdHggPSByZW5kZXJlci5jdHg7XHJcblx0XHRcdGN0eC5iZWdpblBhdGgoKTtcclxuXHRcdFx0Y3R4Lm1vdmVUbygwLCAwKTtcclxuXHRcdFx0Y3R4LmxpbmVUbygxMDAsIDApO1xyXG5cdFx0XHRjdHguc3Ryb2tlU3R5bGUgPSBcIiNGMDBcIjtcclxuXHRcdFx0Y3R4LnN0cm9rZSgpO1xyXG5cdFx0XHRjdHguYmVnaW5QYXRoKCk7XHJcblx0XHRcdGN0eC5tb3ZlVG8oMCwgMCk7XHJcblx0XHRcdGN0eC5saW5lVG8oMCwgMTAwKTtcclxuXHRcdFx0Y3R4LnN0cm9rZVN0eWxlID0gXCIjMEYwXCI7XHJcblx0XHRcdGN0eC5zdHJva2UoKTtcclxuXHRcdH1cclxuXHJcblx0XHRyZW5kZXJlci5yb3RhdGUod2luZG93Lm1fYSB8fCBhbmdsZSk7XHJcblxyXG5cdFx0aWYgKGZsaXApIHtcclxuXHRcdFx0cmVuZGVyZXIuc2NhbGUoLTEsIDEpO1xyXG5cdFx0fVxyXG5cdFx0Ly97XHJcblx0XHQvL1x0bGV0IGN0eCA9IHJlbmRlcmVyLmN0eDtcclxuXHRcdC8vXHRjdHguYmVnaW5QYXRoKCk7XHJcblx0XHQvL1x0Y3R4Lm1vdmVUbygwLCAwKTtcclxuXHRcdC8vXHRjdHgubGluZVRvKDEwMCwgMCk7XHJcblx0XHQvL1x0Y3R4LnN0cm9rZVN0eWxlID0gXCIjRjAwXCI7XHJcblx0XHQvL1x0Y3R4LnN0cm9rZSgpO1xyXG5cdFx0Ly9cdGN0eC5iZWdpblBhdGgoKTtcclxuXHRcdC8vXHRjdHgubW92ZVRvKDAsIDApO1xyXG5cdFx0Ly9cdGN0eC5saW5lVG8oMCwgMTAwKTtcclxuXHRcdC8vXHRjdHguc3Ryb2tlU3R5bGUgPSBcIiMwRjBcIjtcclxuXHRcdC8vXHRjdHguc3Ryb2tlKCk7XHJcblx0XHQvL31cclxuXHJcblx0XHR7XHJcblx0XHRcdGZvciAobGV0IGkgaW4gdGhpcy5zbG90cykge1xyXG5cdFx0XHRcdGxldCBlcXVpcCA9IHRoaXMuc2xvdHNbaV07XHJcblx0XHRcdFx0aWYgKGVxdWlwICYmIGVxdWlwLmVmZmVjdCkge1xyXG5cdFx0XHRcdFx0ZXF1aXAuZWZmZWN0LnJlbmRlcihyZW5kZXJlciwgdGhpcyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAobGV0IGkgaW4gbGlzdCkge1xyXG5cdFx0XHRcdGxldCBmdCA9IGxpc3RbaV07XHJcblx0XHRcdFx0ZnQucmVuZGVyKHJlbmRlcmVyLCB0aGlzKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmVuZGVyZXIucG9wTWF0cml4KCk7XHJcblx0fVxyXG5cdF9fdXBkYXRlX2ZyYWdfbGlzdCgpIHtcclxuXHRcdHRoaXMuX19mcmFnX2xpc3QgPSBbXTtcclxuXHRcdFxyXG5cdFx0LyoqIEB0eXBlIHtBcnJheTxDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZT5bXX0gKi9cclxuXHRcdGxldCBzbG90cyA9IHt9O1xyXG5cdFx0XHJcblx0XHRmb3IgKGxldCBpID0gMjsgaSA8PSAzOyArK2kpIHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGl0ZW0gPSB0aGlzLnNsb3RzW1wiX2hhaXJcIiArIGldO1xyXG5cdFx0XHRcclxuXHRcdFx0dGhpcy5fX2FkZF9lcXVpcF90b19mcmFnX2xpc3Qoc2xvdHMsIGl0ZW0pO1xyXG5cdFx0fVxyXG5cdFx0Zm9yIChsZXQgaSBpbiB0aGlzLnNsb3RzLl9vcmRlcmVkX3Nsb3QpIHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDaGFyYWN0ZXJBcHBlYXJhbmNlQmFzZX0gKi9cclxuXHRcdFx0bGV0IGl0ZW0gPSB0aGlzLnNsb3RzLl9vcmRlcmVkX3Nsb3RbaV07XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLl9fYWRkX2VxdWlwX3RvX2ZyYWdfbGlzdChzbG90cywgaXRlbSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHsvL2JhY2tcclxuXHRcdFx0bGV0IGlzX2JhY2sgPSBmYWxzZTtcclxuXHRcdFx0XHJcblx0XHRcdGZvciAobGV0IGkgaW4gc2xvdHMpIHtcclxuXHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZVtdfSAqL1xyXG5cdFx0XHRcdGxldCBmdHMgPSBzbG90c1tpXTtcclxuXHRcdFx0XHRmb3IgKGxldCBqIGluIGZ0cykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0XHRsZXQgZnQgPSBmdHNbal07XHJcblx0XHRcdFx0XHRpZiAoaXNfYmFjaykge1xyXG5cdFx0XHRcdFx0XHRpZiAoZnQuX3BsYWNlLnN0YXJ0c1dpdGgoXCJmYWNlXCIpKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2UgaWYgKGZ0Ll9wbGFjZS5zdGFydHNXaXRoKFwiYmFja0hhaXJcIikpIHtcclxuXHRcdFx0XHRcdFx0aXNfYmFjayA9IHRydWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR0aGlzLl9fYWRkX2ZyYWdfdG9fbGlzdChmdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHtcclxuXHRcdFx0bGV0IGFlID0gdGhpcy5fX2ZyYWdfbGlzdFsxMTRdOy8vSEFDSzogQWVcclxuXHRcdFx0aWYgKGFlKSB7XHJcblx0XHRcdFx0dGhpcy5fX2ZyYWdfbGlzdC5wdXNoKGFlKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX2NhbGNCb3VuZEJveCgpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0FycmF5PENoYXJhY3RlckFwcGVhcmFuY2VCYXNlPltdfSBzbG90c1xyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQXBwZWFyYW5jZUJhc2V9IGl0ZW1cclxuXHQgKi9cclxuXHRfX2FkZF9lcXVpcF90b19mcmFnX2xpc3Qoc2xvdHMsIGl0ZW0pIHtcclxuXHRcdC8vIGlmIGVxdWlwIG5vdCB1c2UgdGhlbiB2YWx1ZSBpcyBtdW1iZXIoc2xvdF9vcmRlcikgd2hlcmUgdGhpcy5zbG90cy5fb3JkZXJlZF9zbG90XHJcblx0XHRpZiAoaXRlbSA9PSBudWxsKSB7XHJcblx0XHRcdHJldHVybjsvL2RlYnVnZ2VyO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoaXRlbSA+IDApIHsvLyB0eXBlb2YgaXRlbSA9PSAnbnVtYmVyJzsgaXRlbSAhPSBudWxsICYmIChpdGVtIGluc3RhbmNlb2YgQ2hhcmFjdGVyQXBwZWFyYW5jZUJhc2UgfHwgaXRlbSA+PSAwKVxyXG5cdFx0XHRyZXR1cm47Ly9jb250aW51ZTtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBpbml0IHNsb3RzXHJcblx0XHRmb3IgKGxldCBqIGluIGl0ZW0udnNsb3QpIHtcclxuXHRcdFx0bGV0IHNsb3QgPSBpdGVtLnZzbG90W2pdO1xyXG5cdFx0XHRzbG90c1tzbG90XSA9IFtdO1xyXG5cdFx0fVxyXG5cclxuXHRcdGZvciAobGV0IGogaW4gaXRlbS5mcmFnbWVudHMpIHsvL2ZvcmVhY2ggZXF1aXAgcGxhY2VcclxuXHRcdFx0bGV0IHNsb3QgPSBzTWFwW2pdO1xyXG5cdFx0XHRpZiAoc2xvdCAhPSBudWxsKSB7XHJcblx0XHRcdFx0LyoqIEB0eXBlIHtGcmFnbWVudFRleHR1cmV9ICovXHJcblx0XHRcdFx0bGV0IGZ0ID0gaXRlbS5mcmFnbWVudHNbal0uZ2V0VGV4dHVyZSh0aGlzKTtcclxuXHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdGlmICghc2xvdHNbc2xvdF0pIHtcclxuXHRcdFx0XHRcdFx0c2xvdHNbc2xvdF0gPSBbZnRdOy8vY292ZXIgPz9cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRzbG90c1tzbG90XS5wdXNoKGZ0KTsvL2NvdmVyID8/XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGogPT0gXCJkZWZhdWx0XCIpIHtcclxuXHRcdFx0XHQvKiogQHR5cGUge0ZyYWdtZW50VGV4dHVyZX0gKi9cclxuXHRcdFx0XHRsZXQgZnQgPSBpdGVtLmZyYWdtZW50c1tqXS5nZXRUZXh0dXJlKHRoaXMpO1xyXG5cdFx0XHRcdHNsb3QgPSBpdGVtLl9yYXcuaW5mby5pc2xvdDtcclxuXHRcdFx0XHRpZiAoZnQpIHtcclxuXHRcdFx0XHRcdGlmICghc2xvdHNbc2xvdF0pIHtcclxuXHRcdFx0XHRcdFx0c2xvdHNbc2xvdF0gPSBbZnRdOy8vY292ZXIgPz9cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRzbG90c1tzbG90XS5wdXNoKGZ0KTsvL2NvdmVyID8/XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdC8qKiBAdHlwZSB7RnJhZ21lbnRUZXh0dXJlfSAqL1xyXG5cdFx0XHRcdGxldCBmdCA9IGl0ZW0uZnJhZ21lbnRzW2pdLmdldFRleHR1cmUodGhpcyk7XHJcblx0XHRcdFx0aWYgKGZ0KSB7XHJcblx0XHRcdFx0XHR0aGlzLl9fYWRkX2ZyYWdfdG9fbGlzdChmdCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vaXRlbS5mcmFnbWVudHNbal0udmlzaWJsZSA9IHRydWU7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKiBAcGFyYW0ge0ZyYWdtZW50VGV4dHVyZX0gZnQgKi9cclxuXHRfX2FkZF9mcmFnX3RvX2xpc3QoZnQpIHtcclxuXHRcdGZ0LnVwZGF0ZSh0aGlzKTtcclxuXHRcdHRoaXMuX19mcmFnX2xpc3RbZnQuel0gPSBmdDtcclxuXHR9XHJcblxyXG5cclxuXHQvKipcclxuXHQgKiBjYWxjIGN1cnJlbnQgZnJhbWUgYm91bmQgYm94IGFuZCByZXN0b3JlIHJlc3VsdFxyXG5cdCAqIEByZXR1cm5zIHtSZWN0YW5nbGV9XHJcblx0ICovXHJcblx0Y2FsY0JvdW5kQm94KCkge1xyXG5cdFx0aWYgKHRoaXMuX19yZXF1aXJlX3VwZGF0ZSkge1xyXG5cdFx0XHRyZXR1cm4gdGhpcy5fY2FsY0JvdW5kQm94KCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmV0dXJuIHRoaXMuX2JvdW5kQm94O1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogY2FsYyBjdXJyZW50IGZyYW1lIGJvdW5kIGJveCBhbmQgcmVzdG9yZSByZXN1bHRcclxuXHQgKiBAcmV0dXJucyB7UmVjdGFuZ2xlfVxyXG5cdCAqL1xyXG5cdF9jYWxjQm91bmRCb3goKSB7XHJcblx0XHRsZXQgbGVmdCA9IDAsIHRvcCA9IDAsIHJpZ2h0ID0gMCwgYm90dG9tID0gMDtcclxuXHJcblx0XHRmb3IgKGxldCBpIGluIHRoaXMuX19mcmFnX2xpc3QpIHtcclxuXHRcdFx0bGV0IGZ0ID0gdGhpcy5fX2ZyYWdfbGlzdFtpXTtcclxuXHRcdFx0aWYgKGZ0LnRleHR1cmUgJiYgZnQucmVsYXRpdmUpIHtcclxuXHRcdFx0XHRsZXQgeDAgPSBmdC5yZWxhdGl2ZS54O1xyXG5cdFx0XHRcdGxldCB5MCA9IGZ0LnJlbGF0aXZlLnk7XHJcblx0XHRcdFx0bGV0IHgxID0geDAgKyBmdC53aWR0aDtcclxuXHRcdFx0XHRsZXQgeTEgPSB5MCArIGZ0LmhlaWdodDtcclxuXHJcblx0XHRcdFx0bGVmdCA9IE1hdGgubWluKGxlZnQsIHgwKTtcclxuXHRcdFx0XHR0b3AgPSBNYXRoLm1pbih0b3AsIHkwKTtcclxuXHRcdFx0XHRyaWdodCA9IE1hdGgubWF4KHJpZ2h0LCB4MSk7XHJcblx0XHRcdFx0Ym90dG9tID0gTWF0aC5tYXgoYm90dG9tLCB5MSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHRoaXMuX2JvdW5kQm94ID0gbmV3IFJlY3RhbmdsZShcclxuXHRcdFx0TWF0aC50cnVuYyhsZWZ0KSxcclxuXHRcdFx0TWF0aC50cnVuYyh0b3ApLFxyXG5cdFx0XHRNYXRoLnRydW5jKHJpZ2h0IC0gbGVmdCksXHJcblx0XHRcdE1hdGgudHJ1bmMoYm90dG9tIC0gdG9wKVxyXG5cdFx0KTtcclxuXHRcdHJldHVybiB0aGlzLl9ib3VuZEJveDtcclxuXHR9XHJcblx0XHJcblx0dG9KU09OKCkge1xyXG5cdFx0bGV0IG9iaiA9IHtcclxuXHRcdFx0c2xvdHM6IHRoaXMuc2xvdHMudG9KU09OKCksXHJcblx0XHR9O1xyXG5cdFx0aWYgKHRoaXMuc2xvdHMuX2hhaXIyKSB7XHJcblx0XHRcdG9iai5oYWlyMiA9IHRoaXMuc2xvdHMuX2hhaXIyLmlkO1xyXG5cdFx0XHRvYmouaGFpck1peDIgPSB0aGlzLnNsb3RzLmhhaXJNaXgyO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnNsb3RzLmhlYWQuZWxmRWFyKSB7XHJcblx0XHRcdG9iai5lYXIgPSBcImVsZlwiO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAodGhpcy5zbG90cy5oZWFkLmxlZkVhcikge1xyXG5cdFx0XHRvYmouZWFyID0gXCJsZWZcIjtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKHRoaXMuc2xvdHMuaGVhZC5oaWdobGVmRWFyKSB7XHJcblx0XHRcdG9iai5lYXIgPSBcImhpZ2hsZWZcIjtcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENoYXJhY3RlclJlbmRlcmVyIGV4dGVuZHMgQ2hhcmFjdGVyQW5pbWF0aW9uQmFzZSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHRzdXBlcigpO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAtIHBvc2l0aW9uIHggKi9cclxuXHRcdHRoaXMueCA9IDA7XHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gLSBwb3NpdGlvbiB5ICovXHJcblx0XHR0aGlzLnkgPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAtIHdoZXJlIGxheWVyICovXHJcblx0XHR0aGlzLnogPSA1O1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAtIHRyYW5zbGF0ZSB4IG9uY2UgZnJhbWUgKi9cclxuXHRcdHRoaXMudHggPSAwO1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IC0gdHJhbnNsYXRlIHkgb25jZSBmcmFtZSAqL1xyXG5cdFx0dGhpcy50eSA9IDA7XHJcblx0XHRcclxuXHRcdHRoaXMuYW5nbGUgPSAwO1xyXG5cdFx0dGhpcy5mcm9udCA9IC0xO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7UHJvbWlzZTx2b2lkPltdfSAqL1xyXG5cdFx0dGhpcy5fX2xvYWRfdGFzayA9IFtdO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7ZnVuY3Rpb24oSVJlbmRlcmVyKX0gKi9cclxuXHRcdHRoaXMucmVuZGVyID0gZnVuY3Rpb24gKHJlbmRlcmVyKSB7XHJcblx0XHRcdC8vbm90IHJlYWR5IHRvIHJlbmRlclxyXG5cdFx0XHQvL2lmIGxvYWQgdGhlbiBzZXQgbG9hZCByZW5kZXIgPSBfcmVuZGVyXHJcblx0XHR9XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtSZWN0YW5nbGV9ICovXHJcblx0XHR0aGlzLl9ib3VuZEJveCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLl8kb2xkX2FjdGlvbiA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuXyRvbGRfZW1vdGlvbiA9IG51bGw7XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgYXN5bmMgSW5pdCgpIHtcclxuXHRcdGxldCByZXN1bHQgPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcblx0XHRcdCRnZXQuZGF0YShcIi96bWFwXCIpLFxyXG5cdFx0XHQkZ2V0LmRhdGEoXCIvc21hcFwiKSxcclxuXHRcdFx0SXRlbUVmZmVjdC5Jbml0KCksXHJcblx0XHRcdEFjdGlvbkFuaW1hdGlvbi5Jbml0KCksLy9hY3Rpb24gZGVmaW5pdGlvblxyXG5cdFx0XSk7XHJcblx0XHRcclxuXHRcdHpNYXAgPSB7fTtcclxuXHRcdE9iamVjdC5rZXlzKHJlc3VsdFswXSkucmV2ZXJzZSgpLmZvckVhY2goKGssIGkpID0+IHpNYXBba10gPSBpICsgMSk7XHJcblxyXG5cdFx0c01hcCA9IHJlc3VsdFsxXTtcclxuXHR9XHJcblxyXG5cdGxvYWQoKSB7XHJcblx0XHQvL2xvYWQgYm9keSBhbmQgaGVhZCBmb3IgY2FsYyByZWxhdGl2ZSBwb3NpdGlvblxyXG5cdFx0dGhpcy51c2UoXCIwMDAwMjAxMlwiKTtcclxuXHRcdHRoaXMudXNlKFwiMDAwMTIwMTJcIik7XHJcblxyXG5cdFx0bGV0ICRwcm9taXNlID0gUHJvbWlzZS5hbGwoWy4uLnRoaXMuX19sb2FkX3Rhc2tdKTtcclxuXHRcdChmdW5jdGlvbiAodGhhdCwgJHByb21pc2UpIHtcclxuXHRcdFx0JHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcblx0XHRcdFx0dGhhdC5pbml0QW5pbWF0aW9uKCk7XHJcblx0XHRcdFx0dGhhdC5yZW5kZXIgPSB0aGF0Ll9yZW5kZXI7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSkodGhpcywgJHByb21pc2UpO1xyXG5cclxuXHRcdHJldHVybiAkcHJvbWlzZTtcclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHthbnl9IG51bWJlciAgMCA8IHN0YW1wICogc3BlZWQgPCBJbmZpbml0eVxyXG5cdCAqL1xyXG5cdHVwZGF0ZShzdGFtcCkge1xyXG5cdFx0dGhpcy5fJG9sZF9hY3Rpb24gPSB0aGlzLl9hY3Rpb247XHJcblx0XHR0aGlzLl8kb2xkX2Vtb3Rpb24gPSB0aGlzLmVtb3Rpb247XHJcblxyXG5cdFx0dGhpcy53YWl0TG9hZGVkKCk7XHJcblx0XHRzdXBlci51cGRhdGUoc3RhbXApO1xyXG5cclxuXHRcdGlmICh0aGlzLl9fcmVxdWlyZV91cGRhdGUpIHtcclxuXHRcdFx0dGhpcy5fX3VwZGF0ZV9mcmFnX2xpc3QoKTtcclxuXHRcdFx0dGhpcy5fX3JlcXVpcmVfdXBkYXRlID0gZmFsc2U7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0lSZW5kZXJlcn0gcmVuZGVyZXJcclxuXHQgKi9cclxuXHRfcmVuZGVyKHJlbmRlcmVyKSB7XHJcblx0XHRjb25zdCB4ID0gTWF0aC50cnVuYyh0aGlzLnggKyB0aGlzLnR4KTtcclxuXHRcdGNvbnN0IHkgPSBNYXRoLnRydW5jKHRoaXMueSArIHRoaXMudHkpO1xyXG5cdFx0XHJcblx0XHR0aGlzLl9kcmF3KHJlbmRlcmVyLCB4LCB5LCB0aGlzLmFuZ2xlLCB0aGlzLmZyb250ID4gMCk7XHJcblx0XHRcclxuXHRcdC8vdGhpcy50eCA9IDA7Ly9hdXRvIGNsZWFyXHJcblx0XHQvL3RoaXMudHkgPSAwOy8vYXV0byBjbGVhclxyXG5cdH1cclxuXHRcclxuXHRfc2V0dXBfdGVzdCgpIHtcclxuXHRcdGlmICgwKSB7XHJcblx0XHRcdHRoaXMudXNlKFwiMDAwMjY1MDlcIik7XHJcblxyXG5cdFx0XHR0aGlzLnVzZShcIjAwMDQ0MDQxXCIpO1xyXG5cclxuXHRcdFx0Ly90aGlzLnVzZShcIjAxMDIyMjc0XCIpO1xyXG5cclxuXHRcdFx0dGhpcy51c2UoXCIwMTA1MzE2OVwiKTtcclxuXHJcblx0XHRcdHRoaXMudXNlKFwiMDEwNzEwNzdcIik7XHJcblxyXG5cdFx0XHQvL3RoaXMudXNlKFwiMDExMDI5NjBcIik7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpcy51c2UoXCIwMDAyNjUwOVwiKTtcclxuXHJcblx0XHRcdHRoaXMudXNlKFwiMDAwNDE1MjZcIik7XHJcblxyXG5cdFx0XHR0aGlzLnVzZShcIjAxMDUxNDI5XCIpO1xyXG5cclxuXHRcdFx0dGhpcy51c2UoXCIwMTA3MTExMFwiKTtcclxuXHJcblx0XHRcdHRoaXMuZWxmRWFyID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIHVwZGF0ZSBhbmQgZm9yY2Ugd2FpdCBhbGwgcmVzb3VyY2UgbG9hZFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfVxyXG5cdCAqL1xyXG5cdGFzeW5jIF9fc3luY2hyb25pemUoc3RhbXApIHtcclxuXHRcdHRoaXMuX19mb3JjZVVwZGF0ZShzdGFtcCk7XHJcblx0XHJcblx0XHRhd2FpdCB0aGlzLndhaXRMb2FkZWQoKTtcclxuXHRcdGF3YWl0IHRoaXMuX3dhaXRGcmFtZVRleHR1cmVzTG9hZGVkKCk7XHJcblx0fVxyXG5cdGFzeW5jIHdhaXRMb2FkZWQoKSB7XHJcblx0XHRsZXQgdGFza3MgPSB0aGlzLl9fbG9hZF90YXNrO1xyXG5cdFx0aWYgKHRhc2tzICYmIHRhc2tzLmxlbmd0aCkge1xyXG5cdFx0XHRhd2FpdCBQcm9taXNlLmFsbCh0YXNrcykudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5fX2xvYWRfdGFzayA9IFtdO1xyXG5cdFx0XHR9LCBmdW5jdGlvbiAoZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcihlcnIpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcblx0Ly9pc0xvYWRpbmcoKSB7XHJcblx0Ly99XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBjYXRlZ29yeSAtIGNhdGVnb3J5IG9mIGNhc2gtd2VhcG9uXHJcblx0ICovXHJcblx0YXN5bmMgdXNlKGlkLCBjYXRlZ29yeSkge1xyXG5cdFx0aWYgKCFjYXRlZ29yeSkge1xyXG5cdFx0XHRjYXRlZ29yeSA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0Sm9iV2VhcG9uQ2F0ZWdvcnkodGhpcy5qb2IpO1xyXG5cdFx0fVxyXG5cdFx0aWYgKCEoaWQgJiYgdHlwZW9mIGlkID09IFwic3RyaW5nXCIpKSB7XHJcblx0XHRcdHRocm93IG5ldyBUeXBlRXJyb3IoXCJpZDogc3RyaW5nXCIpO1xyXG5cdFx0fVxyXG5cdFx0Y29uc3QgaXRlbV90eXBlID0gaWRbMF07XHJcblx0XHRzd2l0Y2ggKGl0ZW1fdHlwZSkge1xyXG5cdFx0XHRjYXNlIFwiMFwiOi8vZXF1aXBcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHRpZiAoSXRlbUNhdGVnb3J5SW5mby5pc0Nhc2hXZWFwb24oaWQpKSB7XHJcblx0XHRcdFx0XHRcdC8vdGhpcy4kJGNoYW5nZUxvZy53ZWFwb25UeXBlID0gc3NbMV07Lz8/XHJcblx0XHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cud2VhcG9uID0gaWQ7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy51c2VFcXVpcC5wdXNoKGlkKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHRsZXQgdGFzayA9IHRoaXMuc2xvdHMuX3VzZShpZCwgbnVsbCwgY2F0ZWdvcnkpO1xyXG5cdFx0XHRcdFx0dGhpcy5fX2xvYWRfdGFzay5wdXNoKHRhc2spO1xyXG5cdFx0XHRcdFx0bGV0IGl0ZW0gPSBhd2FpdCB0YXNrO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRpZiAoaWQuc3RhcnRzV2l0aChcIjAxOVwiKSkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmFjdGlvbiA9IHRoaXMuYWN0aW9uOy8vZm9yY2UgdXBkYXRlIGFjdGlvblxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHR0aGlzLl9fdXBkYXRlX2ZyYWdfbGlzdCgpO1xyXG5cdFx0XHRcdFx0dGhpcy5fY2FsY0JvdW5kQm94KCk7XHJcblxyXG5cdFx0XHRcdFx0cmV0dXJuIGl0ZW07XHJcblx0XHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICovXHJcblx0dW51c2UoaWQpIHtcclxuXHRcdGRlYnVnZ2VyO1xyXG5cdFx0aWYgKGlkWzBdID09IFwiMFwiKSB7Ly9lcXVpcFxyXG5cdFx0XHRsZXQgcmVzdWx0ID0gdGhpcy5zbG90cy5fdW51c2UoaWQpO1xyXG5cdFx0XHRpZiAocmVzdWx0KSB7XHJcblx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy51bnVzZUVxdWlwLnB1c2goaWQpO1xyXG5cdFx0XHRcdHRoaXMuX2NhbGNCb3VuZEJveCgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybiByZXN1bHQ7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3tzaG93ZWFyczpib29sZWFuLHNob3dMZWZFYXJzOmJvb2xlYW4sc2hvd0hpZ2hMZWZFYXJzOmJvb2xlYW4saXRlbXM6W119fSBvcHRpb25cclxuXHQgKi9cclxuXHRzZXQob3B0aW9uKSB7XHJcblx0XHR0aGlzLmVhciA9IEJvb2xlYW4ob3B0aW9uLnNob3dlYXJzKTtcclxuXHRcdHRoaXMubGVmRWFyID0gQm9vbGVhbihvcHRpb24uc2hvd0xlZkVhcnMpO1xyXG5cdFx0dGhpcy5oaWdobGVmRWFyID0gQm9vbGVhbihvcHRpb24uc2hvd0hpZ2hMZWZFYXJzKTtcclxuXHJcblx0XHRvcHRpb24uaXRlbXMuZm9yRWFjaChhc3luYyAoaXRlbURhdGEpID0+IHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRsZXQgaXRlbUlkID0gTnVtYmVyKGl0ZW1EYXRhLml0ZW1JZCB8IDApLnRvU3RyaW5nKCkucGFkU3RhcnQoOCwgXCIwXCIpO1xyXG5cdFx0XHRcdGxldCBpdGVtID0gYXdhaXQgdGhpcy51c2UoaXRlbUlkKTtcclxuXHRcdFx0XHRpdGVtLnNldChpdGVtRGF0YSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIml0ZW1JZDpcIiwgaXRlbURhdGEuaXRlbUlkLCBleCwgaXRlbURhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGFub3RoZXIgZm9ybWF0XHJcblx0ICogQHBhcmFtIHt7YWxwaGE6IG51bWJlciwgaHVlOiBudW1iZXIsIHNhdHVyYXRpb246IG51bWJlciwgYnJpZ2h0bmVzczogbnVtYmVyLCBjb250cmFzdDogbnVtYmVyfVtdfSBlcXVpcERhdGFBcnJheVxyXG5cdCAqL1xyXG5cdHBhcnNlKGVxdWlwRGF0YUFycmF5KSB7XHJcblx0XHRlcXVpcERhdGFBcnJheS5mb3JFYWNoKGFzeW5jIChpdGVtRGF0YSkgPT4ge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGxldCBpdGVtSWQgPSBOdW1iZXIoaXRlbURhdGEuaXRlbUlkIHwgMCkudG9TdHJpbmcoKS5wYWRTdGFydCg4LCBcIjBcIik7XHJcblx0XHRcdFx0bGV0IGVxdWlwID0gYXdhaXQgdGhpcy51c2UoaXRlbUlkKTtcclxuXHRcdFx0XHRlcXVpcC5wYXJzZShpdGVtRGF0YSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcihcIml0ZW1JZDpcIiwgaXRlbURhdGEuaXRlbUlkLCBleCwgaXRlbURhdGEpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdF9wYXJzZShjb2RlKSB7XHJcblx0XHRpZiAoIWNvZGUpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0bGV0IGVzID0gY29kZS5zcGxpdChcIixcIik7XHJcblx0XHR0aGlzLnNsb3RzLl9jbGVhcigpO1xyXG5cdFx0ZXMuZm9yRWFjaCgodiwgaSwgYSkgPT4ge1xyXG5cdFx0XHRpZiAodi5pbmRleE9mKFwifFwiKSA+PSAwKSB7XHJcblx0XHRcdFx0Y29uc3Qgc3MgPSB2LnNwbGl0KFwifFwiKTtcclxuXHRcdFx0XHRjb25zdCBjYXRlID0gSXRlbUNhdGVnb3J5SW5mby5nZXQoc3NbMF0pO1xyXG5cdFx0XHRcdGxldCBpZDtcclxuXHRcdFx0XHRpZiAoY2F0ZS5zbG90ID09IFwiZmFjZVwiKSB7XHJcblx0XHRcdFx0XHRpZCA9IHNzWzFdLnRyaW0oKS5wYWRTdGFydCg4LCAwKTtcclxuXHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cudXNlRXF1aXAucHVzaChpZCk7XHJcblx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0dGhpcy51c2UoaWQpO1xyXG5cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSBpZiAoY2F0ZS5zbG90ID09IFwiaGFpclwiKSB7XHJcblx0XHRcdFx0XHRjb25zdCBzbG90cyA9IHRoaXMuc2xvdHM7XHJcblx0XHRcdFx0XHRsZXQgaDIgPSBzc1sxXTtcclxuXHRcdFx0XHRcdGxldCBoMyA9IHNzWzJdO1xyXG5cdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdGlkID0gc3NbMF0udHJpbSgpLnBhZFN0YXJ0KDgsIDApO1xyXG5cdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy51c2VFcXVpcC5wdXNoKGlkKTtcclxuXHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHR0aGlzLnVzZShpZCkudGhlbigoKSA9PiB7XHJcblx0XHRcdFx0XHRcdGlmIChoMiAmJiBoMi5pbmRleE9mKFwiJVwiKSA+PSAwKSB7XHJcblx0XHRcdFx0XHRcdFx0bGV0IGhjID0gaDIuc3BsaXQoXCIlXCIpO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGMyID0gaGNbMF07XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgbTIgPSBoY1sxXSAvIDEwMDtcclxuXHRcdFx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMuJCRjaGFuZ2VMb2cuaGFpcjIgPSBjMjtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmhhaXJNaXgyID0gbTI7XHJcblx0XHRcdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdFx0XHRzbG90cy5oYWlyQ29sb3IyID0gYzI7XHJcblx0XHRcdFx0XHRcdFx0c2xvdHMuaGFpck1peDIgPSBtMjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRpZiAoaDMgJiYgaDMuaW5kZXhPZihcIiVcIikgPj0gMCkge1xyXG5cdFx0XHRcdFx0XHRcdGxldCBoYyA9IGgzLnNwbGl0KFwiJVwiKTtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBjMyA9IGhjWzBdO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IG0zID0gaGNbMV0gLyAxMDA7XHJcblx0XHRcdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLmhhaXIzID0gYzM7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy5oYWlyTWl4MyA9IG0zO1xyXG5cdFx0XHRcdFx0XHRcdC8vXHJcblx0XHRcdFx0XHRcdFx0c2xvdHMuaGFpckNvbG9yMyA9IGhjWzBdO1xyXG5cdFx0XHRcdFx0XHRcdHNsb3RzLmhhaXJNaXg0ID0gaGNbMV0gLyAxMDA7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmIChjYXRlLnNsb3QgPT0gXCJ3ZWFwb25cIikge1xyXG5cdFx0XHRcdFx0dGhpcy4kJGNoYW5nZUxvZy53ZWFwb25UeXBlID0gc3NbMV07XHJcblx0XHRcdFx0XHR0aGlzLiQkY2hhbmdlTG9nLndlYXBvbiA9IGlkO1xyXG5cdFx0XHRcdFx0dGhpcy51c2UuYXBwbHkodGhpcywgc3MsIHNzWzFdKTsvL3RoaXMudXNlKHNzWzBdLCBzc1sxXSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGlmIChOdW1iZXIuaXNGaW5pdGUocGFyc2VJbnQodiwgMTApKSkge1xyXG5cdFx0XHRcdFx0bGV0IGlkID0gdi50cmltKCkucGFkU3RhcnQoOCwgMCk7XHJcblx0XHRcdFx0XHR0aGlzLnVzZShpZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEB0eXBlIHtzdHJpbmd9IGNvbFxyXG5cdCAqL1xyXG5cdGdldCBoYWlyQ29sb3IoKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oYWlyKSB7XHJcblx0XHRcdHJldHVybiBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0SGFpckNvbG9yKHRoaXMuc2xvdHMuaGFpci5pZCk7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gXCIwXCI7XHJcblx0fVxyXG5cdHNldCBoYWlyQ29sb3IoY29sKSB7XHJcblx0XHRpZiAodGhpcy5zbG90cy5oYWlyICYmIGNvbCAhPSB0aGlzLmhhaXJDb2xvcikge1xyXG5cdFx0XHRsZXQgaWQgPSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0Q29sb3JIYWlySUQodGhpcy5zbG90cy5oYWlyLmlkLCBjb2wpO1xyXG5cdFx0XHR0aGlzLnVzZShpZCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gY29sXHJcblx0ICovXHJcblx0Z2V0IGZhY2VDb2xvcigpIHtcclxuXHRcdGlmICh0aGlzLnNsb3RzLmZhY2UpIHtcclxuXHRcdFx0cmV0dXJuIENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRGYWNlQ29sb3IodGhpcy5zbG90cy5mYWNlLmlkKTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBcIjBcIjtcclxuXHR9XHJcblx0c2V0IGZhY2VDb2xvcihjb2wpIHtcclxuXHRcdGlmICh0aGlzLnNsb3RzLmZhY2UgJiYgY29sICE9IHRoaXMuZmFjZUNvbG9yKSB7XHJcblx0XHRcdGxldCBpZCA9IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckZhY2VJRCh0aGlzLnNsb3RzLmZhY2UuaWQsIGNvbCk7XHJcblx0XHRcdHRoaXMudXNlKGlkKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q2hhcmFjdGVyQ2hhbmdlTG9nfSBjaGFuZ2VMb2dcclxuXHQgKi9cclxuXHRjb21taXRDaGFuZ2UoY2hhbmdlTG9nKSB7XHJcblx0XHRpZiAoY2hhbmdlTG9nLmVhcikge1xyXG5cdFx0XHR0aGlzLmVhciA9IGNoYW5nZUxvZy5lYXI7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMudXNlRXF1aXApIHtcclxuXHRcdFx0Zm9yIChsZXQgaWQgb2YgdGhpcy51c2VFcXVpcCkge1xyXG5cdFx0XHRcdHRoaXMudXNlKGlkKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLnVudXNlRXF1aXApIHtcclxuXHRcdFx0Zm9yIChsZXQgaWQgb2YgdGhpcy51bnVzZUVxdWlwKSB7XHJcblx0XHRcdFx0dGhpcy51bnVzZShpZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoY2hhbmdlTG9nLmhhaXIyICYmIGNoYW5nZUxvZy5oYWlyTWl4Mikge1xyXG5cdFx0XHR0aGlzLnNsb3RzLmhhaXJDb2xvcjIgPSBjaGFuZ2VMb2cuaGFpcjI7XHJcblx0XHRcdHRoaXMuc2xvdHMuaGFpck1peDIgPSBjaGFuZ2VMb2cuaGFpck1peDI7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNoYW5nZUxvZy5oYWlyMyAmJiBjaGFuZ2VMb2cuaGFpck1peDMpIHtcclxuXHRcdFx0Ly90aGlzLnNsb3RzLmhhaXJDb2xvcjMgPSBjaGFuZ2VMb2cuaGFpcjM7XHJcblx0XHRcdC8vdGhpcy5zbG90cy5oYWlyTWl4MyA9IGNoYW5nZUxvZy5oYWlyTWl4MztcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0aWYgKGNoYW5nZUxvZy53ZWFwb24gJiYgY2hhbmdlTG9nLndlYXBvblR5cGUpIHtcclxuXHRcdFx0dGhpcy51c2UoY2hhbmdlTG9nLndlYXBvbiwgY2hhbmdlTG9nLndlYXBvblR5cGUpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0X3N0cmluZ2lmeShnZW5Db2RlKSB7XHJcblx0XHRsZXQgcmVzdWx0ID0gdGhpcy5zbG90cy5fc3RyaW5naWZ5KCk7XHJcblx0XHRpZiAoZ2VuQ29kZSkge1xyXG5cdFx0XHRyZXR1cm4gYGNoYXJhLl9wYXJzZSgnJHtyZXN1bHR9JylgO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIHJlc3VsdDtcclxuXHR9XHJcblxyXG5cdF9vdXRsaW5rX29sZCgpIHtcclxuXHRcdGlmICh0aGlzLnNsb3RzLmJvZHkgJiYgdGhpcy5zbG90cy5ib2R5LmlkICYmIHRoaXMuc2xvdHMuZmFjZSAmJiB0aGlzLnNsb3RzLmZhY2UuaWQgJiYgdGhpcy5hY3Rpb24gJiYgdGhpcy5lbW90aW9uKSB7XHJcblx0XHRcdGxldCBsaW5rID0gXCJodHRwczovL21hcGxlc3RvcnkuaW8vYXBpL0dNUy9sYXRlc3QvY2hhcmFjdGVyL2NlbnRlci9cIiArIHRoaXMuc2xvdHMuYm9keS5pZCArIFwiL1wiO1xyXG5cdFx0XHRsZXQgc2xvdHMgPSBbLi4udGhpcy5zbG90cy5lbnVtZXJhdGUoKV0ubWFwKGEgPT4gcGFyc2VJbnQoYS5pZCwgMTApKTtcclxuXHJcblx0XHRcdHNsb3RzWzBdID0gdGhpcy5zbG90cy5mYWNlLmlkICsgXCI6XCIgKyB0aGlzLmVtb3Rpb247XHJcblxyXG5cdFx0XHRsaW5rICs9IHNsb3RzLmpvaW4oXCIsXCIpO1xyXG5cclxuXHRcdFx0bGluayArPSBcIi9cIiArIHRoaXMuYWN0aW9uICsgXCI/c2hvd2VhcnM9XCIgKyAodGhpcy5lbGZFYXIgPyBcInRydWVcIiA6IFwiZmFsc2VcIik7XHJcblxyXG5cdFx0XHRsaW5rICs9IFwiJnNob3dMZWZFYXJzPVwiICsgKHRoaXMubGVmRWFyID8gXCJ0cnVlXCIgOiBcImZhbHNlXCIpO1xyXG5cclxuXHRcdFx0cmV0dXJuIGxpbms7XHJcblx0XHR9XHJcblx0XHRjb25zb2xlLmxvZyhcImNoYXJhY3RlciBuZWVkIGJvZHksIGZhY2UsIGFjdGlvbiwgZW1vdGlvblwiKTtcclxuXHR9XHJcblx0XHJcblx0X291dGxpbmsobmFtZSkge1xyXG5cdFx0Y29uc3QgYW5pbWF0aW9uTmFtZSA9IHRoaXMuYWN0aW9uO1xyXG5cdFx0Y29uc3QgZnJhbWUgPSB0aGlzLmFjdGlvbl9mcmFtZTtcclxuXHRcdGNvbnN0IHNsb3RzID0gdGhpcy5zbG90cztcclxuXHRcdGNvbnN0IGl0ZW1MaXN0ID0gbWFrZUl0ZW1MaXN0LmNhbGwoKTtcclxuXHRcdHJldHVybiBcImh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvY2hhcmFjdGVyL1wiICtcclxuXHRcdFx0XHRpdGVtTGlzdCArICAgIC8vIG5vdCBhcnJheVxyXG5cdFx0XHRcdFwiL1wiICsgYW5pbWF0aW9uTmFtZSArIFwiL1wiICsgZnJhbWUgKyBcIj9cIiArXHJcblx0XHRcdFx0XCJzaG93ZWFycz1cIiArIHRoaXMuZWxmRWFyICtcclxuXHRcdFx0XHRcIiZzaG93TGVmRWFycz1cIiArIHRoaXMubGVmRWFyICtcclxuXHRcdFx0XHRcIiZyZXNpemU9MVwiICtcclxuXHRcdFx0XHQobmFtZSA/IChcIiZuYW1lPVwiICsgbmFtZSkgOiBcIlwiKSArXHJcblx0XHRcdFx0XCImZmxpcFg9XCIgKyBCb29sZWFuKHRoaXMuZnJvbnQgPiAwKSArXHJcblx0XHRcdFx0XCImYmdDb2xvcj0wLDAsMCwwXCI7XHJcblx0XHRmdW5jdGlvbiBtYWtlSXRlbUxpc3QoKSB7XHJcblx0XHRcdHJldHVybiBPYmplY3QudmFsdWVzKHNsb3RzKS5maWx0ZXIoYSA9PiBhKS5tYXAoaXRlbSA9PiB7XHJcblx0XHRcdFx0cmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShpdGVtLnRvSlNPTihhbmltYXRpb25OYW1lKSkpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0X2Rvd25sb2FkKCkge1xyXG5cdFx0d2luZG93Lm9wZW4odGhpcy5fb3V0bGluaygpKTtcclxuXHR9XHJcblxyXG5cdF9zYXZlX2FzX3N2ZyhyZW5kZXJlciwgZmlsZW5hbWUpIHtcclxuXHRcdHRoaXMuX190ZXh0dXJlX3RvX2Jhc2U2NCgpLnRoZW4oZnJhZ19saXN0ID0+IHtcclxuXHRcdFx0bGV0IGZpbGVfbmFtZSA9IGAke2ZpbGVuYW1lID8gKGZpbGVuYW1lK1wiLlwiKTpcIlwifSR7dGhpcy5hY3Rpb259WyR7dGhpcy5hY3Rpb25fZnJhbWV9XS4ke3RoaXMuZW1vdGlvbn1bJHt0aGlzLmVtb3Rpb25fZnJhbWV9XS5zdmdgO1xyXG5cdFx0XHRsZXQgYm91bmQgPSB0aGlzLmNhbGNCb3VuZEJveCgpO1xyXG5cdFx0XHRsZXQgc2l6ZSA9IGJvdW5kLnNpemU7XHJcblx0XHRcdGxldCBbY3gsIGN5XSA9IFstYm91bmQubGVmdCwgYm91bmQuaGVpZ2h0XTtcclxuXHRcclxuXHRcdFx0bGV0IHN2ZyA9ICc8IURPQ1RZUEUgc3ZnIFBVQkxJQyBcIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOXCIgXCJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGRcIiA+JztcclxuXHJcblx0XHRcdHN2ZyArPSBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgeG1sbnM6eGxpbms9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiIHdpZHRoPVwiJHtzaXplLnh9XCIgaGVpZ2h0PVwiJHtzaXplLnl9XCI+XFxuYDtcclxuXHJcblx0XHRcdHN2ZyArPSBgPGcgdHJhbnNmb3JtPVwidHJhbnNsYXRlKCR7Y3h9LCAke2N5fSlcIj5gO1xyXG5cdFx0XHRmcmFnX2xpc3QuZm9yRWFjaChmdW5jdGlvbiAoZnQpIHtcclxuXHRcdFx0XHRpZiAoZnQgJiYgZnQucmVsYXRpdmUpIHtcclxuXHRcdFx0XHRcdGxldCBjbHogPSBmdC5jbGFzc0xpc3Q7XHJcblx0XHRcdFx0XHRzdmcgKz0gYFxcdDxpbWFnZSBjbGFzcz1cIiR7Y2x6fVwiIG9wYWNpdHk9XCIke2Z0LnZpc2libGUgPyBmdC5vcGFjaXR5IDogMH1cIiB4PVwiJHtmdC5yZWxhdGl2ZS54fVwiIHk9XCIke2Z0LnJlbGF0aXZlLnl9XCIgd2lkdGg9XCIke2Z0LndpZHRofVwiIGhlaWdodD1cIiR7ZnQuaGVpZ2h0fVwiIHhsaW5rOmhyZWY9XCIke2Z0Ll91cmx9XCI+PC9pbWFnZT5cXG5gO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHN2ZyArPSAnPC9nPic7XHJcblxyXG5cdFx0XHRzdmcgKz0gJzx0ZXh0IHg9XCIwXCIgeT1cIjEyMlwiIGZpbGw9XCJ0cmFuc3BhcmVudFwiPicgKyB0aGlzLl9zdHJpbmdpZnkoZmFsc2UpICsgJzwvdGV4dD4nO1xyXG5cdFx0XHRzdmcgKz0gJzx0ZXh0IHg9XCIwXCIgeT1cIjE0NFwiIGZpbGw9XCJ0cmFuc3BhcmVudFwiPicgKyBKU09OLnN0cmluZ2lmeSh0aGlzKSArICc8L3RleHQ+JztcclxuXHJcblx0XHRcdHN2ZyArPSAnPC9zdmc+JztcclxuXHJcblx0XHRcdC8vbGV0IHVybCA9IFwiZGF0YTp0ZXh0L3BsYWluO3V0ZjgsXCIgKyBzdmc7XHJcblxyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHJcblx0XHRcdC8vd2luZG93Lm9wZW4odXJsKTtcclxuXHRcdFx0RG93bmxvYWREYXRhKHN2ZywgXCJpbWFnZS9zdmcreG1sO3V0ZjhcIiwgZmlsZV9uYW1lKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogXCJkYXRhOmltYWdlL3BuZztiYXNlNjQsWy4uLl1cIlxyXG5cdCAqIEBwYXJhbSB7SVJlbmRlcmVyfSByZW5kZXJlclxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBmaWxlbmFtZVxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9XHJcblx0ICovXHJcblx0X3NhdmVfYXNfcG5nKHJlbmRlcmVyLCBmaWxlbmFtZSkge1xyXG5cdFx0bGV0IGJvdW5kID0gdGhpcy5fY2FsY0JvdW5kQm94KCk7XHJcblx0XHRsZXQgc2l6ZSA9IGJvdW5kLnNpemU7XHJcblx0XHRsZXQgW3gsIHldID0gWy1ib3VuZC5sZWZ0LCBib3VuZC5oZWlnaHRdO1xyXG5cdFx0bGV0IGFuZ2xlID0gMDtcclxuXHRcdGxldCBmcm9udCA9IGZhbHNlO1xyXG5cclxuXHRcdC8vIHVzZSBDYW52YXMyLCBtdXN0IG5vdCBmYWlsXHJcblx0XHR0cnkge1xyXG5cdFx0XHRyZW5kZXJlci4kc3dhcENhbnZhcygpO1xyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXgpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9zYXZlIENhbnZhczIgc2l6ZSwgY3VycmVudCBjdHggaXMgX2N0eDJcclxuXHRcdGNvbnN0IGMydyA9IHJlbmRlcmVyLl9jdHgyLmNhbnZhcy53aWR0aDtcclxuXHRcdGNvbnN0IGMyaCA9IHJlbmRlcmVyLl9jdHgyLmNhbnZhcy5oZWlnaHQ7XHJcblx0XHQvL1xyXG5cdFx0cmVuZGVyZXIuY3R4LmNhbnZhcy53aWR0aCA9IHNpemUueDtcclxuXHRcdHJlbmRlcmVyLmN0eC5jYW52YXMuaGVpZ2h0ID0gc2l6ZS55O1xyXG5cclxuXHRcdHRyeSB7XHJcblx0XHRcdHRoaXMuX2RyYXcocmVuZGVyZXIsIHgsIHksIGFuZ2xlLCBmcm9udCk7XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRcdC8vIG5vdGhpbmdcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgYmFzZTY0ID0gcmVuZGVyZXIuY3R4LmNhbnZhcy50b0RhdGFVUkwoXCJpbWFnZS9wbmdcIik7XHJcblx0XHR7XHJcblx0XHRcdGxldCBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XHJcblxyXG5cdFx0XHRsZXQgbmFtZSA9IGAke2ZpbGVuYW1lID8gKGZpbGVuYW1lK1wiLlwiKTpcIlwifSR7dGhpcy5hY3Rpb259WyR7dGhpcy5hY3Rpb25fZnJhbWV9XS4ke3RoaXMuZW1vdGlvbn1bJHt0aGlzLmVtb3Rpb25fZnJhbWV9XS5wbmdgO1xyXG5cclxuXHRcdFx0ZWxlbS5pZCA9IG5hbWU7XHJcblx0XHRcdGVsZW0uZG93bmxvYWQgPSBuYW1lO1xyXG5cdFx0XHRlbGVtLmhyZWYgPSBiYXNlNjQ7XHJcblxyXG5cdFx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGVsZW0pO1xyXG5cdFx0XHRlbGVtLmNsaWNrKCk7XHJcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZWxlbSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9yZXN0b3JlIENhbnZhczIgc2l6ZSwgY3VycmVudCBjdHggaXMgX2N0eDJcclxuXHRcdHJlbmRlcmVyLmN0eC5jYW52YXMud2lkdGggPSBjMnc7XHJcblx0XHRyZW5kZXJlci5jdHguY2FudmFzLmhlaWdodCA9IGMyaDtcclxuXHJcblx0XHQvLyByZXN0b3JlIENhbnZhcywgbXVzdCBub3QgZmFpbFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmVuZGVyZXIuJHN3YXBDYW52YXMoKTtcclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGV4KTtcclxuXHRcdFx0Ly8gbm90aGluZ1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBiYXNlNjQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcmV0dXJucyB7UHJvbWlzZTxGcmFnbWVudFRleHR1cmVbXT59XHJcblx0ICovXHJcblx0YXN5bmMgX190ZXh0dXJlX3RvX2Jhc2U2NCgpIHtcclxuXHRcdGxldCBmcmFnX2xpc3QgPSB0aGlzLl9fZnJhZ19saXN0O1xyXG5cdFx0bGV0IHRhc2tzID0gW107XHJcblxyXG5cdFx0ZnJhZ19saXN0LmZvckVhY2goZnVuY3Rpb24gKGZ0KSB7XHJcblx0XHRcdGlmICghZnQpIHtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFmdC5fdXJsLnN0YXJ0c1dpdGgoXCJkYXRhOlwiKSkge1xyXG5cdFx0XHRcdHRhc2tzLnB1c2goKGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHRcdC8vZnQudGV4dHVyZS4kc3JjID0gZnQuX3VybDtcclxuXHRcdFx0XHRcdGZ0Ll91cmwgPSBhd2FpdCB0b0RhdGFVUkwoZnQudGV4dHVyZS5zcmMpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIGZ0O1xyXG5cdFx0XHRcdH0pKCkpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRhc2tzLnB1c2goZnQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChmdC5ncmFwaDIpIHtcclxuXHRcdFx0XHRsZXQgc3JjID0gZnQuZ3JhcGgyLnRleHR1cmUuc3JjO1xyXG5cdFx0XHRcdGlmICghc3JjLnN0YXJ0c1dpdGgoXCJkYXRhOlwiKSkge1xyXG5cdFx0XHRcdFx0dGFza3MucHVzaCgoYXN5bmMgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHQvL2Z0LnRleHR1cmUuJHNyYyA9IGZ0Ll91cmw7XHJcblx0XHRcdFx0XHRcdGZ0LmdyYXBoMi5fdXJsID0gYXdhaXQgdG9EYXRhVVJMKHNyYyk7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmdC5ncmFwaDI7XHJcblx0XHRcdFx0XHR9KSgpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHR0YXNrcy5wdXNoKGZ0LmdyYXBoMik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChmdC5ncmFwaDMpIHtcclxuXHRcdFx0XHRsZXQgc3JjID0gZnQuZ3JhcGgzLnRleHR1cmUuc3JjO1xyXG5cdFx0XHRcdGlmICghc3JjLnN0YXJ0c1dpdGgoXCJkYXRhOlwiKSkge1xyXG5cdFx0XHRcdFx0dGFza3MucHVzaCgoYXN5bmMgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFx0XHQvL2Z0LnRleHR1cmUuJHNyYyA9IGZ0Ll91cmw7XHJcblx0XHRcdFx0XHRcdGZ0LmdyYXBoMy5fdXJsID0gYXdhaXQgdG9EYXRhVVJMKHNyYyk7XHJcblx0XHRcdFx0XHRcdHJldHVybiBmdC5ncmFwaDM7XHJcblx0XHRcdFx0XHR9KSgpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHR0YXNrcy5wdXNoKGZ0LmdyYXBoMyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRyZXR1cm4gUHJvbWlzZS5hbGwodGFza3MpO1xyXG5cdH1cclxufVxyXG5BZGRJbml0VGFzayhDaGFyYWN0ZXJSZW5kZXJlci5Jbml0KTtcclxuXHJcbmZ1bmN0aW9uKiBjaXJjdWxhclNlcXVlbmNlKGxlbmd0aCwgc3RhcnQ9MCkge1xyXG5cdGxldCBpID0gc3RhcnQ7XHJcblx0Zm9yICg7IGkgPCBsZW5ndGg7ICsraSkgey8vYTogMCwgMSwgMiwgMywgLi4uYlxyXG5cdFx0eWllbGQgaTtcclxuXHR9XHJcblx0Zm9yIChpIC09IDI7IGkgPiAwOyAtLWkpIHsvL2I6IDIsIDEsIC4uLmFcclxuXHRcdHlpZWxkIGk7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiogbGluZWFyU2VxdWVuY2UobGVuZ3RoLCBzdGFydD0wKSB7XHJcblx0Zm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgbGVuZ3RoOyArK2kpIHtcclxuXHRcdHlpZWxkIGk7XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiBleHRyYWN0X251bWJlcihpbnB1dCkge1xyXG5cdHJldHVybiBTdHJpbmcoaW5wdXQpLm1hdGNoKC8oLT9cXGQrXFwuP1xcZCopfChcXC5cXGQqKS9nKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIGltYWdlIGhyZWYgdG8gZGF0YSB1cmxcclxuICovXHJcbmZ1bmN0aW9uIHRvRGF0YVVSTCh1cmwpIHtcclxuXHRyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG5cdFx0bGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG5cdFx0eGhyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0bGV0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XHJcblx0XHRcdHJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0cmVzb2x2ZShyZWFkZXIucmVzdWx0KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uIChldikge1xyXG5cdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdHJlamVjdChldik7XHJcblx0XHRcdH1cclxuXHRcdFx0cmVhZGVyLnJlYWRBc0RhdGFVUkwoeGhyLnJlc3BvbnNlKTtcclxuXHRcdH07XHJcblx0XHR4aHIub3BlbignR0VUJywgdXJsKTtcclxuXHRcdHhoci5yZXNwb25zZVR5cGUgPSAnYmxvYic7XHJcblx0XHR4aHIuc2VuZCgpO1xyXG5cdH0pO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQVlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///336\n')},347:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return SpriteBase; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return Sprite; });\n/* unused harmony export _$PatternSprite_Loaded */\n/* unused harmony export $PatternSprite */\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(332);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(333);\n/* harmony import */ var _Engine_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(335);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @extends {IGraph}\r\n */\r\nclass SpriteBase extends _Engine_js__WEBPACK_IMPORTED_MODULE_2__["Graph"] {\r\n\t/**\r\n\t * @param {!any} raw\r\n\t * @param {string=} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tif (raw) {\r\n\t\t\tsuper(url, {\r\n\t\t\t\twidth: raw.__w,\r\n\t\t\t\theight: raw.__h,\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsuper();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._raw = raw;\r\n\t\t\r\n\t\t//this.src is broken;\r\n\r\n\t\tif (url) {\r\n\t\t\tdebugger\r\n\t\t\tthis._url = url;\r\n\t\t\t//this._loadTexture(url);//_loadTexture: undefined\r\n\t\t}\r\n\t\telse if (SpriteBase.isTexture(raw) !== false) {\r\n\t\t\tthis._url = raw[""];\r\n\t\t}\r\n\t}\r\n\r\n\tstatic isTexture(raw) {\r\n\t\tif (raw) {\r\n\t\t\tif (raw.hasOwnProperty("")) {\r\n\t\t\t\tif (typeof raw[""] == \'string\') {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (!raw.__isEmpty) {\r\n\t\t\t\t\tconsole.group("no texture");\r\n\t\t\t\t\tconsole.warn(raw);\r\n\t\t\t\t\tconsole.groupEnd();\r\n\t\t\t\t\tthrow new Error("no texture");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tstatic isTextureHasData(raw) {\r\n\t\treturn raw && typeof raw[""] == \'string\' && raw[""].startsWith("data:image/");\r\n\t}\r\n\r\n\tset z(value) {\r\n\t\tthis._order = value;\r\n\t}\r\n\tget z() {\r\n\t\treturn this._order;\r\n\t}\r\n\t\r\n\t/**\r\n\t * try construct value from raw data\r\n\t * @param {T} defaultValue\r\n\t * @param {string} propertyName\r\n\t * @param {function(any):T} constructor\r\n\t * @returns {T}\r\n\t * @template T\r\n\t */\r\n\t_get(defaultValue, propertyName, converter) {\r\n\t\tif (!this._raw) {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\telse if (propertyName in this._raw) {\r\n\t\t\treturn converter(this._raw[propertyName]);\r\n\t\t}\r\n\t\treturn defaultValue;\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tthis._engine.drawGraph(this);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t */\r\n\tdraw2(x, y) {\r\n\t\tthis._engine.drawGraph2(this, x - this.x, y - this.y);\r\n\t}\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t */\r\n\tdraw2i(x, y) {\r\n\t\tthis._engine.drawGraph2(this, Math.trunc(x - this.x + 0.5), Math.trunc(y - this.y + 0.5));\r\n\t}\r\n}\r\n\r\n\r\nclass Sprite extends SpriteBase {\r\n\t/**\r\n\t * sprite = new Sprite(rawData);//不會載入image\r\n\t * sprite._url = img_url;//不會載入image\r\n\t *\r\n\t * 會觸發載入image的method\r\n\t * draw(), isLoaded(), get width(), get height()\r\n\t * \r\n\t * 手動載入image: __loadTexture()\r\n\t * \r\n\t * @param {!any} raw\r\n\t * @param {string=} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\r\n\t\tvar origin = this._get(new _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"](0, 0), "origin", _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"].get);\r\n\t\tthis.x = origin.x;\r\n\t\tthis.y = origin.y;\r\n\r\n\t\tthis.z = this._get(0, "z", Number);\r\n\r\n\t\tthis.delay = this._get(100, "delay", Number);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern(x, y, w, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.rect(x, y, w, h);\r\n\t\t\tctx.clip();\r\n\r\n\t\t\tlet left = x;\r\n\t\t\tlet top = y;\r\n\t\t\tlet right = x + w;\r\n\t\t\tlet bottom = y + h;\r\n\r\n\t\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\t\t\tthis.draw2(j, i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t */\r\n\tdrawHorizontalPattern(x, y, w) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tconst left = x;\r\n\t\t\tconst right = x + w;\r\n\r\n\t\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\t\tthis.draw2(j, y);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} h\r\n\t */\r\n\tdrawVerticalPattern(x, y, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tconst top = y;\r\n\t\t\tconst bottom = y + h;\r\n\r\n\t\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\t\tthis.draw2(x, i);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t\tctx.restore();\r\n\t}\r\n\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\t_drawPattern(x, y, w, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t\r\n\t\tconst sw = Math.trunc(w / this.width) * this.width;\r\n\t\tconst sh = Math.trunc(h / this.height) * this.height;\r\n\t\t\r\n\t\tconst left = x;\r\n\t\tconst top = y;\r\n\t\tconst right = x + sw;\r\n\t\tconst bottom = y + h;\r\n\r\n\t\tlet i, j;\r\n\r\n\t\tif (h >= this.height) {\r\n\t\t\tfor (i = top; i < bottom; i += this.height) {\r\n\t\t\t\tif (w >= this.width) {\r\n\t\t\t\t\tfor (j = left; j < right; j += this.width) {\r\n\t\t\t\t\t\tthis.draw2(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet sx = w - sw;\r\n\t\t\t\t\tif (sx > 0) {\r\n\t\t\t\t\t\tthis._engine._drawImage(this, 0, 0, sx, this.height, j - this.x, i - this.y, sx, this.height);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._engine._drawImage(this, 0, 0, w, this.height, left - this.x, i - this.y, w, this.height);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet sy = h - sh;\r\n\t\t\tif (sy > 0) {\r\n\t\t\t\tconsole.error(new Error("未完成"));\r\n\t\t\t\tthis._engine._drawImage(this, 0, 0, this.width, sy, left - this.x, i - this.y, this.width, sy);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.error(new Error("未完成"));\r\n\t\t\tthis._engine._drawImage(this, 0, 0, this.width, h, left - this.x, top - this.y, this.width, h);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t */\r\n\t_drawHorizontalPattern(x, y, w) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tconst left = x;\r\n\t\tconst right = x + w;\r\n\r\n\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\tthis.draw2(j, y);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} h\r\n\t */\r\n\t_drawVerticalPattern(x, y, h) {\r\n\t\tif (!this.isLoaded()) {\r\n\t\t\treturn;//sprite require property: width, height\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\tconst top = y;\r\n\t\tconst bottom = y + h;\r\n\r\n\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\tthis.draw2(x, i);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\tdrawPattern4i(x, y, w, h) {\r\n\t\tthis.drawPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t */\r\n\tdrawHorizontalPattern3i(x, y, w) {\r\n\t\tthis.drawHorizontalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5));\r\n\t}\r\n\t/**\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\tdrawVerticalPattern3i(x, y, h) {\r\n\t\tthis.drawVerticalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\t_drawPattern4i(x, y, w, h) {\r\n\t\tthis._drawPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} w - type: int\r\n\t */\r\n\t_drawHorizontalPattern3i(x, y, w) {\r\n\t\tthis._drawHorizontalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(w + 0.5));\r\n\t}\r\n\t/**\r\n\t * without clip\r\n\t * @param {number} x - type: int\r\n\t * @param {number} y - type: int\r\n\t * @param {number} h - type: int\r\n\t */\r\n\t_drawVerticalPattern3i(x, y, h) {\r\n\t\tthis._drawVerticalPattern(Math.trunc(x + 0.5), Math.trunc(y + 0.5), Math.trunc(h + 0.5));\r\n\t}\r\n}\r\n\r\nclass _$PatternSprite_Loaded extends Sprite {\r\n\t/**\r\n\t * @param {!any} raw\r\n\t * @param {string=} url\r\n\t */\r\n\tconstructor(raw, url) {\r\n\t\tsuper(raw, url);\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis._direction = null;\r\n\r\n\t\t/** @type {CanvasPattern} */\r\n\t\tthis._pattern = null;\r\n\t}\r\n\r\n\t/** @type {string} */\r\n\tget direction() {\r\n\t\treturn this._direction;\r\n\t}\r\n\tset direction(value) {\r\n\t\tif (value && this._direction != value) {\r\n\t\t\tthis._direction = value;\r\n\t\r\n\t\t\t//reload;\r\n\t\t\tthis._pattern = null;\r\n\t\t\tthis.__proto__ = $PatternSprite.prototype;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern(w, h) {\r\n\t\tif (this.direction && this._pattern) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tctx.rect(-this.x, -this.y, w, h);\r\n\t\t\tctx.fillStyle = this._pattern;\r\n\t\t\tctx.fill();\r\n\t\t\tctx.fillStyle = "no-repeat";\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern2(x, y, w, h) {\r\n\t\tif (this.direction && this._pattern) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tctx.rect(x - this.x, y - this.y, w, h);\r\n\t\t\tctx.fillStyle = this._pattern;\r\n\t\t\tctx.fill();\r\n\t\t\tctx.fillStyle = "no-repeat";\r\n\t\t}\r\n\t}\r\n\r\n\t/** @returns {"repeat"} */\r\n\tget e_repeat() {\r\n\t\treturn "repeat";\r\n\t}\r\n\t/** @returns {"repeat-x"} */\r\n\tget e_repeat_x() {\r\n\t\treturn "repeat-x";\r\n\t}\r\n\t/** @returns {"repeat-y"} */\r\n\tget e_repeat_y() {\r\n\t\treturn "repeat-y";\r\n\t}\r\n\t/** @returns {"no-repeat"} */\r\n\tget e_noRepeat() {\r\n\t\treturn "no-repeat";\r\n\t}\r\n}\r\n\r\nclass $PatternSprite extends _$PatternSprite_Loaded {\r\n\tdrawPattern(w, h) {\r\n\t\tthis.drawPattern2(0, 0, w, h);\r\n\t}\r\n\tdrawPattern2(x, y, w, h) {\r\n\t\tif (this.isLoaded()) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\r\n\t\t\tctx.save();\r\n\t\t\t{\r\n\t\t\t\tctx.rect(x, y, w, h);\r\n\t\t\t\tctx.clip();\r\n\t\t\t\t\r\n\t\t\t\tlet left = x;\r\n\t\t\t\tlet top = y;\r\n\t\t\t\tlet right = x + w;\r\n\t\t\t\tlet bottom = y + h;\r\n\r\n\t\t\t\tfor (let i = top; i < bottom; i += this.height) {\r\n\t\t\t\t\tfor (let j = left; j < right; j += this.width) {\r\n\t\t\t\t\t\tthis.draw2(j, i);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern(w, h) {\r\n\t\tif (this.direction) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tif (!this._pattern) {\r\n\t\t\t\tif (this.isLoaded()) {\r\n\t\t\t\t\tthis._pattern = ctx.createPattern(this.texture, this.direction);\r\n\t\t\t\t\tthis.__proto__ = _$PatternSprite_Loaded.prototype;\r\n\t\t\t\t\tthis.drawPattern(w, h);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} w\r\n\t * @param {number} h\r\n\t */\r\n\tdrawPattern2(x, y, w, h) {\r\n\t\tif (this.direction) {\r\n\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\tconst ctx = this._engine.ctx;\r\n\t\r\n\t\t\tif (!this._pattern) {\r\n\t\t\t\tif (this.isLoaded()) {\r\n\t\t\t\t\tthis._pattern = ctx.createPattern(this.texture, this.direction);\r\n\t\t\t\t\tthis.__proto__ = _$PatternSprite_Loaded.prototype;\r\n\t\t\t\t\tthis.drawPattern2(x, y, w, h);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQ3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvU3ByaXRlLmpzPzA3NzQiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCB7IFZlYzIsIFJlY3RhbmdsZSB9IGZyb20gXCIuL21hdGguanNcIjtcclxuaW1wb3J0IHsgSUdycGFoLCBJUmVuZGVyZXIsIElHcmFwaCB9IGZyb20gXCIuL0lSZW5kZXJlci5qc1wiO1xyXG5cclxuaW1wb3J0IHsgZW5naW5lLCBHcmFwaCB9IGZyb20gXCIuL0VuZ2luZS5qc1wiO1xyXG5cclxuXHJcbi8qKlxyXG4gKiBAZXh0ZW5kcyB7SUdyYXBofVxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIFNwcml0ZUJhc2UgZXh0ZW5kcyBHcmFwaCB7XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHshYW55fSByYXdcclxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHVybFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHRpZiAocmF3KSB7XHJcblx0XHRcdHN1cGVyKHVybCwge1xyXG5cdFx0XHRcdHdpZHRoOiByYXcuX193LFxyXG5cdFx0XHRcdGhlaWdodDogcmF3Ll9faCxcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0c3VwZXIoKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuX3JhdyA9IHJhdztcclxuXHRcdFxyXG5cdFx0Ly90aGlzLnNyYyBpcyBicm9rZW47XHJcblxyXG5cdFx0aWYgKHVybCkge1xyXG5cdFx0XHRkZWJ1Z2dlclxyXG5cdFx0XHR0aGlzLl91cmwgPSB1cmw7XHJcblx0XHRcdC8vdGhpcy5fbG9hZFRleHR1cmUodXJsKTsvL19sb2FkVGV4dHVyZTogdW5kZWZpbmVkXHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChTcHJpdGVCYXNlLmlzVGV4dHVyZShyYXcpICE9PSBmYWxzZSkge1xyXG5cdFx0XHR0aGlzLl91cmwgPSByYXdbXCJcIl07XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgaXNUZXh0dXJlKHJhdykge1xyXG5cdFx0aWYgKHJhdykge1xyXG5cdFx0XHRpZiAocmF3Lmhhc093blByb3BlcnR5KFwiXCIpKSB7XHJcblx0XHRcdFx0aWYgKHR5cGVvZiByYXdbXCJcIl0gPT0gJ3N0cmluZycpIHtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRpZiAoIXJhdy5fX2lzRW1wdHkpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUuZ3JvdXAoXCJubyB0ZXh0dXJlXCIpO1xyXG5cdFx0XHRcdFx0Y29uc29sZS53YXJuKHJhdyk7XHJcblx0XHRcdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XHJcblx0XHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJubyB0ZXh0dXJlXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxuXHRzdGF0aWMgaXNUZXh0dXJlSGFzRGF0YShyYXcpIHtcclxuXHRcdHJldHVybiByYXcgJiYgdHlwZW9mIHJhd1tcIlwiXSA9PSAnc3RyaW5nJyAmJiByYXdbXCJcIl0uc3RhcnRzV2l0aChcImRhdGE6aW1hZ2UvXCIpO1xyXG5cdH1cclxuXHJcblx0c2V0IHoodmFsdWUpIHtcclxuXHRcdHRoaXMuX29yZGVyID0gdmFsdWU7XHJcblx0fVxyXG5cdGdldCB6KCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX29yZGVyO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiB0cnkgY29uc3RydWN0IHZhbHVlIGZyb20gcmF3IGRhdGFcclxuXHQgKiBAcGFyYW0ge1R9IGRlZmF1bHRWYWx1ZVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eU5hbWVcclxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9uKGFueSk6VH0gY29uc3RydWN0b3JcclxuXHQgKiBAcmV0dXJucyB7VH1cclxuXHQgKiBAdGVtcGxhdGUgVFxyXG5cdCAqL1xyXG5cdF9nZXQoZGVmYXVsdFZhbHVlLCBwcm9wZXJ0eU5hbWUsIGNvbnZlcnRlcikge1xyXG5cdFx0aWYgKCF0aGlzLl9yYXcpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChwcm9wZXJ0eU5hbWUgaW4gdGhpcy5fcmF3KSB7XHJcblx0XHRcdHJldHVybiBjb252ZXJ0ZXIodGhpcy5fcmF3W3Byb3BlcnR5TmFtZV0pO1xyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIGRlZmF1bHRWYWx1ZTtcclxuXHR9XHJcblxyXG5cdGRyYXcoKSB7XHJcblx0XHR0aGlzLl9lbmdpbmUuZHJhd0dyYXBoKHRoaXMpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqL1xyXG5cdGRyYXcyKHgsIHkpIHtcclxuXHRcdHRoaXMuX2VuZ2luZS5kcmF3R3JhcGgyKHRoaXMsIHggLSB0aGlzLngsIHkgLSB0aGlzLnkpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geCAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gdHlwZTogaW50XHJcblx0ICovXHJcblx0ZHJhdzJpKHgsIHkpIHtcclxuXHRcdHRoaXMuX2VuZ2luZS5kcmF3R3JhcGgyKHRoaXMsIE1hdGgudHJ1bmMoeCAtIHRoaXMueCArIDAuNSksIE1hdGgudHJ1bmMoeSAtIHRoaXMueSArIDAuNSkpO1xyXG5cdH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBTcHJpdGUgZXh0ZW5kcyBTcHJpdGVCYXNlIHtcclxuXHQvKipcclxuXHQgKiBzcHJpdGUgPSBuZXcgU3ByaXRlKHJhd0RhdGEpOy8v5LiN5pyD6LyJ5YWlaW1hZ2VcclxuXHQgKiBzcHJpdGUuX3VybCA9IGltZ191cmw7Ly/kuI3mnIPovInlhaVpbWFnZVxyXG5cdCAqXHJcblx0ICog5pyD6Ke455m86LyJ5YWlaW1hZ2XnmoRtZXRob2RcclxuXHQgKiBkcmF3KCksIGlzTG9hZGVkKCksIGdldCB3aWR0aCgpLCBnZXQgaGVpZ2h0KClcclxuXHQgKiBcclxuXHQgKiDmiYvli5XovInlhaVpbWFnZTogX19sb2FkVGV4dHVyZSgpXHJcblx0ICogXHJcblx0ICogQHBhcmFtIHshYW55fSByYXdcclxuXHQgKiBAcGFyYW0ge3N0cmluZz19IHVybFxyXG5cdCAqL1xyXG5cdGNvbnN0cnVjdG9yKHJhdywgdXJsKSB7XHJcblx0XHRzdXBlcihyYXcsIHVybCk7XHJcblxyXG5cdFx0dmFyIG9yaWdpbiA9IHRoaXMuX2dldChuZXcgVmVjMigwLCAwKSwgXCJvcmlnaW5cIiwgVmVjMi5nZXQpO1xyXG5cdFx0dGhpcy54ID0gb3JpZ2luLng7XHJcblx0XHR0aGlzLnkgPSBvcmlnaW4ueTtcclxuXHJcblx0XHR0aGlzLnogPSB0aGlzLl9nZXQoMCwgXCJ6XCIsIE51bWJlcik7XHJcblxyXG5cdFx0dGhpcy5kZWxheSA9IHRoaXMuX2dldCgxMDAsIFwiZGVsYXlcIiwgTnVtYmVyKTtcclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGhcclxuXHQgKi9cclxuXHRkcmF3UGF0dGVybih4LCB5LCB3LCBoKSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRyZXR1cm47Ly9zcHJpdGUgcmVxdWlyZSBwcm9wZXJ0eTogd2lkdGgsIGhlaWdodFxyXG5cdFx0fVxyXG5cdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRjb25zdCBjdHggPSB0aGlzLl9lbmdpbmUuY3R4O1xyXG5cclxuXHRcdGN0eC5zYXZlKCk7XHJcblx0XHR0cnkge1xyXG5cdFx0XHRjdHgucmVjdCh4LCB5LCB3LCBoKTtcclxuXHRcdFx0Y3R4LmNsaXAoKTtcclxuXHJcblx0XHRcdGxldCBsZWZ0ID0geDtcclxuXHRcdFx0bGV0IHRvcCA9IHk7XHJcblx0XHRcdGxldCByaWdodCA9IHggKyB3O1xyXG5cdFx0XHRsZXQgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gdG9wOyBpIDwgYm90dG9tOyBpICs9IHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgaiA9IGxlZnQ7IGogPCByaWdodDsgaiArPSB0aGlzLndpZHRoKSB7XHJcblx0XHRcdFx0XHR0aGlzLmRyYXcyKGosIGkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXgpO1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdGN0eC5yZXN0b3JlKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHdcclxuXHQgKi9cclxuXHRkcmF3SG9yaXpvbnRhbFBhdHRlcm4oeCwgeSwgdykge1xyXG5cdFx0aWYgKCF0aGlzLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0cmV0dXJuOy8vc3ByaXRlIHJlcXVpcmUgcHJvcGVydHk6IHdpZHRoLCBoZWlnaHRcclxuXHRcdH1cclxuXHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHJcblx0XHRjdHguc2F2ZSgpO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgbGVmdCA9IHg7XHJcblx0XHRcdGNvbnN0IHJpZ2h0ID0geCArIHc7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBqID0gbGVmdDsgaiA8IHJpZ2h0OyBqICs9IHRoaXMud2lkdGgpIHtcclxuXHRcdFx0XHR0aGlzLmRyYXcyKGosIHkpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0fVxyXG5cdFx0Y3R4LnJlc3RvcmUoKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHlcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaFxyXG5cdCAqL1xyXG5cdGRyYXdWZXJ0aWNhbFBhdHRlcm4oeCwgeSwgaCkge1xyXG5cdFx0aWYgKCF0aGlzLmlzTG9hZGVkKCkpIHtcclxuXHRcdFx0cmV0dXJuOy8vc3ByaXRlIHJlcXVpcmUgcHJvcGVydHk6IHdpZHRoLCBoZWlnaHRcclxuXHRcdH1cclxuXHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHJcblx0XHRjdHguc2F2ZSgpO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0Y29uc3QgdG9wID0geTtcclxuXHRcdFx0Y29uc3QgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gdG9wOyBpIDwgYm90dG9tOyBpICs9IHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdFx0dGhpcy5kcmF3Mih4LCBpKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXgpO1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHRcdGN0eC5yZXN0b3JlKCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiB3aXRob3V0IGNsaXBcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHdcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaFxyXG5cdCAqL1xyXG5cdF9kcmF3UGF0dGVybih4LCB5LCB3LCBoKSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRyZXR1cm47Ly9zcHJpdGUgcmVxdWlyZSBwcm9wZXJ0eTogd2lkdGgsIGhlaWdodFxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRjb25zdCBzdyA9IE1hdGgudHJ1bmModyAvIHRoaXMud2lkdGgpICogdGhpcy53aWR0aDtcclxuXHRcdGNvbnN0IHNoID0gTWF0aC50cnVuYyhoIC8gdGhpcy5oZWlnaHQpICogdGhpcy5oZWlnaHQ7XHJcblx0XHRcclxuXHRcdGNvbnN0IGxlZnQgPSB4O1xyXG5cdFx0Y29uc3QgdG9wID0geTtcclxuXHRcdGNvbnN0IHJpZ2h0ID0geCArIHN3O1xyXG5cdFx0Y29uc3QgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0bGV0IGksIGo7XHJcblxyXG5cdFx0aWYgKGggPj0gdGhpcy5oZWlnaHQpIHtcclxuXHRcdFx0Zm9yIChpID0gdG9wOyBpIDwgYm90dG9tOyBpICs9IHRoaXMuaGVpZ2h0KSB7XHJcblx0XHRcdFx0aWYgKHcgPj0gdGhpcy53aWR0aCkge1xyXG5cdFx0XHRcdFx0Zm9yIChqID0gbGVmdDsgaiA8IHJpZ2h0OyBqICs9IHRoaXMud2lkdGgpIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5kcmF3MihqLCBpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGxldCBzeCA9IHcgLSBzdztcclxuXHRcdFx0XHRcdGlmIChzeCA+IDApIHtcclxuXHRcdFx0XHRcdFx0dGhpcy5fZW5naW5lLl9kcmF3SW1hZ2UodGhpcywgMCwgMCwgc3gsIHRoaXMuaGVpZ2h0LCBqIC0gdGhpcy54LCBpIC0gdGhpcy55LCBzeCwgdGhpcy5oZWlnaHQpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdHRoaXMuX2VuZ2luZS5fZHJhd0ltYWdlKHRoaXMsIDAsIDAsIHcsIHRoaXMuaGVpZ2h0LCBsZWZ0IC0gdGhpcy54LCBpIC0gdGhpcy55LCB3LCB0aGlzLmhlaWdodCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGxldCBzeSA9IGggLSBzaDtcclxuXHRcdFx0aWYgKHN5ID4gMCkge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IobmV3IEVycm9yKFwi5pyq5a6M5oiQXCIpKTtcclxuXHRcdFx0XHR0aGlzLl9lbmdpbmUuX2RyYXdJbWFnZSh0aGlzLCAwLCAwLCB0aGlzLndpZHRoLCBzeSwgbGVmdCAtIHRoaXMueCwgaSAtIHRoaXMueSwgdGhpcy53aWR0aCwgc3kpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihuZXcgRXJyb3IoXCLmnKrlrozmiJBcIikpO1xyXG5cdFx0XHR0aGlzLl9lbmdpbmUuX2RyYXdJbWFnZSh0aGlzLCAwLCAwLCB0aGlzLndpZHRoLCBoLCBsZWZ0IC0gdGhpcy54LCB0b3AgLSB0aGlzLnksIHRoaXMud2lkdGgsIGgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogd2l0aG91dCBjbGlwXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICovXHJcblx0X2RyYXdIb3Jpem9udGFsUGF0dGVybih4LCB5LCB3KSB7XHJcblx0XHRpZiAoIXRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRyZXR1cm47Ly9zcHJpdGUgcmVxdWlyZSBwcm9wZXJ0eTogd2lkdGgsIGhlaWdodFxyXG5cdFx0fVxyXG5cdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRjb25zdCBjdHggPSB0aGlzLl9lbmdpbmUuY3R4O1xyXG5cclxuXHRcdGNvbnN0IGxlZnQgPSB4O1xyXG5cdFx0Y29uc3QgcmlnaHQgPSB4ICsgdztcclxuXHJcblx0XHRmb3IgKGxldCBqID0gbGVmdDsgaiA8IHJpZ2h0OyBqICs9IHRoaXMud2lkdGgpIHtcclxuXHRcdFx0dGhpcy5kcmF3MihqLCB5KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHlcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaFxyXG5cdCAqL1xyXG5cdF9kcmF3VmVydGljYWxQYXR0ZXJuKHgsIHksIGgpIHtcclxuXHRcdGlmICghdGhpcy5pc0xvYWRlZCgpKSB7XHJcblx0XHRcdHJldHVybjsvL3Nwcml0ZSByZXF1aXJlIHByb3BlcnR5OiB3aWR0aCwgaGVpZ2h0XHJcblx0XHR9XHJcblx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdGNvbnN0IGN0eCA9IHRoaXMuX2VuZ2luZS5jdHg7XHJcblxyXG5cdFx0Y29uc3QgdG9wID0geTtcclxuXHRcdGNvbnN0IGJvdHRvbSA9IHkgKyBoO1xyXG5cclxuXHRcdGZvciAobGV0IGkgPSB0b3A7IGkgPCBib3R0b207IGkgKz0gdGhpcy5oZWlnaHQpIHtcclxuXHRcdFx0dGhpcy5kcmF3Mih4LCBpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geCAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB5IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHcgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaCAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdGRyYXdQYXR0ZXJuNGkoeCwgeSwgdywgaCkge1xyXG5cdFx0dGhpcy5kcmF3UGF0dGVybihNYXRoLnRydW5jKHggKyAwLjUpLCBNYXRoLnRydW5jKHkgKyAwLjUpLCBNYXRoLnRydW5jKHcgKyAwLjUpLCBNYXRoLnRydW5jKGggKyAwLjUpKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHggLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geSAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3IC0gdHlwZTogaW50XHJcblx0ICovXHJcblx0ZHJhd0hvcml6b250YWxQYXR0ZXJuM2koeCwgeSwgdykge1xyXG5cdFx0dGhpcy5kcmF3SG9yaXpvbnRhbFBhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyh3ICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaCAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdGRyYXdWZXJ0aWNhbFBhdHRlcm4zaSh4LCB5LCBoKSB7XHJcblx0XHR0aGlzLmRyYXdWZXJ0aWNhbFBhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyhoICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gdyAtIHR5cGU6IGludFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoIC0gdHlwZTogaW50XHJcblx0ICovXHJcblx0X2RyYXdQYXR0ZXJuNGkoeCwgeSwgdywgaCkge1xyXG5cdFx0dGhpcy5fZHJhd1BhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyh3ICsgMC41KSwgTWF0aC50cnVuYyhoICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gdyAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdF9kcmF3SG9yaXpvbnRhbFBhdHRlcm4zaSh4LCB5LCB3KSB7XHJcblx0XHR0aGlzLl9kcmF3SG9yaXpvbnRhbFBhdHRlcm4oTWF0aC50cnVuYyh4ICsgMC41KSwgTWF0aC50cnVuYyh5ICsgMC41KSwgTWF0aC50cnVuYyh3ICsgMC41KSk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIHdpdGhvdXQgY2xpcFxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4IC0gdHlwZTogaW50XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHkgLSB0eXBlOiBpbnRcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gaCAtIHR5cGU6IGludFxyXG5cdCAqL1xyXG5cdF9kcmF3VmVydGljYWxQYXR0ZXJuM2koeCwgeSwgaCkge1xyXG5cdFx0dGhpcy5fZHJhd1ZlcnRpY2FsUGF0dGVybihNYXRoLnRydW5jKHggKyAwLjUpLCBNYXRoLnRydW5jKHkgKyAwLjUpLCBNYXRoLnRydW5jKGggKyAwLjUpKTtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBfJFBhdHRlcm5TcHJpdGVfTG9hZGVkIGV4dGVuZHMgU3ByaXRlIHtcclxuXHQvKipcclxuXHQgKiBAcGFyYW0geyFhbnl9IHJhd1xyXG5cdCAqIEBwYXJhbSB7c3RyaW5nPX0gdXJsXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IocmF3LCB1cmwpIHtcclxuXHRcdHN1cGVyKHJhdywgdXJsKTtcclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuX2RpcmVjdGlvbiA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtDYW52YXNQYXR0ZXJufSAqL1xyXG5cdFx0dGhpcy5fcGF0dGVybiA9IG51bGw7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRnZXQgZGlyZWN0aW9uKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2RpcmVjdGlvbjtcclxuXHR9XHJcblx0c2V0IGRpcmVjdGlvbih2YWx1ZSkge1xyXG5cdFx0aWYgKHZhbHVlICYmIHRoaXMuX2RpcmVjdGlvbiAhPSB2YWx1ZSkge1xyXG5cdFx0XHR0aGlzLl9kaXJlY3Rpb24gPSB2YWx1ZTtcclxuXHRcclxuXHRcdFx0Ly9yZWxvYWQ7XHJcblx0XHRcdHRoaXMuX3BhdHRlcm4gPSBudWxsO1xyXG5cdFx0XHR0aGlzLl9fcHJvdG9fXyA9ICRQYXR0ZXJuU3ByaXRlLnByb3RvdHlwZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGhcclxuXHQgKi9cclxuXHRkcmF3UGF0dGVybih3LCBoKSB7XHJcblx0XHRpZiAodGhpcy5kaXJlY3Rpb24gJiYgdGhpcy5fcGF0dGVybikge1xyXG5cdFx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHRcclxuXHRcdFx0Y3R4LnJlY3QoLXRoaXMueCwgLXRoaXMueSwgdywgaCk7XHJcblx0XHRcdGN0eC5maWxsU3R5bGUgPSB0aGlzLl9wYXR0ZXJuO1xyXG5cdFx0XHRjdHguZmlsbCgpO1xyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gXCJuby1yZXBlYXRcIjtcclxuXHRcdH1cclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB3XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGhcclxuXHQgKi9cclxuXHRkcmF3UGF0dGVybjIoeCwgeSwgdywgaCkge1xyXG5cdFx0aWYgKHRoaXMuZGlyZWN0aW9uICYmIHRoaXMuX3BhdHRlcm4pIHtcclxuXHRcdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRcdGNvbnN0IGN0eCA9IHRoaXMuX2VuZ2luZS5jdHg7XHJcblx0XHJcblx0XHRcdGN0eC5yZWN0KHggLSB0aGlzLngsIHkgLSB0aGlzLnksIHcsIGgpO1xyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gdGhpcy5fcGF0dGVybjtcclxuXHRcdFx0Y3R4LmZpbGwoKTtcclxuXHRcdFx0Y3R4LmZpbGxTdHlsZSA9IFwibm8tcmVwZWF0XCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKiogQHJldHVybnMge1wicmVwZWF0XCJ9ICovXHJcblx0Z2V0IGVfcmVwZWF0KCkge1xyXG5cdFx0cmV0dXJuIFwicmVwZWF0XCI7XHJcblx0fVxyXG5cdC8qKiBAcmV0dXJucyB7XCJyZXBlYXQteFwifSAqL1xyXG5cdGdldCBlX3JlcGVhdF94KCkge1xyXG5cdFx0cmV0dXJuIFwicmVwZWF0LXhcIjtcclxuXHR9XHJcblx0LyoqIEByZXR1cm5zIHtcInJlcGVhdC15XCJ9ICovXHJcblx0Z2V0IGVfcmVwZWF0X3koKSB7XHJcblx0XHRyZXR1cm4gXCJyZXBlYXQteVwiO1xyXG5cdH1cclxuXHQvKiogQHJldHVybnMge1wibm8tcmVwZWF0XCJ9ICovXHJcblx0Z2V0IGVfbm9SZXBlYXQoKSB7XHJcblx0XHRyZXR1cm4gXCJuby1yZXBlYXRcIjtcclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyAkUGF0dGVyblNwcml0ZSBleHRlbmRzIF8kUGF0dGVyblNwcml0ZV9Mb2FkZWQge1xyXG5cdGRyYXdQYXR0ZXJuKHcsIGgpIHtcclxuXHRcdHRoaXMuZHJhd1BhdHRlcm4yKDAsIDAsIHcsIGgpO1xyXG5cdH1cclxuXHRkcmF3UGF0dGVybjIoeCwgeSwgdywgaCkge1xyXG5cdFx0aWYgKHRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHJcblx0XHRcdGN0eC5zYXZlKCk7XHJcblx0XHRcdHtcclxuXHRcdFx0XHRjdHgucmVjdCh4LCB5LCB3LCBoKTtcclxuXHRcdFx0XHRjdHguY2xpcCgpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGxldCBsZWZ0ID0geDtcclxuXHRcdFx0XHRsZXQgdG9wID0geTtcclxuXHRcdFx0XHRsZXQgcmlnaHQgPSB4ICsgdztcclxuXHRcdFx0XHRsZXQgYm90dG9tID0geSArIGg7XHJcblxyXG5cdFx0XHRcdGZvciAobGV0IGkgPSB0b3A7IGkgPCBib3R0b207IGkgKz0gdGhpcy5oZWlnaHQpIHtcclxuXHRcdFx0XHRcdGZvciAobGV0IGogPSBsZWZ0OyBqIDwgcmlnaHQ7IGogKz0gdGhpcy53aWR0aCkge1xyXG5cdFx0XHRcdFx0XHR0aGlzLmRyYXcyKGosIGkpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRjdHgucmVzdG9yZSgpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gd1xyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoXHJcblx0ICovXHJcblx0ZHJhd1BhdHRlcm4odywgaCkge1xyXG5cdFx0aWYgKHRoaXMuZGlyZWN0aW9uKSB7XHJcblx0XHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0XHRjb25zdCBjdHggPSB0aGlzLl9lbmdpbmUuY3R4O1xyXG5cdFxyXG5cdFx0XHRpZiAoIXRoaXMuX3BhdHRlcm4pIHtcclxuXHRcdFx0XHRpZiAodGhpcy5pc0xvYWRlZCgpKSB7XHJcblx0XHRcdFx0XHR0aGlzLl9wYXR0ZXJuID0gY3R4LmNyZWF0ZVBhdHRlcm4odGhpcy50ZXh0dXJlLCB0aGlzLmRpcmVjdGlvbik7XHJcblx0XHRcdFx0XHR0aGlzLl9fcHJvdG9fXyA9IF8kUGF0dGVyblNwcml0ZV9Mb2FkZWQucHJvdG90eXBlO1xyXG5cdFx0XHRcdFx0dGhpcy5kcmF3UGF0dGVybih3LCBoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSB4XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHlcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gd1xyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBoXHJcblx0ICovXHJcblx0ZHJhd1BhdHRlcm4yKHgsIHksIHcsIGgpIHtcclxuXHRcdGlmICh0aGlzLmRpcmVjdGlvbikge1xyXG5cdFx0XHQvKiogQHR5cGUge0NhbnZhc1JlbmRlcmluZ0NvbnRleHQyRH0gKi9cclxuXHRcdFx0Y29uc3QgY3R4ID0gdGhpcy5fZW5naW5lLmN0eDtcclxuXHRcclxuXHRcdFx0aWYgKCF0aGlzLl9wYXR0ZXJuKSB7XHJcblx0XHRcdFx0aWYgKHRoaXMuaXNMb2FkZWQoKSkge1xyXG5cdFx0XHRcdFx0dGhpcy5fcGF0dGVybiA9IGN0eC5jcmVhdGVQYXR0ZXJuKHRoaXMudGV4dHVyZSwgdGhpcy5kaXJlY3Rpb24pO1xyXG5cdFx0XHRcdFx0dGhpcy5fX3Byb3RvX18gPSBfJFBhdHRlcm5TcHJpdGVfTG9hZGVkLnByb3RvdHlwZTtcclxuXHRcdFx0XHRcdHRoaXMuZHJhd1BhdHRlcm4yKHgsIHksIHcsIGgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///347\n')},349:function(module,exports){eval('\ufeff\r\nclass ItemCategoryInfo {\r\n\t/**\r\n\t * @param {string} id_prefix\r\n\t * @param {string} path\r\n\t * @param {boolean} isOnFace\r\n\t * @param {string} slot - property name\r\n\t * @param {string} categoryName\r\n\t * @param {string} type\r\n\t * @param {string} [stringPath]\r\n\t */\r\n\tconstructor(id_prefix, imgDir, listPath, slot, categoryName, type, stringPath) {\r\n\t\tthis.id_prefix = id_prefix;\r\n\r\n\t\t/** data path */\r\n\t\tthis.path = imgDir;\r\n\r\n\t\t/** equip window */\r\n\t\tthis.slot = slot;\r\n\r\n\t\t/** item list file name */\r\n\t\tthis.listPath = listPath;\r\n\r\n\t\t/** display category name */\r\n\t\tthis.categoryName = categoryName;\r\n\r\n\t\t/** renderer */\r\n\t\tthis.FragmentType = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.dataDir = null;\r\n\t\t/** @type {string} */\r\n\t\tthis.stringDir = null;\r\n\t\t/** @type {string} */\r\n\t\tthis.iconPath = null;\r\n\t\t/** @type {string} */\r\n\t\tthis.iconRawPath = null;\r\n\t\t{\r\n\t\t\tlet dataDir, stringDir, iconPath, iconRawPath;\r\n\r\n\t\t\tswitch (slot) {\r\n\t\t\t\tcase "head":\r\n\t\t\t\t\ticonPath = "stand1/0/head";\r\n\t\t\t\t\ticonRawPath = "stand1/0/head";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase "body":\r\n\t\t\t\t\ticonPath = "stand1/0/body";\r\n\t\t\t\t\ticonRawPath = "stand1/0/body";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase "hair":\r\n\t\t\t\t\ticonPath = "stand1/0/hair";\r\n\t\t\t\t\ticonRawPath = "stand1/0/hair";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase "face":\r\n\t\t\t\t\ticonPath = "blink/0/face";\r\n\t\t\t\t\ticonRawPath = "blink/0/face";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault: // typeId: 0|1|2|3|4\r\n\t\t\t\t\ticonPath = "info/icon";\r\n\t\t\t\t\ticonRawPath = "info/iconRaw";\r\n\t\t\t}\r\n\r\n\t\t\tif (id_prefix == "5") {\r\n\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\tstringDir = "/String/Pet/";\r\n\t\t\t\talert("Pet");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tswitch (id_prefix[1]) {\r\n\t\t\t\t\tcase "0":\r\n\t\t\t\t\t\tif (Math.trunc(id_prefix) <= 1) {\r\n\t\t\t\t\t\t\tdataDir = "/Character/";\r\n\t\t\t\t\t\t\tstringDir = null;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase "1":\r\n\t\t\t\t\t\tlet s = imgDir + (imgDir ? "/" : "");\r\n\t\t\t\t\t\tdataDir = "/Character/" + s;\r\n\t\t\t\t\t\tstringDir = "/String/Eqp/Eqp/" + (stringPath || s);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "2":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Consume/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "3":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Ins/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "4":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Etc/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase "5":\r\n\t\t\t\t\t\tdataDir = `/Item/${imgDir}/${id_prefix}/`;\r\n\t\t\t\t\t\tstringDir = "/String/Cash/";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tthrow new Error("unknow item type, param: %o", [id_prefix, imgDir, listPath, slot, categoryName, type]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tObject.defineProperties(this, {\r\n\t\t\t\t"type": {\r\n\t\t\t\t\tvalue: type,\r\n\t\t\t\t},\r\n\t\t\t\t"dataDir": {\r\n\t\t\t\t\tvalue: dataDir,\r\n\t\t\t\t},\r\n\t\t\t\t"stringDir": {\r\n\t\t\t\t\tvalue: stringDir,\r\n\t\t\t\t},\r\n\t\t\t\t"iconPath": {\r\n\t\t\t\t\tvalue: iconPath,\r\n\t\t\t\t},\r\n\t\t\t\t"iconRawPath": {\r\n\t\t\t\t\tvalue: iconRawPath,\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string|null}\r\n\t */\r\n\tstatic getIconRawUrl(id) {\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tlet info = ItemCategoryInfo.get(id);\r\n\t\tif (!info) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (id[0] == "0") {\r\n\t\t\t//TODO: return path, not url\r\n\t\t\treturn info.dataDir + id + "/" + info.iconRawPath;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string|null}\r\n\t */\r\n\tstatic getIconUrl(id) {\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tlet info = ItemCategoryInfo.get(id);\r\n\t\tif (!info) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (id[0] == "0") {\r\n\t\t\t//TODO: return path, not url\r\n\t\t\treturn info.dataDir + id + "/" + info.iconPath;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id - 4+ digit string\r\n\t * @returns {ItemCategoryInfo}\r\n\t */\r\n\tstatic get(id) {\r\n\t\tlet info;\r\n\r\n\t\tif (id == null || id == "") {\r\n\t\t\tdebugger;\r\n\t\t\tthrow new TypeError();\r\n\t\t}\r\n\r\n\t\tif (id[0] == "0") {\r\n\t\t\tif (id.length == 4) {\r\n\t\t\t\tinfo = ItemCategoryInfo._info[id];\r\n\t\t\t\tif (info) {\r\n\t\t\t\t\treturn info;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse if (id.length == 6) {\r\n\t\t\t\treturn ItemCategoryInfo._info[id];\r\n\t\t\t}\r\n\t\t\telse if (id.length == 3) {\r\n\t\t\t\treturn ItemCategoryInfo._info[id];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tinfo = ItemCategoryInfo._info[id.slice(0, 4)];\r\n\t\t\t\tif (info) {\r\n\t\t\t\t\treturn info;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tinfo = ItemCategoryInfo._info[id.slice(0, 6)];\r\n\t\t\t\t\tif (info) {\r\n\t\t\t\t\t\treturn info;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tinfo = ItemCategoryInfo._info[id.slice(0, 3)];//019\r\n\t\t\t\t\t\tif (info) {\r\n\t\t\t\t\t\t\treturn info;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tconsole.warn("unknow item type, itemId: " + id);\r\n\t\treturn null;\r\n\t}\r\n\r\n\tstatic getTypeId() {\r\n\t\treturn Math.trunc(_id / 1000000);\r\n\t}\r\n\r\n\tstatic getCategory() {\r\n\t\treturn Math.trunc(_id / 10000);// % 100;// 0105 // 01 + 05 // type + category\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id - char[4]: type; char[4+]: itemId\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isItem(id) {\r\n\t\tlet type = Math.trunc(id / 1000000);//id.startsWith("00");\r\n\t\treturn type != 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id - char[4]: type; char[4+]: itemId\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isEquip(id) {\r\n\t\tif (!id) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\t\tlet _id = Number(id);\r\n\r\n\t\tif (!Number.isSafeInteger(_id)) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\r\n\t\t//let cate = Number(id.length == 4 ? id : id.slice(0, 4));\r\n\t\t//return (cate >= "0100" && cate < "0180");\r\n\r\n\t\t//let cate = Math.trunc(_id / 10000);\r\n\t\t//if (cate >= 180 && cate < 2000) {\r\n\t\t//\tconsole.warn("?? equip: " + id);\r\n\t\t//\tdebugger;\r\n\t\t//}\r\n\r\n\t\tlet type = Math.trunc(_id / 1000000);\r\n\r\n\t\treturn type == 1;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isSkin(id) {\r\n\t\treturn Math.trunc(id / 10000) == 0;\r\n\t\t//return id.startsWith("0000");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isBody(id) {\r\n\t\treturn Math.trunc(id / 10000) == 0;\r\n\t\t//return id.startsWith("0000");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isHead(id) {\r\n\t\treturn Math.trunc(id / 10000) == 1;\r\n\t\t//return id.startsWith("0000");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isFace(id) {\r\n\t\treturn Math.trunc(id / 10000) == 2;\r\n\t\t//return id.startsWith("0002");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string|number} id\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isHair(id) {\r\n\t\tconst i = Math.trunc(id / 10000);\r\n\t\treturn i == 3 || i == 4;\r\n\t\t//return id.startsWith("0003") || id.startsWith("0004");\r\n\t}\r\n\r\n\tstatic isChair(id) {\r\n\t\tif (!id) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\t\tlet _id = Number(id);\r\n\r\n\t\tif (!Number.isSafeInteger(_id)) {\r\n\t\t\tthrow TypeError();\r\n\t\t}\r\n\r\n\t\tlet cate = Math.trunc(_id / 10000);\r\n\r\n\t\treturn cate == 301;//0301xxxx\r\n\t}\r\n\r\n\t/**\r\n\t * 1~4 digit number\r\n\t * @param {string} itemId\r\n\t */\r\n\tstatic getSubCategory(itemId) {\r\n\t\treturn Math.trunc(itemId / 10000);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} itemId\r\n\t */\r\n\tstatic isCashWeapon(itemId) {\r\n\t\treturn Math.trunc(itemId / 10000) == 170;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} job\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getJobWeaponCategory(job) {\r\n\t\t//TODO: getJobWeaponCategory\r\n\t\tconsole.warn("getJobWeaponCategory: 未完成");\r\n\t}\r\n}\r\nItemCategoryInfo.type = {\r\n\tEquip: "Equip",\r\n\tConsume: "Consume",\r\n\tEtc: "Etc",\r\n\tInstall: "Install",\r\n\tCash: "Cash"\r\n};\r\nItemCategoryInfo.typeName = {\r\n\t0: "Equip",\r\n\t1: "Consume",\r\n\t2: "Etc",\r\n\t3: "Install",\r\n\t4: "Cash"\r\n};\r\nItemCategoryInfo.typeId = {\r\n\tEquip: 0,\r\n\tConsume: 1,\r\n\tEtc: 2,\r\n\tInstall: 3,\r\n\tCash: 4,\r\n};\r\nItemCategoryInfo._info = {\r\n\t"0000": new ItemCategoryInfo("0000", "", "body", "body", "<body>", "Equip"),\r\n\t"0001": new ItemCategoryInfo("0001", "", "head", "head", "<head>", "Equip"),\r\n\r\n\t"0002": new ItemCategoryInfo("0002", "Face", "Face", "face", "臉型", "Equip"),\r\n\t"0003": new ItemCategoryInfo("0003", "Hair", "Hair", "hair", "髮型", "Equip"),\r\n\t"0004": new ItemCategoryInfo("0004", "Hair", "Hair", "hair", "髮型", "Equip"),\r\n\r\n\t"0100": new ItemCategoryInfo("0100", "Cap", "Cap", "cap", "帽子", "Equip"),\r\n\t"0101": new ItemCategoryInfo("0101", "Accessory", "accessoryFace", "accessoryFace", "臉飾", "Equip"),\r\n\t"0102": new ItemCategoryInfo("0102", "Accessory", "accessoryEyes", "accessoryEyes", "眼飾", "Equip"),\r\n\t"0103": new ItemCategoryInfo("0103", "Accessory", "accessoryEars", "accessoryEars", "耳環", "Equip"),\r\n\t"0104": new ItemCategoryInfo("0104", "Coat", "Coat", "coat", "上衣", "Equip"),\r\n\t"0105": new ItemCategoryInfo("0105", "Longcoat", "Longcoat", "longcoat", "套服", "Equip"),\r\n\t"0106": new ItemCategoryInfo("0106", "Pants", "Pants", "pants", "褲子", "Equip"),\r\n\t"0107": new ItemCategoryInfo("0107", "Shoes", "Shoes", "shoes", "鞋子", "Equip"),\r\n\t"0108": new ItemCategoryInfo("0108", "Glove", "Glove", "glove", "手套", "Equip"),\r\n\t"0109": new ItemCategoryInfo("0109", "Shield", "Shield", "shield", "盾牌", "Equip"),\r\n\t"0110": new ItemCategoryInfo("0110", "Cape", "Cape", "cape", "披風", "Equip"),\r\n\r\n\t"0121": new ItemCategoryInfo("0121", "Weapon", "閃亮克魯", "weapon", "閃亮克魯", "Equip"),\r\n\t"0122": new ItemCategoryInfo("0122", "Weapon", "靈魂射手", "weapon", "靈魂射手", "Equip"),\r\n\t"0123": new ItemCategoryInfo("0123", "Weapon", "魔劍", "weapon", "魔劍", "Equip"),\r\n\t"0124": new ItemCategoryInfo("0124", "Weapon", "能量劍", "weapon", "能量劍", "Equip"),\r\n\t"0125": new ItemCategoryInfo("0125", "Weapon", "幻獸棒", "weapon", "幻獸棒", "Equip"),\r\n\t"0126": new ItemCategoryInfo("0126", "Weapon", "ESP限制器", "weapon", "ESP限制器", "Equip"),\r\n\t"0127": new ItemCategoryInfo("0127", "Weapon", "鎖鏈", "weapon", "鎖鏈", "Equip"),\r\n\t"0128": new ItemCategoryInfo("0128", "Weapon", "魔力護腕", "weapon", "魔力護腕", "Equip"),\r\n\r\n\t"0130": new ItemCategoryInfo("0130", "Weapon", "單手劍", "weapon", "單手劍", "Equip"),\r\n\t"0131": new ItemCategoryInfo("0131", "Weapon", "單手斧", "weapon", "單手斧", "Equip"),\r\n\t"0132": new ItemCategoryInfo("0132", "Weapon", "單手錘", "weapon", "單手錘", "Equip"),\r\n\t"0133": new ItemCategoryInfo("0133", "Weapon", "短劍", "weapon", "短劍", "Equip"),\r\n\t"0134": new ItemCategoryInfo("0134", "Weapon", "雙刀", "weapon", "雙刀", "Equip"),\r\n\t"013526": new ItemCategoryInfo("013526", "Weapon", "靈魂之環", "weapon", "靈魂之環", "Equip"),\r\n\t"013530": new ItemCategoryInfo("013530", "Weapon", "控制器", "weapon", "控制器", "Equip"),\r\n\t"0136": new ItemCategoryInfo("0136", "Weapon", "手杖", "weapon", "手杖", "Equip"),\r\n\t"0137": new ItemCategoryInfo("0137", "Weapon", "短杖", "weapon", "短杖", "Equip"),\r\n\t"0138": new ItemCategoryInfo("0138", "Weapon", "長杖", "weapon", "長杖", "Equip"),\r\n\r\n\t"0140": new ItemCategoryInfo("0140", "Weapon", "雙手劍", "weapon", "雙手劍", "Equip"),\r\n\t"0141": new ItemCategoryInfo("0141", "Weapon", "雙手斧", "weapon", "雙手斧", "Equip"),\r\n\t"0142": new ItemCategoryInfo("0142", "Weapon", "雙手棍", "weapon", "雙手棍", "Equip"),\r\n\t"0143": new ItemCategoryInfo("0143", "Weapon", "槍", "weapon", "槍", "Equip"),\r\n\t"0144": new ItemCategoryInfo("0144", "Weapon", "矛", "weapon", "矛", "Equip"),\r\n\t"0145": new ItemCategoryInfo("0145", "Weapon", "弓", "weapon", "弓", "Equip"),\r\n\t"0146": new ItemCategoryInfo("0146", "Weapon", "弩", "weapon", "弩", "Equip"),\r\n\t"0147": new ItemCategoryInfo("0147", "Weapon", "拳套", "weapon", "拳套", "Equip"),\r\n\t"0148": new ItemCategoryInfo("0148", "Weapon", "指虎", "weapon", "指虎", "Equip"),\r\n\t"0149": new ItemCategoryInfo("0149", "Weapon", "火槍", "weapon", "火槍", "Equip"),\r\n\t"0150": new ItemCategoryInfo("0150", "Weapon", "鏟", "weapon", "鏟", "Equip"),\r\n\t"0151": new ItemCategoryInfo("0151", "Weapon", "鎬", "weapon", "鎬", "Equip"),\r\n\t"0152": new ItemCategoryInfo("0152", "Weapon", "雙弩槍", "weapon", "雙弩槍", "Equip"),\r\n\t"0153": new ItemCategoryInfo("0153", "Weapon", "加農砲", "weapon", "加農砲", "Equip"),\r\n\t"0154": new ItemCategoryInfo("0154", "Weapon", "太刀", "weapon", "太刀", "Equip"),\r\n\t"0155": new ItemCategoryInfo("0155", "Weapon", "扇子", "weapon", "扇子", "Equip"),\r\n\t"0156": new ItemCategoryInfo("0156", "Weapon", "琉", "weapon", "琉", "Equip"),\r\n\t"0157": new ItemCategoryInfo("0157", "Weapon", "璃", "weapon", "璃", "Equip"),\r\n\t"0158": new ItemCategoryInfo("0158", "Weapon", "重拳槍", "weapon", "重拳槍", "Equip"),\r\n\t"0170": new ItemCategoryInfo("0170", "Weapon", "0170", "weapon", "點裝武器", "Equip"),\r\n\t"019": new ItemCategoryInfo("019", "TamingMob", "TamingMob", "tamingMob", "騎寵", "Equip", "Taming/"),\r\n\r\n\t"0301": new ItemCategoryInfo("0301", "Install", "Chair", "install", "椅子", "Item"),\r\n};\r\n\r\nItemCategoryInfo._categoryList = (function (info_map) {\r\n\tlet list = [];\r\n\tlet set = new Set();\r\n\tfor (let i in info_map) {\r\n\t\tlet cat = info_map[i];\r\n\t\tlet key = cat.categoryName || cat.listPath;\r\n\r\n\t\tif (!set.has(key)) {\r\n\t\t\tset.add(key);\r\n\r\n\t\t\tlist.push({\r\n\t\t\t\tkey: key,\r\n\t\t\t\tvalue: i,\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\treturn list;\r\n})(ItemCategoryInfo._info);\r\n\r\n\r\n/** @type {Map<string,ItemCategoryInfo} */\r\nItemCategoryInfo.map_slot_to_info = (function () {\r\n\t/** @type {Map<string,ItemCategoryInfo} */\r\n\tconst map = new Map();\r\n\tObject.values(ItemCategoryInfo._info).forEach(info => {\r\n\t\tmap.set(info.slot, info);\r\n\t});\r\n\treturn map;\r\n})();\r\n\r\n\r\nclass EquipSlotsMap {\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {number} slotId\r\n\t * @returns {string} slotName\r\n\t */\r\n\tstatic toName(equipType, slotId) {\r\n\t\treturn EquipSlotsMap.slots_to_name_map[equipType][slotId];\r\n\t}\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {ItemCategoryInfo} info\r\n\t * @returns {number} slotId\r\n\t */\r\n\tstatic infoToSlot(equipType, info) {\r\n\t\treturn EquipSlotsMap.map_slots_to_typeInfo[equipType].get(info);\r\n\t}\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {string} itemId\r\n\t * @returns {number} slotId\r\n\t */\r\n\tstatic itemIdToSlot(equipType, itemId) {\r\n\t\tlet info = ItemCategoryInfo.get(itemId);\r\n\t\treturn EquipSlotsMap.map_slots_to_typeInfo[equipType].get(info);\r\n\t}\r\n\t/**\r\n\t * @param {string} equipType\r\n\t * @param {string} slotName\r\n\t * @returns {number} slotId\r\n\t */\r\n\tstatic toSlot(equipType, slotName) {\r\n\t\treturn EquipSlotsMap.name_to_slots_map[equipType][slotName];\r\n\t}\r\n}\r\n\r\nEquipSlotsMap.slots_to_name_map = {\r\n\tEquip: {\r\n\t\t1: "cap",\r\n\t\t2: "accessoryFace",\r\n\t\t3: "accessoryEyes",\r\n\t\t4: "accessoryEars",\r\n\t\t5: "coat",\r\n\t\t5: "longcoat",\r\n\t\t6: "pants",\r\n\t\t7: "shoes",\r\n\t\t8: "glove",\r\n\t\t9: "cape",\r\n\t\t10: "shield",\r\n\t\t11: "weapon",\r\n\t},\r\n\tCash: {\r\n\t},\r\n}\r\nObject.keys(EquipSlotsMap.slots_to_name_map.Equip).forEach(slot => {\r\n\tEquipSlotsMap.slots_to_name_map.Cash[Number(slot) + 100] = EquipSlotsMap.slots_to_name_map.Equip[slot];\r\n});\r\n\r\nEquipSlotsMap.map_slots_to_typeInfo = {\r\n};\r\nObject.entries(EquipSlotsMap.slots_to_name_map).forEach(([slotTypeName, slots]) => {\r\n\tconst sti = ItemCategoryInfo.map_slot_to_info;\r\n\tconst typedSlots = EquipSlotsMap.map_slots_to_typeInfo[slotTypeName] = new Map();\r\n\r\n\tObject.entries(slots).forEach(function ([slotId, slotName]) {\r\n\t\tconst info = sti.get(slotName);\r\n\t\ttypedSlots.set(info, slotId);\r\n\t})\r\n});\r\n\r\nEquipSlotsMap.name_to_slots_map = {\r\n};\r\nObject.entries(EquipSlotsMap.slots_to_name_map).forEach(([slotTypeName, slots]) => {\r\n\tconst sti = ItemCategoryInfo.map_slot_to_info;\r\n\tconst typedSlots = EquipSlotsMap.name_to_slots_map[slotTypeName] = {};\r\n\r\n\tObject.entries(slots).forEach(function ([slotId, slotName]) {\r\n\t\tconst info = sti.get(slotName);\r\n\t\ttypedSlots[info.slot] = slotId;\r\n\t})\r\n});\r\n\r\n\r\nmodule.exports = {\r\n\tItemCategoryInfo,\r\n\tEquipSlotsMap,\r\n};\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzQ5LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL0NvbW1vbi9JdGVtQ2F0ZWdvcnlJbmZvLmpzPzVhNjMiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmNsYXNzIEl0ZW1DYXRlZ29yeUluZm8ge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZF9wcmVmaXhcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG5cdCAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNPbkZhY2VcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc2xvdCAtIHByb3BlcnR5IG5hbWVcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gY2F0ZWdvcnlOYW1lXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHR5cGVcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gW3N0cmluZ1BhdGhdXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IoaWRfcHJlZml4LCBpbWdEaXIsIGxpc3RQYXRoLCBzbG90LCBjYXRlZ29yeU5hbWUsIHR5cGUsIHN0cmluZ1BhdGgpIHtcclxuXHRcdHRoaXMuaWRfcHJlZml4ID0gaWRfcHJlZml4O1xyXG5cclxuXHRcdC8qKiBkYXRhIHBhdGggKi9cclxuXHRcdHRoaXMucGF0aCA9IGltZ0RpcjtcclxuXHJcblx0XHQvKiogZXF1aXAgd2luZG93ICovXHJcblx0XHR0aGlzLnNsb3QgPSBzbG90O1xyXG5cclxuXHRcdC8qKiBpdGVtIGxpc3QgZmlsZSBuYW1lICovXHJcblx0XHR0aGlzLmxpc3RQYXRoID0gbGlzdFBhdGg7XHJcblxyXG5cdFx0LyoqIGRpc3BsYXkgY2F0ZWdvcnkgbmFtZSAqL1xyXG5cdFx0dGhpcy5jYXRlZ29yeU5hbWUgPSBjYXRlZ29yeU5hbWU7XHJcblxyXG5cdFx0LyoqIHJlbmRlcmVyICovXHJcblx0XHR0aGlzLkZyYWdtZW50VHlwZSA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmRhdGFEaXIgPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLnN0cmluZ0RpciA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuaWNvblBhdGggPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHR0aGlzLmljb25SYXdQYXRoID0gbnVsbDtcclxuXHRcdHtcclxuXHRcdFx0bGV0IGRhdGFEaXIsIHN0cmluZ0RpciwgaWNvblBhdGgsIGljb25SYXdQYXRoO1xyXG5cclxuXHRcdFx0c3dpdGNoIChzbG90KSB7XHJcblx0XHRcdFx0Y2FzZSBcImhlYWRcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJzdGFuZDEvMC9oZWFkXCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwic3RhbmQxLzAvaGVhZFwiO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImJvZHlcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJzdGFuZDEvMC9ib2R5XCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwic3RhbmQxLzAvYm9keVwiO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImhhaXJcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJzdGFuZDEvMC9oYWlyXCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwic3RhbmQxLzAvaGFpclwiO1xyXG5cdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0Y2FzZSBcImZhY2VcIjpcclxuXHRcdFx0XHRcdGljb25QYXRoID0gXCJibGluay8wL2ZhY2VcIjtcclxuXHRcdFx0XHRcdGljb25SYXdQYXRoID0gXCJibGluay8wL2ZhY2VcIjtcclxuXHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdGRlZmF1bHQ6IC8vIHR5cGVJZDogMHwxfDJ8M3w0XHJcblx0XHRcdFx0XHRpY29uUGF0aCA9IFwiaW5mby9pY29uXCI7XHJcblx0XHRcdFx0XHRpY29uUmF3UGF0aCA9IFwiaW5mby9pY29uUmF3XCI7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChpZF9wcmVmaXggPT0gXCI1XCIpIHtcclxuXHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRzdHJpbmdEaXIgPSBcIi9TdHJpbmcvUGV0L1wiO1xyXG5cdFx0XHRcdGFsZXJ0KFwiUGV0XCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHN3aXRjaCAoaWRfcHJlZml4WzFdKSB7XHJcblx0XHRcdFx0XHRjYXNlIFwiMFwiOlxyXG5cdFx0XHRcdFx0XHRpZiAoTWF0aC50cnVuYyhpZF9wcmVmaXgpIDw9IDEpIHtcclxuXHRcdFx0XHRcdFx0XHRkYXRhRGlyID0gXCIvQ2hhcmFjdGVyL1wiO1xyXG5cdFx0XHRcdFx0XHRcdHN0cmluZ0RpciA9IG51bGw7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGNhc2UgXCIxXCI6XHJcblx0XHRcdFx0XHRcdGxldCBzID0gaW1nRGlyICsgKGltZ0RpciA/IFwiL1wiIDogXCJcIik7XHJcblx0XHRcdFx0XHRcdGRhdGFEaXIgPSBcIi9DaGFyYWN0ZXIvXCIgKyBzO1xyXG5cdFx0XHRcdFx0XHRzdHJpbmdEaXIgPSBcIi9TdHJpbmcvRXFwL0VxcC9cIiArIChzdHJpbmdQYXRoIHx8IHMpO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdGNhc2UgXCIyXCI6XHJcblx0XHRcdFx0XHRcdGRhdGFEaXIgPSBgL0l0ZW0vJHtpbWdEaXJ9LyR7aWRfcHJlZml4fS9gO1xyXG5cdFx0XHRcdFx0XHRzdHJpbmdEaXIgPSBcIi9TdHJpbmcvQ29uc3VtZS9cIjtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwiM1wiOlxyXG5cdFx0XHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRcdFx0c3RyaW5nRGlyID0gXCIvU3RyaW5nL0lucy9cIjtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwiNFwiOlxyXG5cdFx0XHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRcdFx0c3RyaW5nRGlyID0gXCIvU3RyaW5nL0V0Yy9cIjtcclxuXHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRjYXNlIFwiNVwiOlxyXG5cdFx0XHRcdFx0XHRkYXRhRGlyID0gYC9JdGVtLyR7aW1nRGlyfS8ke2lkX3ByZWZpeH0vYDtcclxuXHRcdFx0XHRcdFx0c3RyaW5nRGlyID0gXCIvU3RyaW5nL0Nhc2gvXCI7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0ZGVmYXVsdDpcclxuXHRcdFx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKFwidW5rbm93IGl0ZW0gdHlwZSwgcGFyYW06ICVvXCIsIFtpZF9wcmVmaXgsIGltZ0RpciwgbGlzdFBhdGgsIHNsb3QsIGNhdGVnb3J5TmFtZSwgdHlwZV0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcywge1xyXG5cdFx0XHRcdFwidHlwZVwiOiB7XHJcblx0XHRcdFx0XHR2YWx1ZTogdHlwZSxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiZGF0YURpclwiOiB7XHJcblx0XHRcdFx0XHR2YWx1ZTogZGF0YURpcixcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwic3RyaW5nRGlyXCI6IHtcclxuXHRcdFx0XHRcdHZhbHVlOiBzdHJpbmdEaXIsXHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRcImljb25QYXRoXCI6IHtcclxuXHRcdFx0XHRcdHZhbHVlOiBpY29uUGF0aCxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdFwiaWNvblJhd1BhdGhcIjoge1xyXG5cdFx0XHRcdFx0dmFsdWU6IGljb25SYXdQYXRoLFxyXG5cdFx0XHRcdH0sXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHJldHVybnMge3N0cmluZ3xudWxsfVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBnZXRJY29uUmF3VXJsKGlkKSB7XHJcblx0XHQvKiogQHR5cGUge0l0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0XHRsZXQgaW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KGlkKTtcclxuXHRcdGlmICghaW5mbykge1xyXG5cdFx0XHRyZXR1cm4gbnVsbDtcclxuXHRcdH1cclxuXHRcdGlmIChpZFswXSA9PSBcIjBcIikge1xyXG5cdFx0XHQvL1RPRE86IHJldHVybiBwYXRoLCBub3QgdXJsXHJcblx0XHRcdHJldHVybiBpbmZvLmRhdGFEaXIgKyBpZCArIFwiL1wiICsgaW5mby5pY29uUmF3UGF0aDtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd8bnVsbH1cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0SWNvblVybChpZCkge1xyXG5cdFx0LyoqIEB0eXBlIHtJdGVtQ2F0ZWdvcnlJbmZvfSAqL1xyXG5cdFx0bGV0IGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldChpZCk7XHJcblx0XHRpZiAoIWluZm8pIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAoaWRbMF0gPT0gXCIwXCIpIHtcclxuXHRcdFx0Ly9UT0RPOiByZXR1cm4gcGF0aCwgbm90IHVybFxyXG5cdFx0XHRyZXR1cm4gaW5mby5kYXRhRGlyICsgaWQgKyBcIi9cIiArIGluZm8uaWNvblBhdGg7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSA0KyBkaWdpdCBzdHJpbmdcclxuXHQgKiBAcmV0dXJucyB7SXRlbUNhdGVnb3J5SW5mb31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0KGlkKSB7XHJcblx0XHRsZXQgaW5mbztcclxuXHJcblx0XHRpZiAoaWQgPT0gbnVsbCB8fCBpZCA9PSBcIlwiKSB7XHJcblx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGlkWzBdID09IFwiMFwiKSB7XHJcblx0XHRcdGlmIChpZC5sZW5ndGggPT0gNCkge1xyXG5cdFx0XHRcdGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvW2lkXTtcclxuXHRcdFx0XHRpZiAoaW5mbykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGlkLmxlbmd0aCA9PSA2KSB7XHJcblx0XHRcdFx0cmV0dXJuIEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWRdO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGlkLmxlbmd0aCA9PSAzKSB7XHJcblx0XHRcdFx0cmV0dXJuIEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWRdO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGluZm8gPSBJdGVtQ2F0ZWdvcnlJbmZvLl9pbmZvW2lkLnNsaWNlKDAsIDQpXTtcclxuXHRcdFx0XHRpZiAoaW5mbykge1xyXG5cdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0aW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWQuc2xpY2UoMCwgNildO1xyXG5cdFx0XHRcdFx0aWYgKGluZm8pIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0aW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uX2luZm9baWQuc2xpY2UoMCwgMyldOy8vMDE5XHJcblx0XHRcdFx0XHRcdGlmIChpbmZvKSB7XHJcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGluZm87XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNvbnNvbGUud2FybihcInVua25vdyBpdGVtIHR5cGUsIGl0ZW1JZDogXCIgKyBpZCk7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBnZXRUeXBlSWQoKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhfaWQgLyAxMDAwMDAwKTtcclxuXHR9XHJcblxyXG5cdHN0YXRpYyBnZXRDYXRlZ29yeSgpIHtcclxuXHRcdHJldHVybiBNYXRoLnRydW5jKF9pZCAvIDEwMDAwKTsvLyAlIDEwMDsvLyAwMTA1IC8vIDAxICsgMDUgLy8gdHlwZSArIGNhdGVnb3J5XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWQgLSBjaGFyWzRdOiB0eXBlOyBjaGFyWzQrXTogaXRlbUlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzSXRlbShpZCkge1xyXG5cdFx0bGV0IHR5cGUgPSBNYXRoLnRydW5jKGlkIC8gMTAwMDAwMCk7Ly9pZC5zdGFydHNXaXRoKFwiMDBcIik7XHJcblx0XHRyZXR1cm4gdHlwZSAhPSAwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkIC0gY2hhcls0XTogdHlwZTsgY2hhcls0K106IGl0ZW1JZFxyXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBpc0VxdWlwKGlkKSB7XHJcblx0XHRpZiAoIWlkKSB7XHJcblx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xyXG5cdFx0fVxyXG5cdFx0bGV0IF9pZCA9IE51bWJlcihpZCk7XHJcblxyXG5cdFx0aWYgKCFOdW1iZXIuaXNTYWZlSW50ZWdlcihfaWQpKSB7XHJcblx0XHRcdHRocm93IFR5cGVFcnJvcigpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vbGV0IGNhdGUgPSBOdW1iZXIoaWQubGVuZ3RoID09IDQgPyBpZCA6IGlkLnNsaWNlKDAsIDQpKTtcclxuXHRcdC8vcmV0dXJuIChjYXRlID49IFwiMDEwMFwiICYmIGNhdGUgPCBcIjAxODBcIik7XHJcblxyXG5cdFx0Ly9sZXQgY2F0ZSA9IE1hdGgudHJ1bmMoX2lkIC8gMTAwMDApO1xyXG5cdFx0Ly9pZiAoY2F0ZSA+PSAxODAgJiYgY2F0ZSA8IDIwMDApIHtcclxuXHRcdC8vXHRjb25zb2xlLndhcm4oXCI/PyBlcXVpcDogXCIgKyBpZCk7XHJcblx0XHQvL1x0ZGVidWdnZXI7XHJcblx0XHQvL31cclxuXHJcblx0XHRsZXQgdHlwZSA9IE1hdGgudHJ1bmMoX2lkIC8gMTAwMDAwMCk7XHJcblxyXG5cdFx0cmV0dXJuIHR5cGUgPT0gMTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRcclxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRzdGF0aWMgaXNTa2luKGlkKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhpZCAvIDEwMDAwKSA9PSAwO1xyXG5cdFx0Ly9yZXR1cm4gaWQuc3RhcnRzV2l0aChcIjAwMDBcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzQm9keShpZCkge1xyXG5cdFx0cmV0dXJuIE1hdGgudHJ1bmMoaWQgLyAxMDAwMCkgPT0gMDtcclxuXHRcdC8vcmV0dXJuIGlkLnN0YXJ0c1dpdGgoXCIwMDAwXCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyfSBpZFxyXG5cdCAqIEByZXR1cm5zIHtib29sZWFufVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBpc0hlYWQoaWQpIHtcclxuXHRcdHJldHVybiBNYXRoLnRydW5jKGlkIC8gMTAwMDApID09IDE7XHJcblx0XHQvL3JldHVybiBpZC5zdGFydHNXaXRoKFwiMDAwMFwiKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfG51bWJlcn0gaWRcclxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRzdGF0aWMgaXNGYWNlKGlkKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhpZCAvIDEwMDAwKSA9PSAyO1xyXG5cdFx0Ly9yZXR1cm4gaWQuc3RhcnRzV2l0aChcIjAwMDJcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ3xudW1iZXJ9IGlkXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzSGFpcihpZCkge1xyXG5cdFx0Y29uc3QgaSA9IE1hdGgudHJ1bmMoaWQgLyAxMDAwMCk7XHJcblx0XHRyZXR1cm4gaSA9PSAzIHx8IGkgPT0gNDtcclxuXHRcdC8vcmV0dXJuIGlkLnN0YXJ0c1dpdGgoXCIwMDAzXCIpIHx8IGlkLnN0YXJ0c1dpdGgoXCIwMDA0XCIpO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGlzQ2hhaXIoaWQpIHtcclxuXHRcdGlmICghaWQpIHtcclxuXHRcdFx0dGhyb3cgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblx0XHRsZXQgX2lkID0gTnVtYmVyKGlkKTtcclxuXHJcblx0XHRpZiAoIU51bWJlci5pc1NhZmVJbnRlZ2VyKF9pZCkpIHtcclxuXHRcdFx0dGhyb3cgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IGNhdGUgPSBNYXRoLnRydW5jKF9pZCAvIDEwMDAwKTtcclxuXHJcblx0XHRyZXR1cm4gY2F0ZSA9PSAzMDE7Ly8wMzAxeHh4eFxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogMX40IGRpZ2l0IG51bWJlclxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWRcclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0U3ViQ2F0ZWdvcnkoaXRlbUlkKSB7XHJcblx0XHRyZXR1cm4gTWF0aC50cnVuYyhpdGVtSWQgLyAxMDAwMCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaXRlbUlkXHJcblx0ICovXHJcblx0c3RhdGljIGlzQ2FzaFdlYXBvbihpdGVtSWQpIHtcclxuXHRcdHJldHVybiBNYXRoLnRydW5jKGl0ZW1JZCAvIDEwMDAwKSA9PSAxNzA7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gam9iXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0Sm9iV2VhcG9uQ2F0ZWdvcnkoam9iKSB7XHJcblx0XHQvL1RPRE86IGdldEpvYldlYXBvbkNhdGVnb3J5XHJcblx0XHRjb25zb2xlLndhcm4oXCJnZXRKb2JXZWFwb25DYXRlZ29yeTog5pyq5a6M5oiQXCIpO1xyXG5cdH1cclxufVxyXG5JdGVtQ2F0ZWdvcnlJbmZvLnR5cGUgPSB7XHJcblx0RXF1aXA6IFwiRXF1aXBcIixcclxuXHRDb25zdW1lOiBcIkNvbnN1bWVcIixcclxuXHRFdGM6IFwiRXRjXCIsXHJcblx0SW5zdGFsbDogXCJJbnN0YWxsXCIsXHJcblx0Q2FzaDogXCJDYXNoXCJcclxufTtcclxuSXRlbUNhdGVnb3J5SW5mby50eXBlTmFtZSA9IHtcclxuXHQwOiBcIkVxdWlwXCIsXHJcblx0MTogXCJDb25zdW1lXCIsXHJcblx0MjogXCJFdGNcIixcclxuXHQzOiBcIkluc3RhbGxcIixcclxuXHQ0OiBcIkNhc2hcIlxyXG59O1xyXG5JdGVtQ2F0ZWdvcnlJbmZvLnR5cGVJZCA9IHtcclxuXHRFcXVpcDogMCxcclxuXHRDb25zdW1lOiAxLFxyXG5cdEV0YzogMixcclxuXHRJbnN0YWxsOiAzLFxyXG5cdENhc2g6IDQsXHJcbn07XHJcbkl0ZW1DYXRlZ29yeUluZm8uX2luZm8gPSB7XHJcblx0XCIwMDAwXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDAwMFwiLCBcIlwiLCBcImJvZHlcIiwgXCJib2R5XCIsIFwiPGJvZHk+XCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMDAxXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDAwMVwiLCBcIlwiLCBcImhlYWRcIiwgXCJoZWFkXCIsIFwiPGhlYWQ+XCIsIFwiRXF1aXBcIiksXHJcblxyXG5cdFwiMDAwMlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAwMDJcIiwgXCJGYWNlXCIsIFwiRmFjZVwiLCBcImZhY2VcIiwgXCLoh4nlnotcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAwMDNcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMDAzXCIsIFwiSGFpclwiLCBcIkhhaXJcIiwgXCJoYWlyXCIsIFwi6auu5Z6LXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMDA0XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDAwNFwiLCBcIkhhaXJcIiwgXCJIYWlyXCIsIFwiaGFpclwiLCBcIumrruWei1wiLCBcIkVxdWlwXCIpLFxyXG5cclxuXHRcIjAxMDBcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTAwXCIsIFwiQ2FwXCIsIFwiQ2FwXCIsIFwiY2FwXCIsIFwi5bi95a2QXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTAxXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwMVwiLCBcIkFjY2Vzc29yeVwiLCBcImFjY2Vzc29yeUZhY2VcIiwgXCJhY2Nlc3NvcnlGYWNlXCIsIFwi6IeJ6aO+XCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTAyXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwMlwiLCBcIkFjY2Vzc29yeVwiLCBcImFjY2Vzc29yeUV5ZXNcIiwgXCJhY2Nlc3NvcnlFeWVzXCIsIFwi55y86aO+XCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTAzXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwM1wiLCBcIkFjY2Vzc29yeVwiLCBcImFjY2Vzc29yeUVhcnNcIiwgXCJhY2Nlc3NvcnlFYXJzXCIsIFwi6ICz55KwXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTA0XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwNFwiLCBcIkNvYXRcIiwgXCJDb2F0XCIsIFwiY29hdFwiLCBcIuS4iuiho1wiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEwNVwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMDVcIiwgXCJMb25nY29hdFwiLCBcIkxvbmdjb2F0XCIsIFwibG9uZ2NvYXRcIiwgXCLlpZfmnI1cIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMDZcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTA2XCIsIFwiUGFudHNcIiwgXCJQYW50c1wiLCBcInBhbnRzXCIsIFwi6KSy5a2QXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTA3XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEwN1wiLCBcIlNob2VzXCIsIFwiU2hvZXNcIiwgXCJzaG9lc1wiLCBcIumei+WtkFwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEwOFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMDhcIiwgXCJHbG92ZVwiLCBcIkdsb3ZlXCIsIFwiZ2xvdmVcIiwgXCLmiYvlpZdcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMDlcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTA5XCIsIFwiU2hpZWxkXCIsIFwiU2hpZWxkXCIsIFwic2hpZWxkXCIsIFwi55u+54mMXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTEwXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDExMFwiLCBcIkNhcGVcIiwgXCJDYXBlXCIsIFwiY2FwZVwiLCBcIuaKq+miqFwiLCBcIkVxdWlwXCIpLFxyXG5cclxuXHRcIjAxMjFcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTIxXCIsIFwiV2VhcG9uXCIsIFwi6ZaD5Lqu5YWL6a2vXCIsIFwid2VhcG9uXCIsIFwi6ZaD5Lqu5YWL6a2vXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTIyXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEyMlwiLCBcIldlYXBvblwiLCBcIumdiOmtguWwhOaJi1wiLCBcIndlYXBvblwiLCBcIumdiOmtguWwhOaJi1wiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEyM1wiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMjNcIiwgXCJXZWFwb25cIiwgXCLprZTlio1cIiwgXCJ3ZWFwb25cIiwgXCLprZTlio1cIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMjRcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTI0XCIsIFwiV2VhcG9uXCIsIFwi6IO96YeP5YqNXCIsIFwid2VhcG9uXCIsIFwi6IO96YeP5YqNXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTI1XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEyNVwiLCBcIldlYXBvblwiLCBcIuW5u+eNuOajklwiLCBcIndlYXBvblwiLCBcIuW5u+eNuOajklwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEyNlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMjZcIiwgXCJXZWFwb25cIiwgXCJFU1DpmZDliLblmahcIiwgXCJ3ZWFwb25cIiwgXCJFU1DpmZDliLblmahcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMjdcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTI3XCIsIFwiV2VhcG9uXCIsIFwi6Y6W6Y+IXCIsIFwid2VhcG9uXCIsIFwi6Y6W6Y+IXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTI4XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEyOFwiLCBcIldlYXBvblwiLCBcIumtlOWKm+itt+iFlVwiLCBcIndlYXBvblwiLCBcIumtlOWKm+itt+iFlVwiLCBcIkVxdWlwXCIpLFxyXG5cclxuXHRcIjAxMzBcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTMwXCIsIFwiV2VhcG9uXCIsIFwi5Zau5omL5YqNXCIsIFwid2VhcG9uXCIsIFwi5Zau5omL5YqNXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTMxXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzMVwiLCBcIldlYXBvblwiLCBcIuWWruaJi+aWp1wiLCBcIndlYXBvblwiLCBcIuWWruaJi+aWp1wiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEzMlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMzJcIiwgXCJXZWFwb25cIiwgXCLllq7miYvpjJhcIiwgXCJ3ZWFwb25cIiwgXCLllq7miYvpjJhcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMzNcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTMzXCIsIFwiV2VhcG9uXCIsIFwi55+t5YqNXCIsIFwid2VhcG9uXCIsIFwi55+t5YqNXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTM0XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzNFwiLCBcIldlYXBvblwiLCBcIumbmeWIgFwiLCBcIndlYXBvblwiLCBcIumbmeWIgFwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEzNTI2XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzNTI2XCIsIFwiV2VhcG9uXCIsIFwi6Z2I6a2C5LmL55KwXCIsIFwid2VhcG9uXCIsIFwi6Z2I6a2C5LmL55KwXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTM1MzBcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTM1MzBcIiwgXCJXZWFwb25cIiwgXCLmjqfliLblmahcIiwgXCJ3ZWFwb25cIiwgXCLmjqfliLblmahcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxMzZcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTM2XCIsIFwiV2VhcG9uXCIsIFwi5omL5p2WXCIsIFwid2VhcG9uXCIsIFwi5omL5p2WXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTM3XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDEzN1wiLCBcIldlYXBvblwiLCBcIuefreadllwiLCBcIndlYXBvblwiLCBcIuefreadllwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDEzOFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxMzhcIiwgXCJXZWFwb25cIiwgXCLplbfmnZZcIiwgXCJ3ZWFwb25cIiwgXCLplbfmnZZcIiwgXCJFcXVpcFwiKSxcclxuXHJcblx0XCIwMTQwXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0MFwiLCBcIldlYXBvblwiLCBcIumbmeaJi+WKjVwiLCBcIndlYXBvblwiLCBcIumbmeaJi+WKjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE0MVwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNDFcIiwgXCJXZWFwb25cIiwgXCLpm5nmiYvmlqdcIiwgXCJ3ZWFwb25cIiwgXCLpm5nmiYvmlqdcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNDJcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTQyXCIsIFwiV2VhcG9uXCIsIFwi6ZuZ5omL5qONXCIsIFwid2VhcG9uXCIsIFwi6ZuZ5omL5qONXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTQzXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0M1wiLCBcIldlYXBvblwiLCBcIuanjVwiLCBcIndlYXBvblwiLCBcIuanjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE0NFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNDRcIiwgXCJXZWFwb25cIiwgXCLnn5tcIiwgXCJ3ZWFwb25cIiwgXCLnn5tcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNDVcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTQ1XCIsIFwiV2VhcG9uXCIsIFwi5byTXCIsIFwid2VhcG9uXCIsIFwi5byTXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTQ2XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0NlwiLCBcIldlYXBvblwiLCBcIuW8qVwiLCBcIndlYXBvblwiLCBcIuW8qVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE0N1wiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNDdcIiwgXCJXZWFwb25cIiwgXCLmi7PlpZdcIiwgXCJ3ZWFwb25cIiwgXCLmi7PlpZdcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNDhcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTQ4XCIsIFwiV2VhcG9uXCIsIFwi5oyH6JmOXCIsIFwid2VhcG9uXCIsIFwi5oyH6JmOXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTQ5XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE0OVwiLCBcIldlYXBvblwiLCBcIueBq+anjVwiLCBcIndlYXBvblwiLCBcIueBq+anjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE1MFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNTBcIiwgXCJXZWFwb25cIiwgXCLpj59cIiwgXCJ3ZWFwb25cIiwgXCLpj59cIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNTFcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTUxXCIsIFwiV2VhcG9uXCIsIFwi6Y6sXCIsIFwid2VhcG9uXCIsIFwi6Y6sXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTUyXCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE1MlwiLCBcIldlYXBvblwiLCBcIumbmeW8qeanjVwiLCBcIndlYXBvblwiLCBcIumbmeW8qeanjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE1M1wiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNTNcIiwgXCJXZWFwb25cIiwgXCLliqDovrLnoLJcIiwgXCJ3ZWFwb25cIiwgXCLliqDovrLnoLJcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNTRcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTU0XCIsIFwiV2VhcG9uXCIsIFwi5aSq5YiAXCIsIFwid2VhcG9uXCIsIFwi5aSq5YiAXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTU1XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE1NVwiLCBcIldlYXBvblwiLCBcIuaJh+WtkFwiLCBcIndlYXBvblwiLCBcIuaJh+WtkFwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE1NlwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNTZcIiwgXCJXZWFwb25cIiwgXCLnkIlcIiwgXCJ3ZWFwb25cIiwgXCLnkIlcIiwgXCJFcXVpcFwiKSxcclxuXHRcIjAxNTdcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTU3XCIsIFwiV2VhcG9uXCIsIFwi55KDXCIsIFwid2VhcG9uXCIsIFwi55KDXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTU4XCI6IG5ldyBJdGVtQ2F0ZWdvcnlJbmZvKFwiMDE1OFwiLCBcIldlYXBvblwiLCBcIumHjeaLs+anjVwiLCBcIndlYXBvblwiLCBcIumHjeaLs+anjVwiLCBcIkVxdWlwXCIpLFxyXG5cdFwiMDE3MFwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAxNzBcIiwgXCJXZWFwb25cIiwgXCIwMTcwXCIsIFwid2VhcG9uXCIsIFwi6bue6KOd5q2m5ZmoXCIsIFwiRXF1aXBcIiksXHJcblx0XCIwMTlcIjogbmV3IEl0ZW1DYXRlZ29yeUluZm8oXCIwMTlcIiwgXCJUYW1pbmdNb2JcIiwgXCJUYW1pbmdNb2JcIiwgXCJ0YW1pbmdNb2JcIiwgXCLpqI7lr7VcIiwgXCJFcXVpcFwiLCBcIlRhbWluZy9cIiksXHJcblxyXG5cdFwiMDMwMVwiOiBuZXcgSXRlbUNhdGVnb3J5SW5mbyhcIjAzMDFcIiwgXCJJbnN0YWxsXCIsIFwiQ2hhaXJcIiwgXCJpbnN0YWxsXCIsIFwi5qSF5a2QXCIsIFwiSXRlbVwiKSxcclxufTtcclxuXHJcbkl0ZW1DYXRlZ29yeUluZm8uX2NhdGVnb3J5TGlzdCA9IChmdW5jdGlvbiAoaW5mb19tYXApIHtcclxuXHRsZXQgbGlzdCA9IFtdO1xyXG5cdGxldCBzZXQgPSBuZXcgU2V0KCk7XHJcblx0Zm9yIChsZXQgaSBpbiBpbmZvX21hcCkge1xyXG5cdFx0bGV0IGNhdCA9IGluZm9fbWFwW2ldO1xyXG5cdFx0bGV0IGtleSA9IGNhdC5jYXRlZ29yeU5hbWUgfHwgY2F0Lmxpc3RQYXRoO1xyXG5cclxuXHRcdGlmICghc2V0LmhhcyhrZXkpKSB7XHJcblx0XHRcdHNldC5hZGQoa2V5KTtcclxuXHJcblx0XHRcdGxpc3QucHVzaCh7XHJcblx0XHRcdFx0a2V5OiBrZXksXHJcblx0XHRcdFx0dmFsdWU6IGksXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRyZXR1cm4gbGlzdDtcclxufSkoSXRlbUNhdGVnb3J5SW5mby5faW5mbyk7XHJcblxyXG5cclxuLyoqIEB0eXBlIHtNYXA8c3RyaW5nLEl0ZW1DYXRlZ29yeUluZm99ICovXHJcbkl0ZW1DYXRlZ29yeUluZm8ubWFwX3Nsb3RfdG9faW5mbyA9IChmdW5jdGlvbiAoKSB7XHJcblx0LyoqIEB0eXBlIHtNYXA8c3RyaW5nLEl0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0Y29uc3QgbWFwID0gbmV3IE1hcCgpO1xyXG5cdE9iamVjdC52YWx1ZXMoSXRlbUNhdGVnb3J5SW5mby5faW5mbykuZm9yRWFjaChpbmZvID0+IHtcclxuXHRcdG1hcC5zZXQoaW5mby5zbG90LCBpbmZvKTtcclxuXHR9KTtcclxuXHRyZXR1cm4gbWFwO1xyXG59KSgpO1xyXG5cclxuXHJcbmNsYXNzIEVxdWlwU2xvdHNNYXAge1xyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcFR5cGVcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gc2xvdElkXHJcblx0ICogQHJldHVybnMge3N0cmluZ30gc2xvdE5hbWVcclxuXHQgKi9cclxuXHRzdGF0aWMgdG9OYW1lKGVxdWlwVHlwZSwgc2xvdElkKSB7XHJcblx0XHRyZXR1cm4gRXF1aXBTbG90c01hcC5zbG90c190b19uYW1lX21hcFtlcXVpcFR5cGVdW3Nsb3RJZF07XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcFR5cGVcclxuXHQgKiBAcGFyYW0ge0l0ZW1DYXRlZ29yeUluZm99IGluZm9cclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfSBzbG90SWRcclxuXHQgKi9cclxuXHRzdGF0aWMgaW5mb1RvU2xvdChlcXVpcFR5cGUsIGluZm8pIHtcclxuXHRcdHJldHVybiBFcXVpcFNsb3RzTWFwLm1hcF9zbG90c190b190eXBlSW5mb1tlcXVpcFR5cGVdLmdldChpbmZvKTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGVxdWlwVHlwZVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWRcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfSBzbG90SWRcclxuXHQgKi9cclxuXHRzdGF0aWMgaXRlbUlkVG9TbG90KGVxdWlwVHlwZSwgaXRlbUlkKSB7XHJcblx0XHRsZXQgaW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KGl0ZW1JZCk7XHJcblx0XHRyZXR1cm4gRXF1aXBTbG90c01hcC5tYXBfc2xvdHNfdG9fdHlwZUluZm9bZXF1aXBUeXBlXS5nZXQoaW5mbyk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBlcXVpcFR5cGVcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc2xvdE5hbWVcclxuXHQgKiBAcmV0dXJucyB7bnVtYmVyfSBzbG90SWRcclxuXHQgKi9cclxuXHRzdGF0aWMgdG9TbG90KGVxdWlwVHlwZSwgc2xvdE5hbWUpIHtcclxuXHRcdHJldHVybiBFcXVpcFNsb3RzTWFwLm5hbWVfdG9fc2xvdHNfbWFwW2VxdWlwVHlwZV1bc2xvdE5hbWVdO1xyXG5cdH1cclxufVxyXG5cclxuRXF1aXBTbG90c01hcC5zbG90c190b19uYW1lX21hcCA9IHtcclxuXHRFcXVpcDoge1xyXG5cdFx0MTogXCJjYXBcIixcclxuXHRcdDI6IFwiYWNjZXNzb3J5RmFjZVwiLFxyXG5cdFx0MzogXCJhY2Nlc3NvcnlFeWVzXCIsXHJcblx0XHQ0OiBcImFjY2Vzc29yeUVhcnNcIixcclxuXHRcdDU6IFwiY29hdFwiLFxyXG5cdFx0NTogXCJsb25nY29hdFwiLFxyXG5cdFx0NjogXCJwYW50c1wiLFxyXG5cdFx0NzogXCJzaG9lc1wiLFxyXG5cdFx0ODogXCJnbG92ZVwiLFxyXG5cdFx0OTogXCJjYXBlXCIsXHJcblx0XHQxMDogXCJzaGllbGRcIixcclxuXHRcdDExOiBcIndlYXBvblwiLFxyXG5cdH0sXHJcblx0Q2FzaDoge1xyXG5cdH0sXHJcbn1cclxuT2JqZWN0LmtleXMoRXF1aXBTbG90c01hcC5zbG90c190b19uYW1lX21hcC5FcXVpcCkuZm9yRWFjaChzbG90ID0+IHtcclxuXHRFcXVpcFNsb3RzTWFwLnNsb3RzX3RvX25hbWVfbWFwLkNhc2hbTnVtYmVyKHNsb3QpICsgMTAwXSA9IEVxdWlwU2xvdHNNYXAuc2xvdHNfdG9fbmFtZV9tYXAuRXF1aXBbc2xvdF07XHJcbn0pO1xyXG5cclxuRXF1aXBTbG90c01hcC5tYXBfc2xvdHNfdG9fdHlwZUluZm8gPSB7XHJcbn07XHJcbk9iamVjdC5lbnRyaWVzKEVxdWlwU2xvdHNNYXAuc2xvdHNfdG9fbmFtZV9tYXApLmZvckVhY2goKFtzbG90VHlwZU5hbWUsIHNsb3RzXSkgPT4ge1xyXG5cdGNvbnN0IHN0aSA9IEl0ZW1DYXRlZ29yeUluZm8ubWFwX3Nsb3RfdG9faW5mbztcclxuXHRjb25zdCB0eXBlZFNsb3RzID0gRXF1aXBTbG90c01hcC5tYXBfc2xvdHNfdG9fdHlwZUluZm9bc2xvdFR5cGVOYW1lXSA9IG5ldyBNYXAoKTtcclxuXHJcblx0T2JqZWN0LmVudHJpZXMoc2xvdHMpLmZvckVhY2goZnVuY3Rpb24gKFtzbG90SWQsIHNsb3ROYW1lXSkge1xyXG5cdFx0Y29uc3QgaW5mbyA9IHN0aS5nZXQoc2xvdE5hbWUpO1xyXG5cdFx0dHlwZWRTbG90cy5zZXQoaW5mbywgc2xvdElkKTtcclxuXHR9KVxyXG59KTtcclxuXHJcbkVxdWlwU2xvdHNNYXAubmFtZV90b19zbG90c19tYXAgPSB7XHJcbn07XHJcbk9iamVjdC5lbnRyaWVzKEVxdWlwU2xvdHNNYXAuc2xvdHNfdG9fbmFtZV9tYXApLmZvckVhY2goKFtzbG90VHlwZU5hbWUsIHNsb3RzXSkgPT4ge1xyXG5cdGNvbnN0IHN0aSA9IEl0ZW1DYXRlZ29yeUluZm8ubWFwX3Nsb3RfdG9faW5mbztcclxuXHRjb25zdCB0eXBlZFNsb3RzID0gRXF1aXBTbG90c01hcC5uYW1lX3RvX3Nsb3RzX21hcFtzbG90VHlwZU5hbWVdID0ge307XHJcblxyXG5cdE9iamVjdC5lbnRyaWVzKHNsb3RzKS5mb3JFYWNoKGZ1bmN0aW9uIChbc2xvdElkLCBzbG90TmFtZV0pIHtcclxuXHRcdGNvbnN0IGluZm8gPSBzdGkuZ2V0KHNsb3ROYW1lKTtcclxuXHRcdHR5cGVkU2xvdHNbaW5mby5zbG90XSA9IHNsb3RJZDtcclxuXHR9KVxyXG59KTtcclxuXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHRJdGVtQ2F0ZWdvcnlJbmZvLFxyXG5cdEVxdWlwU2xvdHNNYXAsXHJcbn07XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///349\n')},353:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "d", function() { return ResourceManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return $get; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "c", function() { return ItemAttrNormalize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return CharacterRenderConfig; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "e", function() { return load_external_resource; });\n\ufeff\r\n//import { ItemCategoryInfo } from "../../src/Common/ItemCategoryInfo.js";\r\n\r\nif (window.$ROOT_PATH == null) {\r\n\twindow.$ROOT_PATH = "";\r\n\tconsole.error("window.$ROOT_PATH");\r\n}\r\n\r\nwindow.$noimage = location.search.indexOf("noimage") >= 0;\r\n\r\nconst $failed_urls = [];\r\n\r\nconst $archive = {};\r\n\r\nconst $symbol_partial = Symbol("partial");\r\nconst $symbol_loading = Symbol("loading");\r\n\r\n\r\nwindow.character_emotion_list = ["blink", "hit", "smile", "troubled", "cry", "angry", "bewildered", "stunned",\r\n\t"vomit", "oops", "cheers", "chu", "wink", "pain", "glitter", "despair", "love", "shine", "blaze", "hum",\r\n\t"bowing", "hot", "dam", "qBlue"];\r\n\r\nwindow.character_action_list = ["walk1", "walk2", "stand1", "stand2", "alert", "swingO1", "swingO2", "swingO3", "swingOF", "swingT1",\r\n\t"swingT2", "swingT3", "swingTF", "swingP1", "swingP2", "swingPF", "stabO1", "stabO2", "stabOF", "stabT1",\r\n\t"stabT2", "stabTF", "shoot1", "shoot2", "shootF", "proneStab", "prone", "heal", "fly", "jump", "sit", "ladder",\r\n\t"rope"/*, "dead", "ghostwalk", "ghoststand", "ghostjump", "ghostproneStab", "ghostladder", "ghostrope", "ghostfly",\r\n\t\t"ghostsit"*/];\r\n\r\nclass ResourceManager {\r\n\tstatic get dataRegion() { return (localStorage.region || "TWMS").toUpperCase(); }\r\n\tstatic set dataRegion(value) { localStorage.region = (value || "TWMS").toUpperCase(); }\r\n\tstatic get dataVersion() { return (localStorage.version || "220").toUpperCase(); }\r\n\tstatic set dataVersion(value) { localStorage.version = (value || "220").toUpperCase(); }\r\n\r\n\tstatic isEquipExist(id, cateInfo) {\r\n\t\tconst dp = cateInfo.listPath;\r\n\t\tconst es = ResourceManager.equip_map[dp];\r\n\t\treturn !es || es.has(id);\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} url\r\n\t */\r\n\tstatic async loadArchive(url) {\r\n\t\t$setValue($archive, "/", JSON.parse(await ResourceManager.get(url)));\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {""|"arraybuffer"|"blob"|"document"|"json"|"text"} [responseType]\r\n\t */\r\n\tstatic get(url, responseType) {\r\n\t\treturn new Promise(function (resolve, reject) {\r\n\t\t\tlet xhr = new XMLHttpRequest();\r\n\t\t\txhr.open("GET", url, true);\r\n\r\n\t\t\tif (responseType) {\r\n\t\t\t\txhr.responseType = responseType;;\r\n\t\t\t}\r\n\r\n\t\t\txhr.timeout = 10 * 60 * 1000;//20000;\r\n\r\n\t\t\txhr.onload = function () {\r\n\t\t\t\tif (this.status == 404 || this.status == 500) {\r\n\t\t\t\t\t$failed_urls.push(url);\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\t//resolve(null);\r\n\t\t\t\t\treject(this.status + ": " + url);\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.status == 200) {\r\n\t\t\t\t\tresolve(this.response);\r\n\t\t\t\t}\r\n\t\t\t\telse if (this.status == 304) {\r\n\t\t\t\t\tdebugger\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\txhr.ontimeout = function (e) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\t// XMLHttpRequest 超时。在此做某事。\r\n\t\t\t\t//resolve(null);\r\n\t\t\t\treject("timeout: " + url);\r\n\t\t\t};\r\n\r\n\t\t\txhr.onabort = function (e) {\r\n\t\t\t\treject("abort: " + url);\r\n\t\t\t};\r\n\r\n\t\t\txhr.send();\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * load equip or item, name and desc\r\n\t * @param {string} itemId\r\n\t * @returns {{info:{icon:{[""]:string},iconRaw:{[""]:string}},name:string,desc:string,[prop:string]:any}}\r\n\t */\r\n\tstatic async getItem(itemId) {\r\n\t\tconst { ItemCategoryInfo } = await __webpack_require__.e(/* import() */ 19).then(__webpack_require__.t.bind(null, 349, 7));\r\n\r\n\t\t/** @type {ItemCategoryInfo} */\r\n\t\tlet info = ItemCategoryInfo.get(itemId);\r\n\t\tif (!info) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet id = itemId.padStart(8, "0");\r\n\t\tif (id[0] != "0") {\r\n\t\t\tthrow new Error("itemId: " + itemId);\r\n\t\t}\r\n\r\n\t\tlet results;\r\n\t\ttry {\r\n\t\t\tresults = await Promise.all([\r\n\t\t\t\t$get.data(info.dataDir + itemId),\r\n\t\t\t\tinfo.stringDir ? $get.data(info.stringDir + Number(itemId)).then(\r\n\t\t\t\t\ta => a, // have name or desc\r\n\t\t\t\t\t() => { return { name: "<" + itemId + ">" }; } // no name and desc\r\n\t\t\t\t) : { name: "<" + itemId + ">" } // no name and desc\r\n\t\t\t]);\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tthrow new ex;\r\n\t\t}\r\n\r\n\t\tif (!results[0] || !results[1]) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet data = Object.assign(results[0], results[1]);\r\n\r\n\t\tdata.id = itemId;\r\n\r\n\t\tif (data.info) {\r\n\t\t\t{//editor mode data\r\n\t\t\t\tdata.info.id = itemId;\r\n\t\t\t\tdata.info.name = data.name;\r\n\t\t\t\tif (data.desc) {\r\n\t\t\t\t\tdata.info.desc = data.desc;\r\n\t\t\t\t}\r\n\t\t\t\tdata.info.__v = window.DATA_TAG + window.DATA_VERSION;\r\n\t\t\t}\r\n\r\n\t\t\tif (!data.info.icon) {\r\n\t\t\t\tdata.info.icon = {};\r\n\t\t\t}\r\n\t\t\tif (!data.info.iconRaw) {\r\n\t\t\t\tdata.info.iconRaw = {};\r\n\t\t\t}\r\n\t\t\tif (!data.info.icon[""]) {\r\n\t\t\t\tdata.info.icon[""] = ItemCategoryInfo.getIconUrl(itemId);\r\n\t\t\t}\r\n\t\t\tif (data.info.iconRaw[""]) {\r\n\t\t\t\tdata.info.iconRaw[""] = ItemCategoryInfo.getIconRawUrl(itemId);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tstatic get root_path() {\r\n\t\treturn window.$ROOT_PATH;\r\n\t}\r\n\r\n\tstatic get archive() {\r\n\t\treturn $archive;\r\n\t}\r\n\r\n\tstatic get failed_urls() {\r\n\t\treturn $failed_urls;\r\n\t}\r\n}\r\nwindow.$ResourceManager = ResourceManager;\r\n\r\n/**\r\n * @param {{}} obj\r\n * @param {string} path\r\n * @param {any} value\r\n */\r\nfunction $setValue(obj, path, value) {\r\n\tif (path.endsWith("/")) {\r\n\t\tpath = path.slice(0, path.length - 1);\r\n\t}\r\n\tlet ps = path.split("/");\r\n\tlet i, target = obj, lastIndex = ps.length - 1;\r\n\tfor (i = 0; i < lastIndex; ++i) {\r\n\t\tlet key = ps[i];\r\n\t\tif (target[key] == null) {\r\n\t\t\ttarget[key] = {\r\n\t\t\t\t[$symbol_partial]: true,\r\n\t\t\t};\r\n\t\t\tconsole.info("partial object: ", path);\r\n\t\t}\r\n\t\ttarget = target[key];\r\n\t}\r\n\tlet origin_value = target[ps[lastIndex]];\r\n\tif (origin_value instanceof Promise) {\r\n\t\tdelete target[ps[lastIndex]];\r\n\t\ttarget[ps[lastIndex]] = value;\r\n\t\tif (target[ps[lastIndex]][$symbol_partial]) {\r\n\t\t\tdelete target[key][$symbol_partial];\r\n\t\t\tconsole.info("completed object (promise): ", path);\r\n\t\t}\r\n\t}\r\n\telse if (origin_value && typeof origin_value == "object") {\r\n\t\tif (value instanceof Promise) {\r\n\t\t\tdebugger;\r\n\t\t\torigin_value[$symbol_loading] = value.then(function (data) {\r\n\t\t\t\t//for (let key in value) {\r\n\t\t\t\t//\torigin_value[key] = value[key] || origin_value[key];\r\n\t\t\t\t//}\r\n\t\t\t\tobjectAssignDeep(origin_value, data);\r\n\t\t\t\tif (origin_value[$symbol_partial]) {\r\n\t\t\t\t\tdelete origin_value[$symbol_partial];\r\n\t\t\t\t\tconsole.info("completed object (await promise): ", path);\r\n\t\t\t\t}\r\n\t\t\t\tdelete origin_value[$symbol_loading];\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//for (let key in value) {\r\n\t\t\t//\torigin_value[key] = value[key] || origin_value[key];\r\n\t\t\t//}\r\n\t\t\tobjectAssignDeep(origin_value, value);\r\n\t\t\tif (origin_value[$symbol_partial]) {\r\n\t\t\t\tdelete origin_value[$symbol_partial];\r\n\t\t\t\tconsole.info("completed object (value): ", path);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\telse if (typeof value != "undefined") {\r\n\t\ttarget[ps[lastIndex]] = value;\r\n\t\tif (target[ps[lastIndex]][$symbol_partial]) {\r\n\t\t\tdelete target[ps[lastIndex]][$symbol_partial];\r\n\t\t\tconsole.info("C: completed object: ", path);\r\n\t\t}\r\n\t}\r\n}\r\nfunction $getValue(obj, path) {\r\n\tif (path.endsWith("/")) {\r\n\t\tpath = path.slice(0, path.length - 1);\r\n\t}\r\n\tlet ps = path.split("/");\r\n\tlet i, target = obj, lastIndex = ps.length - 1;\r\n\tfor (i = 0; i < lastIndex; ++i) {\r\n\t\tlet key = ps[i];\r\n\t\tif (target[key]) {\r\n\t\t\t\ttarget = target[key];\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\treturn target[ps[lastIndex]];\r\n}\r\n\r\nconst symbol_isPack = Symbol("$pack");\r\n\r\nconst url_startsWith_protocol = RegExp.prototype.test.bind(/^(([a-zA-Z^\\:]+)(\\:.*)$|\\/\\/)/);\r\nfunction _setValueByPath(path, value, is_pack) {\r\n\tif (is_pack) {\r\n\t\tvalue[symbol_isPack] = true;\r\n\t}\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn;\r\n\t}\r\n\telse if (window.$ROOT_PATH != "" && path.startsWith(window.$ROOT_PATH)) {\r\n\t\tif (is_pack) {\r\n\t\t\tvalue[symbol_isPack] = true;\r\n\t\t}\r\n\t\tpath = path.slice(window.$ROOT_PATH.length);\r\n\t\treturn $setValue($archive, path, value);\r\n\t}\r\n\telse {\r\n\t\treturn $setValue($archive, path, value);\r\n\t}\r\n}\r\nfunction _getValueFromArchiveByPath(path, value) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tif (_path) {\r\n\t\treturn $getValue($archive, _path);\r\n\t}\r\n\treturn undefined;\r\n}\r\nfunction _getDataPathByUrl(path) {\r\n\tif (!url_startsWith_protocol(path)) {\r\n\t\tif (window.$ROOT_PATH != "" && path.startsWith(window.$ROOT_PATH)) {\r\n\t\t\treturn path.slice(window.$ROOT_PATH.length);\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn path;\r\n\t\t}\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\n/**\r\n * @returns {Promise<any>|any}\r\n */\r\nfunction $getValueAsync(obj, path) {\r\n\tif (path.endsWith("/")) {\r\n\t\tpath = path.slice(0, path.length - 1);\r\n\t}\r\n\t\r\n\t// try get value sync\r\n\tlet value = $getValue(obj, path);\r\n\t\r\n\t// if value exist\r\n\tif (value) {\r\n\t\tif (value instanceof Promise) {\r\n\t\t\t// ??\r\n\t\t\treturn new Promise(async function (resolve, reject) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet t = await value;\r\n\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t//resolve(await $getValueAsync(obj, path));\r\n\t\t\t\t}\r\n\t\t\t\tcatch (ex) {\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\treject(ex);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t}\r\n\telse {// if value not exist, try await parent node\r\n\t\tlet ps = path.split("/");\r\n\t\tlet i, target = obj, lastIndex = ps.length - 1;\r\n\t\tfor (i = 0; i < lastIndex; ++i) {\r\n\t\t\tlet key = ps[i];\r\n\t\t\tif (target[key] instanceof Promise) {\r\n\t\t\t\treturn new Promise(async function (resolve, reject) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet t = await target[key];\r\n\t\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t\t//resolve(await $getValueAsync(obj, path));\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcatch (ex) {\r\n\t\t\t\t\t\tdebugger;\r\n\t\t\t\t\t\treject(ex);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif (target[key]) {\r\n\t\t\t\t\ttarget = target[key];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet result = target[ps[lastIndex]];\r\n\t\tif (result instanceof Promise) {\r\n\t\t\treturn new Promise(async function (resolve, reject) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet t = await result;\r\n\t\t\t\t\tresolve(t);\r\n\t\t\t\t\t//resolve(await $getValueAsync(obj, path));\r\n\t\t\t\t}\r\n\t\t\t\tcatch (ex) {\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\treject(ex);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} url\r\n * @param {""|"arraybuffer"|"blob"|"document"|"json"|"text"} [responseType]\r\n * @returns {Promise<any>}\r\n */\r\nlet $get = function $get(url, responseType) {\r\n\treturn ResourceManager.get(url, responseType);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.pack = async function $get_pack(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && obj[symbol_isPack]) {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\t//if (process.env.NODE_ENV !== "production") {\r\n\t\t//\tif (obj && !obj[symbol_isPack]) {\r\n\t\t//\t\tthrow new TypeError("data: " + path);\r\n\t\t//\t}\r\n\t\t//}\r\n\t\tconst url = $get.packUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet jsonText = await ResourceManager.get(url);\r\n\r\n\t\t\t\tobj = JSON.parse(jsonText);\r\n\r\n\t\t\t\t_setValueByPath(path, obj, true);\r\n\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, true);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.packSync = function get_packSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn obj;\r\n\t}\r\n\treturn undefined;\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.data = async function $get_data(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && !obj[$symbol_partial]) {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tif (obj && obj[$symbol_partial]) {\r\n\t\t\tconsole.info("complet object: ", path);\r\n\t\t}\r\n\t\tconst url = $get.dataUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet jsonText = await ResourceManager.get(url);\r\n\r\n\t\t\t\tobj = JSON.parse(jsonText);\r\n\r\n\t\t\t\t_setValueByPath(path, obj, false);\r\n\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, false);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {any}\r\n */\r\n$get.dataSync = function get_dataSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn obj;\r\n\t}\r\n\treturn undefined;\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.list = async function $get_list(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\tconsole.warn("$get.list 未完成");\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && !obj[$symbol_partial]) {\r\n\t\tconsole.warn("$get.list 未完成");\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tif (obj && obj[$symbol_partial]) {\r\n\t\t\tconsole.info("complet object: ", path);\r\n\t\t}\r\n\t\tconsole.warn("$get.list 未完成");\r\n\r\n\t\tconst url = $get.listUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet jsonText = await ResourceManager.get(url);\r\n\r\n\t\t\t\tobj = JSON.parse(jsonText);\r\n\r\n\t\t\t\t_setValueByPath(path, obj, false);\r\n\r\n\t\t\t\treturn obj;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, false);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.listSync = function $get_listSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn Object.keys(obj);\r\n\t}\r\n\treturn undefined;\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {Promise<any>}\r\n */\r\n$get.binary = async function $get_data(path) {\r\n\tlet _path = _getDataPathByUrl(path);\r\n\tlet obj;\r\n\r\n\tif (_path) {\r\n\t\tobj = $getValueAsync($archive, _path);\r\n\t}\r\n\r\n\tif (obj instanceof Promise) {\r\n\t\treturn await obj;\r\n\t}\r\n\telse if (obj && !obj[$symbol_partial]) {\r\n\t\treturn obj;\r\n\t}\r\n\telse {\r\n\t\tif (obj && obj[$symbol_partial]) {\r\n\t\t\tconsole.info("complet object: ", path);\r\n\t\t}\r\n\t\tconst url = $get.binaryUrl(path);\r\n\r\n\t\tlet task = (async function () {\r\n\t\t\ttry {\r\n\t\t\t\tlet buf = await ResourceManager.get(url, "arrayBuffer");\r\n\r\n\t\t\t\t_setValueByPath(path, buf, false);\r\n\r\n\t\t\t\treturn buf;\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t})();\r\n\t\t_setValueByPath(path, task, false);\r\n\r\n\t\treturn await task;\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {any}\r\n */\r\n$get.binarySync = function get_dataSync(path) {\r\n\tlet obj = _getValueFromArchiveByPath(path);\r\n\tif (obj) {\r\n\t\treturn obj;\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.dataUrl = function $get_dataUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("data")) {\r\n\t\treturn `${window.$ROOT_PATH}data${path}.json`;\r\n\t}\r\n\tthrow new Error("Not game data: " + path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.packUrl = function $get_packUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("pack")) {\r\n\t\treturn `${window.$ROOT_PATH}pack${path}.json`;\r\n\t}\r\n\tthrow new Error("Not game pack: " + path);\r\n}\r\n$get.listUrl = function $get_listUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("ls")) {\r\n\t\treturn `${window.$ROOT_PATH}ls${path}.json`;\r\n\t}\r\n\tthrow new Error(path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.binaryUrl = function $get_dataUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("binary")) {\r\n\t\treturn `${window.$ROOT_PATH}binary${path}`;\r\n\t}\r\n\tthrow new Error("Not game binary data: " + path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.imageUrl = function $get_imagesUrl(path) {\r\n\tif (window.$noimage) {\r\n\t\treturn `${window.$ROOT_PATH}images/1x1.png`;\r\n\t}\r\n\t{\r\n\t\tif (url_startsWith_protocol(path)) {\r\n\t\t\treturn path;\r\n\t\t}\r\n\t\telse if (!path.startsWith("images")) {\r\n\t\t\treturn `${window.$ROOT_PATH}images${path}.png`;\r\n\t\t}\r\n\t\tthrow new Error("Not game images: " + path);\r\n\t}\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.soundMp3Url = function $get_soundMp3Url(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("sound")) {\r\n\t\treturn `${window.$ROOT_PATH}sound${path}.mp3`;\r\n\t}\r\n\tthrow new Error("Not game sound: " + path);\r\n}\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.soundWavUrl = function $get_soundWavUrl(path) {\r\n\tif (url_startsWith_protocol(path)) {\r\n\t\treturn path;\r\n\t}\r\n\telse if (!path.startsWith("sound")) {\r\n\t\treturn `${window.$ROOT_PATH}sound${path}.wav`;\r\n\t}\r\n\tthrow new Error("Not game sound: " + path);\r\n}\r\n\r\n/**\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\n$get.assetUrl = function $get_assetUrl(path) {\r\n\treturn `${window.$ROOT_PATH}${path}`;\r\n}\r\n$get.asset = function $get_asset(path) {\r\n\treturn $get($get.assetUrl(path));\r\n}\r\n\r\nwindow.$get = $get;\r\n\r\n\r\nclass ItemAttrNormalize {\r\n\tstatic head(item) {\r\n\t\titem.gender = 2;\r\n\t}\r\n\tstatic body(item) {\r\n\t\titem.gender = 2;\r\n\t}\r\n\tstatic Face(item) {\r\n\t\tconst g = Math.trunc((item.id % 10000) / 1000);\r\n\t\titem.gender = g == 1 || g == 4 ? 1 : 0;\r\n\t}\r\n\tstatic Hair(item) {\r\n\t\tconst g = Math.trunc((item.id % 10000) / 1000);\r\n\t\titem.gender = g == 1 || g == 2 || g == 4 || g == 7 ? 1 : 0;\r\n\t}\r\n\tstatic Cap(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic accessoryFace(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic accessoryEyes(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic accessoryEars(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Coat(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Longcoat(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Pants(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Shoes(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Glove(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Shield(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic Cape(item) {\r\n\t\tItemAttrNormalize._equip(item);\r\n\t}\r\n\tstatic _equip(item) {\r\n\t\tconst g = Math.trunc((item.id % 10000) / 1000);\r\n\t\titem.gender = g == 0 ? 0 : (g == 1 ? 1 : 2);\r\n\t}\r\n}\r\n\r\nconst regexp_getHairStyleID = /(\\d{4,7})\\d$/;\r\nconst regexp_getFaceStyleID = /(\\d{2,5})\\d(\\d{2})$/;\r\n\r\nconst regexp_getHairColor = /\\d{4,7}(\\d)$/;\r\nconst regexp_getFaceColor = /\\d{2,5}(\\d)\\d{2}$/;\r\n\r\nclass CharacterRenderConfig {\r\n\t/**\r\n\t * @param {string} style id\r\n\t * @returns {string[]}\r\n\t */\r\n\tstatic * enumHairColor(style) {\r\n\t\tlet m = style.match(regexp_getHairStyleID);\r\n\t\tfor (let i = 0; i < 10; ++i) {\r\n\t\t\tlet id = m[1] + i;\r\n\t\t\tyield id;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} style id\r\n\t * @returns {string[]}\r\n\t */\r\n\tstatic * enumFaceColor(style) {\r\n\t\tlet m = style.match(regexp_getFaceStyleID);\r\n\t\tfor (let i = 0; i < 10; ++i) {\r\n\t\t\tlet id = m[1] + i + m[2];\r\n\t\t\tyield id;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} style\r\n\t * @param {number} color\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getColorHairID(style, color) {\r\n\t\tlet m = style.match(regexp_getHairStyleID);\r\n\t\tlet id = m[1] + (color % 10);\r\n\t\treturn id;\r\n\t}\r\n\t/**\r\n\t * @param {string} style\r\n\t * @param {number} color\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getColorFaceID(style, color) {\r\n\t\tlet m = style.match(regexp_getFaceStyleID);\r\n\t\tlet id = m[1] + (color % 10) + m[2];\r\n\t\treturn id;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id_1\r\n\t * @param {string} id_2\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isHairStyleEqual(id_1, id_2) {\r\n\t\treturn CharacterRenderConfig.getColorHairID(id_1, 0) == CharacterRenderConfig.getColorHairID(id_2, 0);\r\n\t}\r\n\t/**\r\n\t * @param {string} id_1\r\n\t * @param {string} id_2\r\n\t * @returns {boolean}\r\n\t */\r\n\tstatic isFaceStyleEqual(id_1, id_2) {\r\n\t\treturn CharacterRenderConfig.getColorFaceID(id_1, 0) == CharacterRenderConfig.getColorFaceID(id_2, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getHairColor(id) {\r\n\t\tif (id) {\r\n\t\t\tid = String(id);\r\n\t\t\tlet m = id.match(regexp_getHairColor);\r\n\t\t\tif (m) {\r\n\t\t\t\treturn m[1];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} id\r\n\t * @returns {string}\r\n\t */\r\n\tstatic getFaceColor(id) {\r\n\t\tif (id) {\r\n\t\t\tid = String(id);\r\n\t\t\tlet m = id.match(regexp_getFaceColor);\r\n\t\t\tif (m) {\r\n\t\t\t\treturn m[1];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nvar _external_data = {\r\n\t"requiredJobs": [\r\n\t\t"Beginner"\r\n\t],\r\n\t"requiredLevel": 0,\r\n\t"isCash": true,\r\n\t"name": "Blue Beanie",\r\n\t"desc": null,\r\n\t"id": 1000000,\r\n\t"requiredGender": 0,\r\n\t"typeInfo": {\r\n\t\t"overallCategory": "Equip",\r\n\t\t"category": "Armor",\r\n\t\t"subCategory": "Hat"\r\n\t}\r\n};\r\n\r\nvar ItemTypeInfo = {\r\n\t"Equip": {\r\n\t\t"Hat": "Cap",\r\n\t\t"Cape": "Cape",\r\n\t\t"Top": "Coat",\r\n\t\t"Overall": "Longcoat",\r\n\t\t"Glove": "Glove",\r\n\t\t"Bottom": "Pants",\r\n\r\n\t\t"Shield": "Shield",\r\n\t\t"Shoes": "Shoes",\r\n\t\t"Eye Decoration": "accessoryEyes",\r\n\t\t"Earrings": "accessoryEars",\r\n\t\t//"Ring": "",\r\n\r\n\t\t//"Pendant": "",\r\n\t\t"Face Accessory": "accessoryFace",\r\n\t\t//"Belt": "",\r\n\t\t//"Medal": "",\r\n\t\t//"Shoulder Accessory": "",\r\n\t\t//"Badge": "",\r\n\r\n\t\t//"Dragon Equipment": "",\r\n\t\t//"Mechanic Equipment": "",\r\n\t\t//"Pet Equipment": "",\r\n\t\t//"Android": "",\r\n\t\t//"Mechanical Heart": "",\r\n\t\t//"Bits": "",\r\n\r\n\t\t"Face": "Face",\r\n\t\t"Hair": "Hair",\r\n\t},\r\n};\r\n\r\nResourceManager.external = {\r\n\tequip: {\r\n\t},\r\n};\r\n\r\n/** @type {{[category:string]:Map<string,{}>}} */\r\nResourceManager.equip_map = {\r\n};\r\n\r\nfor (let i in ItemTypeInfo.Equip) {\r\n\tlet category = ItemTypeInfo.Equip[i];\r\n\tResourceManager.external.equip[category] = [];\r\n\tResourceManager.equip_map[category] = null;\r\n}\r\nfor (let i = 0; i < 9; ++i) {\r\n\tlet category = "Face" + i;\r\n\tResourceManager.external.equip[category] = [];\r\n\tResourceManager.equip_map[category] = null;\r\n}\r\nfor (let i = 0; i <= 9; ++i) {\r\n\tlet category = "Hair" + i;\r\n\tResourceManager.external.equip[category] = [];\r\n\tResourceManager.equip_map[category] = null;\r\n}\r\n\r\nasync function load_external_resource(url) {\r\n\t//url = url || "/items.json";\r\n\tlet raw;\r\n\r\n\t// try {\r\n\t// \traw = ResourceManager._external_raw = JSON.parse(await $get.asset("equip.json"));\r\n\t// \tif (!raw) {\r\n\t// \t\tdebugger;\r\n\t// \t\tthrow Error("\'/equip.json\' is empty");\r\n\t// \t}\r\n\t// }\r\n\t// catch (ex) {\r\n\t\ttry {\r\n\t\t\traw = ResourceManager._external_raw = JSON.parse(await $get(`https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/category/equip`));\r\n\t\t\tif (!raw) {\r\n\t\t\t\tdebugger;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t// }\r\n\t\r\n\tfor (let i = 0; i < raw.length; ++i) {\r\n\t\tconst item = raw[i];\r\n\t\tconst id = String(item.id).padStart(8, "0");\r\n\t\t\r\n\t\ttry {\r\n\t\t\tif (!(item.typeInfo && ItemTypeInfo[item.typeInfo.overallCategory])) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet clz = item.typeInfo.overallCategory.toLowerCase();\r\n\t\t\tlet categoryName = ItemTypeInfo[item.typeInfo.overallCategory][item.typeInfo.subCategory];\r\n\t\t\tif (!categoryName) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\telse if (categoryName == "Face") {\r\n\t\t\t\tcategoryName += CharacterRenderConfig.getFaceColor(id);\r\n\t\t\t}\r\n\t\t\telse if (categoryName == "Hair") {\r\n\t\t\t\tcategoryName += CharacterRenderConfig.getHairColor(id);\r\n\t\t\t}\r\n\r\n\t\t\tlet it = {\r\n\t\t\t\tid: id,\r\n\t\t\t\tname: item.name,\r\n\t\t\t\tdesc: item.desc,\r\n\t\t\t\tcash: item.isCash ? 1 : 0,\r\n\t\t\t\ticon: {\r\n\t\t\t\t\t"": `https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/${item.id}/icon`,\r\n\t\t\t\t},\r\n\t\t\t\t__v: `${ResourceManager.dataRegion}${ResourceManager.dataVersion}`,\r\n\t\t\t};\r\n\r\n\t\t\tif (Array.isArray(ResourceManager.external[clz][categoryName])) {\r\n\t\t\t\tResourceManager.external[clz][categoryName].push(it);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdebugger\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tconsole.error("external resource: id(" + id + ")");\r\n\t\t\tconsole.error(ex);\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction update_external_equip_list() {\r\n\tdebugger;//??\r\n\tconst url = `https://maplestory.io/api/${ResourceManager.dataRegion}/${ResourceManager.dataVersion}/item/category/equip`;\r\n\tload_external_resource(url).then(() => {\r\n\t\t_concat_external_resource(category, origin_data);\r\n\t\tconcat_external_resource = _concat_external_resource;\r\n\t\tconsole.log("done: update_external_equip_list");\r\n\t});\r\n}\r\n\r\nlet external_resource_promise = load_external_resource();\r\n\r\nwindow.concat_external_resource = _concat_external_resource_p;\r\n\r\nwindow.trigger_update_external_equip_list = function () {\r\n\texternal_resource_promise = load_external_resource();\r\n\twindow.concat_external_resource = _concat_external_resource_p;\r\n}\r\n\r\nasync function _concat_external_resource_p(category, origin_data) {\r\n\tawait external_resource_promise;\r\n\t_concat_external_resource(category, origin_data);\r\n\tconcat_external_resource = _concat_external_resource;\r\n}\r\n\r\nfunction _concat_external_resource(category, origin_data) {\r\n\ttry {\r\n\t\tconst list = ResourceManager.external.equip[category];\r\n\t\tif (!list) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t/** @type {Map<string,{}>} */\r\n\t\tlet id_map = ResourceManager.equip_map[category];\r\n\r\n\t\tif (!id_map) {\r\n\t\t\tid_map = new Map();\r\n\t\t\t\r\n\t\t\torigin_data.forEach(item => {\r\n\t\t\t\tid_map.set(item.id, item);\r\n\t\t\t});\r\n\r\n\t\t\tResourceManager.equip_map[category] = id_map;\r\n\t\t}\r\n\r\n\t\tlist.forEach((item) => {\r\n\t\t\t/** @type {string} */\r\n\t\t\tlet id = item.id;\r\n\t\t\tif (!id_map.has(id)) {\r\n\t\t\t\titem.$foreign = true;\r\n\t\t\t\torigin_data.push(item);\r\n\t\t\t\tid_map.set(id, item);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet ori_item = id_map.get(id);\r\n\t\t\t\tori_item._name = item.name || "";\r\n\t\t\t\tori_item._desc = item.desc || "";\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tcatch (ex) {\r\n\t\tconsole.error(ex);\r\n\t\tdebugger;\r\n\t}\r\n}\r\n\r\n/**\r\n * @param {string} id\r\n * @param {string} categoryName\r\n */\r\nwindow.load_extern_item_data = async function (id, categoryName) {\r\n\tlet dataRegion, dataVersion;\r\n\t//let itemInfo = ResourceManager.equip_map[categoryName].get(id);\r\n\tlet itemInfo = ResourceManager.external.equip[categoryName].find(itemInfo => itemInfo.id == id);\r\n\tif (itemInfo) {\r\n\t\tlet __v = itemInfo.__v.toUpperCase().match(/([A-Z]*)([0-9]*)/);\r\n\t\tif (__v) {\r\n\t\t\tdataRegion = __v[1] || ResourceManager.dataRegion;\r\n\t\t\tdataVersion = __v[2] || ResourceManager.dataVersion;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdataRegion = ResourceManager.dataRegion;\r\n\t\t\tdataVersion = ResourceManager.dataVersion;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tdataRegion = ResourceManager.dataRegion;\r\n\t\tdataVersion = ResourceManager.dataVersion;\r\n\t}\r\n\r\n\tlet _raw = JSON.parse(await $get(`https://maplestory.io/api/${dataRegion}/${dataVersion}/item/${id}`));\r\n\tlet raw = {};\r\n\r\n\tif (_raw == null) {\r\n\t\tconsole.error("Not found:", id);\r\n\t\treturn null;\r\n\t}\r\n\r\n\tlet default_ = _raw.frameBooks.default ? _raw.frameBooks.default.frames[0]:null;\r\n\r\n\tfor (let i in _raw.frameBooks) {\r\n\t\tlet _act = _raw.frameBooks[i];\r\n\t\tlet act = [];\r\n\r\n\t\tfor (let j = 0; j < _act.frames.length; ++j) {\r\n\t\t\tlet frame = _act.frames[j] || default_;\r\n\t\t\tif (!frame || !frame.effects) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tlet _frags = frame.effects;\r\n\t\t\tlet frags = {};\r\n\t\t\tfor (let k in _frags) {\r\n\t\t\t\tlet _frag = _frags[k];\r\n\t\t\t\tif (_frag.image) {\r\n\t\t\t\t\tfrags[k] = {\r\n\t\t\t\t\t\t"": "data:image/png;base64," + _frag.image,\r\n\t\t\t\t\t\t"origin": _frag.originOrZero || _frag.origin || _frag.center,\r\n\t\t\t\t\t\t"map": _frag.mapOffset,\r\n\t\t\t\t\t\t"z": _frag.position\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tact[j] = frags;\r\n\t\t}\r\n\r\n\t\traw[i] = act;\r\n\t}\r\n\r\n\traw.info = {\r\n\t\tislot: _raw.metaInfo.islot,\r\n\t\tvslot: _raw.metaInfo.vslot,\r\n\t\ticon: {\r\n\t\t\t"": `https://maplestory.io/api/${dataRegion}/${dataVersion}/item/${_raw.id}/icon`,\r\n\t\t},\r\n\t\tcash: _raw.metaInfo.cash ? 1 : 0,\r\n\t\t__v: `${dataRegion}${dataVersion}`,\r\n\t};\r\n\r\n\treturn raw;\r\n}\r\n\r\nfunction _objectAssignDeep(target, object) {\r\n\tif (target != null && object != null) {\r\n\t\tif (Object.prototype.valueOf.call(object) instanceof String) {\r\n\t\t\ttarget = object;\r\n\t\t}\r\n\t\telse if (Object.prototype.valueOf.call(object) instanceof Number) {\r\n\t\t\ttarget = object;\r\n\t\t}\r\n\t\telse if (Object.prototype.valueOf.call(object) instanceof Boolean) {\r\n\t\t\ttarget = object;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfor (let key in object) {\r\n\t\t\t\tlet value = object[key];\r\n\t\t\t\tif (value != null) {\r\n\t\t\t\t\ttarget[key] = _objectAssignDeep(target[key], value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn target;\r\n}\r\n\r\nfunction objectAssignDeep(target, ...objects) {\r\n\tfor (let object of objects) {\r\n\t\t_objectAssignDeep(target, object);\r\n\t}\r\n\treturn target;\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzUzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vcHVibGljL2phdmFzY3JpcHRzL3Jlc291cmNlLmpzPzIzZmUiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbi8vaW1wb3J0IHsgSXRlbUNhdGVnb3J5SW5mbyB9IGZyb20gXCIuLi8uLi9zcmMvQ29tbW9uL0l0ZW1DYXRlZ29yeUluZm8uanNcIjtcclxuXHJcbmlmICh3aW5kb3cuJFJPT1RfUEFUSCA9PSBudWxsKSB7XHJcblx0d2luZG93LiRST09UX1BBVEggPSBcIlwiO1xyXG5cdGNvbnNvbGUuZXJyb3IoXCJ3aW5kb3cuJFJPT1RfUEFUSFwiKTtcclxufVxyXG5cclxud2luZG93LiRub2ltYWdlID0gbG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJub2ltYWdlXCIpID49IDA7XHJcblxyXG5jb25zdCAkZmFpbGVkX3VybHMgPSBbXTtcclxuXHJcbmNvbnN0ICRhcmNoaXZlID0ge307XHJcblxyXG5jb25zdCAkc3ltYm9sX3BhcnRpYWwgPSBTeW1ib2woXCJwYXJ0aWFsXCIpO1xyXG5jb25zdCAkc3ltYm9sX2xvYWRpbmcgPSBTeW1ib2woXCJsb2FkaW5nXCIpO1xyXG5cclxuXHJcbndpbmRvdy5jaGFyYWN0ZXJfZW1vdGlvbl9saXN0ID0gW1wiYmxpbmtcIiwgXCJoaXRcIiwgXCJzbWlsZVwiLCBcInRyb3VibGVkXCIsIFwiY3J5XCIsIFwiYW5ncnlcIiwgXCJiZXdpbGRlcmVkXCIsIFwic3R1bm5lZFwiLFxyXG5cdFwidm9taXRcIiwgXCJvb3BzXCIsIFwiY2hlZXJzXCIsIFwiY2h1XCIsIFwid2lua1wiLCBcInBhaW5cIiwgXCJnbGl0dGVyXCIsIFwiZGVzcGFpclwiLCBcImxvdmVcIiwgXCJzaGluZVwiLCBcImJsYXplXCIsIFwiaHVtXCIsXHJcblx0XCJib3dpbmdcIiwgXCJob3RcIiwgXCJkYW1cIiwgXCJxQmx1ZVwiXTtcclxuXHJcbndpbmRvdy5jaGFyYWN0ZXJfYWN0aW9uX2xpc3QgPSBbXCJ3YWxrMVwiLCBcIndhbGsyXCIsIFwic3RhbmQxXCIsIFwic3RhbmQyXCIsIFwiYWxlcnRcIiwgXCJzd2luZ08xXCIsIFwic3dpbmdPMlwiLCBcInN3aW5nTzNcIiwgXCJzd2luZ09GXCIsIFwic3dpbmdUMVwiLFxyXG5cdFwic3dpbmdUMlwiLCBcInN3aW5nVDNcIiwgXCJzd2luZ1RGXCIsIFwic3dpbmdQMVwiLCBcInN3aW5nUDJcIiwgXCJzd2luZ1BGXCIsIFwic3RhYk8xXCIsIFwic3RhYk8yXCIsIFwic3RhYk9GXCIsIFwic3RhYlQxXCIsXHJcblx0XCJzdGFiVDJcIiwgXCJzdGFiVEZcIiwgXCJzaG9vdDFcIiwgXCJzaG9vdDJcIiwgXCJzaG9vdEZcIiwgXCJwcm9uZVN0YWJcIiwgXCJwcm9uZVwiLCBcImhlYWxcIiwgXCJmbHlcIiwgXCJqdW1wXCIsIFwic2l0XCIsIFwibGFkZGVyXCIsXHJcblx0XCJyb3BlXCIvKiwgXCJkZWFkXCIsIFwiZ2hvc3R3YWxrXCIsIFwiZ2hvc3RzdGFuZFwiLCBcImdob3N0anVtcFwiLCBcImdob3N0cHJvbmVTdGFiXCIsIFwiZ2hvc3RsYWRkZXJcIiwgXCJnaG9zdHJvcGVcIiwgXCJnaG9zdGZseVwiLFxyXG5cdFx0XCJnaG9zdHNpdFwiKi9dO1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlc291cmNlTWFuYWdlciB7XHJcblx0c3RhdGljIGdldCBkYXRhUmVnaW9uKCkgeyByZXR1cm4gKGxvY2FsU3RvcmFnZS5yZWdpb24gfHwgXCJUV01TXCIpLnRvVXBwZXJDYXNlKCk7IH1cclxuXHRzdGF0aWMgc2V0IGRhdGFSZWdpb24odmFsdWUpIHsgbG9jYWxTdG9yYWdlLnJlZ2lvbiA9ICh2YWx1ZSB8fCBcIlRXTVNcIikudG9VcHBlckNhc2UoKTsgfVxyXG5cdHN0YXRpYyBnZXQgZGF0YVZlcnNpb24oKSB7IHJldHVybiAobG9jYWxTdG9yYWdlLnZlcnNpb24gfHwgXCIyMjBcIikudG9VcHBlckNhc2UoKTsgfVxyXG5cdHN0YXRpYyBzZXQgZGF0YVZlcnNpb24odmFsdWUpIHsgbG9jYWxTdG9yYWdlLnZlcnNpb24gPSAodmFsdWUgfHwgXCIyMjBcIikudG9VcHBlckNhc2UoKTsgfVxyXG5cclxuXHRzdGF0aWMgaXNFcXVpcEV4aXN0KGlkLCBjYXRlSW5mbykge1xyXG5cdFx0Y29uc3QgZHAgPSBjYXRlSW5mby5saXN0UGF0aDtcclxuXHRcdGNvbnN0IGVzID0gUmVzb3VyY2VNYW5hZ2VyLmVxdWlwX21hcFtkcF07XHJcblx0XHRyZXR1cm4gIWVzIHx8IGVzLmhhcyhpZCk7XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcclxuXHQgKi9cclxuXHRzdGF0aWMgYXN5bmMgbG9hZEFyY2hpdmUodXJsKSB7XHJcblx0XHQkc2V0VmFsdWUoJGFyY2hpdmUsIFwiL1wiLCBKU09OLnBhcnNlKGF3YWl0IFJlc291cmNlTWFuYWdlci5nZXQodXJsKSkpO1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHBhcmFtIHtcIlwifFwiYXJyYXlidWZmZXJcInxcImJsb2JcInxcImRvY3VtZW50XCJ8XCJqc29uXCJ8XCJ0ZXh0XCJ9IFtyZXNwb25zZVR5cGVdXHJcblx0ICovXHJcblx0c3RhdGljIGdldCh1cmwsIHJlc3BvbnNlVHlwZSkge1xyXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuXHRcdFx0bGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG5cdFx0XHR4aHIub3BlbihcIkdFVFwiLCB1cmwsIHRydWUpO1xyXG5cclxuXHRcdFx0aWYgKHJlc3BvbnNlVHlwZSkge1xyXG5cdFx0XHRcdHhoci5yZXNwb25zZVR5cGUgPSByZXNwb25zZVR5cGU7O1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR4aHIudGltZW91dCA9IDEwICogNjAgKiAxMDAwOy8vMjAwMDA7XHJcblxyXG5cdFx0XHR4aHIub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGlmICh0aGlzLnN0YXR1cyA9PSA0MDQgfHwgdGhpcy5zdGF0dXMgPT0gNTAwKSB7XHJcblx0XHRcdFx0XHQkZmFpbGVkX3VybHMucHVzaCh1cmwpO1xyXG5cdFx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0XHQvL3Jlc29sdmUobnVsbCk7XHJcblx0XHRcdFx0XHRyZWplY3QodGhpcy5zdGF0dXMgKyBcIjogXCIgKyB1cmwpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmICh0aGlzLnN0YXR1cyA9PSAyMDApIHtcclxuXHRcdFx0XHRcdHJlc29sdmUodGhpcy5yZXNwb25zZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2UgaWYgKHRoaXMuc3RhdHVzID09IDMwNCkge1xyXG5cdFx0XHRcdFx0ZGVidWdnZXJcclxuXHRcdFx0XHR9XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHR4aHIub250aW1lb3V0ID0gZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0XHQvLyBYTUxIdHRwUmVxdWVzdCDotoXml7bjgILlnKjmraTlgZrmn5DkuovjgIJcclxuXHRcdFx0XHQvL3Jlc29sdmUobnVsbCk7XHJcblx0XHRcdFx0cmVqZWN0KFwidGltZW91dDogXCIgKyB1cmwpO1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0eGhyLm9uYWJvcnQgPSBmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHRcdHJlamVjdChcImFib3J0OiBcIiArIHVybCk7XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHR4aHIuc2VuZCgpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIGxvYWQgZXF1aXAgb3IgaXRlbSwgbmFtZSBhbmQgZGVzY1xyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpdGVtSWRcclxuXHQgKiBAcmV0dXJucyB7e2luZm86e2ljb246e1tcIlwiXTpzdHJpbmd9LGljb25SYXc6e1tcIlwiXTpzdHJpbmd9fSxuYW1lOnN0cmluZyxkZXNjOnN0cmluZyxbcHJvcDpzdHJpbmddOmFueX19XHJcblx0ICovXHJcblx0c3RhdGljIGFzeW5jIGdldEl0ZW0oaXRlbUlkKSB7XHJcblx0XHRjb25zdCB7IEl0ZW1DYXRlZ29yeUluZm8gfSA9IGF3YWl0IGltcG9ydChcIi4uLy4uL3NyYy9Db21tb24vSXRlbUNhdGVnb3J5SW5mby5qc1wiKTtcclxuXHJcblx0XHQvKiogQHR5cGUge0l0ZW1DYXRlZ29yeUluZm99ICovXHJcblx0XHRsZXQgaW5mbyA9IEl0ZW1DYXRlZ29yeUluZm8uZ2V0KGl0ZW1JZCk7XHJcblx0XHRpZiAoIWluZm8pIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IGlkID0gaXRlbUlkLnBhZFN0YXJ0KDgsIFwiMFwiKTtcclxuXHRcdGlmIChpZFswXSAhPSBcIjBcIikge1xyXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJpdGVtSWQ6IFwiICsgaXRlbUlkKTtcclxuXHRcdH1cclxuXHJcblx0XHRsZXQgcmVzdWx0cztcclxuXHRcdHRyeSB7XHJcblx0XHRcdHJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcblx0XHRcdFx0JGdldC5kYXRhKGluZm8uZGF0YURpciArIGl0ZW1JZCksXHJcblx0XHRcdFx0aW5mby5zdHJpbmdEaXIgPyAkZ2V0LmRhdGEoaW5mby5zdHJpbmdEaXIgKyBOdW1iZXIoaXRlbUlkKSkudGhlbihcclxuXHRcdFx0XHRcdGEgPT4gYSwgLy8gaGF2ZSBuYW1lIG9yIGRlc2NcclxuXHRcdFx0XHRcdCgpID0+IHsgcmV0dXJuIHsgbmFtZTogXCI8XCIgKyBpdGVtSWQgKyBcIj5cIiB9OyB9IC8vIG5vIG5hbWUgYW5kIGRlc2NcclxuXHRcdFx0XHQpIDogeyBuYW1lOiBcIjxcIiArIGl0ZW1JZCArIFwiPlwiIH0gLy8gbm8gbmFtZSBhbmQgZGVzY1xyXG5cdFx0XHRdKTtcclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgZXg7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCFyZXN1bHRzWzBdIHx8ICFyZXN1bHRzWzFdKSB7XHJcblx0XHRcdHJldHVybiBudWxsO1xyXG5cdFx0fVxyXG5cdFx0bGV0IGRhdGEgPSBPYmplY3QuYXNzaWduKHJlc3VsdHNbMF0sIHJlc3VsdHNbMV0pO1xyXG5cclxuXHRcdGRhdGEuaWQgPSBpdGVtSWQ7XHJcblxyXG5cdFx0aWYgKGRhdGEuaW5mbykge1xyXG5cdFx0XHR7Ly9lZGl0b3IgbW9kZSBkYXRhXHJcblx0XHRcdFx0ZGF0YS5pbmZvLmlkID0gaXRlbUlkO1xyXG5cdFx0XHRcdGRhdGEuaW5mby5uYW1lID0gZGF0YS5uYW1lO1xyXG5cdFx0XHRcdGlmIChkYXRhLmRlc2MpIHtcclxuXHRcdFx0XHRcdGRhdGEuaW5mby5kZXNjID0gZGF0YS5kZXNjO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRkYXRhLmluZm8uX192ID0gd2luZG93LkRBVEFfVEFHICsgd2luZG93LkRBVEFfVkVSU0lPTjtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCFkYXRhLmluZm8uaWNvbikge1xyXG5cdFx0XHRcdGRhdGEuaW5mby5pY29uID0ge307XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFkYXRhLmluZm8uaWNvblJhdykge1xyXG5cdFx0XHRcdGRhdGEuaW5mby5pY29uUmF3ID0ge307XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCFkYXRhLmluZm8uaWNvbltcIlwiXSkge1xyXG5cdFx0XHRcdGRhdGEuaW5mby5pY29uW1wiXCJdID0gSXRlbUNhdGVnb3J5SW5mby5nZXRJY29uVXJsKGl0ZW1JZCk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGRhdGEuaW5mby5pY29uUmF3W1wiXCJdKSB7XHJcblx0XHRcdFx0ZGF0YS5pbmZvLmljb25SYXdbXCJcIl0gPSBJdGVtQ2F0ZWdvcnlJbmZvLmdldEljb25SYXdVcmwoaXRlbUlkKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiBkYXRhO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldCByb290X3BhdGgoKSB7XHJcblx0XHRyZXR1cm4gd2luZG93LiRST09UX1BBVEg7XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgZ2V0IGFyY2hpdmUoKSB7XHJcblx0XHRyZXR1cm4gJGFyY2hpdmU7XHJcblx0fVxyXG5cclxuXHRzdGF0aWMgZ2V0IGZhaWxlZF91cmxzKCkge1xyXG5cdFx0cmV0dXJuICRmYWlsZWRfdXJscztcclxuXHR9XHJcbn1cclxud2luZG93LiRSZXNvdXJjZU1hbmFnZXIgPSBSZXNvdXJjZU1hbmFnZXI7XHJcblxyXG4vKipcclxuICogQHBhcmFtIHt7fX0gb2JqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEBwYXJhbSB7YW55fSB2YWx1ZVxyXG4gKi9cclxuZnVuY3Rpb24gJHNldFZhbHVlKG9iaiwgcGF0aCwgdmFsdWUpIHtcclxuXHRpZiAocGF0aC5lbmRzV2l0aChcIi9cIikpIHtcclxuXHRcdHBhdGggPSBwYXRoLnNsaWNlKDAsIHBhdGgubGVuZ3RoIC0gMSk7XHJcblx0fVxyXG5cdGxldCBwcyA9IHBhdGguc3BsaXQoXCIvXCIpO1xyXG5cdGxldCBpLCB0YXJnZXQgPSBvYmosIGxhc3RJbmRleCA9IHBzLmxlbmd0aCAtIDE7XHJcblx0Zm9yIChpID0gMDsgaSA8IGxhc3RJbmRleDsgKytpKSB7XHJcblx0XHRsZXQga2V5ID0gcHNbaV07XHJcblx0XHRpZiAodGFyZ2V0W2tleV0gPT0gbnVsbCkge1xyXG5cdFx0XHR0YXJnZXRba2V5XSA9IHtcclxuXHRcdFx0XHRbJHN5bWJvbF9wYXJ0aWFsXTogdHJ1ZSxcclxuXHRcdFx0fTtcclxuXHRcdFx0Y29uc29sZS5pbmZvKFwicGFydGlhbCBvYmplY3Q6IFwiLCBwYXRoKTtcclxuXHRcdH1cclxuXHRcdHRhcmdldCA9IHRhcmdldFtrZXldO1xyXG5cdH1cclxuXHRsZXQgb3JpZ2luX3ZhbHVlID0gdGFyZ2V0W3BzW2xhc3RJbmRleF1dO1xyXG5cdGlmIChvcmlnaW5fdmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRkZWxldGUgdGFyZ2V0W3BzW2xhc3RJbmRleF1dO1xyXG5cdFx0dGFyZ2V0W3BzW2xhc3RJbmRleF1dID0gdmFsdWU7XHJcblx0XHRpZiAodGFyZ2V0W3BzW2xhc3RJbmRleF1dWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdFx0ZGVsZXRlIHRhcmdldFtrZXldWyRzeW1ib2xfcGFydGlhbF07XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcImNvbXBsZXRlZCBvYmplY3QgKHByb21pc2UpOiBcIiwgcGF0aCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2UgaWYgKG9yaWdpbl92YWx1ZSAmJiB0eXBlb2Ygb3JpZ2luX3ZhbHVlID09IFwib2JqZWN0XCIpIHtcclxuXHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdG9yaWdpbl92YWx1ZVskc3ltYm9sX2xvYWRpbmddID0gdmFsdWUudGhlbihmdW5jdGlvbiAoZGF0YSkge1xyXG5cdFx0XHRcdC8vZm9yIChsZXQga2V5IGluIHZhbHVlKSB7XHJcblx0XHRcdFx0Ly9cdG9yaWdpbl92YWx1ZVtrZXldID0gdmFsdWVba2V5XSB8fCBvcmlnaW5fdmFsdWVba2V5XTtcclxuXHRcdFx0XHQvL31cclxuXHRcdFx0XHRvYmplY3RBc3NpZ25EZWVwKG9yaWdpbl92YWx1ZSwgZGF0YSk7XHJcblx0XHRcdFx0aWYgKG9yaWdpbl92YWx1ZVskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRcdFx0XHRkZWxldGUgb3JpZ2luX3ZhbHVlWyRzeW1ib2xfcGFydGlhbF07XHJcblx0XHRcdFx0XHRjb25zb2xlLmluZm8oXCJjb21wbGV0ZWQgb2JqZWN0IChhd2FpdCBwcm9taXNlKTogXCIsIHBhdGgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRkZWxldGUgb3JpZ2luX3ZhbHVlWyRzeW1ib2xfbG9hZGluZ107XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdC8vZm9yIChsZXQga2V5IGluIHZhbHVlKSB7XHJcblx0XHRcdC8vXHRvcmlnaW5fdmFsdWVba2V5XSA9IHZhbHVlW2tleV0gfHwgb3JpZ2luX3ZhbHVlW2tleV07XHJcblx0XHRcdC8vfVxyXG5cdFx0XHRvYmplY3RBc3NpZ25EZWVwKG9yaWdpbl92YWx1ZSwgdmFsdWUpO1xyXG5cdFx0XHRpZiAob3JpZ2luX3ZhbHVlWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdFx0XHRkZWxldGUgb3JpZ2luX3ZhbHVlWyRzeW1ib2xfcGFydGlhbF07XHJcblx0XHRcdFx0Y29uc29sZS5pbmZvKFwiY29tcGxldGVkIG9iamVjdCAodmFsdWUpOiBcIiwgcGF0aCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0ZWxzZSBpZiAodHlwZW9mIHZhbHVlICE9IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdHRhcmdldFtwc1tsYXN0SW5kZXhdXSA9IHZhbHVlO1xyXG5cdFx0aWYgKHRhcmdldFtwc1tsYXN0SW5kZXhdXVskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRcdGRlbGV0ZSB0YXJnZXRbcHNbbGFzdEluZGV4XV1bJHN5bWJvbF9wYXJ0aWFsXTtcclxuXHRcdFx0Y29uc29sZS5pbmZvKFwiQzogY29tcGxldGVkIG9iamVjdDogXCIsIHBhdGgpO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5mdW5jdGlvbiAkZ2V0VmFsdWUob2JqLCBwYXRoKSB7XHJcblx0aWYgKHBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XHJcblx0XHRwYXRoID0gcGF0aC5zbGljZSgwLCBwYXRoLmxlbmd0aCAtIDEpO1xyXG5cdH1cclxuXHRsZXQgcHMgPSBwYXRoLnNwbGl0KFwiL1wiKTtcclxuXHRsZXQgaSwgdGFyZ2V0ID0gb2JqLCBsYXN0SW5kZXggPSBwcy5sZW5ndGggLSAxO1xyXG5cdGZvciAoaSA9IDA7IGkgPCBsYXN0SW5kZXg7ICsraSkge1xyXG5cdFx0bGV0IGtleSA9IHBzW2ldO1xyXG5cdFx0aWYgKHRhcmdldFtrZXldKSB7XHJcblx0XHRcdFx0dGFyZ2V0ID0gdGFyZ2V0W2tleV07XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIHRhcmdldFtwc1tsYXN0SW5kZXhdXTtcclxufVxyXG5cclxuY29uc3Qgc3ltYm9sX2lzUGFjayA9IFN5bWJvbChcIiRwYWNrXCIpO1xyXG5cclxuY29uc3QgdXJsX3N0YXJ0c1dpdGhfcHJvdG9jb2wgPSBSZWdFeHAucHJvdG90eXBlLnRlc3QuYmluZCgvXigoW2EtekEtWl5cXDpdKykoXFw6LiopJHxcXC9cXC8pLyk7XHJcbmZ1bmN0aW9uIF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCB2YWx1ZSwgaXNfcGFjaykge1xyXG5cdGlmIChpc19wYWNrKSB7XHJcblx0XHR2YWx1ZVtzeW1ib2xfaXNQYWNrXSA9IHRydWU7XHJcblx0fVxyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHRlbHNlIGlmICh3aW5kb3cuJFJPT1RfUEFUSCAhPSBcIlwiICYmIHBhdGguc3RhcnRzV2l0aCh3aW5kb3cuJFJPT1RfUEFUSCkpIHtcclxuXHRcdGlmIChpc19wYWNrKSB7XHJcblx0XHRcdHZhbHVlW3N5bWJvbF9pc1BhY2tdID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdHBhdGggPSBwYXRoLnNsaWNlKHdpbmRvdy4kUk9PVF9QQVRILmxlbmd0aCk7XHJcblx0XHRyZXR1cm4gJHNldFZhbHVlKCRhcmNoaXZlLCBwYXRoLCB2YWx1ZSk7XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0cmV0dXJuICRzZXRWYWx1ZSgkYXJjaGl2ZSwgcGF0aCwgdmFsdWUpO1xyXG5cdH1cclxufVxyXG5mdW5jdGlvbiBfZ2V0VmFsdWVGcm9tQXJjaGl2ZUJ5UGF0aChwYXRoLCB2YWx1ZSkge1xyXG5cdGxldCBfcGF0aCA9IF9nZXREYXRhUGF0aEJ5VXJsKHBhdGgpO1xyXG5cdGlmIChfcGF0aCkge1xyXG5cdFx0cmV0dXJuICRnZXRWYWx1ZSgkYXJjaGl2ZSwgX3BhdGgpO1xyXG5cdH1cclxuXHRyZXR1cm4gdW5kZWZpbmVkO1xyXG59XHJcbmZ1bmN0aW9uIF9nZXREYXRhUGF0aEJ5VXJsKHBhdGgpIHtcclxuXHRpZiAoIXVybF9zdGFydHNXaXRoX3Byb3RvY29sKHBhdGgpKSB7XHJcblx0XHRpZiAod2luZG93LiRST09UX1BBVEggIT0gXCJcIiAmJiBwYXRoLnN0YXJ0c1dpdGgod2luZG93LiRST09UX1BBVEgpKSB7XHJcblx0XHRcdHJldHVybiBwYXRoLnNsaWNlKHdpbmRvdy4kUk9PVF9QQVRILmxlbmd0aCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmV0dXJuIHBhdGg7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB1bmRlZmluZWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fGFueX1cclxuICovXHJcbmZ1bmN0aW9uICRnZXRWYWx1ZUFzeW5jKG9iaiwgcGF0aCkge1xyXG5cdGlmIChwYXRoLmVuZHNXaXRoKFwiL1wiKSkge1xyXG5cdFx0cGF0aCA9IHBhdGguc2xpY2UoMCwgcGF0aC5sZW5ndGggLSAxKTtcclxuXHR9XHJcblx0XHJcblx0Ly8gdHJ5IGdldCB2YWx1ZSBzeW5jXHJcblx0bGV0IHZhbHVlID0gJGdldFZhbHVlKG9iaiwgcGF0aCk7XHJcblx0XHJcblx0Ly8gaWYgdmFsdWUgZXhpc3RcclxuXHRpZiAodmFsdWUpIHtcclxuXHRcdGlmICh2YWx1ZSBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuXHRcdFx0Ly8gPz9cclxuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0bGV0IHQgPSBhd2FpdCB2YWx1ZTtcclxuXHRcdFx0XHRcdHJlc29sdmUodCk7XHJcblx0XHRcdFx0XHQvL3Jlc29sdmUoYXdhaXQgJGdldFZhbHVlQXN5bmMob2JqLCBwYXRoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0XHRyZWplY3QoZXgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0cmV0dXJuIHZhbHVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIHsvLyBpZiB2YWx1ZSBub3QgZXhpc3QsIHRyeSBhd2FpdCBwYXJlbnQgbm9kZVxyXG5cdFx0bGV0IHBzID0gcGF0aC5zcGxpdChcIi9cIik7XHJcblx0XHRsZXQgaSwgdGFyZ2V0ID0gb2JqLCBsYXN0SW5kZXggPSBwcy5sZW5ndGggLSAxO1xyXG5cdFx0Zm9yIChpID0gMDsgaSA8IGxhc3RJbmRleDsgKytpKSB7XHJcblx0XHRcdGxldCBrZXkgPSBwc1tpXTtcclxuXHRcdFx0aWYgKHRhcmdldFtrZXldIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG5cdFx0XHRcdHJldHVybiBuZXcgUHJvbWlzZShhc3luYyBmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcblx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRsZXQgdCA9IGF3YWl0IHRhcmdldFtrZXldO1xyXG5cdFx0XHRcdFx0XHRyZXNvbHZlKHQpO1xyXG5cdFx0XHRcdFx0XHQvL3Jlc29sdmUoYXdhaXQgJGdldFZhbHVlQXN5bmMob2JqLCBwYXRoKSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0XHRcdHJlamVjdChleCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRhcmdldFtrZXldKSB7XHJcblx0XHRcdFx0XHR0YXJnZXQgPSB0YXJnZXRba2V5XTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRyZXR1cm4gdW5kZWZpbmVkO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRsZXQgcmVzdWx0ID0gdGFyZ2V0W3BzW2xhc3RJbmRleF1dO1xyXG5cdFx0aWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0bGV0IHQgPSBhd2FpdCByZXN1bHQ7XHJcblx0XHRcdFx0XHRyZXNvbHZlKHQpO1xyXG5cdFx0XHRcdFx0Ly9yZXNvbHZlKGF3YWl0ICRnZXRWYWx1ZUFzeW5jKG9iaiwgcGF0aCkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0XHRcdGRlYnVnZ2VyO1xyXG5cdFx0XHRcdFx0cmVqZWN0KGV4KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHJldHVybiByZXN1bHQ7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHVybFxyXG4gKiBAcGFyYW0ge1wiXCJ8XCJhcnJheWJ1ZmZlclwifFwiYmxvYlwifFwiZG9jdW1lbnRcInxcImpzb25cInxcInRleHRcIn0gW3Jlc3BvbnNlVHlwZV1cclxuICogQHJldHVybnMge1Byb21pc2U8YW55Pn1cclxuICovXHJcbmV4cG9ydCBsZXQgJGdldCA9IGZ1bmN0aW9uICRnZXQodXJsLCByZXNwb25zZVR5cGUpIHtcclxuXHRyZXR1cm4gUmVzb3VyY2VNYW5hZ2VyLmdldCh1cmwsIHJlc3BvbnNlVHlwZSk7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XHJcbiAqL1xyXG4kZ2V0LnBhY2sgPSBhc3luYyBmdW5jdGlvbiAkZ2V0X3BhY2socGF0aCkge1xyXG5cdGxldCBfcGF0aCA9IF9nZXREYXRhUGF0aEJ5VXJsKHBhdGgpO1xyXG5cdGxldCBvYmo7XHJcblxyXG5cdGlmIChfcGF0aCkge1xyXG5cdFx0b2JqID0gJGdldFZhbHVlQXN5bmMoJGFyY2hpdmUsIF9wYXRoKTtcclxuXHR9XHJcblxyXG5cdGlmIChvYmogaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRyZXR1cm4gYXdhaXQgb2JqO1xyXG5cdH1cclxuXHRlbHNlIGlmIChvYmogJiYgb2JqW3N5bWJvbF9pc1BhY2tdKSB7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdC8vaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xyXG5cdFx0Ly9cdGlmIChvYmogJiYgIW9ialtzeW1ib2xfaXNQYWNrXSkge1xyXG5cdFx0Ly9cdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihcImRhdGE6IFwiICsgcGF0aCk7XHJcblx0XHQvL1x0fVxyXG5cdFx0Ly99XHJcblx0XHRjb25zdCB1cmwgPSAkZ2V0LnBhY2tVcmwocGF0aCk7XHJcblxyXG5cdFx0bGV0IHRhc2sgPSAoYXN5bmMgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGxldCBqc29uVGV4dCA9IGF3YWl0IFJlc291cmNlTWFuYWdlci5nZXQodXJsKTtcclxuXHJcblx0XHRcdFx0b2JqID0gSlNPTi5wYXJzZShqc29uVGV4dCk7XHJcblxyXG5cdFx0XHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCBvYmosIHRydWUpO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gb2JqO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRcdHJldHVybiB1bmRlZmluZWQ7XHJcblx0XHRcdH1cclxuXHRcdH0pKCk7XHJcblx0XHRfc2V0VmFsdWVCeVBhdGgocGF0aCwgdGFzaywgdHJ1ZSk7XHJcblxyXG5cdFx0cmV0dXJuIGF3YWl0IHRhc2s7XHJcblx0fVxyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxyXG4gKi9cclxuJGdldC5wYWNrU3luYyA9IGZ1bmN0aW9uIGdldF9wYWNrU3luYyhwYXRoKSB7XHJcblx0bGV0IG9iaiA9IF9nZXRWYWx1ZUZyb21BcmNoaXZlQnlQYXRoKHBhdGgpO1xyXG5cdGlmIChvYmopIHtcclxuXHRcdHJldHVybiBvYmo7XHJcblx0fVxyXG5cdHJldHVybiB1bmRlZmluZWQ7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XHJcbiAqL1xyXG4kZ2V0LmRhdGEgPSBhc3luYyBmdW5jdGlvbiAkZ2V0X2RhdGEocGF0aCkge1xyXG5cdGxldCBfcGF0aCA9IF9nZXREYXRhUGF0aEJ5VXJsKHBhdGgpO1xyXG5cdGxldCBvYmo7XHJcblxyXG5cdGlmIChfcGF0aCkge1xyXG5cdFx0b2JqID0gJGdldFZhbHVlQXN5bmMoJGFyY2hpdmUsIF9wYXRoKTtcclxuXHR9XHJcblxyXG5cdGlmIChvYmogaW5zdGFuY2VvZiBQcm9taXNlKSB7XHJcblx0XHRyZXR1cm4gYXdhaXQgb2JqO1xyXG5cdH1cclxuXHRlbHNlIGlmIChvYmogJiYgIW9ialskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdGlmIChvYmogJiYgb2JqWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdFx0Y29uc29sZS5pbmZvKFwiY29tcGxldCBvYmplY3Q6IFwiLCBwYXRoKTtcclxuXHRcdH1cclxuXHRcdGNvbnN0IHVybCA9ICRnZXQuZGF0YVVybChwYXRoKTtcclxuXHJcblx0XHRsZXQgdGFzayA9IChhc3luYyBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGpzb25UZXh0ID0gYXdhaXQgUmVzb3VyY2VNYW5hZ2VyLmdldCh1cmwpO1xyXG5cclxuXHRcdFx0XHRvYmogPSBKU09OLnBhcnNlKGpzb25UZXh0KTtcclxuXHJcblx0XHRcdFx0X3NldFZhbHVlQnlQYXRoKHBhdGgsIG9iaiwgZmFsc2UpO1xyXG5cclxuXHRcdFx0XHRyZXR1cm4gb2JqO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRcdHJldHVybiB1bmRlZmluZWQ7XHJcblx0XHRcdH1cclxuXHRcdH0pKCk7XHJcblx0XHRfc2V0VmFsdWVCeVBhdGgocGF0aCwgdGFzaywgZmFsc2UpO1xyXG5cclxuXHRcdHJldHVybiBhd2FpdCB0YXNrO1xyXG5cdH1cclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge2FueX1cclxuICovXHJcbiRnZXQuZGF0YVN5bmMgPSBmdW5jdGlvbiBnZXRfZGF0YVN5bmMocGF0aCkge1xyXG5cdGxldCBvYmogPSBfZ2V0VmFsdWVGcm9tQXJjaGl2ZUJ5UGF0aChwYXRoKTtcclxuXHRpZiAob2JqKSB7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRyZXR1cm4gdW5kZWZpbmVkO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxyXG4gKi9cclxuJGdldC5saXN0ID0gYXN5bmMgZnVuY3Rpb24gJGdldF9saXN0KHBhdGgpIHtcclxuXHRsZXQgX3BhdGggPSBfZ2V0RGF0YVBhdGhCeVVybChwYXRoKTtcclxuXHRsZXQgb2JqO1xyXG5cclxuXHRpZiAoX3BhdGgpIHtcclxuXHRcdG9iaiA9ICRnZXRWYWx1ZUFzeW5jKCRhcmNoaXZlLCBfcGF0aCk7XHJcblx0fVxyXG5cclxuXHRpZiAob2JqIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG5cdFx0Y29uc29sZS53YXJuKFwiJGdldC5saXN0IOacquWujOaIkFwiKTtcclxuXHRcdHJldHVybiBhd2FpdCBvYmo7XHJcblx0fVxyXG5cdGVsc2UgaWYgKG9iaiAmJiAhb2JqWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdGNvbnNvbGUud2FybihcIiRnZXQubGlzdCDmnKrlrozmiJBcIik7XHJcblx0XHRyZXR1cm4gb2JqO1xyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdGlmIChvYmogJiYgb2JqWyRzeW1ib2xfcGFydGlhbF0pIHtcclxuXHRcdFx0Y29uc29sZS5pbmZvKFwiY29tcGxldCBvYmplY3Q6IFwiLCBwYXRoKTtcclxuXHRcdH1cclxuXHRcdGNvbnNvbGUud2FybihcIiRnZXQubGlzdCDmnKrlrozmiJBcIik7XHJcblxyXG5cdFx0Y29uc3QgdXJsID0gJGdldC5saXN0VXJsKHBhdGgpO1xyXG5cclxuXHRcdGxldCB0YXNrID0gKGFzeW5jIGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRsZXQganNvblRleHQgPSBhd2FpdCBSZXNvdXJjZU1hbmFnZXIuZ2V0KHVybCk7XHJcblxyXG5cdFx0XHRcdG9iaiA9IEpTT04ucGFyc2UoanNvblRleHQpO1xyXG5cclxuXHRcdFx0XHRfc2V0VmFsdWVCeVBhdGgocGF0aCwgb2JqLCBmYWxzZSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBvYmo7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fSkoKTtcclxuXHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCB0YXNrLCBmYWxzZSk7XHJcblxyXG5cdFx0cmV0dXJuIGF3YWl0IHRhc2s7XHJcblx0fVxyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fVxyXG4gKi9cclxuJGdldC5saXN0U3luYyA9IGZ1bmN0aW9uICRnZXRfbGlzdFN5bmMocGF0aCkge1xyXG5cdGxldCBvYmogPSBfZ2V0VmFsdWVGcm9tQXJjaGl2ZUJ5UGF0aChwYXRoKTtcclxuXHRpZiAob2JqKSB7XHJcblx0XHRyZXR1cm4gT2JqZWN0LmtleXMob2JqKTtcclxuXHR9XHJcblx0cmV0dXJuIHVuZGVmaW5lZDtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge1Byb21pc2U8YW55Pn1cclxuICovXHJcbiRnZXQuYmluYXJ5ID0gYXN5bmMgZnVuY3Rpb24gJGdldF9kYXRhKHBhdGgpIHtcclxuXHRsZXQgX3BhdGggPSBfZ2V0RGF0YVBhdGhCeVVybChwYXRoKTtcclxuXHRsZXQgb2JqO1xyXG5cclxuXHRpZiAoX3BhdGgpIHtcclxuXHRcdG9iaiA9ICRnZXRWYWx1ZUFzeW5jKCRhcmNoaXZlLCBfcGF0aCk7XHJcblx0fVxyXG5cclxuXHRpZiAob2JqIGluc3RhbmNlb2YgUHJvbWlzZSkge1xyXG5cdFx0cmV0dXJuIGF3YWl0IG9iajtcclxuXHR9XHJcblx0ZWxzZSBpZiAob2JqICYmICFvYmpbJHN5bWJvbF9wYXJ0aWFsXSkge1xyXG5cdFx0cmV0dXJuIG9iajtcclxuXHR9XHJcblx0ZWxzZSB7XHJcblx0XHRpZiAob2JqICYmIG9ialskc3ltYm9sX3BhcnRpYWxdKSB7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcImNvbXBsZXQgb2JqZWN0OiBcIiwgcGF0aCk7XHJcblx0XHR9XHJcblx0XHRjb25zdCB1cmwgPSAkZ2V0LmJpbmFyeVVybChwYXRoKTtcclxuXHJcblx0XHRsZXQgdGFzayA9IChhc3luYyBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGJ1ZiA9IGF3YWl0IFJlc291cmNlTWFuYWdlci5nZXQodXJsLCBcImFycmF5QnVmZmVyXCIpO1xyXG5cclxuXHRcdFx0XHRfc2V0VmFsdWVCeVBhdGgocGF0aCwgYnVmLCBmYWxzZSk7XHJcblxyXG5cdFx0XHRcdHJldHVybiBidWY7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0cmV0dXJuIHVuZGVmaW5lZDtcclxuXHRcdFx0fVxyXG5cdFx0fSkoKTtcclxuXHRcdF9zZXRWYWx1ZUJ5UGF0aChwYXRoLCB0YXNrLCBmYWxzZSk7XHJcblxyXG5cdFx0cmV0dXJuIGF3YWl0IHRhc2s7XHJcblx0fVxyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7YW55fVxyXG4gKi9cclxuJGdldC5iaW5hcnlTeW5jID0gZnVuY3Rpb24gZ2V0X2RhdGFTeW5jKHBhdGgpIHtcclxuXHRsZXQgb2JqID0gX2dldFZhbHVlRnJvbUFyY2hpdmVCeVBhdGgocGF0aCk7XHJcblx0aWYgKG9iaikge1xyXG5cdFx0cmV0dXJuIG9iajtcclxuXHR9XHJcblx0cmV0dXJuIHVuZGVmaW5lZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG4kZ2V0LmRhdGFVcmwgPSBmdW5jdGlvbiAkZ2V0X2RhdGFVcmwocGF0aCkge1xyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJkYXRhXCIpKSB7XHJcblx0XHRyZXR1cm4gYCR7d2luZG93LiRST09UX1BBVEh9ZGF0YSR7cGF0aH0uanNvbmA7XHJcblx0fVxyXG5cdHRocm93IG5ldyBFcnJvcihcIk5vdCBnYW1lIGRhdGE6IFwiICsgcGF0aCk7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAqL1xyXG4kZ2V0LnBhY2tVcmwgPSBmdW5jdGlvbiAkZ2V0X3BhY2tVcmwocGF0aCkge1xyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJwYWNrXCIpKSB7XHJcblx0XHRyZXR1cm4gYCR7d2luZG93LiRST09UX1BBVEh9cGFjayR7cGF0aH0uanNvbmA7XHJcblx0fVxyXG5cdHRocm93IG5ldyBFcnJvcihcIk5vdCBnYW1lIHBhY2s6IFwiICsgcGF0aCk7XHJcbn1cclxuJGdldC5saXN0VXJsID0gZnVuY3Rpb24gJGdldF9saXN0VXJsKHBhdGgpIHtcclxuXHRpZiAodXJsX3N0YXJ0c1dpdGhfcHJvdG9jb2wocGF0aCkpIHtcclxuXHRcdHJldHVybiBwYXRoO1xyXG5cdH1cclxuXHRlbHNlIGlmICghcGF0aC5zdGFydHNXaXRoKFwibHNcIikpIHtcclxuXHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1scyR7cGF0aH0uanNvbmA7XHJcblx0fVxyXG5cdHRocm93IG5ldyBFcnJvcihwYXRoKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbiRnZXQuYmluYXJ5VXJsID0gZnVuY3Rpb24gJGdldF9kYXRhVXJsKHBhdGgpIHtcclxuXHRpZiAodXJsX3N0YXJ0c1dpdGhfcHJvdG9jb2wocGF0aCkpIHtcclxuXHRcdHJldHVybiBwYXRoO1xyXG5cdH1cclxuXHRlbHNlIGlmICghcGF0aC5zdGFydHNXaXRoKFwiYmluYXJ5XCIpKSB7XHJcblx0XHRyZXR1cm4gYCR7d2luZG93LiRST09UX1BBVEh9YmluYXJ5JHtwYXRofWA7XHJcblx0fVxyXG5cdHRocm93IG5ldyBFcnJvcihcIk5vdCBnYW1lIGJpbmFyeSBkYXRhOiBcIiArIHBhdGgpO1xyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuJGdldC5pbWFnZVVybCA9IGZ1bmN0aW9uICRnZXRfaW1hZ2VzVXJsKHBhdGgpIHtcclxuXHRpZiAod2luZG93LiRub2ltYWdlKSB7XHJcblx0XHRyZXR1cm4gYCR7d2luZG93LiRST09UX1BBVEh9aW1hZ2VzLzF4MS5wbmdgO1xyXG5cdH1cclxuXHR7XHJcblx0XHRpZiAodXJsX3N0YXJ0c1dpdGhfcHJvdG9jb2wocGF0aCkpIHtcclxuXHRcdFx0cmV0dXJuIHBhdGg7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmICghcGF0aC5zdGFydHNXaXRoKFwiaW1hZ2VzXCIpKSB7XHJcblx0XHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1pbWFnZXMke3BhdGh9LnBuZ2A7XHJcblx0XHR9XHJcblx0XHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgZ2FtZSBpbWFnZXM6IFwiICsgcGF0aCk7XHJcblx0fVxyXG59XHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuJGdldC5zb3VuZE1wM1VybCA9IGZ1bmN0aW9uICRnZXRfc291bmRNcDNVcmwocGF0aCkge1xyXG5cdGlmICh1cmxfc3RhcnRzV2l0aF9wcm90b2NvbChwYXRoKSkge1xyXG5cdFx0cmV0dXJuIHBhdGg7XHJcblx0fVxyXG5cdGVsc2UgaWYgKCFwYXRoLnN0YXJ0c1dpdGgoXCJzb3VuZFwiKSkge1xyXG5cdFx0cmV0dXJuIGAke3dpbmRvdy4kUk9PVF9QQVRIfXNvdW5kJHtwYXRofS5tcDNgO1xyXG5cdH1cclxuXHR0aHJvdyBuZXcgRXJyb3IoXCJOb3QgZ2FtZSBzb3VuZDogXCIgKyBwYXRoKTtcclxufVxyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHBhdGhcclxuICogQHJldHVybnMge3N0cmluZ31cclxuICovXHJcbiRnZXQuc291bmRXYXZVcmwgPSBmdW5jdGlvbiAkZ2V0X3NvdW5kV2F2VXJsKHBhdGgpIHtcclxuXHRpZiAodXJsX3N0YXJ0c1dpdGhfcHJvdG9jb2wocGF0aCkpIHtcclxuXHRcdHJldHVybiBwYXRoO1xyXG5cdH1cclxuXHRlbHNlIGlmICghcGF0aC5zdGFydHNXaXRoKFwic291bmRcIikpIHtcclxuXHRcdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH1zb3VuZCR7cGF0aH0ud2F2YDtcclxuXHR9XHJcblx0dGhyb3cgbmV3IEVycm9yKFwiTm90IGdhbWUgc291bmQ6IFwiICsgcGF0aCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aFxyXG4gKiBAcmV0dXJucyB7c3RyaW5nfVxyXG4gKi9cclxuJGdldC5hc3NldFVybCA9IGZ1bmN0aW9uICRnZXRfYXNzZXRVcmwocGF0aCkge1xyXG5cdHJldHVybiBgJHt3aW5kb3cuJFJPT1RfUEFUSH0ke3BhdGh9YDtcclxufVxyXG4kZ2V0LmFzc2V0ID0gZnVuY3Rpb24gJGdldF9hc3NldChwYXRoKSB7XHJcblx0cmV0dXJuICRnZXQoJGdldC5hc3NldFVybChwYXRoKSk7XHJcbn1cclxuXHJcbndpbmRvdy4kZ2V0ID0gJGdldDtcclxuXHJcblxyXG5leHBvcnQgY2xhc3MgSXRlbUF0dHJOb3JtYWxpemUge1xyXG5cdHN0YXRpYyBoZWFkKGl0ZW0pIHtcclxuXHRcdGl0ZW0uZ2VuZGVyID0gMjtcclxuXHR9XHJcblx0c3RhdGljIGJvZHkoaXRlbSkge1xyXG5cdFx0aXRlbS5nZW5kZXIgPSAyO1xyXG5cdH1cclxuXHRzdGF0aWMgRmFjZShpdGVtKSB7XHJcblx0XHRjb25zdCBnID0gTWF0aC50cnVuYygoaXRlbS5pZCAlIDEwMDAwKSAvIDEwMDApO1xyXG5cdFx0aXRlbS5nZW5kZXIgPSBnID09IDEgfHwgZyA9PSA0ID8gMSA6IDA7XHJcblx0fVxyXG5cdHN0YXRpYyBIYWlyKGl0ZW0pIHtcclxuXHRcdGNvbnN0IGcgPSBNYXRoLnRydW5jKChpdGVtLmlkICUgMTAwMDApIC8gMTAwMCk7XHJcblx0XHRpdGVtLmdlbmRlciA9IGcgPT0gMSB8fCBnID09IDIgfHwgZyA9PSA0IHx8IGcgPT0gNyA/IDEgOiAwO1xyXG5cdH1cclxuXHRzdGF0aWMgQ2FwKGl0ZW0pIHtcclxuXHRcdEl0ZW1BdHRyTm9ybWFsaXplLl9lcXVpcChpdGVtKTtcclxuXHR9XHJcblx0c3RhdGljIGFjY2Vzc29yeUZhY2UoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgYWNjZXNzb3J5RXllcyhpdGVtKSB7XHJcblx0XHRJdGVtQXR0ck5vcm1hbGl6ZS5fZXF1aXAoaXRlbSk7XHJcblx0fVxyXG5cdHN0YXRpYyBhY2Nlc3NvcnlFYXJzKGl0ZW0pIHtcclxuXHRcdEl0ZW1BdHRyTm9ybWFsaXplLl9lcXVpcChpdGVtKTtcclxuXHR9XHJcblx0c3RhdGljIENvYXQoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgTG9uZ2NvYXQoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgUGFudHMoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgU2hvZXMoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgR2xvdmUoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgU2hpZWxkKGl0ZW0pIHtcclxuXHRcdEl0ZW1BdHRyTm9ybWFsaXplLl9lcXVpcChpdGVtKTtcclxuXHR9XHJcblx0c3RhdGljIENhcGUoaXRlbSkge1xyXG5cdFx0SXRlbUF0dHJOb3JtYWxpemUuX2VxdWlwKGl0ZW0pO1xyXG5cdH1cclxuXHRzdGF0aWMgX2VxdWlwKGl0ZW0pIHtcclxuXHRcdGNvbnN0IGcgPSBNYXRoLnRydW5jKChpdGVtLmlkICUgMTAwMDApIC8gMTAwMCk7XHJcblx0XHRpdGVtLmdlbmRlciA9IGcgPT0gMCA/IDAgOiAoZyA9PSAxID8gMSA6IDIpO1xyXG5cdH1cclxufVxyXG5cclxuY29uc3QgcmVnZXhwX2dldEhhaXJTdHlsZUlEID0gLyhcXGR7NCw3fSlcXGQkLztcclxuY29uc3QgcmVnZXhwX2dldEZhY2VTdHlsZUlEID0gLyhcXGR7Miw1fSlcXGQoXFxkezJ9KSQvO1xyXG5cclxuY29uc3QgcmVnZXhwX2dldEhhaXJDb2xvciA9IC9cXGR7NCw3fShcXGQpJC87XHJcbmNvbnN0IHJlZ2V4cF9nZXRGYWNlQ29sb3IgPSAvXFxkezIsNX0oXFxkKVxcZHsyfSQvO1xyXG5cclxuZXhwb3J0IGNsYXNzIENoYXJhY3RlclJlbmRlckNvbmZpZyB7XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHN0eWxlIGlkXHJcblx0ICogQHJldHVybnMge3N0cmluZ1tdfVxyXG5cdCAqL1xyXG5cdHN0YXRpYyAqIGVudW1IYWlyQ29sb3Ioc3R5bGUpIHtcclxuXHRcdGxldCBtID0gc3R5bGUubWF0Y2gocmVnZXhwX2dldEhhaXJTdHlsZUlEKTtcclxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgMTA7ICsraSkge1xyXG5cdFx0XHRsZXQgaWQgPSBtWzFdICsgaTtcclxuXHRcdFx0eWllbGQgaWQ7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc3R5bGUgaWRcclxuXHQgKiBAcmV0dXJucyB7c3RyaW5nW119XHJcblx0ICovXHJcblx0c3RhdGljICogZW51bUZhY2VDb2xvcihzdHlsZSkge1xyXG5cdFx0bGV0IG0gPSBzdHlsZS5tYXRjaChyZWdleHBfZ2V0RmFjZVN0eWxlSUQpO1xyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgKytpKSB7XHJcblx0XHRcdGxldCBpZCA9IG1bMV0gKyBpICsgbVsyXTtcclxuXHRcdFx0eWllbGQgaWQ7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gc3R5bGVcclxuXHQgKiBAcGFyYW0ge251bWJlcn0gY29sb3JcclxuXHQgKiBAcmV0dXJucyB7c3RyaW5nfVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBnZXRDb2xvckhhaXJJRChzdHlsZSwgY29sb3IpIHtcclxuXHRcdGxldCBtID0gc3R5bGUubWF0Y2gocmVnZXhwX2dldEhhaXJTdHlsZUlEKTtcclxuXHRcdGxldCBpZCA9IG1bMV0gKyAoY29sb3IgJSAxMCk7XHJcblx0XHRyZXR1cm4gaWQ7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBzdHlsZVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBjb2xvclxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9XHJcblx0ICovXHJcblx0c3RhdGljIGdldENvbG9yRmFjZUlEKHN0eWxlLCBjb2xvcikge1xyXG5cdFx0bGV0IG0gPSBzdHlsZS5tYXRjaChyZWdleHBfZ2V0RmFjZVN0eWxlSUQpO1xyXG5cdFx0bGV0IGlkID0gbVsxXSArIChjb2xvciAlIDEwKSArIG1bMl07XHJcblx0XHRyZXR1cm4gaWQ7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gaWRfMVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZF8yXHJcblx0ICogQHJldHVybnMge2Jvb2xlYW59XHJcblx0ICovXHJcblx0c3RhdGljIGlzSGFpclN0eWxlRXF1YWwoaWRfMSwgaWRfMikge1xyXG5cdFx0cmV0dXJuIENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckhhaXJJRChpZF8xLCAwKSA9PSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0Q29sb3JIYWlySUQoaWRfMiwgMCk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZF8xXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXzJcclxuXHQgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuXHQgKi9cclxuXHRzdGF0aWMgaXNGYWNlU3R5bGVFcXVhbChpZF8xLCBpZF8yKSB7XHJcblx0XHRyZXR1cm4gQ2hhcmFjdGVyUmVuZGVyQ29uZmlnLmdldENvbG9yRmFjZUlEKGlkXzEsIDApID09IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRDb2xvckZhY2VJRChpZF8yLCAwKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBpZFxyXG5cdCAqIEByZXR1cm5zIHtzdHJpbmd9XHJcblx0ICovXHJcblx0c3RhdGljIGdldEhhaXJDb2xvcihpZCkge1xyXG5cdFx0aWYgKGlkKSB7XHJcblx0XHRcdGlkID0gU3RyaW5nKGlkKTtcclxuXHRcdFx0bGV0IG0gPSBpZC5tYXRjaChyZWdleHBfZ2V0SGFpckNvbG9yKTtcclxuXHRcdFx0aWYgKG0pIHtcclxuXHRcdFx0XHRyZXR1cm4gbVsxXTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGlkXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRzdGF0aWMgZ2V0RmFjZUNvbG9yKGlkKSB7XHJcblx0XHRpZiAoaWQpIHtcclxuXHRcdFx0aWQgPSBTdHJpbmcoaWQpO1xyXG5cdFx0XHRsZXQgbSA9IGlkLm1hdGNoKHJlZ2V4cF9nZXRGYWNlQ29sb3IpO1xyXG5cdFx0XHRpZiAobSkge1xyXG5cdFx0XHRcdHJldHVybiBtWzFdO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG52YXIgX2V4dGVybmFsX2RhdGEgPSB7XHJcblx0XCJyZXF1aXJlZEpvYnNcIjogW1xyXG5cdFx0XCJCZWdpbm5lclwiXHJcblx0XSxcclxuXHRcInJlcXVpcmVkTGV2ZWxcIjogMCxcclxuXHRcImlzQ2FzaFwiOiB0cnVlLFxyXG5cdFwibmFtZVwiOiBcIkJsdWUgQmVhbmllXCIsXHJcblx0XCJkZXNjXCI6IG51bGwsXHJcblx0XCJpZFwiOiAxMDAwMDAwLFxyXG5cdFwicmVxdWlyZWRHZW5kZXJcIjogMCxcclxuXHRcInR5cGVJbmZvXCI6IHtcclxuXHRcdFwib3ZlcmFsbENhdGVnb3J5XCI6IFwiRXF1aXBcIixcclxuXHRcdFwiY2F0ZWdvcnlcIjogXCJBcm1vclwiLFxyXG5cdFx0XCJzdWJDYXRlZ29yeVwiOiBcIkhhdFwiXHJcblx0fVxyXG59O1xyXG5cclxudmFyIEl0ZW1UeXBlSW5mbyA9IHtcclxuXHRcIkVxdWlwXCI6IHtcclxuXHRcdFwiSGF0XCI6IFwiQ2FwXCIsXHJcblx0XHRcIkNhcGVcIjogXCJDYXBlXCIsXHJcblx0XHRcIlRvcFwiOiBcIkNvYXRcIixcclxuXHRcdFwiT3ZlcmFsbFwiOiBcIkxvbmdjb2F0XCIsXHJcblx0XHRcIkdsb3ZlXCI6IFwiR2xvdmVcIixcclxuXHRcdFwiQm90dG9tXCI6IFwiUGFudHNcIixcclxuXHJcblx0XHRcIlNoaWVsZFwiOiBcIlNoaWVsZFwiLFxyXG5cdFx0XCJTaG9lc1wiOiBcIlNob2VzXCIsXHJcblx0XHRcIkV5ZSBEZWNvcmF0aW9uXCI6IFwiYWNjZXNzb3J5RXllc1wiLFxyXG5cdFx0XCJFYXJyaW5nc1wiOiBcImFjY2Vzc29yeUVhcnNcIixcclxuXHRcdC8vXCJSaW5nXCI6IFwiXCIsXHJcblxyXG5cdFx0Ly9cIlBlbmRhbnRcIjogXCJcIixcclxuXHRcdFwiRmFjZSBBY2Nlc3NvcnlcIjogXCJhY2Nlc3NvcnlGYWNlXCIsXHJcblx0XHQvL1wiQmVsdFwiOiBcIlwiLFxyXG5cdFx0Ly9cIk1lZGFsXCI6IFwiXCIsXHJcblx0XHQvL1wiU2hvdWxkZXIgQWNjZXNzb3J5XCI6IFwiXCIsXHJcblx0XHQvL1wiQmFkZ2VcIjogXCJcIixcclxuXHJcblx0XHQvL1wiRHJhZ29uIEVxdWlwbWVudFwiOiBcIlwiLFxyXG5cdFx0Ly9cIk1lY2hhbmljIEVxdWlwbWVudFwiOiBcIlwiLFxyXG5cdFx0Ly9cIlBldCBFcXVpcG1lbnRcIjogXCJcIixcclxuXHRcdC8vXCJBbmRyb2lkXCI6IFwiXCIsXHJcblx0XHQvL1wiTWVjaGFuaWNhbCBIZWFydFwiOiBcIlwiLFxyXG5cdFx0Ly9cIkJpdHNcIjogXCJcIixcclxuXHJcblx0XHRcIkZhY2VcIjogXCJGYWNlXCIsXHJcblx0XHRcIkhhaXJcIjogXCJIYWlyXCIsXHJcblx0fSxcclxufTtcclxuXHJcblJlc291cmNlTWFuYWdlci5leHRlcm5hbCA9IHtcclxuXHRlcXVpcDoge1xyXG5cdH0sXHJcbn07XHJcblxyXG4vKiogQHR5cGUge3tbY2F0ZWdvcnk6c3RyaW5nXTpNYXA8c3RyaW5nLHt9Pn19ICovXHJcblJlc291cmNlTWFuYWdlci5lcXVpcF9tYXAgPSB7XHJcbn07XHJcblxyXG5mb3IgKGxldCBpIGluIEl0ZW1UeXBlSW5mby5FcXVpcCkge1xyXG5cdGxldCBjYXRlZ29yeSA9IEl0ZW1UeXBlSW5mby5FcXVpcFtpXTtcclxuXHRSZXNvdXJjZU1hbmFnZXIuZXh0ZXJuYWwuZXF1aXBbY2F0ZWdvcnldID0gW107XHJcblx0UmVzb3VyY2VNYW5hZ2VyLmVxdWlwX21hcFtjYXRlZ29yeV0gPSBudWxsO1xyXG59XHJcbmZvciAobGV0IGkgPSAwOyBpIDwgOTsgKytpKSB7XHJcblx0bGV0IGNhdGVnb3J5ID0gXCJGYWNlXCIgKyBpO1xyXG5cdFJlc291cmNlTWFuYWdlci5leHRlcm5hbC5lcXVpcFtjYXRlZ29yeV0gPSBbXTtcclxuXHRSZXNvdXJjZU1hbmFnZXIuZXF1aXBfbWFwW2NhdGVnb3J5XSA9IG51bGw7XHJcbn1cclxuZm9yIChsZXQgaSA9IDA7IGkgPD0gOTsgKytpKSB7XHJcblx0bGV0IGNhdGVnb3J5ID0gXCJIYWlyXCIgKyBpO1xyXG5cdFJlc291cmNlTWFuYWdlci5leHRlcm5hbC5lcXVpcFtjYXRlZ29yeV0gPSBbXTtcclxuXHRSZXNvdXJjZU1hbmFnZXIuZXF1aXBfbWFwW2NhdGVnb3J5XSA9IG51bGw7XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkX2V4dGVybmFsX3Jlc291cmNlKHVybCkge1xyXG5cdC8vdXJsID0gdXJsIHx8IFwiL2l0ZW1zLmpzb25cIjtcclxuXHRsZXQgcmF3O1xyXG5cclxuXHQvLyB0cnkge1xyXG5cdC8vIFx0cmF3ID0gUmVzb3VyY2VNYW5hZ2VyLl9leHRlcm5hbF9yYXcgPSBKU09OLnBhcnNlKGF3YWl0ICRnZXQuYXNzZXQoXCJlcXVpcC5qc29uXCIpKTtcclxuXHQvLyBcdGlmICghcmF3KSB7XHJcblx0Ly8gXHRcdGRlYnVnZ2VyO1xyXG5cdC8vIFx0XHR0aHJvdyBFcnJvcihcIicvZXF1aXAuanNvbicgaXMgZW1wdHlcIik7XHJcblx0Ly8gXHR9XHJcblx0Ly8gfVxyXG5cdC8vIGNhdGNoIChleCkge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmF3ID0gUmVzb3VyY2VNYW5hZ2VyLl9leHRlcm5hbF9yYXcgPSBKU09OLnBhcnNlKGF3YWl0ICRnZXQoYGh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbn0vJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259L2l0ZW0vY2F0ZWdvcnkvZXF1aXBgKSk7XHJcblx0XHRcdGlmICghcmF3KSB7XHJcblx0XHRcdFx0ZGVidWdnZXI7XHJcblx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdC8vIH1cclxuXHRcclxuXHRmb3IgKGxldCBpID0gMDsgaSA8IHJhdy5sZW5ndGg7ICsraSkge1xyXG5cdFx0Y29uc3QgaXRlbSA9IHJhd1tpXTtcclxuXHRcdGNvbnN0IGlkID0gU3RyaW5nKGl0ZW0uaWQpLnBhZFN0YXJ0KDgsIFwiMFwiKTtcclxuXHRcdFxyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aWYgKCEoaXRlbS50eXBlSW5mbyAmJiBJdGVtVHlwZUluZm9baXRlbS50eXBlSW5mby5vdmVyYWxsQ2F0ZWdvcnldKSkge1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgY2x6ID0gaXRlbS50eXBlSW5mby5vdmVyYWxsQ2F0ZWdvcnkudG9Mb3dlckNhc2UoKTtcclxuXHRcdFx0bGV0IGNhdGVnb3J5TmFtZSA9IEl0ZW1UeXBlSW5mb1tpdGVtLnR5cGVJbmZvLm92ZXJhbGxDYXRlZ29yeV1baXRlbS50eXBlSW5mby5zdWJDYXRlZ29yeV07XHJcblx0XHRcdGlmICghY2F0ZWdvcnlOYW1lKSB7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAoY2F0ZWdvcnlOYW1lID09IFwiRmFjZVwiKSB7XHJcblx0XHRcdFx0Y2F0ZWdvcnlOYW1lICs9IENoYXJhY3RlclJlbmRlckNvbmZpZy5nZXRGYWNlQ29sb3IoaWQpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2UgaWYgKGNhdGVnb3J5TmFtZSA9PSBcIkhhaXJcIikge1xyXG5cdFx0XHRcdGNhdGVnb3J5TmFtZSArPSBDaGFyYWN0ZXJSZW5kZXJDb25maWcuZ2V0SGFpckNvbG9yKGlkKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0bGV0IGl0ID0ge1xyXG5cdFx0XHRcdGlkOiBpZCxcclxuXHRcdFx0XHRuYW1lOiBpdGVtLm5hbWUsXHJcblx0XHRcdFx0ZGVzYzogaXRlbS5kZXNjLFxyXG5cdFx0XHRcdGNhc2g6IGl0ZW0uaXNDYXNoID8gMSA6IDAsXHJcblx0XHRcdFx0aWNvbjoge1xyXG5cdFx0XHRcdFx0XCJcIjogYGh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbn0vJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259L2l0ZW0vJHtpdGVtLmlkfS9pY29uYCxcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdF9fdjogYCR7UmVzb3VyY2VNYW5hZ2VyLmRhdGFSZWdpb259JHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259YCxcclxuXHRcdFx0fTtcclxuXHJcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KFJlc291cmNlTWFuYWdlci5leHRlcm5hbFtjbHpdW2NhdGVnb3J5TmFtZV0pKSB7XHJcblx0XHRcdFx0UmVzb3VyY2VNYW5hZ2VyLmV4dGVybmFsW2Nsel1bY2F0ZWdvcnlOYW1lXS5wdXNoKGl0KTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRkZWJ1Z2dlclxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRjYXRjaCAoZXgpIHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihcImV4dGVybmFsIHJlc291cmNlOiBpZChcIiArIGlkICsgXCIpXCIpO1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGV4KTtcclxuXHRcdFx0ZGVidWdnZXI7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVfZXh0ZXJuYWxfZXF1aXBfbGlzdCgpIHtcclxuXHRkZWJ1Z2dlcjsvLz8/XHJcblx0Y29uc3QgdXJsID0gYGh0dHBzOi8vbWFwbGVzdG9yeS5pby9hcGkvJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbn0vJHtSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb259L2l0ZW0vY2F0ZWdvcnkvZXF1aXBgO1xyXG5cdGxvYWRfZXh0ZXJuYWxfcmVzb3VyY2UodXJsKS50aGVuKCgpID0+IHtcclxuXHRcdF9jb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2UoY2F0ZWdvcnksIG9yaWdpbl9kYXRhKTtcclxuXHRcdGNvbmNhdF9leHRlcm5hbF9yZXNvdXJjZSA9IF9jb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2U7XHJcblx0XHRjb25zb2xlLmxvZyhcImRvbmU6IHVwZGF0ZV9leHRlcm5hbF9lcXVpcF9saXN0XCIpO1xyXG5cdH0pO1xyXG59XHJcblxyXG5sZXQgZXh0ZXJuYWxfcmVzb3VyY2VfcHJvbWlzZSA9IGxvYWRfZXh0ZXJuYWxfcmVzb3VyY2UoKTtcclxuXHJcbndpbmRvdy5jb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2UgPSBfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlX3A7XHJcblxyXG53aW5kb3cudHJpZ2dlcl91cGRhdGVfZXh0ZXJuYWxfZXF1aXBfbGlzdCA9IGZ1bmN0aW9uICgpIHtcclxuXHRleHRlcm5hbF9yZXNvdXJjZV9wcm9taXNlID0gbG9hZF9leHRlcm5hbF9yZXNvdXJjZSgpO1xyXG5cdHdpbmRvdy5jb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2UgPSBfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlX3A7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIF9jb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2VfcChjYXRlZ29yeSwgb3JpZ2luX2RhdGEpIHtcclxuXHRhd2FpdCBleHRlcm5hbF9yZXNvdXJjZV9wcm9taXNlO1xyXG5cdF9jb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2UoY2F0ZWdvcnksIG9yaWdpbl9kYXRhKTtcclxuXHRjb25jYXRfZXh0ZXJuYWxfcmVzb3VyY2UgPSBfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBfY29uY2F0X2V4dGVybmFsX3Jlc291cmNlKGNhdGVnb3J5LCBvcmlnaW5fZGF0YSkge1xyXG5cdHRyeSB7XHJcblx0XHRjb25zdCBsaXN0ID0gUmVzb3VyY2VNYW5hZ2VyLmV4dGVybmFsLmVxdWlwW2NhdGVnb3J5XTtcclxuXHRcdGlmICghbGlzdCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHQvKiogQHR5cGUge01hcDxzdHJpbmcse30+fSAqL1xyXG5cdFx0bGV0IGlkX21hcCA9IFJlc291cmNlTWFuYWdlci5lcXVpcF9tYXBbY2F0ZWdvcnldO1xyXG5cclxuXHRcdGlmICghaWRfbWFwKSB7XHJcblx0XHRcdGlkX21hcCA9IG5ldyBNYXAoKTtcclxuXHRcdFx0XHJcblx0XHRcdG9yaWdpbl9kYXRhLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0aWRfbWFwLnNldChpdGVtLmlkLCBpdGVtKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRSZXNvdXJjZU1hbmFnZXIuZXF1aXBfbWFwW2NhdGVnb3J5XSA9IGlkX21hcDtcclxuXHRcdH1cclxuXHJcblx0XHRsaXN0LmZvckVhY2goKGl0ZW0pID0+IHtcclxuXHRcdFx0LyoqIEB0eXBlIHtzdHJpbmd9ICovXHJcblx0XHRcdGxldCBpZCA9IGl0ZW0uaWQ7XHJcblx0XHRcdGlmICghaWRfbWFwLmhhcyhpZCkpIHtcclxuXHRcdFx0XHRpdGVtLiRmb3JlaWduID0gdHJ1ZTtcclxuXHRcdFx0XHRvcmlnaW5fZGF0YS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdGlkX21hcC5zZXQoaWQsIGl0ZW0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGxldCBvcmlfaXRlbSA9IGlkX21hcC5nZXQoaWQpO1xyXG5cdFx0XHRcdG9yaV9pdGVtLl9uYW1lID0gaXRlbS5uYW1lIHx8IFwiXCI7XHJcblx0XHRcdFx0b3JpX2l0ZW0uX2Rlc2MgPSBpdGVtLmRlc2MgfHwgXCJcIjtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cdGNhdGNoIChleCkge1xyXG5cdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRkZWJ1Z2dlcjtcclxuXHR9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaWRcclxuICogQHBhcmFtIHtzdHJpbmd9IGNhdGVnb3J5TmFtZVxyXG4gKi9cclxud2luZG93LmxvYWRfZXh0ZXJuX2l0ZW1fZGF0YSA9IGFzeW5jIGZ1bmN0aW9uIChpZCwgY2F0ZWdvcnlOYW1lKSB7XHJcblx0bGV0IGRhdGFSZWdpb24sIGRhdGFWZXJzaW9uO1xyXG5cdC8vbGV0IGl0ZW1JbmZvID0gUmVzb3VyY2VNYW5hZ2VyLmVxdWlwX21hcFtjYXRlZ29yeU5hbWVdLmdldChpZCk7XHJcblx0bGV0IGl0ZW1JbmZvID0gUmVzb3VyY2VNYW5hZ2VyLmV4dGVybmFsLmVxdWlwW2NhdGVnb3J5TmFtZV0uZmluZChpdGVtSW5mbyA9PiBpdGVtSW5mby5pZCA9PSBpZCk7XHJcblx0aWYgKGl0ZW1JbmZvKSB7XHJcblx0XHRsZXQgX192ID0gaXRlbUluZm8uX192LnRvVXBwZXJDYXNlKCkubWF0Y2goLyhbQS1aXSopKFswLTldKikvKTtcclxuXHRcdGlmIChfX3YpIHtcclxuXHRcdFx0ZGF0YVJlZ2lvbiA9IF9fdlsxXSB8fCBSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbjtcclxuXHRcdFx0ZGF0YVZlcnNpb24gPSBfX3ZbMl0gfHwgUmVzb3VyY2VNYW5hZ2VyLmRhdGFWZXJzaW9uO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGRhdGFSZWdpb24gPSBSZXNvdXJjZU1hbmFnZXIuZGF0YVJlZ2lvbjtcclxuXHRcdFx0ZGF0YVZlcnNpb24gPSBSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb247XHJcblx0XHR9XHJcblx0fVxyXG5cdGVsc2Uge1xyXG5cdFx0ZGF0YVJlZ2lvbiA9IFJlc291cmNlTWFuYWdlci5kYXRhUmVnaW9uO1xyXG5cdFx0ZGF0YVZlcnNpb24gPSBSZXNvdXJjZU1hbmFnZXIuZGF0YVZlcnNpb247XHJcblx0fVxyXG5cclxuXHRsZXQgX3JhdyA9IEpTT04ucGFyc2UoYXdhaXQgJGdldChgaHR0cHM6Ly9tYXBsZXN0b3J5LmlvL2FwaS8ke2RhdGFSZWdpb259LyR7ZGF0YVZlcnNpb259L2l0ZW0vJHtpZH1gKSk7XHJcblx0bGV0IHJhdyA9IHt9O1xyXG5cclxuXHRpZiAoX3JhdyA9PSBudWxsKSB7XHJcblx0XHRjb25zb2xlLmVycm9yKFwiTm90IGZvdW5kOlwiLCBpZCk7XHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcblxyXG5cdGxldCBkZWZhdWx0XyA9IF9yYXcuZnJhbWVCb29rcy5kZWZhdWx0ID8gX3Jhdy5mcmFtZUJvb2tzLmRlZmF1bHQuZnJhbWVzWzBdOm51bGw7XHJcblxyXG5cdGZvciAobGV0IGkgaW4gX3Jhdy5mcmFtZUJvb2tzKSB7XHJcblx0XHRsZXQgX2FjdCA9IF9yYXcuZnJhbWVCb29rc1tpXTtcclxuXHRcdGxldCBhY3QgPSBbXTtcclxuXHJcblx0XHRmb3IgKGxldCBqID0gMDsgaiA8IF9hY3QuZnJhbWVzLmxlbmd0aDsgKytqKSB7XHJcblx0XHRcdGxldCBmcmFtZSA9IF9hY3QuZnJhbWVzW2pdIHx8IGRlZmF1bHRfO1xyXG5cdFx0XHRpZiAoIWZyYW1lIHx8ICFmcmFtZS5lZmZlY3RzKSB7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0bGV0IF9mcmFncyA9IGZyYW1lLmVmZmVjdHM7XHJcblx0XHRcdGxldCBmcmFncyA9IHt9O1xyXG5cdFx0XHRmb3IgKGxldCBrIGluIF9mcmFncykge1xyXG5cdFx0XHRcdGxldCBfZnJhZyA9IF9mcmFnc1trXTtcclxuXHRcdFx0XHRpZiAoX2ZyYWcuaW1hZ2UpIHtcclxuXHRcdFx0XHRcdGZyYWdzW2tdID0ge1xyXG5cdFx0XHRcdFx0XHRcIlwiOiBcImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxcIiArIF9mcmFnLmltYWdlLFxyXG5cdFx0XHRcdFx0XHRcIm9yaWdpblwiOiBfZnJhZy5vcmlnaW5Pclplcm8gfHwgX2ZyYWcub3JpZ2luIHx8IF9mcmFnLmNlbnRlcixcclxuXHRcdFx0XHRcdFx0XCJtYXBcIjogX2ZyYWcubWFwT2Zmc2V0LFxyXG5cdFx0XHRcdFx0XHRcInpcIjogX2ZyYWcucG9zaXRpb25cclxuXHRcdFx0XHRcdH07XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRhY3Rbal0gPSBmcmFncztcclxuXHRcdH1cclxuXHJcblx0XHRyYXdbaV0gPSBhY3Q7XHJcblx0fVxyXG5cclxuXHRyYXcuaW5mbyA9IHtcclxuXHRcdGlzbG90OiBfcmF3Lm1ldGFJbmZvLmlzbG90LFxyXG5cdFx0dnNsb3Q6IF9yYXcubWV0YUluZm8udnNsb3QsXHJcblx0XHRpY29uOiB7XHJcblx0XHRcdFwiXCI6IGBodHRwczovL21hcGxlc3RvcnkuaW8vYXBpLyR7ZGF0YVJlZ2lvbn0vJHtkYXRhVmVyc2lvbn0vaXRlbS8ke19yYXcuaWR9L2ljb25gLFxyXG5cdFx0fSxcclxuXHRcdGNhc2g6IF9yYXcubWV0YUluZm8uY2FzaCA/IDEgOiAwLFxyXG5cdFx0X192OiBgJHtkYXRhUmVnaW9ufSR7ZGF0YVZlcnNpb259YCxcclxuXHR9O1xyXG5cclxuXHRyZXR1cm4gcmF3O1xyXG59XHJcblxyXG5mdW5jdGlvbiBfb2JqZWN0QXNzaWduRGVlcCh0YXJnZXQsIG9iamVjdCkge1xyXG5cdGlmICh0YXJnZXQgIT0gbnVsbCAmJiBvYmplY3QgIT0gbnVsbCkge1xyXG5cdFx0aWYgKE9iamVjdC5wcm90b3R5cGUudmFsdWVPZi5jYWxsKG9iamVjdCkgaW5zdGFuY2VvZiBTdHJpbmcpIHtcclxuXHRcdFx0dGFyZ2V0ID0gb2JqZWN0O1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSBpZiAoT2JqZWN0LnByb3RvdHlwZS52YWx1ZU9mLmNhbGwob2JqZWN0KSBpbnN0YW5jZW9mIE51bWJlcikge1xyXG5cdFx0XHR0YXJnZXQgPSBvYmplY3Q7XHJcblx0XHR9XHJcblx0XHRlbHNlIGlmIChPYmplY3QucHJvdG90eXBlLnZhbHVlT2YuY2FsbChvYmplY3QpIGluc3RhbmNlb2YgQm9vbGVhbikge1xyXG5cdFx0XHR0YXJnZXQgPSBvYmplY3Q7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Zm9yIChsZXQga2V5IGluIG9iamVjdCkge1xyXG5cdFx0XHRcdGxldCB2YWx1ZSA9IG9iamVjdFtrZXldO1xyXG5cdFx0XHRcdGlmICh2YWx1ZSAhPSBudWxsKSB7XHJcblx0XHRcdFx0XHR0YXJnZXRba2V5XSA9IF9vYmplY3RBc3NpZ25EZWVwKHRhcmdldFtrZXldLCB2YWx1ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiB0YXJnZXQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9iamVjdEFzc2lnbkRlZXAodGFyZ2V0LCAuLi5vYmplY3RzKSB7XHJcblx0Zm9yIChsZXQgb2JqZWN0IG9mIG9iamVjdHMpIHtcclxuXHRcdF9vYmplY3RBc3NpZ25EZWVwKHRhcmdldCwgb2JqZWN0KTtcclxuXHR9XHJcblx0cmV0dXJuIHRhcmdldDtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///353\n')},368:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return AddInitTask; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "b", function() { return InitAll; });\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(358);\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(414);\n/* harmony import */ var jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_core_css__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(415);\n/* harmony import */ var jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_theme_css__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var jquery_ui_themes_base_selectable_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(416);\n/* harmony import */ var jquery_ui_themes_base_selectable_css__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_selectable_css__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var jquery_ui_themes_base_sortable_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(417);\n/* harmony import */ var jquery_ui_themes_base_sortable_css__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_sortable_css__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var jquery_ui_themes_base_draggable_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(418);\n/* harmony import */ var jquery_ui_themes_base_draggable_css__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_themes_base_draggable_css__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var jquery_ui_ui_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(419);\n/* harmony import */ var jquery_ui_ui_core__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_core__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var jquery_ui_ui_widgets_selectable__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(420);\n/* harmony import */ var jquery_ui_ui_widgets_selectable__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_selectable__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var jquery_ui_ui_widgets_sortable__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(421);\n/* harmony import */ var jquery_ui_ui_widgets_sortable__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_sortable__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var jquery_ui_ui_widgets_draggable__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(422);\n/* harmony import */ var jquery_ui_ui_widgets_draggable__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_widgets_draggable__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var jquery_ui_ui_disable_selection__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(423);\n/* harmony import */ var jquery_ui_ui_disable_selection__WEBPACK_IMPORTED_MODULE_10___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_disable_selection__WEBPACK_IMPORTED_MODULE_10__);\n/* harmony import */ var jquery_ui_ui_position__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(424);\n/* harmony import */ var jquery_ui_ui_position__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_position__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var jquery_ui_ui_effect__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(425);\n/* harmony import */ var jquery_ui_ui_effect__WEBPACK_IMPORTED_MODULE_12___default = /*#__PURE__*/__webpack_require__.n(jquery_ui_ui_effect__WEBPACK_IMPORTED_MODULE_12__);\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(383);\n/* harmony import */ var _util_js__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(_util_js__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(337);\n/* harmony import */ var vue__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(vue__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var vuex__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(363);\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvue__WEBPACK_IMPORTED_MODULE_14___default.a.config.productionTip = false;\r\nvue__WEBPACK_IMPORTED_MODULE_14___default.a.use(vuex__WEBPACK_IMPORTED_MODULE_15__[/* default */ "a"]);\r\n\r\nwindow.jQuery = jquery__WEBPACK_IMPORTED_MODULE_0___default.a;\r\nwindow.$ = jquery__WEBPACK_IMPORTED_MODULE_0___default.a;\r\n\r\nif (!window.onwheel) {\r\n\twindow.onwheel = function () {\r\n\t}\r\n}\r\n\r\nlet init_tasks = [];\r\n\r\nfunction AddInitTask(task) {\r\n\tinit_tasks.push(task);\r\n}\r\n\r\nfunction InitAll() {\r\n\tlet promise_list = init_tasks.map(f => f());\r\n\tinit_tasks = [];\r\n\tlet a = Promise.all(promise_list);\r\n\treturn a;\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzY4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2luaXQuanM/ZDk5ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IGpRdWVyeSBmcm9tIFwianF1ZXJ5XCI7XHJcblxyXG5pbXBvcnQgXCJqcXVlcnktdWkvdGhlbWVzL2Jhc2UvY29yZS5jc3NcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3RoZW1lcy9iYXNlL3RoZW1lLmNzc1wiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdGhlbWVzL2Jhc2Uvc2VsZWN0YWJsZS5jc3NcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3RoZW1lcy9iYXNlL3NvcnRhYmxlLmNzc1wiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdGhlbWVzL2Jhc2UvZHJhZ2dhYmxlLmNzc1wiO1xyXG5cclxuaW1wb3J0IFwianF1ZXJ5LXVpL3VpL2NvcmVcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3VpL3dpZGdldHMvc2VsZWN0YWJsZVwiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdWkvd2lkZ2V0cy9zb3J0YWJsZVwiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdWkvd2lkZ2V0cy9kcmFnZ2FibGVcIjtcclxuaW1wb3J0IFwianF1ZXJ5LXVpL3VpL2Rpc2FibGUtc2VsZWN0aW9uXCI7XHJcbmltcG9ydCBcImpxdWVyeS11aS91aS9wb3NpdGlvblwiO1xyXG5pbXBvcnQgXCJqcXVlcnktdWkvdWkvZWZmZWN0XCI7XHJcblxyXG5pbXBvcnQgeyB9IGZyb20gXCIuL3V0aWwuanNcIjtcclxuXHJcbmltcG9ydCBWdWUgZnJvbSBcInZ1ZVwiO1xyXG5pbXBvcnQgVnVleCBmcm9tIFwidnVleFwiO1xyXG5cclxuVnVlLmNvbmZpZy5wcm9kdWN0aW9uVGlwID0gZmFsc2U7XHJcblZ1ZS51c2UoVnVleCk7XHJcblxyXG53aW5kb3cualF1ZXJ5ID0galF1ZXJ5O1xyXG53aW5kb3cuJCA9IGpRdWVyeTtcclxuXHJcbmlmICghd2luZG93Lm9ud2hlZWwpIHtcclxuXHR3aW5kb3cub253aGVlbCA9IGZ1bmN0aW9uICgpIHtcclxuXHR9XHJcbn1cclxuXHJcbmxldCBpbml0X3Rhc2tzID0gW107XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gQWRkSW5pdFRhc2sodGFzaykge1xyXG5cdGluaXRfdGFza3MucHVzaCh0YXNrKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIEluaXRBbGwoKSB7XHJcblx0bGV0IHByb21pc2VfbGlzdCA9IGluaXRfdGFza3MubWFwKGYgPT4gZigpKTtcclxuXHRpbml0X3Rhc2tzID0gW107XHJcblx0bGV0IGEgPSBQcm9taXNlLmFsbChwcm9taXNlX2xpc3QpO1xyXG5cdHJldHVybiBhO1xyXG59XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///368\n')},371:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* unused harmony export ActionAnimationFrameData */\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return ActionAnimation; });\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(332);\n\ufeff\r\n\r\n\r\n\r\nclass ActionAnimationFrameData {\r\n\tconstructor() {\r\n\t\t/** @type {number} */\r\n\t\tthis.delay = 0;\r\n\r\n\t\t/** @type {Vec2} */\r\n\t\tthis.move = null;\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.action = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.frame = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * from loaded raw data\r\n\t * @param {ActionAnimationFrameData} raw\r\n\t * @param {string} action\r\n\t * @param {number} frame\r\n\t */\r\n\t_load(raw, action, frame) {\r\n\t\tthis._raw = raw;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.delay = raw.delay;\r\n\r\n\t\t/** @type {Vec2} */\r\n\t\tif (raw.move) {\r\n\t\t\tthis.move = new _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"](raw.move.x, raw.move.y);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.move = new _math_js__WEBPACK_IMPORTED_MODULE_0__["Vec2"](0, 0);\r\n\t\t}\r\n\r\n\t\t/** @type {string} */\r\n\t\tthis.action = raw.action || action;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.frame = raw.frame || frame;\r\n\t}\r\n}\r\n\r\nclass ActionAnimation {\r\n\tconstructor(raw) {\r\n\t\t/** @returns {ActionAnimationFrameData[]} */\r\n\t\tthis.frames = null;\r\n\r\n\t\t/**\r\n\t\t * input action\r\n\t\t * @type {string}\r\n\t\t */\r\n\t\tthis._action = null;\r\n\r\n\t\t/**\r\n\t\t * input action\r\n\t\t * @type {number}\r\n\t\t */\r\n\t\tthis.frame = 0;\r\n\r\n\t\t/** @type {number} */\r\n\t\tthis.time = 0;\r\n\r\n\t\t/** @type {number} this.delay = delay < 0 ? -delay:0; if (this.delay == 0) launch attack */\r\n\t\tthis.delay = 0;//not frame delay\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis.loop = false;\r\n\r\n\t\t/** @type {boolean} */\r\n\t\tthis._is_end = false;\r\n\r\n\t\t/** @type {(oldInputAction:string,oldOutputAction:string) => void} */\r\n\t\tthis.onEnd = null;\r\n\t}\r\n\r\n\t/**\r\n\t * from loaded data\r\n\t * @param {string} action\r\n\t */\r\n\t_load(action) {\r\n\t\tthis._action = action;\r\n\t\tthis.frames = ActionAnimation.Adef[action];\r\n\t}\r\n\r\n\t/**\r\n\t * from loaded data\r\n\t * @param {string} action\r\n\t * @param {(oldInputAction:string,oldOutputAction:string) => void} onEnd\r\n\t */\r\n\treload(action, onEnd) {\r\n\t\tif (this.onEnd) {\r\n\t\t\tthis.onEnd(this._action, this.action);\r\n\t\t}\r\n\r\n\t\tthis.reset();\r\n\t\tthis._load(action);\r\n\t\tthis.onEnd = onEnd;\r\n\t}\r\n\r\n\treset() {\r\n\t\tthis.time = 0;\r\n\t\tthis.frame = 0;\r\n\t\tthis._is_end = false;\r\n\t}\r\n\r\n\t/**\r\n\t * update action delay, target.action, target.action_frame, target.tx, target.ty\r\n\t * @param {number} stamp\r\n\t * @param {CharacterRenderer} target\r\n\t */\r\n\tupdate(stamp, target) {\r\n\t\tif (!this.frames || !stamp) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst fdat = this.fdat;\r\n\t\tlet delay = 0;\r\n\r\n\t\tif (!fdat) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.time = this.time + stamp;\r\n\r\n\t\tif (fdat.delay < 0) {\r\n\t\t\tfdat.delay = -fdat.delay;\r\n\t\t}\r\n\r\n\t\tif (fdat.delay > 0) {\r\n\t\t\tdelay = fdat.delay;\r\n\t\t\tthis.delay = 0;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdelay = -fdat.delay;\r\n\t\t\tthis.delay = delay;\r\n\t\t}\r\n\r\n\t\tif (this.time > delay) {\r\n\t\t\tthis.frame = ++this.frame;\r\n\t\t\tthis.time = 0;\r\n\t\t}\r\n\r\n\t\t//translate target position\r\n\t\tif (fdat.move) {\r\n\t\t\ttarget.tx = -fdat.move.x * target.front;\r\n\t\t\ttarget.ty = fdat.move.y;//Y 軸相反\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttarget.tx = 0;\r\n\t\t\ttarget.ty = 0;\r\n\t\t}\r\n\t\tif (this.isEnd()) {\r\n\t\t\ttarget.tx = 0;\r\n\t\t\ttarget.ty = 0;\r\n\t\t}\r\n\t\t\r\n\t\t// 改變 action & action_frame 會造成迴圈: this.reload(this._action)\r\n\t\tif (!target._ride_action) {\r\n\t\t\ttarget._action = fdat.action;\r\n\t\t\ttarget._action_frame = fdat.frame;\r\n\t\t}\r\n\r\n\t\tif (!this.frames || this.fdat == null) {\r\n\t\t\tthis._is_end = true;\r\n\t\t}\r\n\t\telse if (!this.loop) {\r\n\t\t\tthis._is_end = false;\r\n\t\t}\r\n\t\tif (this.frames.length <= 1) {\r\n\t\t\tthis._is_end = true;\r\n\t\t}\r\n\t}\r\n\r\n\tisEnd() {\r\n\t\treturn this._is_end;\r\n\t}\r\n\r\n\tgetTotalTime() {\r\n\t\treturn this.frames.reduce((total, frame) => total + frame.delay, 0);\r\n\t}\r\n\r\n\t/**\r\n\t * frame data\r\n\t * @returns {ActionAnimationFrameData}\r\n\t */\r\n\tget fdat() {\r\n\t\tconst fdat = this.frames[this.frame];\r\n\t\treturn fdat;\r\n\t}\r\n\t/**\r\n\t * output action\r\n\t * @returns {string}\r\n\t */\r\n\tget action() {\r\n\t\tconst fdat = this.frames[this.frame];\r\n\t\treturn fdat ? fdat.action : this.frames[0].action;//need default\r\n\t}\r\n\t/**\r\n\t * output action frame\r\n\t * @returns {number}\r\n\t */\r\n\tget actionFrame() {\r\n\t\tconst fdat = this.frames[this.frame];\r\n\t\treturn fdat ? fdat.frame : 0;\r\n\t}\r\n\r\n\tstatic async Init() {\r\n\t\t/** @type {{[action:string]:ActionAnimationFrameData[]}} */\r\n\t\tlet raw = await $get.data(ActionAnimation._base_path);\r\n\r\n\t\tlet aadef = Object.assign({}, raw);\r\n\t\t\r\n\t\tdelete aadef[\'info\'];\r\n\r\n\t\tfor (let actName in aadef) {\r\n\t\t\tlet aa = aadef[actName];\r\n\t\t\taadef[actName] = Object.values(aa).map((_fdef, frame) => {\r\n\t\t\t\tlet fdef = new ActionAnimationFrameData();\r\n\t\t\t\tfdef._load(_fdef, actName, frame);\r\n\t\t\t\treturn fdef;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t//action definition\r\n\t\tActionAnimation.Adef = aadef;\r\n\r\n\t\twindow.CharacterActionAnimationDefinition = aadef;\r\n\t}\r\n\r\n\tstatic get _base_path() {\r\n\t\treturn "/Character/00002000";\r\n\t}\r\n}\r\n/**\r\n * action definition\r\n * @type {{[action:string]:ActionAnimationFrameData[]}}\r\n */\r\nActionAnimation.Adef = null;\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzcxLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvUmVuZGVyZXIvQ2hhcmFjdGVyQWN0aW9uQW5pbWF0aW9uLmpzP2I2NjUiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCB7IFZlYzIgfSBmcm9tIFwiLi4vbWF0aC5qc1wiO1xyXG5cclxuXHJcbmV4cG9ydCBjbGFzcyBBY3Rpb25BbmltYXRpb25GcmFtZURhdGEge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLmRlbGF5ID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge1ZlYzJ9ICovXHJcblx0XHR0aGlzLm1vdmUgPSBudWxsO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy5hY3Rpb24gPSAwO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xyXG5cdFx0dGhpcy5mcmFtZSA9IDA7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBmcm9tIGxvYWRlZCByYXcgZGF0YVxyXG5cdCAqIEBwYXJhbSB7QWN0aW9uQW5pbWF0aW9uRnJhbWVEYXRhfSByYXdcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGZyYW1lXHJcblx0ICovXHJcblx0X2xvYWQocmF3LCBhY3Rpb24sIGZyYW1lKSB7XHJcblx0XHR0aGlzLl9yYXcgPSByYXc7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLmRlbGF5ID0gcmF3LmRlbGF5O1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7VmVjMn0gKi9cclxuXHRcdGlmIChyYXcubW92ZSkge1xyXG5cdFx0XHR0aGlzLm1vdmUgPSBuZXcgVmVjMihyYXcubW92ZS54LCByYXcubW92ZS55KTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHR0aGlzLm1vdmUgPSBuZXcgVmVjMigwLCAwKTtcclxuXHRcdH1cclxuXHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMuYWN0aW9uID0gcmF3LmFjdGlvbiB8fCBhY3Rpb247XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLmZyYW1lID0gcmF3LmZyYW1lIHx8IGZyYW1lO1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEFjdGlvbkFuaW1hdGlvbiB7XHJcblx0Y29uc3RydWN0b3IocmF3KSB7XHJcblx0XHQvKiogQHJldHVybnMge0FjdGlvbkFuaW1hdGlvbkZyYW1lRGF0YVtdfSAqL1xyXG5cdFx0dGhpcy5mcmFtZXMgPSBudWxsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogaW5wdXQgYWN0aW9uXHJcblx0XHQgKiBAdHlwZSB7c3RyaW5nfVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLl9hY3Rpb24gPSBudWxsO1xyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogaW5wdXQgYWN0aW9uXHJcblx0XHQgKiBAdHlwZSB7bnVtYmVyfVxyXG5cdFx0ICovXHJcblx0XHR0aGlzLmZyYW1lID0gMDtcclxuXHJcblx0XHQvKiogQHR5cGUge251bWJlcn0gKi9cclxuXHRcdHRoaXMudGltZSA9IDA7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IHRoaXMuZGVsYXkgPSBkZWxheSA8IDAgPyAtZGVsYXk6MDsgaWYgKHRoaXMuZGVsYXkgPT0gMCkgbGF1bmNoIGF0dGFjayAqL1xyXG5cdFx0dGhpcy5kZWxheSA9IDA7Ly9ub3QgZnJhbWUgZGVsYXlcclxuXHJcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXHJcblx0XHR0aGlzLmxvb3AgPSBmYWxzZTtcclxuXHJcblx0XHQvKiogQHR5cGUge2Jvb2xlYW59ICovXHJcblx0XHR0aGlzLl9pc19lbmQgPSBmYWxzZTtcclxuXHJcblx0XHQvKiogQHR5cGUgeyhvbGRJbnB1dEFjdGlvbjpzdHJpbmcsb2xkT3V0cHV0QWN0aW9uOnN0cmluZykgPT4gdm9pZH0gKi9cclxuXHRcdHRoaXMub25FbmQgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogZnJvbSBsb2FkZWQgZGF0YVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb25cclxuXHQgKi9cclxuXHRfbG9hZChhY3Rpb24pIHtcclxuXHRcdHRoaXMuX2FjdGlvbiA9IGFjdGlvbjtcclxuXHRcdHRoaXMuZnJhbWVzID0gQWN0aW9uQW5pbWF0aW9uLkFkZWZbYWN0aW9uXTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIGZyb20gbG9hZGVkIGRhdGFcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uXHJcblx0ICogQHBhcmFtIHsob2xkSW5wdXRBY3Rpb246c3RyaW5nLG9sZE91dHB1dEFjdGlvbjpzdHJpbmcpID0+IHZvaWR9IG9uRW5kXHJcblx0ICovXHJcblx0cmVsb2FkKGFjdGlvbiwgb25FbmQpIHtcclxuXHRcdGlmICh0aGlzLm9uRW5kKSB7XHJcblx0XHRcdHRoaXMub25FbmQodGhpcy5fYWN0aW9uLCB0aGlzLmFjdGlvbik7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5yZXNldCgpO1xyXG5cdFx0dGhpcy5fbG9hZChhY3Rpb24pO1xyXG5cdFx0dGhpcy5vbkVuZCA9IG9uRW5kO1xyXG5cdH1cclxuXHJcblx0cmVzZXQoKSB7XHJcblx0XHR0aGlzLnRpbWUgPSAwO1xyXG5cdFx0dGhpcy5mcmFtZSA9IDA7XHJcblx0XHR0aGlzLl9pc19lbmQgPSBmYWxzZTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIHVwZGF0ZSBhY3Rpb24gZGVsYXksIHRhcmdldC5hY3Rpb24sIHRhcmdldC5hY3Rpb25fZnJhbWUsIHRhcmdldC50eCwgdGFyZ2V0LnR5XHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YW1wXHJcblx0ICogQHBhcmFtIHtDaGFyYWN0ZXJSZW5kZXJlcn0gdGFyZ2V0XHJcblx0ICovXHJcblx0dXBkYXRlKHN0YW1wLCB0YXJnZXQpIHtcclxuXHRcdGlmICghdGhpcy5mcmFtZXMgfHwgIXN0YW1wKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGNvbnN0IGZkYXQgPSB0aGlzLmZkYXQ7XHJcblx0XHRsZXQgZGVsYXkgPSAwO1xyXG5cclxuXHRcdGlmICghZmRhdCkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy50aW1lID0gdGhpcy50aW1lICsgc3RhbXA7XHJcblxyXG5cdFx0aWYgKGZkYXQuZGVsYXkgPCAwKSB7XHJcblx0XHRcdGZkYXQuZGVsYXkgPSAtZmRhdC5kZWxheTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoZmRhdC5kZWxheSA+IDApIHtcclxuXHRcdFx0ZGVsYXkgPSBmZGF0LmRlbGF5O1xyXG5cdFx0XHR0aGlzLmRlbGF5ID0gMDtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWxheSA9IC1mZGF0LmRlbGF5O1xyXG5cdFx0XHR0aGlzLmRlbGF5ID0gZGVsYXk7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKHRoaXMudGltZSA+IGRlbGF5KSB7XHJcblx0XHRcdHRoaXMuZnJhbWUgPSArK3RoaXMuZnJhbWU7XHJcblx0XHRcdHRoaXMudGltZSA9IDA7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly90cmFuc2xhdGUgdGFyZ2V0IHBvc2l0aW9uXHJcblx0XHRpZiAoZmRhdC5tb3ZlKSB7XHJcblx0XHRcdHRhcmdldC50eCA9IC1mZGF0Lm1vdmUueCAqIHRhcmdldC5mcm9udDtcclxuXHRcdFx0dGFyZ2V0LnR5ID0gZmRhdC5tb3ZlLnk7Ly9ZIOi7uOebuOWPjVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRhcmdldC50eCA9IDA7XHJcblx0XHRcdHRhcmdldC50eSA9IDA7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5pc0VuZCgpKSB7XHJcblx0XHRcdHRhcmdldC50eCA9IDA7XHJcblx0XHRcdHRhcmdldC50eSA9IDA7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdC8vIOaUueiuiiBhY3Rpb24gJiBhY3Rpb25fZnJhbWUg5pyD6YCg5oiQ6L+05ZyIOiB0aGlzLnJlbG9hZCh0aGlzLl9hY3Rpb24pXHJcblx0XHRpZiAoIXRhcmdldC5fcmlkZV9hY3Rpb24pIHtcclxuXHRcdFx0dGFyZ2V0Ll9hY3Rpb24gPSBmZGF0LmFjdGlvbjtcclxuXHRcdFx0dGFyZ2V0Ll9hY3Rpb25fZnJhbWUgPSBmZGF0LmZyYW1lO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghdGhpcy5mcmFtZXMgfHwgdGhpcy5mZGF0ID09IG51bGwpIHtcclxuXHRcdFx0dGhpcy5faXNfZW5kID0gdHJ1ZTtcclxuXHRcdH1cclxuXHRcdGVsc2UgaWYgKCF0aGlzLmxvb3ApIHtcclxuXHRcdFx0dGhpcy5faXNfZW5kID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5mcmFtZXMubGVuZ3RoIDw9IDEpIHtcclxuXHRcdFx0dGhpcy5faXNfZW5kID0gdHJ1ZTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGlzRW5kKCkge1xyXG5cdFx0cmV0dXJuIHRoaXMuX2lzX2VuZDtcclxuXHR9XHJcblxyXG5cdGdldFRvdGFsVGltZSgpIHtcclxuXHRcdHJldHVybiB0aGlzLmZyYW1lcy5yZWR1Y2UoKHRvdGFsLCBmcmFtZSkgPT4gdG90YWwgKyBmcmFtZS5kZWxheSwgMCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBmcmFtZSBkYXRhXHJcblx0ICogQHJldHVybnMge0FjdGlvbkFuaW1hdGlvbkZyYW1lRGF0YX1cclxuXHQgKi9cclxuXHRnZXQgZmRhdCgpIHtcclxuXHRcdGNvbnN0IGZkYXQgPSB0aGlzLmZyYW1lc1t0aGlzLmZyYW1lXTtcclxuXHRcdHJldHVybiBmZGF0O1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBvdXRwdXQgYWN0aW9uXHJcblx0ICogQHJldHVybnMge3N0cmluZ31cclxuXHQgKi9cclxuXHRnZXQgYWN0aW9uKCkge1xyXG5cdFx0Y29uc3QgZmRhdCA9IHRoaXMuZnJhbWVzW3RoaXMuZnJhbWVdO1xyXG5cdFx0cmV0dXJuIGZkYXQgPyBmZGF0LmFjdGlvbiA6IHRoaXMuZnJhbWVzWzBdLmFjdGlvbjsvL25lZWQgZGVmYXVsdFxyXG5cdH1cclxuXHQvKipcclxuXHQgKiBvdXRwdXQgYWN0aW9uIGZyYW1lXHJcblx0ICogQHJldHVybnMge251bWJlcn1cclxuXHQgKi9cclxuXHRnZXQgYWN0aW9uRnJhbWUoKSB7XHJcblx0XHRjb25zdCBmZGF0ID0gdGhpcy5mcmFtZXNbdGhpcy5mcmFtZV07XHJcblx0XHRyZXR1cm4gZmRhdCA/IGZkYXQuZnJhbWUgOiAwO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGFzeW5jIEluaXQoKSB7XHJcblx0XHQvKiogQHR5cGUge3tbYWN0aW9uOnN0cmluZ106QWN0aW9uQW5pbWF0aW9uRnJhbWVEYXRhW119fSAqL1xyXG5cdFx0bGV0IHJhdyA9IGF3YWl0ICRnZXQuZGF0YShBY3Rpb25BbmltYXRpb24uX2Jhc2VfcGF0aCk7XHJcblxyXG5cdFx0bGV0IGFhZGVmID0gT2JqZWN0LmFzc2lnbih7fSwgcmF3KTtcclxuXHRcdFxyXG5cdFx0ZGVsZXRlIGFhZGVmWydpbmZvJ107XHJcblxyXG5cdFx0Zm9yIChsZXQgYWN0TmFtZSBpbiBhYWRlZikge1xyXG5cdFx0XHRsZXQgYWEgPSBhYWRlZlthY3ROYW1lXTtcclxuXHRcdFx0YWFkZWZbYWN0TmFtZV0gPSBPYmplY3QudmFsdWVzKGFhKS5tYXAoKF9mZGVmLCBmcmFtZSkgPT4ge1xyXG5cdFx0XHRcdGxldCBmZGVmID0gbmV3IEFjdGlvbkFuaW1hdGlvbkZyYW1lRGF0YSgpO1xyXG5cdFx0XHRcdGZkZWYuX2xvYWQoX2ZkZWYsIGFjdE5hbWUsIGZyYW1lKTtcclxuXHRcdFx0XHRyZXR1cm4gZmRlZjtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9hY3Rpb24gZGVmaW5pdGlvblxyXG5cdFx0QWN0aW9uQW5pbWF0aW9uLkFkZWYgPSBhYWRlZjtcclxuXHJcblx0XHR3aW5kb3cuQ2hhcmFjdGVyQWN0aW9uQW5pbWF0aW9uRGVmaW5pdGlvbiA9IGFhZGVmO1xyXG5cdH1cclxuXHJcblx0c3RhdGljIGdldCBfYmFzZV9wYXRoKCkge1xyXG5cdFx0cmV0dXJuIFwiL0NoYXJhY3Rlci8wMDAwMjAwMFwiO1xyXG5cdH1cclxufVxyXG4vKipcclxuICogYWN0aW9uIGRlZmluaXRpb25cclxuICogQHR5cGUge3tbYWN0aW9uOnN0cmluZ106QWN0aW9uQW5pbWF0aW9uRnJhbWVEYXRhW119fVxyXG4gKi9cclxuQWN0aW9uQW5pbWF0aW9uLkFkZWYgPSBudWxsO1xyXG5cclxuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///371\n')},383:function(module,exports){eval('\r\nwindow.GetSearchParams = function GetSearchParams() {\r\n\tconst url = new URL(window.location, window.location.origin);\r\n\tlet params = {};\r\n\r\n\tfor ([key, value] of url.searchParams.entries()) {\r\n\t\tparams[key] = value;\r\n\t}\r\n\r\n\treturn params;\r\n}\r\n\r\nwindow.DownloadData = (function () {\r\n\tlet a = document.createElement("a");\r\n\tdocument.body.appendChild(a);\r\n\ta.style = "display: none";\r\n\ta.target = "_blank";\r\n\treturn function DownloadData(text, type, fileName) {\r\n\t\tlet blob = new Blob([text], { type: type || "octet/stream" });\r\n\t\tlet url = window.URL.createObjectURL(blob);\r\n\t\tif (fileName && fileName != "") {\r\n\t\t\ta.href = url;\r\n\t\t\ta.download = fileName;\r\n\t\t\ta.click();\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//a.href = url;\r\n\t\t\t//a.click();\r\n\t\t\twindow.open(url, \'_blank\');\r\n\t\t}\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t};\r\n}());\r\n\r\nwindow.SelectText = function SelectText(elem) {\r\n\tvar range, selection;\r\n\r\n\tif (document.body.createTextRange) {\r\n\t\trange = document.body.createTextRange();\r\n\t\trange.moveToElementText(elem);\r\n\t\trange.select();\r\n\t}\r\n\telse if (window.getSelection) {\r\n\t\tselection = window.getSelection();\r\n\t\trange = document.createRange();\r\n\t\trange.selectNodeContents(elem);\r\n\t\tselection.removeAllRanges();\r\n\t\tselection.addRange(range);\r\n\t}\r\n}\r\nwindow.copyToClipboard = function copyToClipboard(text) {\r\n\tvar $temp = $("<input>");\r\n\t$("body").append($temp);\r\n\t$temp.val(text).select();\r\n\tdocument.execCommand("copy");\r\n\t$temp.remove();\r\n}\r\n\r\n/**\r\n * disable textNode "#text"\r\n * @param {string} xml - xml\r\n * @param {string[]=} arrayTags - optional\r\n * @returns {object}\r\n */\r\nfunction parseXml(xml, arrayTags) {\r\n\tvar dom = null;\r\n\tif (window.DOMParser) {\r\n\t\tdom = (new DOMParser()).parseFromString(xml, "text/xml");\r\n\t}\r\n\telse if (window.ActiveXObject) {\r\n\t\tdom = new ActiveXObject(\'Microsoft.XMLDOM\');\r\n\t\tdom.async = false;\r\n\t\tif (!dom.loadXML(xml)) {\r\n\t\t\tthrow dom.parseError.reason + " " + dom.parseError.srcText;\r\n\t\t}\r\n\t}\r\n\telse {\r\n\t\tthrow "cannot parse xml string!";\r\n\t}\r\n\r\n\tfunction isArray(o) {\r\n\t\treturn Object.prototype.toString.apply(o) === \'[object Array]\';\r\n\t}\r\n\r\n\tfunction parseNode(xmlNode, result) {\r\n\t\tif (xmlNode.nodeName == "#text" && xmlNode.nodeValue.trim() == "") {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar jsonNode = {};\r\n\t\tvar existing = result[xmlNode.nodeName];\r\n\t\tif (existing) {\r\n\t\t\tif (!isArray(existing)) {\r\n\t\t\t\tresult[xmlNode.nodeName] = [existing, jsonNode];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tresult[xmlNode.nodeName].push(jsonNode);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tif (arrayTags && arrayTags.indexOf(xmlNode.nodeName) != -1) {\r\n\t\t\t\tresult[xmlNode.nodeName] = [jsonNode];\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tresult[xmlNode.nodeName] = jsonNode;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (xmlNode.attributes) {\r\n\t\t\tvar length = xmlNode.attributes.length;\r\n\t\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\t\tvar attribute = xmlNode.attributes[i];\r\n\t\t\t\tjsonNode[attribute.nodeName] = attribute.nodeValue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar length = xmlNode.childNodes.length;\r\n\t\tfor (var i = 0; i < length; i++) {\r\n\t\t\tparseNode(xmlNode.childNodes[i], jsonNode);\r\n\t\t}\r\n\t}\r\n\r\n\tvar result = {};\r\n\tif (dom.childNodes.length) {\r\n\t\tparseNode(dom.childNodes[0], result);\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwuanM/ZTBlYiJdLCJzb3VyY2VzQ29udGVudCI6WyJcclxud2luZG93LkdldFNlYXJjaFBhcmFtcyA9IGZ1bmN0aW9uIEdldFNlYXJjaFBhcmFtcygpIHtcclxuXHRjb25zdCB1cmwgPSBuZXcgVVJMKHdpbmRvdy5sb2NhdGlvbiwgd2luZG93LmxvY2F0aW9uLm9yaWdpbik7XHJcblx0bGV0IHBhcmFtcyA9IHt9O1xyXG5cclxuXHRmb3IgKFtrZXksIHZhbHVlXSBvZiB1cmwuc2VhcmNoUGFyYW1zLmVudHJpZXMoKSkge1xyXG5cdFx0cGFyYW1zW2tleV0gPSB2YWx1ZTtcclxuXHR9XHJcblxyXG5cdHJldHVybiBwYXJhbXM7XHJcbn1cclxuXHJcbndpbmRvdy5Eb3dubG9hZERhdGEgPSAoZnVuY3Rpb24gKCkge1xyXG5cdGxldCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XHJcblx0ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTtcclxuXHRhLnN0eWxlID0gXCJkaXNwbGF5OiBub25lXCI7XHJcblx0YS50YXJnZXQgPSBcIl9ibGFua1wiO1xyXG5cdHJldHVybiBmdW5jdGlvbiBEb3dubG9hZERhdGEodGV4dCwgdHlwZSwgZmlsZU5hbWUpIHtcclxuXHRcdGxldCBibG9iID0gbmV3IEJsb2IoW3RleHRdLCB7IHR5cGU6IHR5cGUgfHwgXCJvY3RldC9zdHJlYW1cIiB9KTtcclxuXHRcdGxldCB1cmwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuXHRcdGlmIChmaWxlTmFtZSAmJiBmaWxlTmFtZSAhPSBcIlwiKSB7XHJcblx0XHRcdGEuaHJlZiA9IHVybDtcclxuXHRcdFx0YS5kb3dubG9hZCA9IGZpbGVOYW1lO1xyXG5cdFx0XHRhLmNsaWNrKCk7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Ly9hLmhyZWYgPSB1cmw7XHJcblx0XHRcdC8vYS5jbGljaygpO1xyXG5cdFx0XHR3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTtcclxuXHRcdH1cclxuXHRcdHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7XHJcblx0fTtcclxufSgpKTtcclxuXHJcbndpbmRvdy5TZWxlY3RUZXh0ID0gZnVuY3Rpb24gU2VsZWN0VGV4dChlbGVtKSB7XHJcblx0dmFyIHJhbmdlLCBzZWxlY3Rpb247XHJcblxyXG5cdGlmIChkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSkge1xyXG5cdFx0cmFuZ2UgPSBkb2N1bWVudC5ib2R5LmNyZWF0ZVRleHRSYW5nZSgpO1xyXG5cdFx0cmFuZ2UubW92ZVRvRWxlbWVudFRleHQoZWxlbSk7XHJcblx0XHRyYW5nZS5zZWxlY3QoKTtcclxuXHR9XHJcblx0ZWxzZSBpZiAod2luZG93LmdldFNlbGVjdGlvbikge1xyXG5cdFx0c2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xyXG5cdFx0cmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xyXG5cdFx0cmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzKGVsZW0pO1xyXG5cdFx0c2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xyXG5cdFx0c2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTtcclxuXHR9XHJcbn1cclxud2luZG93LmNvcHlUb0NsaXBib2FyZCA9IGZ1bmN0aW9uIGNvcHlUb0NsaXBib2FyZCh0ZXh0KSB7XHJcblx0dmFyICR0ZW1wID0gJChcIjxpbnB1dD5cIik7XHJcblx0JChcImJvZHlcIikuYXBwZW5kKCR0ZW1wKTtcclxuXHQkdGVtcC52YWwodGV4dCkuc2VsZWN0KCk7XHJcblx0ZG9jdW1lbnQuZXhlY0NvbW1hbmQoXCJjb3B5XCIpO1xyXG5cdCR0ZW1wLnJlbW92ZSgpO1xyXG59XHJcblxyXG4vKipcclxuICogZGlzYWJsZSB0ZXh0Tm9kZSBcIiN0ZXh0XCJcclxuICogQHBhcmFtIHtzdHJpbmd9IHhtbCAtIHhtbFxyXG4gKiBAcGFyYW0ge3N0cmluZ1tdPX0gYXJyYXlUYWdzIC0gb3B0aW9uYWxcclxuICogQHJldHVybnMge29iamVjdH1cclxuICovXHJcbmZ1bmN0aW9uIHBhcnNlWG1sKHhtbCwgYXJyYXlUYWdzKSB7XHJcblx0dmFyIGRvbSA9IG51bGw7XHJcblx0aWYgKHdpbmRvdy5ET01QYXJzZXIpIHtcclxuXHRcdGRvbSA9IChuZXcgRE9NUGFyc2VyKCkpLnBhcnNlRnJvbVN0cmluZyh4bWwsIFwidGV4dC94bWxcIik7XHJcblx0fVxyXG5cdGVsc2UgaWYgKHdpbmRvdy5BY3RpdmVYT2JqZWN0KSB7XHJcblx0XHRkb20gPSBuZXcgQWN0aXZlWE9iamVjdCgnTWljcm9zb2Z0LlhNTERPTScpO1xyXG5cdFx0ZG9tLmFzeW5jID0gZmFsc2U7XHJcblx0XHRpZiAoIWRvbS5sb2FkWE1MKHhtbCkpIHtcclxuXHRcdFx0dGhyb3cgZG9tLnBhcnNlRXJyb3IucmVhc29uICsgXCIgXCIgKyBkb20ucGFyc2VFcnJvci5zcmNUZXh0O1xyXG5cdFx0fVxyXG5cdH1cclxuXHRlbHNlIHtcclxuXHRcdHRocm93IFwiY2Fubm90IHBhcnNlIHhtbCBzdHJpbmchXCI7XHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBpc0FycmF5KG8pIHtcclxuXHRcdHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmFwcGx5KG8pID09PSAnW29iamVjdCBBcnJheV0nO1xyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcGFyc2VOb2RlKHhtbE5vZGUsIHJlc3VsdCkge1xyXG5cdFx0aWYgKHhtbE5vZGUubm9kZU5hbWUgPT0gXCIjdGV4dFwiICYmIHhtbE5vZGUubm9kZVZhbHVlLnRyaW0oKSA9PSBcIlwiKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHR2YXIganNvbk5vZGUgPSB7fTtcclxuXHRcdHZhciBleGlzdGluZyA9IHJlc3VsdFt4bWxOb2RlLm5vZGVOYW1lXTtcclxuXHRcdGlmIChleGlzdGluZykge1xyXG5cdFx0XHRpZiAoIWlzQXJyYXkoZXhpc3RpbmcpKSB7XHJcblx0XHRcdFx0cmVzdWx0W3htbE5vZGUubm9kZU5hbWVdID0gW2V4aXN0aW5nLCBqc29uTm9kZV07XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0W3htbE5vZGUubm9kZU5hbWVdLnB1c2goanNvbk5vZGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0aWYgKGFycmF5VGFncyAmJiBhcnJheVRhZ3MuaW5kZXhPZih4bWxOb2RlLm5vZGVOYW1lKSAhPSAtMSkge1xyXG5cdFx0XHRcdHJlc3VsdFt4bWxOb2RlLm5vZGVOYW1lXSA9IFtqc29uTm9kZV07XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0cmVzdWx0W3htbE5vZGUubm9kZU5hbWVdID0ganNvbk5vZGU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoeG1sTm9kZS5hdHRyaWJ1dGVzKSB7XHJcblx0XHRcdHZhciBsZW5ndGggPSB4bWxOb2RlLmF0dHJpYnV0ZXMubGVuZ3RoO1xyXG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0dmFyIGF0dHJpYnV0ZSA9IHhtbE5vZGUuYXR0cmlidXRlc1tpXTtcclxuXHRcdFx0XHRqc29uTm9kZVthdHRyaWJ1dGUubm9kZU5hbWVdID0gYXR0cmlidXRlLm5vZGVWYWx1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBsZW5ndGggPSB4bWxOb2RlLmNoaWxkTm9kZXMubGVuZ3RoO1xyXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xyXG5cdFx0XHRwYXJzZU5vZGUoeG1sTm9kZS5jaGlsZE5vZGVzW2ldLCBqc29uTm9kZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR2YXIgcmVzdWx0ID0ge307XHJcblx0aWYgKGRvbS5jaGlsZE5vZGVzLmxlbmd0aCkge1xyXG5cdFx0cGFyc2VOb2RlKGRvbS5jaGlsZE5vZGVzWzBdLCByZXN1bHQpO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHJlc3VsdDtcclxufVxyXG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///383\n')}}]);